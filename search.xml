<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>manjaroå®‰è£…å’Œé…ç½®</title>
      <link href="2021/01/14/manjaro-an-zhuang-he-pei-zhi/"/>
      <url>2021/01/14/manjaro-an-zhuang-he-pei-zhi/</url>
      
        <content type="html"><![CDATA[<h1 id="manjaroå®‰è£…å’ŒåŸºç¡€é…ç½®"><a href="#manjaroå®‰è£…å’ŒåŸºç¡€é…ç½®" class="headerlink" title="manjaroå®‰è£…å’ŒåŸºç¡€é…ç½®"></a>manjaroå®‰è£…å’ŒåŸºç¡€é…ç½®</h1><blockquote><p>æŒç»­æ›´æ–°</p></blockquote><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="å‡†å¤‡ï¼š"><a href="#å‡†å¤‡ï¼š" class="headerlink" title="å‡†å¤‡ï¼š"></a>å‡†å¤‡ï¼š</h3><ul><li><p>uç›˜ï¼Œä¸å°äº4g</p></li><li><p>isoé•œåƒ ğŸ‘‰ <a href="https://mirrors.tuna.tsinghua.edu.cn/osdn/storage/g/m/ma/manjaro/">æ¸…åå¤§å­¦å¼€æºé•œåƒç«™</a>ï¼Œé€‰æ‹©å¯¹åº”ç‰ˆæœ¬ï¼ˆæˆ‘æ˜¯kdeï¼‰</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20210104133934602.png" alt="image-20210104133934602"></p></li><li><p><a href="http://rufus.ie/">Rufus</a>ï¼Œå…‰ç›˜åˆ»å½•å·¥å…·(windows)</p></li><li><p>etcher (linux)</p></li></ul><h3 id="åˆ¶ä½œå¯åŠ¨ç›˜"><a href="#åˆ¶ä½œå¯åŠ¨ç›˜" class="headerlink" title="åˆ¶ä½œå¯åŠ¨ç›˜"></a>åˆ¶ä½œå¯åŠ¨ç›˜</h3><p>è¿›å…¥Rufusï¼Œé€‰æ‹©åˆšåˆšä¸‹å¥½çš„.isoæ–‡ä»¶ï¼Œå…¶ä»–åŸºæœ¬æ˜¯é»˜è®¤ï¼Œç‚¹å‡»ç¡®å®šï¼Œä¼šæç¤ºæ˜¯å¦æ¸…ç©ºï¼Œç¡®å®šå³å¯å¼€å§‹çƒ§å†™ã€‚è¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒé•¿ï¼Œç­‰è¿›åº¦æ¡è·‘å®Œäº†æç¤ºå®Œæˆå°±é€€å‡ºå³å¯ã€‚ï¼ˆä¸€å®šè¦å°å¿ƒï¼Œåˆ«å†ç‚¹ä¸€æ¬¡ï¼Œä¼šå‡ºé—®é¢˜ï¼‰</p><h3 id="åˆ©ç”¨Uç›˜å¯åŠ¨"><a href="#åˆ©ç”¨Uç›˜å¯åŠ¨" class="headerlink" title="åˆ©ç”¨Uç›˜å¯åŠ¨"></a>åˆ©ç”¨Uç›˜å¯åŠ¨</h3><p>æˆ‘çš„ç”µè„‘æ˜¯æˆ´å°”çš„ï¼Œæ’å…¥uç›˜ï¼Œå…³æœºåæŒ‰F12ï¼Œå³å¯è¿›å…¥BIOSï¼Œé€‰æ‹©Uç›˜å¯åŠ¨ã€‚</p><p><strong>é—®é¢˜</strong></p><ul><li>æœ‰çš„äººæ‰¾ä¸åˆ°Uç›˜å¯åŠ¨é€‰é¡¹ï¼Œå»biosè®¾ç½®Uç›˜çš„ä¼˜å…ˆçº§UEFIå¯åŠ¨ï¼Œå…·ä½“æ ¹æ®æœºå‹ç™¾åº¦å³å¯</li><li>æœ‰çš„äººä½¿ç”¨uç›˜å¯åŠ¨è¿›ä¸å»ï¼Œè¦åœ¨biosä¸­å…³é—­ security boot</li></ul><h3 id="è¿›å…¥pre-installç•Œé¢"><a href="#è¿›å…¥pre-installç•Œé¢" class="headerlink" title="è¿›å…¥pre-installç•Œé¢"></a>è¿›å…¥pre-installç•Œé¢</h3><p>é¦–å…ˆæ˜¯è¿™ä¸ªç•Œé¢ï¼ˆ<strong>å›¾æ˜¯æˆ‘å·çš„</strong>ï¼ŒåŸæ–‡é“¾æ¥<a href="https://linuxacme.icu/?p=99">åœ¨è¿™</a>ï¼‰ï¼Œ<code>lang</code>å¯ä»¥é…ç½®ä¸­æ–‡ï¼Œä¹Ÿå¯ä»¥è¿›å…¥é‡Œé¢çš„ç•Œé¢å†è®¾ç½®ï¼Œdriverè®¾ç½®é©±åŠ¨ï¼Œå¦‚æœæ˜¯nå¡é€‰æ‹©nofreeï¼Œä¼šè‡ªåŠ¨ç»™ä¸€ä¸ªæ˜¾å¡é©±åŠ¨çš„é…ç½®æ–¹å¼ï¼Œä¹Ÿå¯ä»¥å®‰è£…å®Œæˆåå†é…ç½®ã€‚ç„¶åè¿›å…¥ç³»ç»Ÿå®‰è£…</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20210104135559089.png" alt="image-20210104135559089"></p><h3 id="çœŸæ­£çš„å®‰è£…"><a href="#çœŸæ­£çš„å®‰è£…" class="headerlink" title="çœŸæ­£çš„å®‰è£…"></a>çœŸæ­£çš„å®‰è£…</h3><p>ç‚¹å‡»æ¡Œé¢çš„install Manjaroè¿›å…¥å¯è§†åŒ–å®‰è£…ç•Œé¢ï¼ˆ<strong>å®‰è£…ä¸€å®šæ–­ç½‘ï¼Œå¦åˆ™æœ€åä¼šå¡åœ¨93%ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</strong>ï¼‰</p><p>è¿™æ—¶å€™å°±ä¼šåœ¨æ¬¢è¿é¡µé¢å¡ä¸€å°ä¼šå„¿ï¼Œæç¤ºä½ æœªè¿æ¥ç½‘ç»œï¼Œæˆ‘ä»¬ä¸ç®¡ä»–ï¼Œç»§ç»­å®‰è£…ã€‚</p><p>è®¾ç½®å¥½æ—¶åŒºä¸ºshanghaiï¼Œé”®ç›˜ä¹ æƒ¯ç­‰ç­‰ï¼Œè¿›å…¥<strong>åˆ†åŒºé¡µé¢</strong>ã€‚</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20210104140332046.png"></p><blockquote><p>æˆ‘è¿™é‡Œæ˜¯ç›´æ¥å–ä»£win10äº†ï¼Œæœ‰çš„ç«¥é‹å¯èƒ½ä¼šè£…åŒç³»ç»Ÿï¼Œå¯ä»¥æŸ¥çœ‹ç½‘ä¸Šçš„æ•™ç¨‹</p><p>é…ç½®ï¼š</p><ul><li>æˆ´å°”G3è€ç‰ˆ<ul><li>cpu i5-8300H</li><li>æ˜¾å¡ gtx1050ti</li><li>å†…å­˜ 8+8</li><li>ç¡¬ç›˜ 128å›ºæ€+1Tæœºæ¢°</li></ul></li></ul></blockquote><p>åœ¨è¿™ä¸ªç•Œé¢ç›´æ¥ç‚¹åˆ é™¤ï¼Œå°±èƒ½æŠŠåŸæ¥çš„Windowsåˆ†åŒºåˆ é™¤äº†ã€‚è¿™é‡Œç»™ä¸¤ä¸ªåˆ†åŒºæ–¹æ¡ˆ</p><p><strong>çº¯å›ºæ€</strong></p><p>256Gçš„å¯ä»¥è¿™ä¹ˆåˆ†ï¼š</p><table><thead><tr><th align="center">æŒ‚è½½ç‚¹</th><th align="center">æ–‡ä»¶ç³»ç»Ÿ</th><th align="center">å¤§å°</th><th align="center">æ ‡è®°</th></tr></thead><tbody><tr><td align="center">/boot/efi</td><td align="center">FAT32</td><td align="center">300Mè¶³å¤Ÿäº†</td><td align="center">/bootï¼ˆæ–°ç‰ˆçš„åªéœ€å‹¾é€‰è¿™ä¸ªï¼Œæ—§ç‰ˆçš„å¯èƒ½è¿˜æœ‰espï¼‰</td></tr><tr><td align="center">/opt</td><td align="center">ext4</td><td align="center">30Gï¼ˆè¿™ä¸ªåŒºåŸŸå¯ä»¥ä¸åˆ†ï¼Œç›´æ¥å½’æ ¹ç›®å½•ä¸­ï¼‰</td><td align="center">æ— </td></tr><tr><td align="center">/</td><td align="center">ext4</td><td align="center">30G</td><td align="center">æ— </td></tr><tr><td align="center">/swap</td><td align="center">linuxswap</td><td align="center">è·Ÿä½ çš„å†…å­˜æœ‰å…³å¦‚æœæ˜¯8gå†…å­˜è¿™é‡Œå°±æ˜¯8gï¼Œå¦‚æœæ˜¯16gå°±æ˜¯16g</td><td align="center">æ— </td></tr><tr><td align="center">æ— </td><td align="center">æ— </td><td align="center">8Gï¼ˆç©º8ä¸ªGä½œä¸ºè¡¥å……ï¼Ÿï¼Ÿï¼‰</td><td align="center">æ— </td></tr><tr><td align="center">/home</td><td align="center">ext4</td><td align="center">å‰©ä¸‹çš„å…¨éƒ¨</td><td align="center">æ— </td></tr></tbody></table><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20210104140717701.png" alt="å›¾æ˜¯æˆ‘å·çš„"></p><p>512Gçš„çœ‹ç€å¼„å°±è¡Œäº†ï¼Œå«Œéº»çƒ¦å¯ä»¥ä¸ç”¨å•ç‹¬åˆ†å‡ºoptå’Œusrç­‰åŒºï¼Œç›´æ¥æ”¾æ ¹ç›®å½•ä¸­å°±è¡Œ</p><p><strong>å›ºæ€+æœºæ¢°</strong></p><p>manjaroçš„è¿™é‡Œå¯ä»¥åˆ‡æ¢ç¡¬ç›˜</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20210104141738254.png" alt="image-20210104141738254"></p><p>åˆ†åŒºç­–ç•¥æ˜¯ï¼š</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">SSDç¡¬ç›˜ï¼š&#x2F;boot&#x2F;efi 300Mswaplinux 8Gï¼ˆæ ¹æ®ä½ çš„å†…å­˜å®šï¼‰ç©ºä¸€äº›ç©ºé—´å‡ºæ¥ï¼Œè·Ÿä¸Šè¾¹çš„å›¾ä¸€æ ·&#x2F;    å‰©ä¸‹çš„å…¨éƒ¨HHDç¡¬ç›˜ï¼š&#x2F;home   è‡ªå·±çœ‹ç€è®¾å§ï¼Œæ¨è100Gä»¥ä¸Š<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è‡³æ­¤ï¼Œï¼Œï¼Œï¼Œï¼Œ</p><p>ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œè¾“å…¥ä¸€äº›ä¿¡æ¯ï¼Œé€‰æ‹©no office å› ä¸ºæˆ‘ä»¬è¦ç”¨wpsï¼Œï¼Œä¸€ç›´åˆ°æœ€åç‚¹å‡»å®‰è£…å³å¯ã€‚</p><p><strong>å†æ¬¡æé†’ï¼Œå®‰è£…ä¸€å®šè¦æ–­ç½‘ï¼Œå¦åˆ™ä¼šå¡åœ¨93%ï¼Œå¡ä¸€å¤©</strong></p><hr><h2 id="åŸºç¡€é…ç½®"><a href="#åŸºç¡€é…ç½®" class="headerlink" title="åŸºç¡€é…ç½®"></a>åŸºç¡€é…ç½®</h2><p><strong>è¿™é‡Œå…ˆæä¾›ä¸€äº›åŸºæœ¬çš„æŒ‡ä»¤ç”¨æ¥ç†è§£</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># å®‰è£…xxxpacman -S  xxx   # åˆ é™¤XXXXXï¼ˆä¿ç•™ä¾èµ–çš„åŒ…ï¼‰pacman -R XXXXX# åˆ é™¤XXXXXä»¥åŠå…¶ä¾èµ–çš„åŒ…pacman -Rs XXXXX#  å®‰è£…è‡ªå·±ä¸‹è½½çš„XXXXXåŒ…æˆ–è€…è½¬æ¢è¿‡çš„debpacman -U XXXXX# æ¸…ç†æœªå®‰è£…çš„åŒ…æ–‡ä»¶pacman -Sc<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯¦ç»†çš„æŒ‡ä»¤å¯ä»¥æŸ¥çœ‹<a href="https://www.cnblogs.com/msvc/p/11298188.html">è¿™é‡Œ</a></p><hr><h3 id="é…ç½®æº"><a href="#é…ç½®æº" class="headerlink" title="é…ç½®æº"></a>é…ç½®æº</h3><h4 id="pacman"><a href="#pacman" class="headerlink" title="pacman"></a>pacman</h4><blockquote><p>pacmanæ˜¯manjaroçš„åº“ç®¡ç†è½¯ä»¶ï¼Œå›½å¤–æºå¤ªæ…¢ä¸”ä¸ç¨³å®šï¼Œæ‰€ä»¥è¦åˆ‡æ¢ä¸ºå›½å†…æº</p></blockquote><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo pacman-mirrors -i -c China -m rank<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ˜¯å¯¹å›½å†…é•œåƒæºæµ‹é€Ÿå¹¶æ’åºï¼Œåœ¨å¼¹å‡ºçš„çª—å£ä¸­é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªï¼Œå¤šä¸ªçš„æƒ…å†µæ˜¯å¦‚æœç¬¬ä¸€ä¸ªè¿æ¥è¶…æ—¶å°±ä¼šå»è®¿é—®ç¬¬äºŒä¸ª</p><h4 id="æ·»åŠ AURçš„æº"><a href="#æ·»åŠ AURçš„æº" class="headerlink" title="æ·»åŠ AURçš„æº"></a>æ·»åŠ AURçš„æº</h4><p>Manjaroæ˜¯archLinuxçš„è¡ç”Ÿç³»ï¼Œå¯ä»¥ä½¿ç”¨Archä¸°å¯Œçš„AURåº“ï¼Œå®˜ç½‘æ˜¯<a href="https://aur.archlinux.org/">è¿™ä¸ª</a></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo vim &#x2F;etc&#x2F;pacman.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœæç¤ºvimä¸å­˜åœ¨ï¼Œæˆ‘ä»¬å…ˆä¸‹è½½vim</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo pacman -Sy vim# è¿™é‡Œçš„ -Sè¡¨ç¤ºä¸‹è½½ï¼Œyè¡¨ç¤ºæ›´æ–°æºï¼Œä¿è¯ä½ ä¸‹è½½çš„æ˜¯æœ€æ–°çš„ï¼Œå…¶å® -Sä¹Ÿå¯ä»¥ä¸‹è½½<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å†æ¬¡è¾“å…¥ä¸Šé¢çš„æŒ‡ä»¤ï¼Œæ‰“å¼€pacman.confåï¼Œåœ¨æœ«å°¾æ·»åŠ å¦‚ä¸‹å†…å®¹</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">[archlinuxcn]SigLevel &#x3D; Optional TrustedOnlyServer &#x3D; https:&#x2F;&#x2F;mirrors.tuna.tsinghua.edu.cn&#x2F;archlinuxcn&#x2F;$arch<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å®‰è£…å¯†é’¥</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo pacman -S archlinuxcn-keyring antergos-keyring<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ›´æ–°è½¯ä»¶åˆ—è¡¨</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo pacman -Syu<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h4 id="ä¸‹è½½å¹¶é…ç½®yay"><a href="#ä¸‹è½½å¹¶é…ç½®yay" class="headerlink" title="ä¸‹è½½å¹¶é…ç½®yay"></a>ä¸‹è½½å¹¶é…ç½®yay</h4><blockquote><p> yayæ˜¯ä¼˜ç§€çš„AURåŒ…ç®¡ç†å·¥å…·ï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿pacmanï¼Œè€Œä¸”yayçš„è¯­æ³•è·Ÿpacmanä¸€æ¨¡ä¸€æ ·</p></blockquote><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo pacman -Sy yay<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é…ç½®é•œåƒ (æ¨èæ¸…åé•œåƒ<a href="https://mirrors.tuna.tsinghua.edu.cn/help/AUR/">ç½‘ç«™</a>)</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay --aururl &quot;https:&#x2F;&#x2F;aur.tuna.tsinghua.edu.cn&quot; --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹çš„é…ç½®æ–‡ä»¶ä½äº <code>~/.config/yay/config.json</code> ï¼Œè¿˜å¯é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ä¿®æ”¹è¿‡çš„é…ç½®ï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -P -g<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h3 id="å¸¸ç”¨è½¯ä»¶å®‰è£…"><a href="#å¸¸ç”¨è½¯ä»¶å®‰è£…" class="headerlink" title="å¸¸ç”¨è½¯ä»¶å®‰è£…"></a>å¸¸ç”¨è½¯ä»¶å®‰è£…</h3><h4 id="è¾“å…¥æ³•å®‰è£…"><a href="#è¾“å…¥æ³•å®‰è£…" class="headerlink" title="è¾“å…¥æ³•å®‰è£…"></a>è¾“å…¥æ³•å®‰è£…</h4><p>è¿™é‡Œæˆ‘ä»¬å®‰è£…fcitxè¾“å…¥æ³•ï¼Œä¸»è¦æ˜¯æœç‹—è¾“å…¥æ³•ä¸å¤ªå¥½ç”¨ï¼Œå¦‚æœæ˜¯gnomeæ¡Œé¢ç¯å¢ƒï¼Œè¯·é€‰æ‹©ibus</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo pacman -S fcitx-im fcitx-configtool pacaur yay fcitx-libpinyin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹é…ç½®æ–‡ä»¶ä½¿fcitxè¾“å…¥æ³•ç”Ÿæ•ˆ</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo sed -i &#39;$a\export GTK_IM_MODULE&#x3D;fcitx\nexport QT_IM_MODULE&#x3D;fcitx\nexport XMODIFIERS&#x3D;&quot;@im&#x3D;fcitx&quot;&#39;  &#x2F;etc&#x2F;environment<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½¿ç”¨<code>cat /etc/environment</code>æŸ¥çœ‹</p><p>ç„¶åè¯·æ³¨é”€æˆ–è€…é‡å¯ï¼Œå°±èƒ½ç”Ÿæ•ˆäº†ã€‚</p><p>ctrl+spaceå¯ä»¥åˆ‡æ¢è¾“å…¥æ³•</p><p>å¦‚æœé…ç½®è¾“å…¥æ³•è¯·è¾“å…¥è¿™ä¸ªæŒ‡ä»¤ï¼Œæˆ–è€…å»æ¡Œé¢æ‰¾å°å›¾æ ‡å³å‡»å®ƒ</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">fcitx-config-gtk3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="tim"><a href="#tim" class="headerlink" title="tim"></a>tim</h4><p>åœ¨archLinuxå®˜ç½‘æœqqï¼Œç°åœ¨timå«qq.tim.sparkï¼Œæ˜¯åŸºäºwine5çš„</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20210104145444472.png" alt="image-20210104145444472"></p><p>ä¸‹è½½è¾“å…¥ï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -Sy com.qq.tim.spark<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸€ç›´å›è½¦å°±è¡Œäº†ï¼Œï¼Œè€å¿ƒç­‰å¾…å®‰è£…å®Œæˆå³å¯</p><p><strong>å¾®ä¿¡ï¼ŒqqåŒç†</strong></p><hr><h4 id="ç½‘æ˜“äº‘"><a href="#ç½‘æ˜“äº‘" class="headerlink" title="ç½‘æ˜“äº‘"></a>ç½‘æ˜“äº‘</h4><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -Sy netease-cloud-music  ###å…·ä½“æ˜¯ä¸æ˜¯è¿™ä¸ªå‘½ä»¤æˆ‘å¿˜äº†ï¼Œï¼Œå»å®˜ç½‘å¯ä»¥æŸ¥çœ‹<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>è§£å†³ç½‘æ˜“äº‘æœç´¢ä¸èƒ½ç”¨ä¸­æ–‡çš„é—®é¢˜</strong></p><p>????</p><h4 id="typora"><a href="#typora" class="headerlink" title="typora"></a>typora</h4><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -Sy typora<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="xdm"><a href="#xdm" class="headerlink" title="xdm"></a>xdm</h4><blockquote><p>xdmæ˜¯ç±»ä¼¼äºidmçš„å¤šçº¿ç¨‹ä¸‹è½½å™¨ï¼Œå¯ä»¥ç”¨æ›´å¿«çš„é€Ÿåº¦ä¸‹è½½è½¯ä»¶~</p><p><a href="https://subhra74.github.io/xdm/">å®˜ç½‘åœ¨æ­¤</a></p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20210104152100305.png" alt="image-20210104152100305"></p><p>ç‚¹å‡»ä¸‹è½½å³å¯ï¼Œæ˜¯tar.gzæ ¼å¼çš„</p><p>ä¸‹è½½å®Œæˆåè§£å‹ç¼©å¹¶å®‰è£…</p><h4 id="flameshot"><a href="#flameshot" class="headerlink" title="flameshot"></a>flameshot</h4><blockquote><p>Linuxä¸‹å¥½ç”¨çš„æˆªå›¾è½¯ä»¶ falmeshotï¼Œè·ŸWindowsä¸‹çš„ Snipaste æœ‰è¿‡è€Œæ— ä¸åŠ</p></blockquote><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo pacman -Sy flameshot<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>flameshotåˆå«ç«ç„°æˆªå›¾ï¼Œæˆ‘ä»¬ä¸‹è½½å¥½ä»¥åï¼Œå¯åŠ¨åº”ç”¨ï¼Œå·¦ä¸‹è§’å°±ä¼šå‡ºç°å›¾æ ‡</p><p><strong>è®¾ç½®å¿«æ·é”®</strong></p><p>ç³»ç»Ÿè®¾ç½®==ã€‹å¿«æ·é”®==ã€‹è‡ªå®šä¹‰å¿«æ·é”®==ã€‹ç¼–è¾‘==ã€‹æ–°å»º==ã€‹å…¨å±€å¿«æ·é”®==ã€‹å‘½ä»¤/URL</p><p>è®¾ç½®åŠ¨ä½œä¸º <code>flameshot gui</code></p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/img/image-20210109232237012.png" alt="image-20210109225955035"></p><p>è®¾ç½®è§¦å‘å™¨ï¼ˆå¿«æ·å»ºï¼‰ï¼Œä¿å­˜å³å¯</p><hr><h4 id="wps"><a href="#wps" class="headerlink" title="wps"></a>wps</h4><p>archlinuxä¸Šçš„wpsä¸‹è½½ä¸‹æ¥çš„æ˜¯è‹±æ–‡çš„ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥å»å®˜ç½‘ä¸‹è½½çš„wps for linux â€”-&gt; <a href="https://www.wps.cn/product/wpslinux">å®˜ç½‘</a></p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20210104152220686.png" alt="image-20210104152220686"></p><p>è¿™æ—¶å€™æˆ‘ä»¬ç”¨xdmä¸‹è½½é€Ÿåº¦ä¼šå¿«ä¸€ç‚¹~</p><p>æˆ‘ä»¬è¿™æ—¶å€™ä¸‹è½½çš„æ˜¯debåŒ…ï¼Œåœ¨archlinuxä¸­éœ€è¦è¿›è¡Œè½¬æ¢ï¼Œæˆ‘ä»¬éœ€è¦<code>debtap</code>æ¥å¸®åŠ©æˆ‘ä»¬</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -Sy debtap## æ›´æ¢ä¸­å›½æº#æ›¿æ¢ï¼šhttp:&#x2F;&#x2F;ftp.debian.org&#x2F;debian&#x2F;distshttps:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;debian&#x2F;dists#æ›¿æ¢ï¼šhttp:&#x2F;&#x2F;archive.ubuntu.com&#x2F;ubuntu&#x2F;distshttps:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;ubuntu&#x2F;dists&#x2F;#æ‰§è¡Œå‡çº§sudo debtap -u#å‡çº§å®Œæˆåä½¿ç”¨è¯¥æŒ‡ä»¤å®‰è£…ï¼Œå®‰è£…æ—¶ä¼šæç¤ºè¾“å…¥åŒ…åï¼Œä»¥åŠlicenseã€‚åŒ…åéšæ„ï¼Œlicenseå¡«GPL ä¸Šè¿°æ“ä½œå®Œæˆåä¼šåœ¨debåŒ…åŒçº§ç›®å½•ç”Ÿæˆxxx.tar.xzæ–‡ä»¶sudo debtap xxx.deb# å®‰è£…å®Œæˆåï¼Œæ‰§è¡Œsudo pacman -U xxx.tar.xz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ss"><a href="#ss" class="headerlink" title="ss"></a>ss</h4><p>manjaroå®˜æ–¹æœ‰ä¸€ä¸ªshadowsocks-qt5ï¼Œä¸‹è½½ä»¥åå¡«å†™ç›¸åº”çš„é…ç½®ï¼Œå³å¯ä½¿ç”¨ã€‚ä¸è¿‡æ˜¯é»˜è®¤å¯¹1080ç«¯å£å¼€æ”¾ä»£ç†æƒé™ã€‚</p><p>å¦‚æœæ˜¯åœ¨ç»ˆç«¯ä¸­ä¸Šç½‘</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -S proxychains-ngsudo vim &#x2F;etc&#x2F;proxychains.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ–‡ä»¶æœ«å°¾ä¿®æ”¹ä¸ºï¼Œæˆ–è€…æ·»åŠ ä¸ºï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">socks5 127.0.0.1 1080<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åï¼Œå¤§å¤šæ•°çš„ç»ˆç«¯è½¯ä»¶å°±å¯ä»¥ä¸Šç½‘äº†ï¼Œä¾‹å¦‚ï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">proxychains curl www.google.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/img/image-20210109230138403.png"></p><p><strong>é…ç½®å…¨å±€ä»£ç†</strong></p><p>ç‰¹åˆ«ç®€å•ï¼š</p><ol><li>å®‰è£…polipo</li></ol><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo pacman -Sy polipo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="2"><li>è®¾ç½®</li></ol><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo cp &#x2F;etc&#x2F;polipo&#x2F;config.sample &#x2F;etc&#x2F;polipo&#x2F;configsudo vim &#x2F;etc&#x2F;polipo&#x2F;config<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="3"><li>ä¿®æ”¹</li></ol><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">proxyAddress &#x3D; &quot;0.0.0.0&quot;allowedClients &#x3D; 127.0.0.1socksParentProxy &#x3D; &quot;127.0.0.1:1080&quot;socksProxyType &#x3D; socks5<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ol start="4"><li>é‡å¯æœåŠ¡ï¼Œè¿™æ—¶å€™å°±ä¼šåœ¨8123ç«¯å£å¼€ä¸€ä¸ªä»£ç†</li></ol><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo systemctl restart polipo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="5"><li>ç¼–è¾‘ <code>~/.bashrc</code>æˆ–è€…<code>~/.zshrc</code>ï¼Œè®¾ç½®å…¨å±€ä»£ç†å˜é‡ï¼Œé‡å¯çª—å£</li></ol><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">alias proxyon&#x3D;&#39;export http_proxy&#x3D;http:&#x2F;&#x2F;127.0.0.1:8123 https_proxy&#x3D;http:&#x2F;&#x2F;127.0.0.1:8123&#39;alias proxyoff&#x3D;&#39;unset http_proxy https_proxy&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç»ˆç«¯è¾“å…¥proxyon å°±å¼€å¯äº†ï¼Œè¾“å…¥proxyoff å°±å…³é—­äº†</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/img/image-20210109231914693.png"></p><ol start="6"><li>è®¾ç½®å¼€æœºè‡ªå¯åŠ¨</li></ol><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo systemctl enable polipo.service<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="oh-my-zsh"><a href="#oh-my-zsh" class="headerlink" title="oh-my-zsh"></a>oh-my-zsh</h4><p>å®‰è£…zshï¼Œç°åœ¨æœ€æ–°ç‰ˆæœ¬çš„manjaroå·²ç»è‡ªå¸¦zshäº†</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -Sy zsh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ‘å–œæ¬¢ç”¨zshï¼Œå› ä¸ºå®ƒåŠŸèƒ½æ›´å¼ºå¤§ï¼Œæ‰€ä»¥æˆ‘è®¾ç½®zshä¸ºé»˜è®¤ç»ˆç«¯shell</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">cat &#x2F;etc&#x2F;shells # æŸ¥çœ‹ç»ˆç«¯æœ‰å¤šå°‘ç§shellchsh -s &#x2F;bin&#x2F;zsh # è®¾ç½®zshä¸ºé»˜è®¤  é‡å¯ç”Ÿæ•ˆ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å®‰è£…oh-my-zsh</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">## éœ€è¦ä¸€ç‚¹æ‰‹æ®µï¼Œæ‰èƒ½ä¸‹è½½ï¼ˆç§‘å­¦ä¸Šç½‘ï¼‰sh -c &quot;$(proxychains curl -fsSL https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;robbyrussell&#x2F;oh-my-zsh&#x2F;master&#x2F;tools&#x2F;install.sh)&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p> xxxxxå®‰è£…ä¸»é¢˜</p><p>å‚è€ƒåˆ«çš„åšå®¢</p><h4 id="filezilla-å¼ºå¤§çš„FTPå·¥å…·"><a href="#filezilla-å¼ºå¤§çš„FTPå·¥å…·" class="headerlink" title="filezilla å¼ºå¤§çš„FTPå·¥å…·"></a>filezilla å¼ºå¤§çš„FTPå·¥å…·</h4><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -Sy filezilla<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="obs"><a href="#obs" class="headerlink" title="obs"></a>obs</h4><blockquote><p>ç›´æ’­ï¼Œå½•å±è½¯ä»¶</p></blockquote><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo pacman -Sy obs-studio<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="freerdp"><a href="#freerdp" class="headerlink" title="freerdp"></a>freerdp</h3><blockquote><p>linuxè¿æ¥windowsæœåŠ¡å™¨çš„ä¸€æ¬¾å¥½ç”¨çš„è½¯ä»¶</p></blockquote><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -Sy freerdp#å®‰è£…å®Œæˆä»¥åï¼Œåœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªç›®å½•cd ~mkdir shared<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åè¾“å…¥è¿™æ¡æŒ‡ä»¤ï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">xfreerdp &#x2F;f &#x2F;v:æœåŠ¡å™¨ip &#x2F;u:æœåŠ¡å™¨ç”¨æˆ·å &#x2F;p:æœåŠ¡å™¨å¯†ç  &#x2F;workarea &#x2F;sound &#x2F;drive:shared,&#x2F;home&#x2F;ä½ çš„ç”¨æˆ·&#x2F;shared<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å¼€å‘è½¯ä»¶å®‰è£…"><a href="#å¼€å‘è½¯ä»¶å®‰è£…" class="headerlink" title="å¼€å‘è½¯ä»¶å®‰è£…"></a>å¼€å‘è½¯ä»¶å®‰è£…</h2><h3 id="gité…ç½®ä»£ç†"><a href="#gité…ç½®ä»£ç†" class="headerlink" title="gité…ç½®ä»£ç†"></a>gité…ç½®ä»£ç†</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">git config --global https.proxy socks5:127.0.0.1:1080git config --global http.proxy socks5:127.0.0.1:1080vim ~&#x2F;.gitconfigå¯ä»¥çœ‹è§<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="jdk"><a href="#jdk" class="headerlink" title="jdk"></a>jdk</h3><blockquote><p>å…¶ä»–ç‰ˆæœ¬çš„å‚è€ƒå³å¯ï¼Œè¯¦æƒ…æŸ¥æ‰¾auråº“</p></blockquote><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -Sy jdk8-openjdk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="maven"><a href="#maven" class="headerlink" title="maven"></a>maven</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -Sy maven<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‰©ä¸‹çš„æ“ä½œå°±è·Ÿwindowsä¸‹çš„ä¸€æ ·äº†</p><h3 id="node-js"><a href="#node-js" class="headerlink" title="node.js"></a>node.js</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -Sy nodejs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å®‰è£…npm</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -Sy npm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å®‰è£…yarn</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm install yarn -g<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®¾ç½®npmå’Œyarnæº</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">npm config set registry https:&#x2F;&#x2F;registry.npm.taobao.org --globalnpm config set disturl https:&#x2F;&#x2F;npm.taobao.org&#x2F;dist --globalyarn config set registry https:&#x2F;&#x2F;registry.npm.taobao.org --globalyarn config set disturl https:&#x2F;&#x2F;npm.taobao.org&#x2F;dist --global<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h3><p>redis ä½œä¸ºç¼“å­˜ï¼Œåœ¨å¼€å‘ä¸­å¾ˆå¸¸è§</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -Sy redis<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="redis-desktop-manager"><a href="#redis-desktop-manager" class="headerlink" title="redis-desktop-manager"></a>redis-desktop-manager</h3><p>linuxä¸‹çš„ä¸€æ¬¾rediså¯è§†åŒ–ç®¡ç†å·¥å…·</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yay -Sy redis-desktop-manager<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><p>mysql åœ¨å®˜æ–¹åŒ…ä¸­æœ‰</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo pacman -Sy mysql     Y4&gt;%hyP?%AGs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>åˆå§‹åŒ–mysql</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo mysqld --initialize --user&#x3D;mysql --basedir&#x3D;&#x2F;usr --datadir&#x3D;&#x2F;var&#x2F;lib&#x2F;mysql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å¯èƒ½ä¼šæŠ¥é”™</p><p>mysqld: error while loading shared libraries: <strong>libicuuc.so.68</strong>: cannot open shared object file: No such file or directory</p></blockquote><p>è¿™é‡Œè¦æ„Ÿè°¢åšä¸»æä¾›çš„æ€è·¯ï¼š<a href="https://www.jianshu.com/p/a7f1f2f5c1c5">https://www.jianshu.com/p/a7f1f2f5c1c5</a></p><p><strong>è§£å†³æ€è·¯</strong>ï¼š</p><p>å»<a href="http://site.icu-project.org/home">å®˜ç½‘</a>ä¸‹è½½libicuuc.so.68çš„åŒ…ï¼Œæ‰§è¡Œ</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">cd source .&#x2F;configure --prefix&#x3D;&#x2F;usr          make<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¼–è¯‘å®Œæˆä¹‹åï¼Œè¿›å…¥<code>source/lib</code>ç›®å½•ä¸­</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">cp libicuuc.so.68*  &#x2F;usr&#x2F;libcp libicui18n.so.68* &#x2F;usr&#x2F;libcp libicudata.so.68* &#x2F;usr&#x2F;lib<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ³¨æ„</strong>ï¼šåªéœ€è¦æ‹·è´å‰ç¼€æ˜¯è¿™å‡ ä¸ªçš„å°±è¡Œäº†ï¼Œå¦‚æœç‰ˆæœ¬ä¸ä¸€æ ·ï¼Œä¿®æ”¹æ•°å­—å°±è¡Œæ¯”å¦‚è¯´ï¼š <code>**cp libicuuc.so.64* /usr/lib</code></p><p>å…¨éƒ¨åšå®Œä¹‹åï¼Œå†æ¬¡æ‰§è¡Œåˆå§‹åŒ–æ“ä½œï¼Œ</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/img/20210113115255.png"></p><p><strong>å¼€å¯mysqlæœåŠ¡</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo systemctl start mysqld.service<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>è®¿é—®å¹¶ä¿®æ”¹å¯†ç </strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">mysql -u root -palter user &#39;root&#39;@&#39;localhost&#39; identified with mysql_native_password by &#39;å¯†ç &#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><hr><p><strong>mysql å…³é—­å¤§å°å†™æ•æ„Ÿ</strong></p><ol><li>åœæ­¢MySQL</li></ol><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo systemctl stop mysqld<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="2"><li>åˆ é™¤ MySQLçš„æ•°æ®ï¼ˆå¦‚æœä»¥å‰æœ‰æ•°æ®è®°å¾—å…ˆå¤‡ä»½ï¼‰</li></ol><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo rm -rf &#x2F;var&#x2F;lib&#x2F;mysql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="3"><li>ä¿®æ”¹ é…ç½®æ–‡ä»¶</li></ol><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo vim &#x2F;etc&#x2F;mysql&#x2F;my.cnfæœ€åé¢æ·»åŠ  lower_case_table_names &#x3D; 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ol start="4"><li>é‡æ–°åˆå§‹åŒ–å¯†ç å’Œæ•°æ®åº“ï¼ˆç¡®ä¿/var/lib/mysqlä¸å­˜åœ¨ï¼‰</li></ol><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo mysqld --initialize --user&#x3D;mysql --basedir&#x3D;&#x2F;usr --datadir&#x3D;&#x2F;var&#x2F;lib&#x2F;mysql<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol start="5"><li>å¯åŠ¨æœåŠ¡</li></ol><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo systemctl start mysqld<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="IDEA"><a href="#IDEA" class="headerlink" title="IDEA"></a>IDEA</h3><p>yayä¸‹è½½ï¼Œä¸èƒ½è‡ªä¸»æ›´æ–°ï¼Œå®˜ç½‘ä¸‹è½½ï¼Œèƒ½è‡ªä¸»æ›´æ–°ï¼Œä½†æ˜¯è¦è‡ªå·±åˆ›å»ºå¿«æ·æ–¹å¼</p><p>è¿™é‡Œè®²ä¸€ä¸‹å®˜ç½‘ä¸‹è½½å’Œå®‰è£…çš„æ–¹æ³•ï¼š</p><p>å»ideaå®˜ç½‘ï¼Œä¸‹è½½idea for linuxï¼Œæ˜¯tar.gzæ ¼å¼çš„ï¼Œè§£å‹å°±èƒ½ç”¨</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/img/20210113122751.png"></p><p>è§£å‹ä¹‹åï¼Œåœ¨/bin/ç›®å½•ä¸­ï¼Œæœ‰ä¸ª<code>idea.sh</code>ï¼Œæ˜¯å¯åŠ¨æ–‡ä»¶ï¼Œidea.pngæ˜¯å›¾ç‰‡ï¼Œ</p><p><strong>è¿™ç§æ–¹å¼ä¸ä¼šè‡ªåŠ¨åˆ›å»ºå¿«æ·æ–¹å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è‡ªå·±åˆ›å»º</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">cd &#x2F;usr&#x2F;share&#x2F;applications   #è¿™é‡Œé¢å…¨æ˜¯å¿«æ·æ–¹å¼# æˆ‘ä»¬éšä¾¿å¤åˆ¶ä¸€ä¸ªå¿«æ·æ–¹å¼ï¼Œä½œä¸ºç»™ideaçš„ï¼Œå› ä¸ºè¿™äº›å¿«æ·æ–¹å¼æ ¼å¼éƒ½ä¸€æ ·ï¼Œæ‰€ä»¥å“ªä¸€ä¸ªéƒ½è¡Œsudo cp xdman.desktop idea.desktop<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/img/20210113123408.png"></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo vim idea.desktop #ç¼–è¾‘è¿™ä¸ªå¿«æ·æ–¹å¼#æ ¼å¼å¦‚ä¸‹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/img/20210113123834.png"></p><p>ä¿®æ”¹å®Œä¿å­˜å³å¯ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥åœ¨alt+spaceä¸­çœ‹åˆ°å¿«æ·æ–¹å¼äº†ï¼ï¼ï¼</p><h3 id="Webstorm"><a href="#Webstorm" class="headerlink" title="Webstorm"></a>Webstorm</h3><p>æ­¥éª¤åŒIDEA</p><h3 id="navicat"><a href="#navicat" class="headerlink" title="navicat"></a>navicat</h3><p>å®‰è£…ç ´è§£å‚è€ƒï¼š<a href="https://rlds.tk/">https://rlds.tk/</a></p><h2 id="Nå¡é©±åŠ¨"><a href="#Nå¡é©±åŠ¨" class="headerlink" title="Nå¡é©±åŠ¨"></a>Nå¡é©±åŠ¨</h2><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/u011250429/article/details/84857676#t3">https://blog.csdn.net/u011250429/article/details/84857676#t3</a></p><h2 id="å…¶ä»–é—®é¢˜"><a href="#å…¶ä»–é—®é¢˜" class="headerlink" title="å…¶ä»–é—®é¢˜"></a>å…¶ä»–é—®é¢˜</h2><p>å¾…è¡¥å……ã€‚ã€‚ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> manjaro </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> manjaro </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RabbitMQæ¶ˆæ¯é˜Ÿåˆ—</title>
      <link href="2020/11/26/rabbitmq-xiao-xi-dui-lie/"/>
      <url>2020/11/26/rabbitmq-xiao-xi-dui-lie/</url>
      
        <content type="html"><![CDATA[<h1 id="RabbitMQ-å®æˆ˜æ•™ç¨‹"><a href="#RabbitMQ-å®æˆ˜æ•™ç¨‹" class="headerlink" title="RabbitMQ å®æˆ˜æ•™ç¨‹"></a>RabbitMQ å®æˆ˜æ•™ç¨‹</h1><h2 id="ä¸åŒMQçš„ç‰¹ç‚¹"><a href="#ä¸åŒMQçš„ç‰¹ç‚¹" class="headerlink" title="ä¸åŒMQçš„ç‰¹ç‚¹"></a>ä¸åŒMQçš„ç‰¹ç‚¹</h2><blockquote><p><strong>ActiveMQ</strong></p><p>APIä¸°å¯Œï¼Œä½†æ˜¯æ€§èƒ½è¦å·®ï¼Œååé‡ä½ï¼Œåœ¨ä¸­å°å‹ä¼ä¸šä¸­å—æ¬¢è¿</p><p><strong>Kafka</strong></p><p>é«˜ååï¼Œåœ¨<strong>å¤§æ•°æ®é¢†åŸŸ</strong>åšæ—¥å¿—ä¼ è¾“ï¼Œå¯¹äº‹åŠ¡çš„ä¼˜åŒ–ä¸æ˜¯å¾ˆå¥½ï¼Œå¯èƒ½ä¼šä¸¢å¤±ä¸€äº›æ•°æ®ã€</p><p><strong>RocketMQ</strong></p><p>å®‰å…¨ï¼Œå¯é ï¼Œäº‹åŠ¡æ€§æœ‰äº†ä¼˜åŒ–ï¼Œä½†æ˜¯å¼€æºç‰ˆå¯¹åˆ†å¸ƒå¼äº‹åŠ¡æ²¡æœ‰å¼€æºï¼Œï¼Œå¼€æºçš„åŠŸèƒ½å°‘</p><p><strong>RabbitMQ</strong></p><p>åœ¨Springæ¡†æ¶ä¸­æ— ç¼æ•´åˆï¼Œå®‰å…¨å¯é ï¼Œå¯¹æ•°æ®çš„ä¸€è‡´æ€§æœ‰å¾ˆé«˜çš„è¦æ±‚ï¼Œæ€§èƒ½å’Œååé‡åœ¨å…¶æ¬¡</p></blockquote><h2 id="RabbitMQ-å¼•è¨€"><a href="#RabbitMQ-å¼•è¨€" class="headerlink" title="RabbitMQ å¼•è¨€"></a>RabbitMQ å¼•è¨€</h2><p>è¯¦æƒ…å¯çœ‹-&gt;<a href="https://www.rabbitmq.com/">å®˜ç½‘</a></p><blockquote><p>åŸºäºAMQPåè®®ï¼Œerlangè¯­è¨€å¼€å‘ï¼Œæ˜¯éƒ¨ç½²æœ€å¹¿æ³›çš„å¼€æºæ¶ˆæ¯ä¸­é—´ä»¶ï¼Œä¸springæ¡†æ¶å¯ä»¥æ— ç¼æ•´åˆï¼Œä¸ä¼šä¸¢å¤±ä»»ä½•æ•°æ®</p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201217103155143.png" alt="image-20201217103155143"></p><p>rabbitMQä¼šæŠŠæ¶ˆæ¯å…ˆå‘é€ç»™exchangeäº¤æ¢æœºï¼Œè€Œä¹‹å‰æˆ‘å­¦çš„activemqæ˜¯ç›´æ¥å‘é€ç»™é˜Ÿåˆ—çš„</p><h2 id="æœåŠ¡å®‰è£…å’Œå¯åŠ¨"><a href="#æœåŠ¡å®‰è£…å’Œå¯åŠ¨" class="headerlink" title="æœåŠ¡å®‰è£…å’Œå¯åŠ¨"></a>æœåŠ¡å®‰è£…å’Œå¯åŠ¨</h2><p>manjaroç³»ç»Ÿå®‰è£…ï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># ä½¿ç”¨ pacmansudo pacman -S rabbitmq rabbitmqadmin# ä½¿ç”¨ yarourtyay -S rabbitmq rabbitmqadmin#############å¯åŠ¨# å¼€å¯ç®¡ç†æ¨¡å—sudo rabbitmq-plugins enable rabbitmq_management# å¯åŠ¨sudo rabbitmq-serversudo systemctl status rabbitmq # æŸ¥çœ‹mqçŠ¶æ€<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>docker å®‰è£…ï¼š</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># å®‰è£…docker pull rabbitmq:3.7-management# å¯åŠ¨docker run -d --hostname localhost --name myrabbit -p 15672:15672 -p 5672:5672 rabbitmq:3.6.15-management<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="webç®¡ç†ç•Œé¢"><a href="#webç®¡ç†ç•Œé¢" class="headerlink" title="webç®¡ç†ç•Œé¢"></a>webç®¡ç†ç•Œé¢</h3><p>ç™»å½• ip:15672 ç”¨æˆ·åå¯†ç æ˜¯guest</p><p>ç™»å½•æˆåŠŸé¡µé¢ï¼š</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201217143331220.png" alt="image-20201217143331220"></p><h2 id="ç®¡ç†ç•Œé¢"><a href="#ç®¡ç†ç•Œé¢" class="headerlink" title="ç®¡ç†ç•Œé¢"></a>ç®¡ç†ç•Œé¢</h2><p>äº¤æ¢æœºï¼š</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201217144506358.png" alt="image-20201217144506358"></p><p>ç›‘å¬ç«¯å£:</p><table><thead><tr><th align="left">Protocol</th><th align="left">Bound to</th><th align="left">Port</th></tr></thead><tbody><tr><td align="left">amqpï¼ˆæˆ‘ä»¬javaæ“ä½œçš„ç«¯å£ï¼‰</td><td align="left">0.0.0.0</td><td align="left">5672</td></tr><tr><td align="left">clusteringï¼ˆé›†ç¾¤é€šè®¯ç«¯å£ï¼‰</td><td align="left">::</td><td align="left">25672</td></tr><tr><td align="left">httpï¼ˆwebç®¡ç†é¡µé¢ï¼‰</td><td align="left">::</td><td align="left">15672</td></tr></tbody></table><h2 id="HelloWorldæ¨¡å‹"><a href="#HelloWorldæ¨¡å‹" class="headerlink" title="HelloWorldæ¨¡å‹"></a>HelloWorldæ¨¡å‹</h2><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201217150041005.png" alt="image-20201217150041005"></p><p><img src="https://www.rabbitmq.com/img/tutorials/python-one.png" alt="æœ€åŸºæœ¬çš„"></p><h3 id="å°è£…å·¥å…·ç±»"><a href="#å°è£…å·¥å…·ç±»" class="headerlink" title="å°è£…å·¥å…·ç±»"></a>å°è£…å·¥å…·ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">helloworld</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>rabbitmq<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">Channel</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>rabbitmq<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">Connection</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>rabbitmq<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">ConnectionFactory</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">TimeoutException</span><span class="token punctuation">;</span><span class="token comment">/** * TODO: * * @author Zhang Hao yu * @date 2020/12/17 16:13 */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitMQUtil</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ConnectionFactory</span> connectionFactory<span class="token punctuation">;</span>    <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>        connectionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConnectionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®¾ç½®è¿æ¥ä¸»æœº</span>        connectionFactory<span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">"192.168.217.128"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®¾ç½®ç«¯å£å·</span>        connectionFactory<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5672</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®¾ç½®è™šæ‹Ÿä¸»æœº</span>        connectionFactory<span class="token punctuation">.</span><span class="token function">setVirtualHost</span><span class="token punctuation">(</span><span class="token string">"ems"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®¾ç½®ç”¨æˆ·åå¯†ç </span>        connectionFactory<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        connectionFactory<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> connectionFactory<span class="token punctuation">.</span><span class="token function">newConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> <span class="token class-name">TimeoutException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeAll</span><span class="token punctuation">(</span><span class="token class-name">Channel</span> channel<span class="token punctuation">,</span> <span class="token class-name">Connection</span> connection<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            channel<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> <span class="token class-name">TimeoutException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ç§åŸºæœ¬æ¨¡å¼çš„ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸å…¶ä»–mqçš„æ¨¡å¼ç›¸åŒ</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// è·å–è¿æ¥å¯¹è±¡</span>        <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtil</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// é€šè¿‡è¿æ¥è·å–é€šé“å¯¹è±¡</span>        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// é€šé“ç»‘å®šå¯¹åº”çš„æ¶ˆæ¯é˜Ÿåˆ—</span>        <span class="token comment">/*         * å‚æ•°1ï¼šé˜Ÿåˆ—åç§°         * å‚æ•°2ï¼šæ˜¯å¦æŒä¹…åŒ–  æŠŠé˜Ÿåˆ—è¿›è¡ŒæŒä¹…åŒ–         * å‚æ•°3ï¼šæ˜¯å¦ç‹¬å é˜Ÿåˆ—  åªæœ‰å½“å‰è¿æ¥èƒ½ç”¨         * å‚æ•°4ï¼šæ˜¯å¦åœ¨æ¶ˆè´¹è€…æ¶ˆè´¹å®Œæˆåè‡ªåŠ¨åˆ é™¤é˜Ÿåˆ—  è¿™ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼æ¶ˆè´¹è€…è¦å®Œå…¨æ–­å¼€è¿æ¥æ‰å¯ä»¥åˆ é™¤æ‰         * å‚æ•°5ï¼šé¢å¤–å‚æ•°         */</span>        channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">/*        å‚æ•°1ï¼šäº¤æ¢æœºåç§°        å‚æ•°2ï¼šé˜Ÿåˆ—åç§°        å‚æ•°3ï¼šä¼ é€’æ¶ˆæ¯çš„é¢å¤–è®¾ç½®   MessageProperties.PERSISTENT_TEXT_PLAIN æŠŠæ¶ˆæ¯è¿›è¡ŒæŒä¹…åŒ–        å‚æ•°4ï¼šæ¶ˆæ¯çš„å…·ä½“å†…å®¹         */</span>        channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">"hello"</span><span class="token punctuation">,</span> <span class="token class-name">MessageProperties</span><span class="token punctuation">.</span>PERSISTENT_TEXT_PLAIN<span class="token punctuation">,</span><span class="token string">"hello rabbit"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        channel<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtil</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*å‚æ•°1ï¼šé˜Ÿåˆ—åç§°å‚æ•°2ï¼šå¼€å¯æ¶ˆæ¯è‡ªåŠ¨ç¡®è®¤æœºåˆ¶å‚æ•°3ï¼šæ¶ˆè´¹æ—¶çš„å›è°ƒæ¥å£ */</span>channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">/**     * TODO:     *     *     * @author ZhangHaoyu     * @param consumerTag     * @param envelope     * @param properties     * @param body æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å‡ºçš„æ¶ˆæ¯     * @return void     */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="å·¥ä½œæ¨¡å‹work-queue"><a href="#å·¥ä½œæ¨¡å‹work-queue" class="headerlink" title="å·¥ä½œæ¨¡å‹work queue"></a>å·¥ä½œæ¨¡å‹work queue</h2><p><img src="https://www.rabbitmq.com/img/tutorials/python-two.png" alt="å·¥ä½œæ¨¡å‹ï¼Œå…è®¸æœ‰å¤šä¸ªæ¶ˆè´¹è€…"></p><blockquote><p>å·¥ä½œæ¨¡å‹ï¼Œå…è®¸å¤šä¸ªæ¶ˆè´¹è€…ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…éƒ½å¤„ç†ä¸åŒçš„æ¶ˆæ¯ï¼Œä»¥æ­¤æ¥æé«˜æ‰§è¡Œçš„æ•ˆç‡</p></blockquote><p> ç”Ÿäº§è€…</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtil</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">"work"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// ç”Ÿäº§æ¶ˆæ¯</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">"work"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token string">" hello work queue"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">RabbitMQUtil</span><span class="token punctuation">.</span><span class="token function">closeAll</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¶ˆè´¹è€…ï¼ˆä¸¤ä¸ªï¼Œè¿™é‡Œåªæ˜¾ç¤ºä¸€ä¸ªï¼‰</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtil</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">"work"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">"work"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆè´¹è€…1   "</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201217164431498.png" alt="image-20201217164431498"></p><p>é»˜è®¤æ¶ˆè´¹è€…çš„æ¶ˆè´¹æ–¹å¼æ˜¯<strong>è½®è¯¢</strong>ï¼Œå¹³å‡åˆ†é…</p><p><strong>è¿™ç§æ¨¡å¼å¾ˆå®¹æ˜“å› ä¸ºæŸä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹çš„æ…¢ï¼Œæ‰€ä»¥å¯¼è‡´æ¶ˆæ¯å †ç§¯</strong>ï¼ï¼ï¼ï¼ï¼ï¼</p><hr><p>æ¶ˆæ¯ç¡®è®¤æœºåˆ¶ï¼š</p><p>rabbitå®˜æ–¹æ¨èæˆ‘ä»¬æ¶ˆæ¯ç¡®è®¤ä¸ºæ‰‹åŠ¨ç¡®è®¤ï¼Œå¼€å¯æ–¹å¼ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtil</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ¯ä¸€æ¬¡åªèƒ½æ¶ˆè´¹ä¸€ä¸ªæ¶ˆæ¯</span>        channel<span class="token punctuation">.</span><span class="token function">basicQos</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">"work"</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">"work"</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆè´¹è€…1   "</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// å‚æ•°1ï¼šç¡®è®¤é˜Ÿåˆ—ä¸­æ¶ˆæ¯çš„æ ‡å¿—ï¼Œå‚æ•°2ï¼šæ˜¯å¦å¤šä¸ª</span>                channel<span class="token punctuation">.</span><span class="token function">basicAck</span><span class="token punctuation">(</span>envelope<span class="token punctuation">.</span><span class="token function">getDeliveryTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>channelè®¾ç½®qosï¼Œè®¾ç½®ä¸ºä¸€æ¬¡æ¶ˆè´¹nä¸ªæ¶ˆæ¯</p><p>hannel.basicAck(envelope.getDeliveryTag(),false)</p><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸ºäº†ç¡®å®šé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯çš„æ ‡å¿—</p><p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ æ˜¯å¦å¼€å¯å¤šä¸ª</p><p>== åœ¨ä¸šåŠ¡ç¹é‡çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½æŸä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†èƒ½åŠ›å¼ºï¼Œå¦ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†èƒ½åŠ›å¼±ï¼Œæˆ‘ä»¬æå€¡èƒ½è€…å¤šåŠ³ï¼Œå½“æˆ‘ä»¬å¼€å¯æ‰‹åŠ¨æ¶ˆæ¯ç¡®è®¤åï¼Œä¸ä»…å¯ä»¥åŠ å¿«ä¸šåŠ¡å¤„ç†çš„èƒ½åŠ›ï¼Œè¿˜å¯ä»¥æœ‰æ•ˆçš„ä¿è¯ä¸€ä¸ªæ¶ˆè´¹è€…åœ¨å¤„ç†ä¸šåŠ¡çš„æ—¶å€™å®•æœºï¼Œä¸ä¼šå¸¦æ¥æ›´å¤§çš„æŸå¤±ã€‚</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201217170523829.png" alt="image-20201217170523829"></p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201217170533715.png" alt="image-20201217170533715"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>MysqlåŸºç¡€è¡¥å……ä¸é«˜çº§</title>
      <link href="2020/11/23/mysql-ji-chu-bu-chong-yu-gao-ji/"/>
      <url>2020/11/23/mysql-ji-chu-bu-chong-yu-gao-ji/</url>
      
        <content type="html"><![CDATA[<h1 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h1><h2 id="mysqlåŸºç¡€è¡¥å……"><a href="#mysqlåŸºç¡€è¡¥å……" class="headerlink" title="mysqlåŸºç¡€è¡¥å……"></a>mysqlåŸºç¡€è¡¥å……</h2><h3 id="mysqlä¸­çš„-å·"><a href="#mysqlä¸­çš„-å·" class="headerlink" title="mysqlä¸­çš„+å·"></a>mysqlä¸­çš„+å·</h3><blockquote><p>ä»…ä»…æœ‰ä¸€ä¸ªè¿ç®—ç¬¦åŠŸèƒ½</p></blockquote><p>select 100+90ï¼› ä¸¤ä¸ªæ“ä½œæ•°éƒ½ä¸ºæ•°å€¼å‹ï¼ŒåšåŠ æ³•è¿ç®—</p><p>select â€˜123â€™+90ï¼›å…¶ä¸­ä¸€æ–¹ä¸ºå­—ç¬¦å‹ï¼Œè¯•å›¾<strong>å°†å­—ç¬¦å‹æ•°å€¼è½¬æ¢æˆæ•°å€¼å‹</strong>ï¼Œå¦‚æœè½¬æ¢æˆåŠŸï¼Œåˆ™ç»§ç»­åšåŠ æ³•è¿ç®—ï¼Œå¦‚æœè½¬æ¢å¤±è´¥ï¼Œåˆ™<strong>å°†å­—ç¬¦å‹æ•°å€¼è½¬æ¢ä¸º0</strong></p><p>select null+90ï¼›åªè¦å…¶ä¸­ä¸€æ–¹ä¸ºnullï¼Œåˆ™ç»“æœå¿…ä¸ºnull</p><h3 id="concatå‡½æ•°"><a href="#concatå‡½æ•°" class="headerlink" title="concatå‡½æ•°"></a>concatå‡½æ•°</h3><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql"># å¯ä»¥æ‹¼æ¥å¤šä¸ªSELECT CONCAT(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;) ....   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="å®‰å…¨ç­‰äº"><a href="#å®‰å…¨ç­‰äº" class="headerlink" title="å®‰å…¨ç­‰äº"></a>å®‰å…¨ç­‰äº</h3><p><code>&lt;=&gt;</code>å®‰å…¨ç­‰äºï¼Œä¸ä»…å¯ä»¥åˆ¤æ–­nullå€¼ï¼Œä¹Ÿèƒ½åˆ¤æ–­æ™®é€šçš„å€¼</p><ul><li>å¯è¯»æ€§å·®</li></ul><h3 id="å¸¸è§å‡½æ•°"><a href="#å¸¸è§å‡½æ•°" class="headerlink" title="å¸¸è§å‡½æ•°"></a>å¸¸è§å‡½æ•°</h3><h4 id="å­—ç¬¦å‡½æ•°"><a href="#å­—ç¬¦å‡½æ•°" class="headerlink" title="å­—ç¬¦å‡½æ•°"></a>å­—ç¬¦å‡½æ•°</h4><blockquote><p>lpad ç”¨æŒ‡å®šå­—ç¬¦å®ç°å·¦å¡«å……æŒ‡å®šé•¿åº¦</p></blockquote><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> lpad<span class="token punctuation">(</span><span class="token string">'aaa'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>rpad ç”¨æŒ‡å®šå­—ç¬¦å®ç°å³å¡«å……æŒ‡å®šé•¿åº¦</p></blockquote><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> rpad<span class="token punctuation">(</span><span class="token string">'aaa'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h4 id="æ•°å­—å‡½æ•°"><a href="#æ•°å­—å‡½æ•°" class="headerlink" title="æ•°å­—å‡½æ•°"></a>æ•°å­—å‡½æ•°</h4><blockquote><p>round å››èˆäº”å…¥</p></blockquote><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.55</span><span class="token punctuation">)</span><span class="token keyword">select</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.555554</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>ceil å‘ä¸Šå–æ•´ï¼Œè¿”å›&gt;=è¯¥å‚æ•°çš„æœ€å°æ•´æ•°</p></blockquote><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> ceil<span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>floor å‘ä¸‹å–æ•´</p></blockquote><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> floor<span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><strong>truncate</strong> æˆªæ–­</p></blockquote><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token keyword">truncate</span> <span class="token punctuation">(</span><span class="token number">1.688888888</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>mod å–ä½™</p></blockquote><hr><h4 id="æ—¥æœŸå‡½æ•°"><a href="#æ—¥æœŸå‡½æ•°" class="headerlink" title="æ—¥æœŸå‡½æ•°"></a>æ—¥æœŸå‡½æ•°</h4><p><code>now()</code>è¿”å›å½“å‰ç³»ç»Ÿ æ—¶é—´+æ—¥æœŸ</p><hr><p><code>str_to_date</code>å°†æ—¥æœŸæ ¼å¼çš„å­—ç¬¦è½¬æ¢æˆæŒ‡å®šæ ¼å¼çš„æ—¥æœŸ</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">STR_TO_DATE<span class="token punctuation">(</span><span class="token string">'9-13-1999'</span><span class="token punctuation">,</span><span class="token string">'%m-%d-%Y'</span><span class="token punctuation">)</span>  <span class="token number">1999</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span><span class="token number">13</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><p><code>date_format</code>å°†æ—¥æœŸè½¬æ¢æˆå­—ç¬¦</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">DATE_FORMAT<span class="token punctuation">(</span><span class="token string">'2020/1/1'</span><span class="token punctuation">,</span><span class="token string">'%Yå¹´%mæœˆ%dæ—¥'</span><span class="token punctuation">)</span>     <span class="token number">2020</span>å¹´<span class="token number">01</span>æœˆ<span class="token number">01</span>æ—¥<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h4 id="æµç¨‹æ§åˆ¶å‡½æ•°"><a href="#æµç¨‹æ§åˆ¶å‡½æ•°" class="headerlink" title="æµç¨‹æ§åˆ¶å‡½æ•°"></a>æµç¨‹æ§åˆ¶å‡½æ•°</h4><ul><li><p>if( 10&gt;5 ,â€™å¤§â€™,â€™å°â€™)</p></li><li><p>case  </p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201123183709225.png" alt="image-20201123183709225"></p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201123183949234.png" alt="image-20201123183949234"></p></li></ul><h4 id="åˆ†ç»„å‡½æ•°"><a href="#åˆ†ç»„å‡½æ•°" class="headerlink" title="åˆ†ç»„å‡½æ•°"></a>åˆ†ç»„å‡½æ•°</h4><blockquote><p>ç»Ÿè®¡å‡½æ•°ï¼Œèšåˆå‡½æ•°ï¼Œç»„å‡½æ•°ï¼Œç”¨äºç»Ÿè®¡</p></blockquote><ul><li><p>sum</p></li><li><p>avg</p></li><li><p>max</p></li><li><p>min</p></li><li><p>count</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201123185833144.png" alt="image-20201123185833144"></p></li></ul><h4 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h4><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201123202044853.png" alt="image-20201123202044853"></p><h4 id="åˆ†é¡µæŸ¥è¯¢"><a href="#åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢"></a>åˆ†é¡µæŸ¥è¯¢</h4><ul><li>limit (page-1)*size,size<ul><li>page å½“å‰é¡µ</li><li>sizeè¦æ˜¾ç¤ºçš„æ¡ç›®ä¸ªæ•°</li></ul></li></ul><h3 id="è§†å›¾"><a href="#è§†å›¾" class="headerlink" title="è§†å›¾"></a>è§†å›¾</h3><blockquote><p>è§†å›¾ä¿å­˜çš„æ˜¯sqlé€»è¾‘ï¼Œä¸æ˜¯å®é™…çš„æ•°æ®ï¼ï¼ï¼</p></blockquote><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">create view  v1 as xxxxxxxxxxxxxxxxxxxselect * from  v1# ä¿®æ”¹è§†å›¾create or replace view v1 xxxxxx# æˆ–alter view v1 xxxxxxx# åˆ é™¤è§†å›¾drop view è§†å›¾åï¼Œè§†å›¾å......<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="mysqlé«˜çº§"><a href="#mysqlé«˜çº§" class="headerlink" title="mysqlé«˜çº§"></a>mysqlé«˜çº§</h2><h3 id="mysqlé€»è¾‘æ¶æ„ä»‹ç»"><a href="#mysqlé€»è¾‘æ¶æ„ä»‹ç»" class="headerlink" title="mysqlé€»è¾‘æ¶æ„ä»‹ç»"></a>mysqlé€»è¾‘æ¶æ„ä»‹ç»</h3><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201123204238277.png" alt="image-20201123204238277"></p><ul><li><p>è¿æ¥å±‚</p></li><li><p>æœåŠ¡å±‚</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201124131854893.png" alt="image-20201124131854893"></p></li><li><p>å¼•æ“å±‚</p><p>å­˜å‚¨å¼•æ“å±‚çœŸæ­£çš„è´Ÿè´£äº†mysqlä¸­æ•°æ®çš„å­˜å‚¨å’Œæå–ï¼ŒæœåŠ¡å™¨é€šè¿‡APIä¸å­˜å‚¨å¼•æ“è¿›è¡Œé€šä¿¡ï¼Œä¸åŒçš„å­˜å‚¨å¼•æ“å…·æœ‰çš„åŠŸèƒ½ä¸åŒã€‚</p></li><li><p>å­˜å‚¨å±‚</p><p>æ•°æ®å­˜å‚¨ä¸»è¦æ˜¯å°†æ•°æ®å­˜å‚¨åœ¨è¿è¡Œäºè£¸è®¾å¤‡çš„æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šï¼Œå®Œæˆä¸å­˜å‚¨å¼•æ“çš„äº¤äº’</p></li></ul><h3 id="å­˜å‚¨å¼•æ“"><a href="#å­˜å‚¨å¼•æ“" class="headerlink" title="å­˜å‚¨å¼•æ“"></a>å­˜å‚¨å¼•æ“</h3><h4 id="MyISAMå’ŒInnoDB"><a href="#MyISAMå’ŒInnoDB" class="headerlink" title="MyISAMå’ŒInnoDB"></a>MyISAMå’ŒInnoDB</h4><table><thead><tr><th align="center">å¯¹æ¯”é¡¹</th><th align="center">MyISAM</th><th align="center">InnoDB</th></tr></thead><tbody><tr><td align="center">ä¸»å¤–é”®</td><td align="center">ä¸æ”¯æŒ</td><td align="center">æ”¯æŒ</td></tr><tr><td align="center">äº‹åŠ¡</td><td align="center">ä¸æ”¯æŒ</td><td align="center">æ”¯æŒ</td></tr><tr><td align="center">è¡Œé”è¡¨</td><td align="center"><strong>è¡¨é”</strong>ï¼Œå³ä½¿æ“ä½œä¸€æ¡è®°å½•ä¹Ÿä¼šé”ä½æ•´ä¸ªè¡¨ï¼Œä¸é€‚åˆé«˜å¹¶å‘çš„æ“ä½œ</td><td align="center"><strong>è¡Œé”</strong>ï¼Œæ“ä½œæ—¶åªé”æŸä¸€è¡Œï¼Œä¸å¯¹å…¶ä»–è¡Œæœ‰å½±å“ï¼Œ<strong>é€‚åˆé«˜å¹¶å‘åœºæ™¯</strong></td></tr><tr><td align="center">ç¼“å­˜</td><td align="center">åªç¼“å­˜ç´¢å¼•ï¼Œä¸ç¼“å­˜çœŸå®çš„æ•°æ®</td><td align="center">ä¸ä»…ç¼“å­˜ç´¢å¼•è¿˜è¦ç¼“å­˜çœŸå®æ•°æ®ï¼Œå¯¹å†…å­˜è¦æ±‚æ¯”è¾ƒé«˜ï¼Œè€Œä¸”å†…å­˜å¤§å°å¯¹æ€§èƒ½æœ‰å†³å®šæ€§å½±å“</td></tr><tr><td align="center">è¡¨ç©ºé—´</td><td align="center">å°</td><td align="center">å¤§</td></tr><tr><td align="center">å…³æ³¨ç‚¹</td><td align="center">æ€§èƒ½</td><td align="center">äº‹åŠ¡</td></tr><tr><td align="center">é»˜è®¤å®‰è£…</td><td align="center">Y</td><td align="center">Y</td></tr><tr><td align="center">æ”¯æŒå¤–é”®</td><td align="center">N</td><td align="center">Y</td></tr></tbody></table><p>mysql5ä»¥åé»˜è®¤çš„æ˜¯InnoDBå¼•æ“</p><hr><h4 id="å­˜å‚¨å¼•æ“çš„é€‰æ‹©"><a href="#å­˜å‚¨å¼•æ“çš„é€‰æ‹©" class="headerlink" title="å­˜å‚¨å¼•æ“çš„é€‰æ‹©"></a>å­˜å‚¨å¼•æ“çš„é€‰æ‹©</h4><ul><li>InnoDBï¼š<strong>å¯¹äº‹åŠ¡çš„å®Œæ•´æ€§æœ‰è¾ƒé«˜çš„è¦æ±‚</strong>ï¼Œ<strong>åœ¨å¹¶å‘æ¡ä»¶ä¸‹è¦æ±‚æ•°æ®çš„ä¸€è‡´æ€§</strong>ï¼Œéœ€è¦å¤–é”®ï¼Œå¯ä»¥ç”¨è¿™ä¸ª</li><li>MyISAMï¼šå¦‚æœåº”ç”¨æ˜¯<strong>ä»¥è¯»æ“ä½œå’Œæ’å…¥æ“ä½œä¸ºä¸»ï¼Œåªæœ‰å¾ˆå°‘çš„æ›´æ–°å’Œåˆ é™¤æ“ä½œ</strong>ï¼Œå¹¶ä¸”<strong>å¯¹äº‹åŠ¡çš„å®Œæ•´æ€§ã€å¹¶å‘æ€§è¦æ±‚ä¸æ˜¯å¾ˆé«˜</strong>ï¼Œé‚£ä¹ˆé€‰æ‹©è¿™ä¸ªå­˜å‚¨å¼•æ“æ˜¯éå¸¸åˆé€‚çš„</li><li>MEMORYï¼šå°†æ‰€æœ‰æ•°æ®ä¿å­˜åœ¨RAMä¸­ï¼Œåœ¨éœ€è¦å¿«é€Ÿå®šä½è®°å½•å’Œå…¶ä»–ç±»ä¼¼æ•°æ®ç¯å¢ƒä¸‹ï¼Œæä¾›å—è®¿é—®ã€‚é€šå¸¸ç”¨äºæ›´æ–°ä¸å¤ªé¢‘ç¹çš„å°è¡¨ï¼Œç”¨ä»¥å¿«é€Ÿå¾—åˆ°è®¿é—®ç»“æœ</li><li>MERGEï¼šå°†ä¸€ç³»åˆ—ç­‰åŒçš„MyISAMè¡¨ä»¥é€»è¾‘æ–¹å¼ç»„åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä½œä¸ºä¸€ä¸ªå¯¹è±¡å¼•ç”¨ä»–ä»¬ã€‚</li></ul><h3 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h3><blockquote><p>ç´¢å¼•æ˜¯å¸®åŠ©mysql <strong>é«˜æ•ˆè·å–æ•°æ®</strong>çš„ä¸€ç§<strong>æ•°æ®ç»“æ„</strong>ï¼ˆæœ‰åºï¼‰</p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201124134758959.png" alt="image-20201124134758959"></p><p>==&gt; æ²¡æœ‰å»ºç«‹ç´¢å¼•ï¼ŒæŸ¥æ‰¾å°±æ˜¯éå†å…¨è¡¨ï¼Œç„¶ååŒ¹é…å¯¹åº”çš„å­—æ®µæ˜¯å¦æ»¡è¶³æ¡ä»¶ã€‚</p><p><strong>å¯¹è¡¨ç»“æ„ä¸­çš„å­—æ®µå»ºç«‹ç´¢å¼•</strong></p><p>ç»´æŠ¤ä¸€ä¸ªäºŒå‰æ•°ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ ¹èŠ‚ç‚¹ï¼Œä¹‹åæ¯ä¸€ä¸ªè¿›æ¥çš„å…ƒç´ éƒ½è¦è·Ÿä¸€äº›èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒï¼Œå°çš„æ”¾èµ°éï¼Œå¤§çš„æ”¾å³è¾¹ã€‚<strong>æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½è¦æŒ‡å‘å¯¹åº”æ•°æ®è®°å½•ç‰©ç†åœ°å€çš„æŒ‡é’ˆ</strong></p><hr><h4 id="ç´¢å¼•çš„ä¼˜åŠ¿åŠ£åŠ¿"><a href="#ç´¢å¼•çš„ä¼˜åŠ¿åŠ£åŠ¿" class="headerlink" title="ç´¢å¼•çš„ä¼˜åŠ¿åŠ£åŠ¿"></a>ç´¢å¼•çš„ä¼˜åŠ¿åŠ£åŠ¿</h4><p><strong>ä¼˜åŠ¿</strong></p><ul><li>æé«˜äº†æ•°æ®æ£€ç´¢çš„æ•ˆç‡ï¼Œé™ä½æ•°æ®åº“IOçš„æˆæœ¬</li><li>é€šè¿‡ç´¢å¼•åˆ—å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œé™ä½æ•°æ®æ’åºçš„æˆæœ¬ï¼Œé™ä½CPUçš„æ¶ˆè€—</li></ul><p><strong>åŠ£åŠ¿</strong></p><ul><li>å®é™…ä¸Šç´¢å¼•ä¹Ÿæ˜¯ä¸€å¼ è¡¨ï¼Œè¯¥è¡¨ä¸­ä¿å­˜äº†ä¸»é”®ä¸ç´¢å¼•å­—æ®µï¼Œå¹¶æŒ‡å‘å®ä½“ç±»çš„è®°å½•ï¼Œç´¢å¼•ç´¢å¼•åˆ—ä¹Ÿæ˜¯è¦å ç”¨ç©ºé—´çš„</li><li>è™½ç„¶ç´¢å¼•å¤§å¤§æé«˜äº†æŸ¥è¯¢æ•ˆç‡ï¼ŒåŒæ—¶å´ä¹Ÿé™ä½æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼Œå¦‚å¯¹è¡¨è¿›è¡ŒINSERTã€UPDATEã€DELETEã€‚å› ä¸º<strong>æ›´æ–°è¡¨æ—¶ï¼ŒMySQLä¸ä»…è¦ä¿å­˜æ•°æ®ï¼Œè¿˜è¦ä¿å­˜ç´¢å¼•æ–‡ä»¶</strong>ï¼Œæ¯æ¬¡æ›´æ–°äº†ç´¢å¼•åˆ—çš„å­—æ®µï¼Œéƒ½ä¼šè°ƒæ•´å› ä¸ºæ›´æ–°æ‰€å¸¦æ¥çš„é”®å€¼å˜åŒ–åçš„ç´¢å¼•ä¿¡æ¯</li></ul><hr><h4 id="ç´¢å¼•çš„ç»“æ„"><a href="#ç´¢å¼•çš„ç»“æ„" class="headerlink" title="ç´¢å¼•çš„ç»“æ„"></a>ç´¢å¼•çš„ç»“æ„</h4><blockquote><p>ç´¢å¼•æ˜¯åœ¨mysqlçš„å­˜å‚¨å¼•æ“å±‚ä¸­å®ç°çš„ï¼Œè€Œä¸æ˜¯åœ¨æœåŠ¡å™¨å±‚å®ç°çš„ï¼Œæ‰€ä»¥æ¯ç§å­˜å‚¨å¼•æ“çš„ç´¢å¼•éƒ½ä¸ä¸€å®šå®Œå…¨ç›¸åŒï¼Œä¹Ÿä¸æ˜¯æ‰€æœ‰çš„å­˜å‚¨å¼•æ“éƒ½æ”¯æŒæ‰€æœ‰çš„ç´¢å¼•ç±»å‹ï¼Œç›®å‰æœ‰4ä¸­ç´¢å¼•ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li>Btreeç´¢å¼•ï¼šæœ€å¸¸è§çš„ç´¢å¼•ï¼Œå¤§éƒ¨åˆ†ç´¢å¼•éƒ½æ”¯æŒBæ ‘ç´¢å¼•</li><li>Hashç´¢å¼•ï¼šåªæœ‰Memoryå¼•æ“æ”¯æŒ</li><li>R-treeç´¢å¼•ï¼šç©ºé—´ç´¢å¼• æ˜¯MyISAMå¼•æ“ä¸­çš„ä¸€ä¸ªç‰¹æ®Šç´¢å¼•ç±»å‹ï¼Œä¸»è¦ç”¨äºåœ°ç†ç©ºé—´æ•°æ®ç±»å‹</li><li>Full-textï¼šå…¨æ–‡ç´¢å¼• ä¹Ÿæ˜¯MyISAMä¸­çš„ä¸€ä¸ªç‰¹æ®Šç´¢å¼•ï¼Œä¸»è¦ç”¨äºå…¨æ–‡ç´¢å¼•</li></ul></blockquote><table><thead><tr><th align="center">ç´¢å¼•</th><th align="center">InnoDB</th><th align="center">MyISAM</th><th align="center">Memory</th></tr></thead><tbody><tr><td align="center">BTREE</td><td align="center"><strong>Y</strong></td><td align="center"><strong>Y</strong></td><td align="center"><strong>Y</strong></td></tr><tr><td align="center">HASH</td><td align="center">N</td><td align="center">N</td><td align="center"><strong>Y</strong></td></tr><tr><td align="center">R-tree</td><td align="center">N</td><td align="center"><strong>Y</strong></td><td align="center">N</td></tr><tr><td align="center">Full-text</td><td align="center">5.6ä»¥åæ”¯æŒ</td><td align="center">N</td><td align="center">N</td></tr></tbody></table><p>æˆ‘ä»¬å¹³å¸¸æ‰€è¯´çš„ç´¢å¼•ï¼Œé»˜è®¤æŒ‡çš„æ˜¯B+æ ‘ï¼ˆå¤šè·¯æœç´¢æ ‘ï¼Œä¸ä¸€å®šæ˜¯äºŒå‰çš„ï¼‰ç»“æ„ç»„ç»‡çš„ç´¢å¼•ã€‚å…¶ä¸­ <strong>èšé›†ç´¢å¼•ã€å¤åˆç´¢å¼•ã€å‰ç¼€ç´¢å¼•ã€å”¯ä¸€ç´¢å¼•</strong>é»˜è®¤éƒ½æ˜¯ä½¿ç”¨B+treeæ ‘ç´¢å¼•</p><hr><h4 id="BTREEç»“æ„"><a href="#BTREEç»“æ„" class="headerlink" title="BTREEç»“æ„"></a>BTREEç»“æ„</h4><p>ä¸€ä¸ªmå‰çš„BTreeç‰¹æ€§å¦‚ä¸‹ï¼š</p><ul><li>æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šåŒ…å«mä¸ªå­©å­</li><li>é™¤æ ¹èŠ‚ç‚¹ä¸å¶å­èŠ‚ç‚¹å¤–ï¼Œæ¯ä¸ªèŠ‚ç‚¹è‡³å°‘æœ‰ã€cell(m/2)ã€‘ä¸ªå­©å­</li><li>è‹¥æ ¹èŠ‚ç‚¹ä¸æ˜¯å¶å­èŠ‚ç‚¹ï¼Œåˆ™è‡³å°‘æœ‰ä¸¤ä¸ªå­©å­</li><li>æ‰€æœ‰çš„å¶å­èŠ‚ç‚¹éƒ½åœ¨åŒä¸€å±‚</li><li>æ¯ä¸ªéå¶å­èŠ‚ç‚¹ç”±nä¸ªkeyä¸n+1ä¸ªæŒ‡é’ˆç»„æˆï¼Œå…¶ä¸­[ceil(m/2)-1]&lt;=n&lt;=m-1</li></ul><p>æ¼”å˜è¿‡ç¨‹ï¼š</p><p>å‚è€ƒğŸ‘‰<a href="http://yueyueniao-gif.gitee.io/yueyueniao-gif/2020/11/17/shu-ju-jie-gou/">åšå®¢</a> </p><hr><h4 id="B-TREEç»“æ„"><a href="#B-TREEç»“æ„" class="headerlink" title="B+TREEç»“æ„"></a>B+TREEç»“æ„</h4><p>ä¸BTreeçš„åŒºåˆ«:</p><ul><li>nå‰B+Treeæœ€å¤šå«æœ‰nä¸ªkeyï¼Œè€ŒBTreeæœ€å¤šå«æœ‰n-1ä¸ªkey</li><li>B+Treeçš„å¶å­èŠ‚ç‚¹ä¿å­˜æ‰€æœ‰çš„keyä¿¡æ¯ï¼Œä¾keyå¤§å°é¡ºåºæ’åˆ—</li><li>æ‰€æœ‰çš„éå¶å­èŠ‚ç‚¹éƒ½å¯ä»¥çœ‹ä½œæ˜¯keyçš„ç´¢å¼•éƒ¨åˆ†</li></ul><p><strong>mysqlä¸­çš„B+Tree</strong>  </p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201124164552862.png" alt="image-20201124164552862"></p><p>mysqlç´¢å¼•æ•°æ®ç»“æ„å¯¹ç»å…¸çš„B+æ ‘è¿›è¡Œäº†ä¼˜åŒ–ï¼Œåœ¨åŸB+æ ‘çš„åŸºç¡€ä¸Šå¢åŠ ä¸€ä¸ªæŒ‡å‘ç›¸é‚»å¶å­èŠ‚ç‚¹çš„é“¾è¡¨æŒ‡é’ˆï¼Œå°±å½¢æˆäº†å¸¦æœ‰é¡ºåºæŒ‡é’ˆçš„B+æ ‘ï¼Œæé«˜åŒºé—´è®¿é—®çš„æ€§èƒ½</p><hr><h4 id="ç´¢å¼•çš„åˆ†ç±»"><a href="#ç´¢å¼•çš„åˆ†ç±»" class="headerlink" title="ç´¢å¼•çš„åˆ†ç±»"></a>ç´¢å¼•çš„åˆ†ç±»</h4><ul><li><strong>å•å€¼ç´¢å¼•</strong>ï¼šä¸€ä¸ªç´¢å¼•åªåŒ…å«å•ä¸ªåˆ—ï¼Œä¸€ä¸ªè¡¨å¯ä»¥ç”±å¤šä¸ªå•åˆ—ç´¢å¼•</li><li><strong>å”¯ä¸€ç´¢å¼•</strong>ï¼šç´¢å¼•åˆ—çš„å€¼å¿…é¡»å”¯ä¸€ï¼Œä½†å…è®¸æœ‰ç©ºå€¼</li><li><strong>å¤åˆç´¢å¼•</strong>ï¼šå³ä¸€ä¸ªç´¢å¼•åŒ…å«å¤šä¸ªåˆ—</li></ul><hr><h4 id="ç´¢å¼•çš„è®¾è®¡åŸåˆ™"><a href="#ç´¢å¼•çš„è®¾è®¡åŸåˆ™" class="headerlink" title="ç´¢å¼•çš„è®¾è®¡åŸåˆ™"></a>ç´¢å¼•çš„è®¾è®¡åŸåˆ™</h4><ul><li><p>æŸ¥è¯¢é¢‘ç‡é«˜ï¼Œæ•°æ®é‡æ¯”è¾ƒå¤§</p></li><li><p>éœ€è¦é’ˆå¯¹äºwhereæ¡ä»¶ä¸­çš„å­—æ®µå»ºç«‹ç´¢å¼•</p></li><li><p>ä½¿ç”¨<strong>å”¯ä¸€ç´¢å¼•</strong>ï¼ŒåŒºåˆ†åº¦è¶Šé«˜ï¼Œä½¿ç”¨ç´¢å¼•çš„æ•ˆç‡è¶Šé«˜</p></li><li><p>å¯¹äºæ›´æ–°ç­‰çš„æ“ä½œï¼Œç´¢å¼•è¿‡å¤šï¼Œä¼šå¯¼è‡´ç»´æŠ¤çš„æ—¶é—´è¶Šæ¥è¶Šé«˜ï¼Œé™ä½æ•ˆç‡</p></li><li><p>ä½¿ç”¨çŸ­ç´¢å¼•</p></li><li><p>åˆ©ç”¨æœ€å·¦å‰ç¼€ï¼Œé’ˆå¯¹äºç»„åˆç´¢å¼•</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201124175811560.png" alt="image-20201124175811560"></p></li></ul><hr><h3 id="è§†å›¾-1"><a href="#è§†å›¾-1" class="headerlink" title="è§†å›¾"></a>è§†å›¾</h3><p>ç›¸å¯¹äºæ™®é€šçš„è¡¨ï¼š</p><ul><li><strong>ç®€å•</strong>ï¼šä½¿ç”¨è§†å›¾çš„ç”¨æˆ·å®Œå…¨ä¸éœ€è¦å…³å¿ƒåé¢å¯¹åº”çš„è¡¨çš„ç»“æ„ã€å…³è”æ¡ä»¶å’Œç­›é€‰æ¡ä»¶</li><li><strong>å®‰å…¨</strong>ï¼šé™åˆ¶æŸäº›ç”¨æˆ·èƒ½çœ‹åˆ°çš„ä¸œè¥¿</li><li><strong>æ•°æ®ç‹¬ç«‹</strong>ï¼šä¸€æ—¦è§†å›¾çš„ç»“æ„ç¡®å®šäº†ï¼Œå¯ä»¥å±è”½è¡¨ç»“æ„å˜åŒ–å¯¹ç”¨æˆ·çš„å½±å“</li></ul><hr><h3 id="ä¼˜åŒ–SQLçš„æ­¥éª¤"><a href="#ä¼˜åŒ–SQLçš„æ­¥éª¤" class="headerlink" title="ä¼˜åŒ–SQLçš„æ­¥éª¤"></a>ä¼˜åŒ–SQLçš„æ­¥éª¤</h3><h4 id="æŸ¥è¯¢sqlæ‰§è¡Œé¢‘ç‡"><a href="#æŸ¥è¯¢sqlæ‰§è¡Œé¢‘ç‡" class="headerlink" title="æŸ¥è¯¢sqlæ‰§è¡Œé¢‘ç‡"></a>æŸ¥è¯¢sqlæ‰§è¡Œé¢‘ç‡</h4><ul><li><code>show status like &quot;Com_______&quot;; </code> æ˜¾ç¤ºå½“å‰sessionä¸­æ‰€æœ‰ç»Ÿè®¡å‚æ•°çš„å€¼</li></ul><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201125132325204.png" alt="image-20201125132325204"></p><ul><li><p><code>show GLOBAL status like &quot;Com_______&quot;;</code> æ˜¾ç¤ºå…¨å±€çš„ï¼ˆè‡ªæ•°æ®åº“ä¸Šæ¬¡å¯åŠ¨è‡³ä»Šï¼‰ç»Ÿè®¡ç»“æœ</p></li><li><p><code>show global status like &quot;Innodb_rows_%&quot;;</code> æ˜¾ç¤ºä½¿ç”¨äº†innodbå­˜å‚¨å¼•æ“çš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ‰§è¡Œäº†insertçš„è¡Œæ•°ï¼Œselectçš„è¡Œæ•°ç­‰ç­‰</p></li></ul><h4 id="å®šä½ä½æ•ˆç‡çš„SQL"><a href="#å®šä½ä½æ•ˆç‡çš„SQL" class="headerlink" title="å®šä½ä½æ•ˆç‡çš„SQL"></a>å®šä½ä½æ•ˆç‡çš„SQL</h4><p>é€šè¿‡ä¸¤ç§æ–¹å¼æ¥å®šä½ï¼š</p><ul><li><strong>æ…¢æŸ¥è¯¢æ—¥å¿—</strong>ï¼šç”¨<code>--log-slow-queries[=file_name]</code>é€‰é¡¹å¯åŠ¨æ—¶ï¼Œmysqldå†™ä¸€ä¸ªåŒ…å«æ‰€æœ‰æ‰§è¡Œæ—¶é—´è¶…è¿‡long_query_timeç§’çš„SQLè¯­å¥æ—¥å¿—æ–‡ä»¶ã€‚</li><li><strong>show processlist</strong>ï¼šæ…¢æŸ¥è¯¢æ—¥å¿—åœ¨æŸ¥è¯¢ç»“æŸä»¥åæ‰çºªå½•ï¼Œæ‰€æœ‰åœ¨åº”ç”¨åæ˜ æ‰§è¡Œæ•ˆç‡å‡ºç°é—®é¢˜çš„æ—¶å€™æŸ¥è¯¢è¿™ä¸ªæ—¥å¿—å¹¶ä¸èƒ½å®šä½é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡<code>show processlist</code>å‘½ä»¤æŸ¥çœ‹å½“å‰MySQLåœ¨è¿›è¡Œçš„çº¿ç¨‹ï¼Œ<strong>åŒ…æ‹¬çº¿ç¨‹çš„çŠ¶æ€ã€æ˜¯å¦é”è¡¨ç­‰ï¼Œå¯ä»¥å®æ—¶åœ°æŸ¥çœ‹SQLçš„æ‰§è¡Œæƒ…å†µï¼ŒåŒæ—¶å¯¹ä¸€äº›ç¼©è¡¨æ“ä½œè¿›è¡Œä¼˜åŒ–</strong></li></ul><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201125134444647.png" alt="image-20201125134444647"></p><pre class="line-numbers language-none"><code class="language-none">idåˆ—ï¼Œç”¨æˆ·ç™»å½•mysqlæ—¶ï¼Œç³»ç»Ÿåˆ†é…çš„connection_idï¼Œå¯ä»¥ä½¿ç”¨å‡½æ•°connection_id()æŸ¥çœ‹useråˆ—ï¼Œæ˜¾ç¤ºå½“å‰ç”¨æˆ·ã€‚å¦‚æœä¸æ˜¯rootï¼Œè¿™ä¸ªå‘½ä»¤å°±åªæ˜¾ç¤ºç”¨æˆ·æƒé™èŒƒå›´çš„sqlè¯­å¥hoståˆ—ï¼Œæ˜¾ç¤ºè¿™ä¸ªè¯­å¥æ˜¯ä»å“ªä¸ªipçš„å“ªä¸ªç«¯å£ä¸Šå‘çš„dbåˆ—ï¼Œè¿æ¥çš„æ•°æ®åº“commandåˆ—ï¼Œæ˜¾ç¤ºå½“å‰è¿æ¥æ‰§è¡Œçš„å‘½ä»¤ï¼Œä¸€èˆ¬ä¸ºsleepï¼Œqueryï¼Œconnect ç­‰timeåˆ—ï¼Œæ˜¾ç¤ºè¿™ä¸ªçŠ¶æ€æŒç»­çš„æ—¶é—´ï¼Œå•ä½sstateåˆ—ï¼Œæ˜¾ç¤ºä½¿ç”¨å½“å‰è¿æ¥çš„sqlè¯­å¥çš„çŠ¶æ€ï¼Œå¾ˆé‡è¦ï¼ï¼ï¼infoåˆ—ï¼Œæ˜¾ç¤ºè¿™ä¸ªsqlè¯­å¥ï¼Œæ˜¯åˆ¤æ–­é—®é¢˜è¯­å¥çš„ä¸€ä¸ªé‡è¦ä¾æ®<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="explainåˆ†ææ‰§è¡Œè®¡åˆ’"><a href="#explainåˆ†ææ‰§è¡Œè®¡åˆ’" class="headerlink" title="explainåˆ†ææ‰§è¡Œè®¡åˆ’"></a>explainåˆ†ææ‰§è¡Œè®¡åˆ’</h4><blockquote><p>é€šè¿‡ä¸Šé¢æ­¥èµ°æŸ¥è¯¢åˆ°æ•ˆç‡ä½çš„sqlåï¼Œå¯ä»¥ç”¨è¿‡explainæˆ–è€…descå‘½ä»¤è·å–mysqlå¦‚ä½•æ‰§è¡Œselectè¯­å¥çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬selectè¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­è¡¨å¦‚ä½•è¿æ¥å’Œè¿æ¥é¡ºåº</p></blockquote><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">explain select * from sys_user where id &#x3D; &quot;e9ca23d68d884d4ebb19d07889727dae&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201125140528226.png" alt="image-20201125140528226"></p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">explain select * from sys_user where username &#x3D; &quot;admin&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201125140621333.png" alt="image-20201125140621333"></p><table><thead><tr><th align="center">å­—æ®µ</th><th align="center">å«ä¹‰</th></tr></thead><tbody><tr><td align="center">id</td><td align="center">selectæŸ¥è¯¢çš„åºåˆ—å·ï¼Œæ˜¯ä¸€ç»„æ•°å­—ï¼Œè¡¨ç¤ºçš„æ˜¯æŸ¥è¯¢ä¸­æ‰§è¡Œselectå­å¥æˆ–è€…æ˜¯æ“ä½œè¡¨çš„é¡ºåºã€‚</td></tr><tr><td align="center">select_type</td><td align="center">è¡¨ç¤º SELECT çš„ç±»å‹</td></tr><tr><td align="center">table</td><td align="center">è¾“å‡ºç»“æœé›†çš„è¡¨</td></tr><tr><td align="center">type</td><td align="center">è¡¨ç¤ºè¡¨çš„è¿æ¥ç±»å‹</td></tr><tr><td align="center">possible_keys</td><td align="center">è¡¨ç¤ºæŸ¥è¯¢æ—¶ï¼Œå¯èƒ½ä½¿ç”¨çš„ç´¢å¼•</td></tr><tr><td align="center">key</td><td align="center">è¡¨ç¤ºå®é™…ä½¿ç”¨çš„ç´¢å¼•</td></tr><tr><td align="center">key_len</td><td align="center">ç´¢å¼•å­—æ®µçš„é•¿åº¦</td></tr><tr><td align="center">rows</td><td align="center">æ‰«æè¡Œçš„æ•°é‡</td></tr><tr><td align="center">extra</td><td align="center">æ‰§è¡Œæƒ…å†µçš„è¯´æ˜å’Œæè¿°</td></tr></tbody></table><p><strong>explain â€”â€” id</strong></p><blockquote><p>id å­—æ®µæ˜¯ selectæŸ¥è¯¢çš„åºåˆ—å·ï¼Œæ˜¯ä¸€ç»„æ•°å­—ï¼Œè¡¨ç¤ºçš„æ˜¯æŸ¥è¯¢ä¸­æ‰§è¡Œselectå­å¥æˆ–è€…æ˜¯æ“ä½œè¡¨çš„é¡ºåº</p></blockquote><ol><li>id ç›¸åŒè¡¨ç¤ºåŠ è½½è¡¨çš„é¡ºåºæ˜¯ä»ä¸Šåˆ°ä¸‹ã€‚</li><li> id ä¸åŒidå€¼è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆè¢«æ‰§è¡Œã€‚</li><li> id æœ‰ç›¸åŒï¼Œä¹Ÿæœ‰ä¸åŒï¼ŒåŒæ—¶å­˜åœ¨ã€‚<strong>idç›¸åŒçš„å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç»„</strong>ï¼Œä»ä¸Šå¾€ä¸‹é¡ºåºæ‰§è¡Œï¼›åœ¨æ‰€æœ‰çš„ç»„ä¸­ï¼Œidçš„å€¼è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆæ‰§è¡Œã€‚</li></ol><p><strong>explain ä¹‹ select_type</strong></p><table><thead><tr><th>select_type</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>SIMPLE</td><td>ç®€å•çš„selectæŸ¥è¯¢ï¼ŒæŸ¥è¯¢ä¸­ä¸åŒ…å«å­æŸ¥è¯¢æˆ–è€…UNION</td></tr><tr><td>PRIMARY</td><td>æŸ¥è¯¢ä¸­è‹¥åŒ…å«ä»»ä½•å¤æ‚çš„å­æŸ¥è¯¢ï¼Œæœ€å¤–å±‚æŸ¥è¯¢æ ‡è®°ä¸ºè¯¥æ ‡è¯†</td></tr><tr><td>SUBQUERY</td><td>åœ¨SELECT æˆ– WHERE åˆ—è¡¨ä¸­åŒ…å«äº†å­æŸ¥è¯¢</td></tr><tr><td>DERIVED</td><td>åœ¨FROM åˆ—è¡¨ä¸­åŒ…å«çš„å­æŸ¥è¯¢ï¼Œè¢«æ ‡è®°ä¸º DERIVEDï¼ˆè¡ç”Ÿï¼‰ MYSQLä¼šé€’å½’æ‰§è¡Œè¿™äº›å­æŸ¥ è¯¢ï¼ŒæŠŠç»“æœæ”¾åœ¨ä¸´æ—¶è¡¨ä¸­</td></tr><tr><td>UNION</td><td>è‹¥ç¬¬äºŒä¸ªSELECTå‡ºç°åœ¨UNIONä¹‹åï¼Œåˆ™æ ‡è®°ä¸ºUNION ï¼› è‹¥UNIONåŒ…å«åœ¨FROMå­å¥çš„å­ æŸ¥è¯¢ä¸­ï¼Œå¤–å±‚SELECTå°†è¢«æ ‡è®°ä¸º ï¼š DERIVED</td></tr><tr><td>UNION RESULT</td><td>ä»UNIONè¡¨è·å–ç»“æœçš„SELECT</td></tr></tbody></table><p><strong>explain ä¹‹ type</strong></p><blockquote><p>type æ˜¾ç¤ºçš„æ˜¯è®¿é—®ç±»å‹ï¼Œæ˜¯è¾ƒä¸ºé‡è¦çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œå¯å–å€¼ä¸ºï¼š</p></blockquote><table><thead><tr><th>type</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>NULL</td><td>MySQLä¸è®¿é—®ä»»ä½•è¡¨ï¼Œç´¢å¼•ï¼Œç›´æ¥è¿”å›ç»“æœ</td></tr><tr><td>system</td><td>è¡¨åªæœ‰ä¸€è¡Œè®°å½•(ç­‰äºç³»ç»Ÿè¡¨)ï¼Œè¿™æ˜¯constç±»å‹çš„ç‰¹ä¾‹ï¼Œä¸€èˆ¬ä¸ä¼šå‡ºç°</td></tr><tr><td>const</td><td>è¡¨ç¤ºé€šè¿‡ç´¢å¼•ä¸€æ¬¡å°±æ‰¾åˆ°äº†ï¼Œconst ç”¨äºæ¯”è¾ƒprimary key æˆ–è€… unique ç´¢å¼•ã€‚å› ä¸ºåªåŒ¹é…ä¸€è¡Œæ•° æ®ï¼Œæ‰€ä»¥å¾ˆå¿«ã€‚å¦‚å°†ä¸»é”®ç½®äºwhereåˆ—è¡¨ä¸­ï¼ŒMySQL å°±èƒ½å°†è¯¥æŸ¥è¯¢è½¬æ¢ä¸ºä¸€ä¸ªå¸¸äº®ã€‚constäºå°† â€œä¸»é”®â€ æˆ– â€œå”¯ä¸€â€ ç´¢å¼•çš„æ‰€æœ‰éƒ¨åˆ†ä¸å¸¸é‡å€¼è¿›è¡Œæ¯”è¾ƒ</td></tr><tr><td>eq_ref</td><td>ç±»ä¼¼refï¼ŒåŒºåˆ«åœ¨äºä½¿ç”¨çš„æ˜¯å”¯ä¸€ç´¢å¼•ï¼Œä½¿ç”¨ä¸»é”®çš„å…³è”æŸ¥è¯¢ï¼Œå…³è”æŸ¥è¯¢å‡ºçš„è®°å½•åªæœ‰ä¸€æ¡ã€‚å¸¸è§ äºä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•æ‰«æ</td></tr><tr><td>ref</td><td>éå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œè¿”å›åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„æ‰€æœ‰è¡Œã€‚æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§ç´¢å¼•è®¿é—®ï¼Œè¿”å›æ‰€æœ‰åŒ¹é…æŸ ä¸ªå•ç‹¬å€¼çš„æ‰€æœ‰è¡Œï¼ˆå¤šä¸ªï¼‰</td></tr><tr><td>range</td><td>åªæ£€ç´¢ç»™å®šè¿”å›çš„è¡Œï¼Œä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥é€‰æ‹©è¡Œã€‚ where ä¹‹åå‡ºç° between ï¼Œ &lt; , &gt; , in ç­‰æ“ä½œã€‚</td></tr><tr><td>index</td><td>index ä¸ ALLçš„åŒºåˆ«ä¸º index ç±»å‹åªæ˜¯éå†äº†ç´¢å¼•æ ‘ï¼Œ é€šå¸¸æ¯”ALL å¿«ï¼Œ ALL æ˜¯éå†æ•°æ®æ–‡ä»¶ã€‚</td></tr><tr><td>all</td><td>å°†éå†å…¨è¡¨ä»¥æ‰¾åˆ°åŒ¹é…çš„è¡Œ</td></tr></tbody></table><pre class="line-numbers language-none"><code class="language-none">ç»“æœå€¼ä»æœ€å¥½åˆ°æœ€åä»¥æ­¤æ˜¯:NULL &gt; system &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt;unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALLsystem &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; ALL<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€èˆ¬æ¥è¯´ï¼Œ æˆ‘ä»¬éœ€è¦ä¿è¯æŸ¥è¯¢è‡³å°‘è¾¾åˆ° <strong>range</strong> çº§åˆ«ï¼Œ æœ€å¥½è¾¾åˆ°<strong>ref</strong> ã€‚</p><p><strong>explain ä¹‹ key</strong></p><pre class="line-numbers language-none"><code class="language-none">possible_keys : æ˜¾ç¤ºå¯èƒ½åº”ç”¨åœ¨è¿™å¼ è¡¨çš„ç´¢å¼•ï¼Œ ä¸€ä¸ªæˆ–å¤šä¸ªã€‚key ï¼š å®é™…ä½¿ç”¨çš„ç´¢å¼•ï¼Œ å¦‚æœä¸ºNULLï¼Œ åˆ™æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ã€‚key_len : è¡¨ç¤ºç´¢å¼•ä¸­ä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œ è¯¥å€¼ä¸ºç´¢å¼•å­—æ®µæœ€å¤§å¯èƒ½é•¿åº¦ï¼Œå¹¶éå®é™…ä½¿ç”¨é•¿åº¦ï¼Œåœ¨ä¸æŸå¤±ç²¾ç¡®æ€§çš„å‰æä¸‹ï¼Œ é•¿åº¦è¶ŠçŸ­è¶Šå¥½ ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>explain ä¹‹ extra</strong></p><blockquote><p>å…¶ä»–çš„é¢å¤–çš„æ‰§è¡Œè®¡åˆ’ä¿¡æ¯ï¼Œåœ¨è¯¥åˆ—å±•ç¤º ã€‚</p></blockquote><table><thead><tr><th>extra</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>using filesort</td><td>è¯´æ˜mysqlä¼šå¯¹æ•°æ®ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çš„ç´¢å¼•æ’åºï¼Œè€Œä¸æ˜¯æŒ‰ç…§è¡¨å†…çš„ç´¢å¼•é¡ºåºè¿›è¡Œè¯»å–ï¼Œ ç§°ä¸º â€œ<strong>æ–‡ä»¶æ’åº</strong>â€, æ•ˆç‡ä½ã€‚</td></tr><tr><td>using temporary</td><td>ä½¿ç”¨äº†ä¸´æ—¶è¡¨ä¿å­˜ä¸­é—´ç»“æœï¼ŒMySQLåœ¨å¯¹æŸ¥è¯¢ç»“æœæ’åºæ—¶ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚å¸¸è§äº order by å’Œ group byï¼› æ•ˆç‡ä½</td></tr><tr><td>using index</td><td>è¡¨ç¤ºç›¸åº”çš„selectæ“ä½œä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼Œ é¿å…è®¿é—®è¡¨çš„æ•°æ®è¡Œï¼Œ æ•ˆç‡ä¸é”™</td></tr></tbody></table><h4 id="show-profileåˆ†æSQL"><a href="#show-profileåˆ†æSQL" class="headerlink" title="show profileåˆ†æSQL"></a>show profileåˆ†æSQL</h4><h3 id="ç´¢å¼•çš„ä½¿ç”¨"><a href="#ç´¢å¼•çš„ä½¿ç”¨" class="headerlink" title="ç´¢å¼•çš„ä½¿ç”¨"></a>ç´¢å¼•çš„ä½¿ç”¨</h3><p>å‡†å¤‡æ¡ä»¶:</p><blockquote><p><code>create index idx_seller_name_sta_addr on tb_seller(name,status,address);</code></p></blockquote><h4 id="é¿å…ç´¢å¼•å¤±æ•ˆ"><a href="#é¿å…ç´¢å¼•å¤±æ•ˆ" class="headerlink" title="é¿å…ç´¢å¼•å¤±æ•ˆ"></a>é¿å…ç´¢å¼•å¤±æ•ˆ</h4><ul><li><p><strong>å…¨å€¼åŒ¹é…</strong> ï¼Œå¯¹ç´¢å¼•ä¸­æ‰€æœ‰åˆ—éƒ½æŒ‡å®šå…·ä½“å€¼ï¼Œè¯¥æƒ…å†µä¸‹ç´¢å¼•ç”Ÿæ•ˆï¼Œæ‰§è¡Œæ•ˆç‡é«˜</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">explain select * from tb_seller where name&#x3D;&#39;å°ç±³ç§‘æŠ€&#39; and status&#x3D;&#39;1&#39; and address&#x3D;&#39;åŒ—äº¬å¸‚&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201126200538720.png" alt="image-20201126200538720"></p></li><li><p><strong>æœ€å·¦å‰ç¼€æ³•åˆ™</strong>(æŒ‡çš„æ˜¯æŸ¥è¯¢è¦ä»ç´¢å¼•çš„æœ€å·¦å‰åˆ—å¼€å§‹ï¼Œå¹¶ä¸”ä¸è·³è¿‡ç´¢å¼•ä¸­çš„åˆ—)</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201126200821090.png" alt="image-20201126200821090"></p><p>è¿æ³•æœ€å·¦å‰ç¼€æ³•åˆ™ ï¼Œ ç´¢å¼•å¤±æ•ˆï¼š</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201126201028628.png" alt="image-20201126201028628"></p><p>å¦‚æœç¬¦åˆæœ€å·¦æ³•åˆ™ï¼Œä½†æ˜¯å‡ºç°è·³è·ƒæŸä¸€åˆ—ï¼Œåªæœ‰æœ€å·¦åˆ—ç´¢å¼•ç”Ÿæ•ˆï¼š</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201126201047543.png" alt="image-20201126201047543"></p></li><li><p><strong>èŒƒå›´æŸ¥è¯¢å³è¾¹çš„åˆ—ï¼Œä¸èƒ½ä½¿ç”¨ç´¢å¼•</strong> </p><blockquote><p>æ ¹æ®å‰é¢çš„ä¸¤ä¸ªå­—æ®µname ï¼Œ status æŸ¥è¯¢æ˜¯èµ°ç´¢å¼•çš„ï¼Œ ä½†æ˜¯æœ€åä¸€ä¸ªæ¡ä»¶address æ²¡æœ‰ç”¨åˆ°ç´¢å¼•ã€‚</p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201126201157253.png" alt="image-20201126201157253"></p></li><li><p><strong>ä¸è¦åœ¨ç´¢å¼•åˆ—ä¸Šè¿›è¡Œè¿ç®—æ“ä½œï¼Œ ç´¢å¼•å°†å¤±æ•ˆ</strong></p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201126201223070.png" alt="image-20201126201223070"></p></li><li><p><strong>å­—ç¬¦ä¸²ä¸åŠ å•å¼•å·</strong>ï¼Œé€ æˆç´¢å¼•å¤±æ•ˆã€‚</p><blockquote><p>ç”±äºåœ¨æŸ¥è¯¢çš„æ—¶å€™æ²¡æœ‰å¯¹å­—ç¬¦ä¸²åŠ å•å¼•å·ï¼ŒMySQLçš„æŸ¥è¯¢ä¼˜åŒ–å™¨ï¼Œä¼šè‡ªåŠ¨çš„è¿›è¡Œç±»å‹è½¬æ¢ï¼Œé€ æˆç´¢å¼•å¤±æ•ˆã€‚</p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201126201250213.png" alt="image-20201126201250213"></p></li><li><p>å°½é‡ä½¿ç”¨è¦†ç›–ç´¢å¼•(<strong>åªè®¿é—®ç´¢å¼•çš„æŸ¥è¯¢ï¼ˆç´¢å¼•åˆ—å®Œå…¨åŒ…å«æŸ¥è¯¢åˆ—ï¼‰</strong>)ï¼Œé¿å…<code>select *</code></p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201126201411070.png" alt="image-20201126201411070"></p><p>å¦‚æœæŸ¥è¯¢åˆ—ï¼Œè¶…å‡ºç´¢å¼•åˆ—ï¼Œä¹Ÿä¼šé™ä½æ€§èƒ½</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201126201437408.png" alt="image-20201126201437408"></p><pre class="line-numbers language-none"><code class="language-none">TIP :    using index ï¼šä½¿ç”¨è¦†ç›–ç´¢å¼•çš„æ—¶å€™å°±ä¼šå‡ºç°        using whereï¼šåœ¨æŸ¥æ‰¾ä½¿ç”¨ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œéœ€è¦å›è¡¨å»æŸ¥è¯¢æ‰€éœ€çš„æ•°æ®        using index conditionï¼šæŸ¥æ‰¾ä½¿ç”¨äº†ç´¢å¼•ï¼Œä½†æ˜¯éœ€è¦å›è¡¨æŸ¥è¯¢æ•°æ®        using index ; using whereï¼šæŸ¥æ‰¾ä½¿ç”¨äº†ç´¢å¼•ï¼Œä½†æ˜¯éœ€è¦çš„æ•°æ®éƒ½åœ¨ç´¢å¼•åˆ—ä¸­èƒ½æ‰¾åˆ°ï¼Œæ‰€ä»¥ä¸éœ€è¦å›è¡¨æŸ¥è¯¢æ•°æ®    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>ç”¨oråˆ†å‰²å¼€çš„æ¡ä»¶ï¼Œ å¦‚æœorå‰çš„æ¡ä»¶ä¸­çš„åˆ—æœ‰ç´¢å¼•ï¼Œè€Œåé¢çš„åˆ—ä¸­æ²¡æœ‰ç´¢å¼•ï¼Œé‚£ä¹ˆæ¶‰åŠçš„ç´¢å¼•éƒ½ä¸ä¼šè¢«ç”¨åˆ°ã€‚</strong></p><blockquote><p>ç¤ºä¾‹ï¼Œnameå­—æ®µæ˜¯ç´¢å¼•åˆ— ï¼Œ è€Œcreatetimeä¸æ˜¯ç´¢å¼•åˆ—ï¼Œä¸­é—´æ˜¯orè¿›è¡Œè¿æ¥æ˜¯ä¸èµ°ç´¢å¼•çš„ ï¼š</p></blockquote><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">explain select * from tb_seller where name&#x3D;&#39;é»‘é©¬ç¨‹åºå‘˜&#39; or createtime &#x3D; &#39;2088-01-01 12:00:00&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201126202050643.png" alt="image-20201126202050643"></p></li><li><p><strong>ä»¥%å¼€å¤´çš„Likeæ¨¡ç³ŠæŸ¥è¯¢ï¼Œç´¢å¼•å¤±æ•ˆ</strong></p><blockquote><p>å¦‚æœä»…ä»…æ˜¯å°¾éƒ¨æ¨¡ç³ŠåŒ¹é…ï¼Œç´¢å¼•ä¸ä¼šå¤±æ•ˆã€‚å¦‚æœæ˜¯å¤´éƒ¨æ¨¡ç³ŠåŒ¹é…ï¼Œç´¢å¼•å¤±æ•ˆã€‚</p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201126202146578.png" alt="image-20201126202146578"></p><p><strong>è¿™ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥é€šè¿‡è¦†ç›–ç´¢å¼•æ¥è§£å†³</strong></p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201126202214001.png" alt="image-20201126202214001"></p></li><li><p>å¦‚æœMySQLè¯„ä¼°ä½¿ç”¨ç´¢å¼•æ¯”å…¨è¡¨æ›´æ…¢ï¼Œåˆ™ä¸ä½¿ç”¨ç´¢å¼•ã€‚</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201126202345972.png" alt="image-20201126202345972"></p></li><li><p><code>is NULL</code> ï¼Œ <code>is NOT NULL</code> æœ‰æ—¶ç´¢å¼•å¤±æ•ˆã€‚</p><p>isNULLçš„æ—¶å€™ï¼Œnullå¤šçš„æ—¶å€™ä¼šå¤±æ•ˆï¼Œå°‘çš„æ—¶å€™èµ°ç´¢å¼•</p><p>isNotNULLçš„æ—¶å€™ nullå°‘çš„æ—¶å€™ä¼šå¤±æ•ˆï¼Œå¤šçš„æ—¶å€™èµ°ç´¢å¼•</p></li><li><p> <code>in èµ°ç´¢å¼•</code>ï¼Œ <code>not in</code> ç´¢å¼•å¤±æ•ˆã€‚</p></li><li><p><strong>å°½é‡ä½¿ç”¨ å¤åˆç´¢å¼•ï¼Œå°‘ä½¿ç”¨å•åˆ—ç´¢å¼•</strong>ï¼</p><ul><li><p>åˆ›å»ºå¤åˆç´¢å¼•å°±ç›¸å½“äºåˆ›å»ºäº†ä¸‰ä¸ªç´¢å¼•</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">create index idx_name_sta_address on tb_seller(name, status, address);å°±ç›¸å½“äºåˆ›å»ºäº†ä¸‰ä¸ªç´¢å¼• ï¼š    name    name + status    name + status + address    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ•°æ®åº“ä¼šé€‰æ‹©ä¸€ä¸ªæœ€ä¼˜çš„ç´¢å¼•ï¼ˆè¾¨è¯†åº¦æœ€é«˜ç´¢å¼•ï¼‰æ¥ä½¿ç”¨ï¼Œå¹¶ä¸ä¼šä½¿ç”¨å…¨éƒ¨ç´¢å¼• ã€‚</p></li></ul></li></ul><h4 id="æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ"><a href="#æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ" class="headerlink" title="æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ"></a>æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ</h4><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">show status like &#39;Handler_read%&#39;;show global status like &#39;Handler_read%&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201127132314991.png" alt="image-20201127132314991"></p><h3 id="SQLä¼˜åŒ–"><a href="#SQLä¼˜åŒ–" class="headerlink" title="SQLä¼˜åŒ–"></a>SQLä¼˜åŒ–</h3><p><strong>ç¯å¢ƒå‡†å¤‡</strong></p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">CREATE TABLE &#96;tb_user_2&#96; (&#96;id&#96; int(11) NOT NULL AUTO_INCREMENT,&#96;username&#96; varchar(45) NOT NULL,&#96;password&#96; varchar(96) NOT NULL,&#96;name&#96; varchar(45) NOT NULL,&#96;birthday&#96; datetime DEFAULT NULL,&#96;sex&#96; char(1) DEFAULT NULL,&#96;email&#96; varchar(45) DEFAULT NULL,&#96;phone&#96; varchar(45) DEFAULT NULL,&#96;qq&#96; varchar(32) DEFAULT NULL,&#96;status&#96; varchar(32) NOT NULL COMMENT &#39;ç”¨æˆ·çŠ¶æ€&#39;,&#96;create_time&#96; datetime NOT NULL,&#96;update_time&#96; datetime DEFAULT NULL,PRIMARY KEY (&#96;id&#96;),UNIQUE KEY &#96;unique_user_username&#96; (&#96;username&#96;)) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8 ; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ä¼˜åŒ–å¯¼å…¥æ•°æ®æ•ˆç‡"><a href="#ä¼˜åŒ–å¯¼å…¥æ•°æ®æ•ˆç‡" class="headerlink" title="ä¼˜åŒ–å¯¼å…¥æ•°æ®æ•ˆç‡"></a>ä¼˜åŒ–å¯¼å…¥æ•°æ®æ•ˆç‡</h4><blockquote><p>å½“ä½¿ç”¨load å‘½ä»¤å¯¼å…¥æ•°æ®çš„æ—¶å€™ï¼Œ<strong>é€‚å½“çš„è®¾ç½®å¯ä»¥æé«˜å¯¼å…¥çš„æ•ˆç‡</strong>ã€‚</p></blockquote><ul><li><p>ä¸»é”®é¡ºåºæ’å…¥</p><blockquote><p>sql1.log â€”-&gt; ä¸»é”®æœ‰åº </p><p>sql2.log â€”-&gt; ä¸»é”®æ— åº</p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201127135432056.png" alt="image-20201127135432056"></p></li><li><p>å…³é—­å”¯ä¸€æ€§æ ¡éªŒ</p><blockquote><p>åœ¨å¯¼å…¥æ•°æ®å‰æ‰§è¡Œ set unique_checks = 0ï¼Œå…³é—­å”¯ä¸€æ€§æ ¡éªŒï¼Œåœ¨å¯¼å…¥ç»“æŸåæ‰§è¡Œ set unique_checks = 1ï¼Œæ¢å¤å”¯ä¸€æ€§æ ¡éªŒï¼Œå¯ä»¥æé«˜æ•ˆç‡</p></blockquote></li><li><p>æ‰‹åŠ¨æäº¤äº‹åŠ¡</p><blockquote><p>å¦‚æœåº”ç”¨ä½¿ç”¨è‡ªåŠ¨æäº¤çš„æ–¹å¼ï¼Œå»ºè®®åœ¨å¯¼å…¥å‰æ‰§è¡Œset autocommit = 0ï¼Œå…³é—­è‡ªåŠ¨æäº¤ï¼Œå¯¼å…¥ç»“æŸåå†æ‰§è¡Œ set autocommit = 1ï¼Œæ‰“å¼€è‡ªåŠ¨æäº¤ï¼Œä¹Ÿå¯ä»¥æé«˜å¯¼å…¥çš„æ•ˆç‡</p></blockquote></li></ul><h4 id="ä¼˜åŒ–insertè¯­å¥"><a href="#ä¼˜åŒ–insertè¯­å¥" class="headerlink" title="ä¼˜åŒ–insertè¯­å¥"></a>ä¼˜åŒ–insertè¯­å¥</h4><blockquote><p>å¦‚æœéœ€è¦<strong>åŒæ—¶å¯¹ä¸€å¼ è¡¨æ’å…¥å¾ˆå¤šè¡Œæ•°æ®</strong>æ—¶ï¼Œåº”è¯¥<strong>å°½é‡ä½¿ç”¨å¤šä¸ªå€¼è¡¨çš„insertè¯­å¥</strong>ï¼Œè¿™ç§æ–¹å¼å°†<strong>å¤§å¤§çš„ç¼©å‡å®¢æˆ·ç«¯ä¸æ•°æ®åº“ä¹‹é—´çš„è¿æ¥ã€å…³é—­ç­‰æ¶ˆè€—</strong>ã€‚ä½¿å¾—æ•ˆç‡æ¯”åˆ†å¼€æ‰§è¡Œçš„å•ä¸ªinsertè¯­å¥å¿«ã€‚</p></blockquote><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">åŸå§‹çš„æ–¹å¼ï¼š    insert into tb_test values(1,&#39;Tom&#39;);    insert into tb_test values(2,&#39;Cat&#39;);    insert into tb_test values(3,&#39;Jerry&#39;);ä¼˜åŒ–çš„æ–¹å¼ï¼šinsert into tb_test values(1,&#39;Tom&#39;),(2,&#39;Cat&#39;)ï¼Œ(3,&#39;Jerry&#39;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>åœ¨äº‹åŠ¡ä¸­è¿›è¡Œæ•°æ®æ’å…¥</p></blockquote><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">start transaction;    insert into tb_test values(1,&#39;Tom&#39;);    insert into tb_test values(2,&#39;Cat&#39;);    insert into tb_test values(3,&#39;Jerry&#39;);commit;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ•°æ®æœ‰åºæ’å…¥</p></blockquote><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">ä¼˜åŒ–å‰ï¼š    insert into tb_test values(4,&#39;Tim&#39;);    insert into tb_test values(1,&#39;Tom&#39;);    insert into tb_test values(3,&#39;Jerry&#39;);    insert into tb_test values(5,&#39;Rose&#39;);    insert into tb_test values(2,&#39;Cat&#39;);ä¼˜åŒ–åï¼šinsert into tb_test values(1,&#39;Tom&#39;);insert into tb_test values(2,&#39;Cat&#39;);insert into tb_test values(3,&#39;Jerry&#39;);insert into tb_test values(4,&#39;Tim&#39;);insert into tb_test values(5,&#39;Rose&#39;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ä¼˜åŒ–order-byè¯­å¥"><a href="#ä¼˜åŒ–order-byè¯­å¥" class="headerlink" title="ä¼˜åŒ–order byè¯­å¥"></a>ä¼˜åŒ–order byè¯­å¥</h4><p>ä¸¤ç§æ’åºæ–¹å¼ï¼š</p><ul><li><p><strong>filesortæ’åº</strong>ï¼Œé€šè¿‡å¯¹è¿”å›æ•°æ®è¿›è¡Œæ’åºï¼Œæ‰€æœ‰ä¸æ˜¯é€šè¿‡ç´¢å¼•ç›´æ¥è¿”å›æ’åºç»“æœçš„æ’åºéƒ½å«FileSortæ’åº</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201128192710911.png" alt="image-20201128192710911"></p></li><li><p><strong>using index</strong>ï¼Œé€šè¿‡æœ‰åºç´¢å¼•â€“é¡ºåºæ‰«æâ€“ç›´æ¥è¿”å›æœ‰åºæ•°æ®ï¼Œï¼Œä¸éœ€è¦é¢å¤–çš„æ’åºï¼Œæ•ˆç‡é«˜</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201128192642322.png" alt="image-20201128192642322"></p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201128193523272.png" alt="image-20201128193523272"></p></li></ul><blockquote><p>äº†è§£äº†MySQLçš„æ’åºæ–¹å¼ï¼Œä¼˜åŒ–ç›®æ ‡å°±æ¸…æ™°äº†ï¼šå°½é‡<strong>å‡å°‘é¢å¤–çš„æ’åº</strong>ï¼Œ<strong>é€šè¿‡ç´¢å¼•ç›´æ¥è¿”å›æœ‰åºæ•°æ®</strong>ã€‚where æ¡ä»¶å’ŒOrder by ä½¿ç”¨ç›¸åŒçš„ç´¢å¼•ï¼Œå¹¶ä¸”<strong>Order By çš„é¡ºåºå’Œç´¢å¼•é¡ºåºç›¸åŒ</strong>ï¼Œ å¹¶ä¸”Order  by çš„å­—æ®µéƒ½æ˜¯å‡åºï¼Œæˆ–è€…éƒ½æ˜¯é™åºã€‚å¦åˆ™è‚¯å®šéœ€è¦é¢å¤–çš„æ“ä½œï¼Œè¿™æ ·å°±ä¼šå‡ºç°FileSortã€‚</p></blockquote><hr><h5 id="filesortçš„ä¼˜åŒ–"><a href="#filesortçš„ä¼˜åŒ–" class="headerlink" title="filesortçš„ä¼˜åŒ–"></a>filesortçš„ä¼˜åŒ–</h5><blockquote><p>é€šè¿‡åˆ›å»ºåˆé€‚çš„ç´¢å¼•ï¼Œèƒ½å¤Ÿå‡å°‘ Filesort çš„å‡ºç°ï¼Œä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ¡ä»¶é™åˆ¶ä¸èƒ½è®©Filesortæ¶ˆå¤±ï¼Œé‚£å°±éœ€è¦åŠ å¿« Filesortçš„æ’åºæ“ä½œã€‚å¯¹äºFilesort ï¼Œ MySQL æœ‰ä¸¤ç§æ’åºç®—æ³•ï¼š</p><p>1ï¼‰ ä¸¤æ¬¡æ‰«æç®—æ³• ï¼šMySQL4.1 ä¹‹å‰ï¼Œä½¿ç”¨è¯¥æ–¹å¼æ’åºã€‚é¦–å…ˆæ ¹æ®æ¡ä»¶å–å‡ºæ’åºå­—æ®µå’Œè¡ŒæŒ‡é’ˆä¿¡æ¯ï¼Œç„¶ååœ¨æ’åºåŒº sort buffer ä¸­æ’åºï¼Œå¦‚æœsort bufferä¸å¤Ÿï¼Œåˆ™åœ¨<strong>ä¸´æ—¶è¡¨</strong> temporary table ä¸­å­˜å‚¨æ’åºç»“æœã€‚å®Œæˆæ’åºä¹‹åï¼Œå†æ ¹æ®è¡ŒæŒ‡é’ˆå›è¡¨è¯»å–è®°å½•ï¼Œè¯¥æ“ä½œå¯èƒ½ä¼šå¯¼è‡´å¤§é‡éšæœºI/Oæ“ä½œã€‚</p><p>2ï¼‰ä¸€æ¬¡æ‰«æç®—æ³•ï¼šä¸€æ¬¡æ€§å–å‡ºæ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰å­—æ®µï¼Œç„¶ååœ¨æ’åºåŒº sort  buffer ä¸­æ’åºåç›´æ¥è¾“å‡ºç»“æœé›†ã€‚æ’åºæ—¶å†…å­˜å¼€é”€è¾ƒå¤§ï¼Œä½†æ˜¯æ’åºæ•ˆç‡æ¯”ä¸¤æ¬¡æ‰«æç®—æ³•è¦é«˜ã€‚</p></blockquote><hr><h4 id="ä¼˜åŒ–group-by"><a href="#ä¼˜åŒ–group-by" class="headerlink" title="ä¼˜åŒ–group by"></a>ä¼˜åŒ–group by</h4><blockquote><p>group byå®é™…ä¸Šä¹Ÿä¼šè¿›è¡Œæ’åºæ“ä½œï¼Œäºorder by ç›¸æ¯”ï¼Œgroup byä¸»è¦çŸ¥è¯†å¤šäº†æ’åºä¹‹åçš„åˆ†ç»„æ“ä½œ</p></blockquote><p>å¦‚æœæŸ¥è¯¢åŒ…å« group by ä½†æ˜¯ç”¨æˆ·æƒ³è¦é¿å…æ’åºç»“æœçš„æ¶ˆè€—ï¼Œ <strong>åˆ™å¯ä»¥æ‰§è¡Œorder by null ç¦æ­¢æ’åº</strong></p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">drop index idx_emp_age_salary on emp;explain select age,count(*) from emp group by age;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä¼˜åŒ–åæ˜¯ï¼š</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">explain select age,count(*) from emp group by age order by null;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h4 id="ä¼˜åŒ–åµŒå¥—æŸ¥è¯¢"><a href="#ä¼˜åŒ–åµŒå¥—æŸ¥è¯¢" class="headerlink" title="ä¼˜åŒ–åµŒå¥—æŸ¥è¯¢"></a>ä¼˜åŒ–åµŒå¥—æŸ¥è¯¢</h4><p>æœ‰äº›æƒ…å†µä¸‹ï¼Œå­æŸ¥è¯¢æ˜¯å¯ä»¥è¢«æ›´é«˜æ•ˆçš„è¿æ¥ï¼ˆJOINï¼‰æ›¿ä»£ã€‚</p><p>è¿æ¥(Join)æŸ¥è¯¢ä¹‹æ‰€ä»¥æ›´æœ‰æ•ˆç‡ä¸€äº› ï¼Œæ˜¯å› ä¸ºMySQLä¸éœ€è¦<strong>åœ¨å†…å­˜ä¸­åˆ›å»ºä¸´æ—¶è¡¨</strong>æ¥å®Œæˆè¿™ä¸ªé€»è¾‘ä¸Šéœ€è¦ä¸¤ä¸ªæ­¥éª¤çš„æŸ¥è¯¢å·¥ä½œã€‚</p><hr><h4 id="ä¼˜åŒ–oræ¡ä»¶"><a href="#ä¼˜åŒ–oræ¡ä»¶" class="headerlink" title="ä¼˜åŒ–oræ¡ä»¶"></a>ä¼˜åŒ–oræ¡ä»¶</h4><blockquote><p>å¯¹äºåŒ…å«ORçš„æŸ¥è¯¢å­å¥ï¼Œå¦‚æœè¦åˆ©ç”¨ç´¢å¼•ï¼Œåˆ™ORä¹‹é—´çš„æ¯ä¸ªæ¡ä»¶åˆ—éƒ½å¿…é¡»ç”¨åˆ°ç´¢å¼• ï¼Œ è€Œä¸”ä¸èƒ½ä½¿ç”¨åˆ°å¤åˆç´¢å¼•ï¼› å¦‚æœæ²¡æœ‰ç´¢å¼•ï¼Œåˆ™åº”è¯¥è€ƒè™‘å¢åŠ ç´¢å¼•ã€‚</p></blockquote><p>å»ºè®®ä½¿ç”¨ union æ›¿æ¢ or ï¼š</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">select * from emp where id &#x3D; 1 or age &#x3D; 30;åº”è¯¥æ›¿æ¢ä¸ºï¼šselect * from emp where id &#x3D; 1 union select * from emp where  age &#x3D; 30;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h4 id="ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢"><a href="#ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢"></a>ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢</h4><blockquote><p>ä¸€èˆ¬åˆ†é¡µæŸ¥è¯¢æ—¶ï¼Œé€šè¿‡åˆ›å»ºè¦†ç›–ç´¢å¼•èƒ½å¤Ÿæ¯”è¾ƒå¥½åœ°æé«˜æ€§èƒ½ã€‚ä¸€ä¸ª<strong>å¸¸è§åˆéå¸¸å¤´ç–¼çš„é—®é¢˜</strong>å°±æ˜¯ limit 2000000,10  ï¼Œæ­¤æ—¶éœ€è¦MySQLæ’åºå‰2000010 è®°å½•ï¼Œä»…ä»…è¿”å›2000000 - 2000010 çš„è®°å½•ï¼Œå…¶ä»–è®°å½•ä¸¢å¼ƒï¼ŒæŸ¥è¯¢æ’åºçš„ä»£ä»·éå¸¸å¤§ ã€‚</p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201128201314111.png" alt="image-20201128201314111"></p><h5 id="ä¼˜åŒ–æ€è·¯1"><a href="#ä¼˜åŒ–æ€è·¯1" class="headerlink" title="ä¼˜åŒ–æ€è·¯1"></a>ä¼˜åŒ–æ€è·¯1</h5><blockquote><p>åœ¨ç´¢å¼•ä¸Šå®Œæˆæ’åºåˆ†é¡µå·¥ä½œï¼Œæœ€åæ ¹æ®ä¸»é”®å…³è”å›åŸè¡¨æŸ¥è¯¢æ‰€éœ€è¦çš„å…¶ä»–åˆ—å†…å®¹</p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201128201648073.png" alt="image-20201128201648073"></p><h5 id="ä¼˜åŒ–æ€è·¯äºŒ"><a href="#ä¼˜åŒ–æ€è·¯äºŒ" class="headerlink" title="ä¼˜åŒ–æ€è·¯äºŒ"></a>ä¼˜åŒ–æ€è·¯äºŒ</h5><blockquote><p>è¯¥æ–¹æ¡ˆé€‚ç”¨äº<strong>ä¸»é”®è‡ªå¢</strong>çš„è¡¨ï¼Œ<strong>å¹¶ä¸”ä¸»é”®è‡ªå¢ä¸èƒ½å‡ºç°æ–­å±‚</strong>ï¼Œå¯ä»¥æŠŠLimit æŸ¥è¯¢è½¬æ¢æˆæŸä¸ªä½ç½®çš„æŸ¥è¯¢ ã€‚</p></blockquote><p>ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">select * from table where id &gt; 200000 limit 10<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h4 id="ä½¿ç”¨SQLæç¤º"><a href="#ä½¿ç”¨SQLæç¤º" class="headerlink" title="ä½¿ç”¨SQLæç¤º"></a>ä½¿ç”¨SQLæç¤º</h4><blockquote><p>SQLæç¤ºï¼Œæ˜¯ä¼˜åŒ–æ•°æ®åº“çš„ä¸€ä¸ªé‡è¦æ‰‹æ®µï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯åœ¨SQLè¯­å¥ä¸­åŠ å…¥ä¸€äº›äººä¸ºçš„æç¤ºæ¥è¾¾åˆ°ä¼˜åŒ–æ“ä½œçš„ç›®çš„ã€‚</p></blockquote><ul><li><p>use index</p><p>å‘Šè¯‰mysqlç”¨å“ªä¸ªç´¢å¼•ï¼Œï¼Œä¸æ˜¯å¼ºåˆ¶çš„ï¼Œåªæ˜¯å»ºè®®</p></li><li><p>ignore index</p></li><li><p>force index</p></li></ul><hr><h3 id="åº”ç”¨ä¼˜åŒ–"><a href="#åº”ç”¨ä¼˜åŒ–" class="headerlink" title="åº”ç”¨ä¼˜åŒ–"></a>åº”ç”¨ä¼˜åŒ–</h3><h4 id="ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± "><a href="#ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± "></a>ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± </h4><blockquote><p>å¯¹äºè®¿é—®æ•°æ®åº“æ¥è¯´ï¼Œå»ºç«‹è¿æ¥çš„ä»£ä»·å¾ˆå¤§ï¼Œå¦‚æœé¢‘ç¹çš„å¼€å¯å…³é—­è¿æ¥ï¼Œå¾ˆè€—èµ„æºï¼Œæˆ‘ä»¬æœ‰å¿…è¦å»ºç«‹æ•°æ®åº“è¿æ¥æ± </p></blockquote><p>c3p0</p><p>druid</p><hr><h4 id="å‡å°‘å¯¹mysqlçš„è®¿é—®"><a href="#å‡å°‘å¯¹mysqlçš„è®¿é—®" class="headerlink" title="å‡å°‘å¯¹mysqlçš„è®¿é—®"></a>å‡å°‘å¯¹mysqlçš„è®¿é—®</h4><ul><li><p>é¿å…å¯¹æ•°æ®è¿›è¡Œé‡å¤æ£€ç´¢</p></li><li><p>å¢åŠ ç¼“å­˜å±‚</p></li><li><p>è´Ÿè½½å‡è¡¡</p><ul><li>ä¸»ä»å¤åˆ¶</li><li>è¯»å†™åˆ†ç¦»</li><li>åˆ†å¸ƒå¼æ•°æ®åº“æ¶æ„</li></ul></li></ul><hr><h4 id="MySQLæŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–ï¼ˆ8ä»¥åºŸå¼ƒï¼‰"><a href="#MySQLæŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–ï¼ˆ8ä»¥åºŸå¼ƒï¼‰" class="headerlink" title="MySQLæŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–ï¼ˆ8ä»¥åºŸå¼ƒï¼‰"></a>MySQLæŸ¥è¯¢ç¼“å­˜ä¼˜åŒ–ï¼ˆ8ä»¥åºŸå¼ƒï¼‰</h4><blockquote><p>å¼€å¯mysqlçš„æŸ¥è¯¢ç¼“å­˜ï¼Œå®Œå…¨ç›¸åŒçš„sqlè¯­å¥ä¼šä»ç¼“å­˜ä¸­è¯»å–</p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201128210435548.png" alt="image-20201128210435548"></p><p>è¯¦æƒ…æŸ¥çœ‹ç½‘ä¸Šçš„ä¿¡æ¯</p><hr><h4 id="mysqlå†…å­˜ç®¡ç†åŠä¼˜åŒ–"><a href="#mysqlå†…å­˜ç®¡ç†åŠä¼˜åŒ–" class="headerlink" title="mysqlå†…å­˜ç®¡ç†åŠä¼˜åŒ–"></a>mysqlå†…å­˜ç®¡ç†åŠä¼˜åŒ–</h4><h5 id="å†…å­˜ä¼˜åŒ–åŸåˆ™"><a href="#å†…å­˜ä¼˜åŒ–åŸåˆ™" class="headerlink" title="å†…å­˜ä¼˜åŒ–åŸåˆ™"></a>å†…å­˜ä¼˜åŒ–åŸåˆ™</h5><ul><li>å°†å°½é‡å¤šçš„å†…å­˜åˆ†é…ç»™mysqlåšç¼“å­˜ï¼Œç»™æ“ä½œç³»ç»Ÿå’Œå…¶ä»–ç¨‹åºé¢„ç•™è¶³å¤Ÿå†…å­˜</li><li>MyISAMå­˜å‚¨å¼•æ“çš„æ•°æ®æ–‡ä»¶è¯»å–ä¾èµ–äºæ“ä½œç³»ç»Ÿè‡ªèº«çš„IOç¼“å­˜ï¼Œå› æ­¤ï¼Œå¦‚æœæœ‰MyISAMè¡¨ï¼Œå°±è¦é¢„ç•™æ›´å¤šçš„å†…å­˜ç»™æ“ä½œç³»ç»ŸåšIOç¼“å­˜</li><li>æ’åºåŒºã€è¿æ¥åŒºç­‰ç¼“å­˜æ—¶åˆ†é…ç»™æ¯ä¸ªæ•°æ®åº“sessionä¸“ç”¨çš„ï¼Œå…¶é»˜è®¤å€¼çš„è®¾ç½®è¦æ ¹æ®æœ€å¤§è¿æ¥æ•°åˆç†åˆ†é…ï¼Œå¦‚æœè®¾ç½®å¤ªå¤§ï¼Œä¸ä½†æµªè´¹èµ„æºï¼Œè€Œä¸”åœ¨å¹¶å‘è¿æ¥è¾ƒé«˜æ—¶ä¼šå¯¼è‡´ç‰©ç†å†…å­˜è€—å°½</li></ul><hr><h5 id="MyISAMå†…å­˜ä¼˜åŒ–"><a href="#MyISAMå†…å­˜ä¼˜åŒ–" class="headerlink" title="MyISAMå†…å­˜ä¼˜åŒ–"></a>MyISAMå†…å­˜ä¼˜åŒ–</h5><blockquote><p>myisamå­˜å‚¨å¼•æ“ä½¿ç”¨ key_bufferç¼“å­˜ç´¢å¼•å—ï¼ŒåŠ é€Ÿmyisamç´¢å¼•çš„è¯»å†™é€Ÿåº¦ã€‚å¯¹äºmyisamè¡¨çš„æ•°æ®åº“ï¼Œmysqlæ²¡æœ‰ç‰¹åˆ«çš„ç¼“å­˜æœºåˆ¶ï¼Œå®Œå…¨ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„IOç¼“å­˜</p></blockquote><h5 id="key-buffer-size"><a href="#key-buffer-size" class="headerlink" title="key_buffer_size"></a>key_buffer_size</h5><p>key_buffer_sizeå†³å®šMyISAMç´¢å¼•å—ç¼“å­˜åŒºçš„å¤§å°ï¼Œç›´æ¥å½±å“åˆ°MyISAMè¡¨çš„å­˜å–æ•ˆç‡ã€‚å¯ä»¥åœ¨MySQLå‚æ•°æ–‡ä»¶ä¸­è®¾ç½®key_buffer_sizeçš„å€¼ï¼Œå¯¹äºä¸€èˆ¬MyISAMæ•°æ®åº“ï¼Œå»ºè®®è‡³å°‘å°†1/4å¯ç”¨å†…å­˜åˆ†é…ç»™key_buffer_sizeã€‚</p><p>åœ¨/usr/my.cnf ä¸­åšå¦‚ä¸‹é…ç½®ï¼š</p><pre class="line-numbers language-none"><code class="language-none">key_buffer_size&#x3D;512M<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="read-buffer-size"><a href="#read-buffer-size" class="headerlink" title="read_buffer_size"></a>read_buffer_size</h5><p>å¦‚æœéœ€è¦ç»å¸¸é¡ºåºæ‰«æmyisamè¡¨ï¼Œå¯ä»¥é€šè¿‡å¢å¤§read_buffer_sizeçš„å€¼æ¥æ”¹å–„æ€§èƒ½ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯read_buffer_sizeæ˜¯æ¯ä¸ªsessionç‹¬å çš„ï¼Œå¦‚æœé»˜è®¤å€¼è®¾ç½®å¤ªå¤§ï¼Œå°±ä¼šé€ æˆå†…å­˜æµªè´¹ã€‚</p><h5 id="read-rnd-buffer-size"><a href="#read-rnd-buffer-size" class="headerlink" title="read_rnd_buffer_size"></a>read_rnd_buffer_size</h5><p>å¯¹äºéœ€è¦åšæ’åºçš„myisamè¡¨çš„æŸ¥è¯¢ï¼Œå¦‚å¸¦æœ‰order byå­å¥çš„sqlï¼Œé€‚å½“å¢åŠ  read_rnd_buffer_size çš„å€¼ï¼Œå¯ä»¥æ”¹å–„æ­¤ç±»çš„sqlæ€§èƒ½ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ read_rnd_buffer_size æ˜¯æ¯ä¸ªsessionç‹¬å çš„ï¼Œå¦‚æœé»˜è®¤å€¼è®¾ç½®å¤ªå¤§ï¼Œå°±ä¼šé€ æˆå†…å­˜æµªè´¹ã€‚</p><hr><h5 id="innoDBå†…å­˜ä¼˜åŒ–"><a href="#innoDBå†…å­˜ä¼˜åŒ–" class="headerlink" title="innoDBå†…å­˜ä¼˜åŒ–"></a>innoDBå†…å­˜ä¼˜åŒ–</h5><p>innodbç”¨ä¸€å—å†…å­˜åŒºåšIOç¼“å­˜æ± ï¼Œè¯¥ç¼“å­˜æ± ä¸ä»…ç”¨æ¥ç¼“å­˜innodbçš„ç´¢å¼•å—ï¼Œè€Œä¸”ä¹Ÿç”¨æ¥ç¼“å­˜innodbçš„æ•°æ®å—ã€‚</p><h5 id="innodb-buffer-pool-size"><a href="#innodb-buffer-pool-size" class="headerlink" title="innodb_buffer_pool_size"></a>innodb_buffer_pool_size</h5><p>è¯¥å˜é‡å†³å®šäº† innodb å­˜å‚¨å¼•æ“è¡¨æ•°æ®å’Œç´¢å¼•æ•°æ®çš„æœ€å¤§ç¼“å­˜åŒºå¤§å°ã€‚åœ¨ä¿è¯æ“ä½œç³»ç»ŸåŠå…¶ä»–ç¨‹åºæœ‰è¶³å¤Ÿå†…å­˜å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œinnodb_buffer_pool_size çš„å€¼è¶Šå¤§ï¼Œç¼“å­˜å‘½ä¸­ç‡è¶Šé«˜ï¼Œè®¿é—®InnoDBè¡¨éœ€è¦çš„ç£ç›˜I/O å°±è¶Šå°‘ï¼Œæ€§èƒ½ä¹Ÿå°±è¶Šé«˜ã€‚</p><pre class="line-numbers language-none"><code class="language-none">innodb_buffer_pool_size&#x3D;512M<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="innodb-log-buffer-size"><a href="#innodb-log-buffer-size" class="headerlink" title="innodb_log_buffer_size"></a>innodb_log_buffer_size</h5><p>å†³å®šäº†innodbé‡åšæ—¥å¿—ç¼“å­˜çš„å¤§å°ï¼Œå¯¹äºå¯èƒ½äº§ç”Ÿå¤§é‡æ›´æ–°è®°å½•çš„å¤§äº‹åŠ¡ï¼Œå¢åŠ innodb_log_buffer_sizeçš„å¤§å°ï¼Œå¯ä»¥é¿å…innodbåœ¨äº‹åŠ¡æäº¤å‰å°±æ‰§è¡Œä¸å¿…è¦çš„æ—¥å¿—å†™å…¥ç£ç›˜æ“ä½œã€‚</p><pre class="line-numbers language-none"><code class="language-none">innodb_log_buffer_size&#x3D;10M<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h3 id="Mysqlå¹¶å‘å‚æ•°è°ƒæ•´"><a href="#Mysqlå¹¶å‘å‚æ•°è°ƒæ•´" class="headerlink" title="Mysqlå¹¶å‘å‚æ•°è°ƒæ•´"></a>Mysqlå¹¶å‘å‚æ•°è°ƒæ•´</h3><p>ä»å®ç°ä¸Šæ¥è¯´ï¼ŒMySQL Server æ˜¯å¤šçº¿ç¨‹ç»“æ„ï¼ŒåŒ…æ‹¬åå°çº¿ç¨‹å’Œå®¢æˆ·æœåŠ¡çº¿ç¨‹ã€‚å¤šçº¿ç¨‹å¯ä»¥æœ‰æ•ˆåˆ©ç”¨æœåŠ¡å™¨èµ„æºï¼Œæé«˜æ•°æ®åº“çš„å¹¶å‘æ€§èƒ½ã€‚åœ¨Mysqlä¸­ï¼Œæ§åˆ¶å¹¶å‘è¿æ¥å’Œçº¿ç¨‹çš„ä¸»è¦å‚æ•°åŒ…æ‹¬ max_connectionsã€back_logã€thread_cache_sizeã€table_open_cahceã€‚</p><h4 id="4-1-max-connections"><a href="#4-1-max-connections" class="headerlink" title="4.1 max_connections"></a>4.1 max_connections</h4><p>é‡‡ç”¨max_connections æ§åˆ¶å…è®¸è¿æ¥åˆ°MySQLæ•°æ®åº“çš„æœ€å¤§æ•°é‡ï¼Œé»˜è®¤å€¼æ˜¯ 151ã€‚å¦‚æœçŠ¶æ€å˜é‡ connection_errors_max_connections ä¸ä¸ºé›¶ï¼Œå¹¶ä¸”ä¸€ç›´å¢é•¿ï¼Œåˆ™è¯´æ˜ä¸æ–­æœ‰è¿æ¥è¯·æ±‚å› æ•°æ®åº“è¿æ¥æ•°å·²è¾¾åˆ°å…è®¸æœ€å¤§å€¼è€Œå¤±è´¥ï¼Œè¿™æ˜¯å¯ä»¥è€ƒè™‘å¢å¤§max_connections çš„å€¼ã€‚</p><p>Mysql æœ€å¤§å¯æ”¯æŒçš„è¿æ¥æ•°ï¼Œå–å†³äºå¾ˆå¤šå› ç´ ï¼ŒåŒ…æ‹¬ç»™å®šæ“ä½œç³»ç»Ÿå¹³å°çš„çº¿ç¨‹åº“çš„è´¨é‡ã€å†…å­˜å¤§å°ã€æ¯ä¸ªè¿æ¥çš„è´Ÿè·ã€CPUçš„å¤„ç†é€Ÿåº¦ï¼ŒæœŸæœ›çš„å“åº”æ—¶é—´ç­‰ã€‚åœ¨Linux å¹³å°ä¸‹ï¼Œæ€§èƒ½å¥½çš„æœåŠ¡å™¨ï¼Œæ”¯æŒ 500-1000 ä¸ªè¿æ¥ä¸æ˜¯éš¾äº‹ï¼Œéœ€è¦æ ¹æ®æœåŠ¡å™¨æ€§èƒ½è¿›è¡Œè¯„ä¼°è®¾å®šã€‚</p><h4 id="4-2-back-log"><a href="#4-2-back-log" class="headerlink" title="4.2 back_log"></a>4.2 back_log</h4><p>back_log å‚æ•°æ§åˆ¶MySQLç›‘å¬TCPç«¯å£æ—¶è®¾ç½®çš„ç§¯å‹è¯·æ±‚æ ˆå¤§å°ã€‚å¦‚æœMySqlçš„è¿æ¥æ•°è¾¾åˆ°max_connectionsæ—¶ï¼Œæ–°æ¥çš„è¯·æ±‚å°†ä¼šè¢«å­˜åœ¨å †æ ˆä¸­ï¼Œä»¥ç­‰å¾…æŸä¸€è¿æ¥é‡Šæ”¾èµ„æºï¼Œè¯¥å †æ ˆçš„æ•°é‡å³back_logï¼Œå¦‚æœç­‰å¾…è¿æ¥çš„æ•°é‡è¶…è¿‡back_logï¼Œå°†ä¸è¢«æˆäºˆè¿æ¥èµ„æºï¼Œå°†ä¼šæŠ¥é”™ã€‚5.6.6 ç‰ˆæœ¬ä¹‹å‰é»˜è®¤å€¼ä¸º 50 ï¼Œ ä¹‹åçš„ç‰ˆæœ¬é»˜è®¤ä¸º 50 + ï¼ˆmax_connections / 5ï¼‰ï¼Œ ä½†æœ€å¤§ä¸è¶…è¿‡900ã€‚</p><p>å¦‚æœéœ€è¦æ•°æ®åº“åœ¨è¾ƒçŸ­çš„æ—¶é—´å†…å¤„ç†å¤§é‡è¿æ¥è¯·æ±‚ï¼Œ å¯ä»¥è€ƒè™‘é€‚å½“å¢å¤§back_log çš„å€¼ã€‚</p><h4 id="4-3-table-open-cache"><a href="#4-3-table-open-cache" class="headerlink" title="4.3 table_open_cache"></a>4.3 table_open_cache</h4><p>è¯¥å‚æ•°ç”¨æ¥æ§åˆ¶æ‰€æœ‰SQLè¯­å¥æ‰§è¡Œçº¿ç¨‹å¯æ‰“å¼€è¡¨ç¼“å­˜çš„æ•°é‡ï¼Œ è€Œåœ¨æ‰§è¡ŒSQLè¯­å¥æ—¶ï¼Œæ¯ä¸€ä¸ªSQLæ‰§è¡Œçº¿ç¨‹è‡³å°‘è¦æ‰“å¼€ 1 ä¸ªè¡¨ç¼“å­˜ã€‚è¯¥å‚æ•°çš„å€¼åº”è¯¥æ ¹æ®è®¾ç½®çš„æœ€å¤§è¿æ¥æ•° max_connections ä»¥åŠæ¯ä¸ªè¿æ¥æ‰§è¡Œå…³è”æŸ¥è¯¢ä¸­æ¶‰åŠçš„è¡¨çš„æœ€å¤§æ•°é‡æ¥è®¾å®š ï¼š</p><p>â€‹    max_connections x N ï¼›</p><h4 id="4-4-thread-cache-size"><a href="#4-4-thread-cache-size" class="headerlink" title="4.4 thread_cache_size"></a>4.4 thread_cache_size</h4><p>ä¸ºäº†åŠ å¿«è¿æ¥æ•°æ®åº“çš„é€Ÿåº¦ï¼ŒMySQL ä¼šç¼“å­˜ä¸€å®šæ•°é‡çš„å®¢æˆ·æœåŠ¡çº¿ç¨‹ä»¥å¤‡é‡ç”¨ï¼Œé€šè¿‡å‚æ•° thread_cache_size å¯æ§åˆ¶ MySQL ç¼“å­˜å®¢æˆ·æœåŠ¡çº¿ç¨‹çš„æ•°é‡ã€‚</p><h4 id="4-5-innodb-lock-wait-timeout"><a href="#4-5-innodb-lock-wait-timeout" class="headerlink" title="4.5 innodb_lock_wait_timeout"></a>4.5 innodb_lock_wait_timeout</h4><p>è¯¥å‚æ•°æ˜¯ç”¨æ¥è®¾ç½®InnoDB äº‹åŠ¡ç­‰å¾…è¡Œé”çš„æ—¶é—´ï¼Œé»˜è®¤å€¼æ˜¯50ms ï¼Œ å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡ŒåŠ¨æ€è®¾ç½®ã€‚å¯¹äºéœ€è¦å¿«é€Ÿåé¦ˆçš„ä¸šåŠ¡ç³»ç»Ÿæ¥è¯´ï¼Œå¯ä»¥å°†è¡Œé”çš„ç­‰å¾…æ—¶é—´è°ƒå°ï¼Œä»¥é¿å…äº‹åŠ¡é•¿æ—¶é—´æŒ‚èµ·ï¼› å¯¹äºåå°è¿è¡Œçš„æ‰¹é‡å¤„ç†ç¨‹åºæ¥è¯´ï¼Œ å¯ä»¥å°†è¡Œé”çš„ç­‰å¾…æ—¶é—´è°ƒå¤§ï¼Œ ä»¥é¿å…å‘ç”Ÿå¤§çš„å›æ»šæ“ä½œã€‚</p><hr><h3 id="mysqlé”"><a href="#mysqlé”" class="headerlink" title="mysqlé”"></a>mysqlé”</h3><p><strong>é”åˆ†ç±»</strong></p><p>ä»å¯¹æ•°æ®æ“ä½œçš„ç²’åº¦åˆ† ï¼š </p><p>1ï¼‰ è¡¨é”ï¼šæ“ä½œæ—¶ï¼Œä¼šé”å®šæ•´ä¸ªè¡¨ã€‚</p><p>2ï¼‰ è¡Œé”ï¼šæ“ä½œæ—¶ï¼Œä¼šé”å®šå½“å‰æ“ä½œè¡Œã€‚</p><p>ä»å¯¹æ•°æ®æ“ä½œçš„ç±»å‹åˆ†ï¼š</p><p>1ï¼‰ è¯»é”ï¼ˆå…±äº«é”ï¼‰ï¼šé’ˆå¯¹åŒä¸€ä»½æ•°æ®ï¼Œå¤šä¸ªè¯»æ“ä½œå¯ä»¥åŒæ—¶è¿›è¡Œè€Œä¸ä¼šäº’ç›¸å½±å“ã€‚</p><p>2ï¼‰ å†™é”ï¼ˆæ’å®ƒé”ï¼‰ï¼šå½“å‰æ“ä½œæ²¡æœ‰å®Œæˆä¹‹å‰ï¼Œå®ƒä¼šé˜»æ–­å…¶ä»–å†™é”å’Œè¯»é”ã€‚</p><hr><p><strong>é”ç‰¹æ€§</strong></p><p>ç›¸å¯¹å…¶ä»–æ•°æ®åº“è€Œè¨€ï¼ŒMySQLçš„é”æœºåˆ¶æ¯”è¾ƒç®€å•ï¼Œå…¶æœ€æ˜¾è‘—çš„ç‰¹ç‚¹æ˜¯ä¸åŒçš„å­˜å‚¨å¼•æ“æ”¯æŒä¸åŒçš„é”æœºåˆ¶ã€‚ä¸‹è¡¨ä¸­ç½—åˆ—å‡ºäº†å„å­˜å‚¨å¼•æ“å¯¹é”çš„æ”¯æŒæƒ…å†µï¼š</p><table><thead><tr><th>å­˜å‚¨å¼•æ“</th><th>è¡¨çº§é”</th><th>è¡Œçº§é”</th><th>é¡µé¢é”</th></tr></thead><tbody><tr><td>MyISAM</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>InnoDB</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>MEMORY</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>BDB</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr></tbody></table><p>MySQLè¿™3ç§é”çš„ç‰¹æ€§å¯å¤§è‡´å½’çº³å¦‚ä¸‹ ï¼š</p><table><thead><tr><th>é”ç±»å‹</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td>è¡¨çº§é”</td><td>åå‘MyISAM å­˜å‚¨å¼•æ“ï¼Œå¼€é”€å°ï¼ŒåŠ é”å¿«ï¼›ä¸ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦å¤§ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€é«˜,å¹¶å‘åº¦æœ€ä½ã€‚</td></tr><tr><td>è¡Œçº§é”</td><td>åå‘InnoDB å­˜å‚¨å¼•æ“ï¼Œå¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦æœ€å°ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½,å¹¶å‘åº¦ä¹Ÿæœ€é«˜ã€‚</td></tr><tr><td>é¡µé¢é”</td><td>å¼€é”€å’ŒåŠ é”æ—¶é—´ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼Œå¹¶å‘åº¦ä¸€èˆ¬ã€‚</td></tr></tbody></table><p>ä»ä¸Šè¿°ç‰¹ç‚¹å¯è§ï¼Œå¾ˆéš¾ç¬¼ç»Ÿåœ°è¯´å“ªç§é”æ›´å¥½ï¼Œåªèƒ½å°±å…·ä½“åº”ç”¨çš„ç‰¹ç‚¹æ¥è¯´å“ªç§é”æ›´åˆé€‚ï¼ä»…ä»é”çš„è§’åº¦æ¥è¯´ï¼šè¡¨çº§é”æ›´é€‚åˆäºä»¥æŸ¥è¯¢ä¸ºä¸»ï¼Œåªæœ‰å°‘é‡æŒ‰ç´¢å¼•æ¡ä»¶æ›´æ–°æ•°æ®çš„åº”ç”¨ï¼Œå¦‚Web åº”ç”¨ï¼›è€Œè¡Œçº§é”åˆ™æ›´é€‚åˆäºæœ‰å¤§é‡æŒ‰ç´¢å¼•æ¡ä»¶å¹¶å‘æ›´æ–°å°‘é‡ä¸åŒæ•°æ®ï¼ŒåŒæ—¶åˆæœ‰å¹¶æŸ¥è¯¢çš„åº”ç”¨ï¼Œå¦‚ä¸€äº›åœ¨çº¿äº‹åŠ¡å¤„ç†ï¼ˆOLTPï¼‰ç³»ç»Ÿã€‚</p><h4 id="MyISAMè¡¨é”"><a href="#MyISAMè¡¨é”" class="headerlink" title="MyISAMè¡¨é”"></a>MyISAMè¡¨é”</h4><blockquote><p>MyISAMåªæ”¯æŒè¡¨é”</p></blockquote><p>MyISAM åœ¨æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼ˆSELECTï¼‰å‰ï¼Œä¼šè‡ªåŠ¨ç»™æ¶‰åŠçš„æ‰€æœ‰è¡¨åŠ è¯»é”ï¼Œåœ¨æ‰§è¡Œæ›´æ–°æ“ä½œï¼ˆUPDATEã€DELETEã€INSERT ç­‰ï¼‰å‰ï¼Œä¼šè‡ªåŠ¨ç»™æ¶‰åŠçš„è¡¨åŠ å†™é”ï¼Œè¿™ä¸ªè¿‡ç¨‹å¹¶ä¸éœ€è¦ç”¨æˆ·å¹²é¢„ï¼Œå› æ­¤ï¼Œç”¨æˆ·ä¸€èˆ¬ä¸éœ€è¦ç›´æ¥ç”¨ LOCK TABLE å‘½ä»¤ç»™ MyISAM è¡¨æ˜¾å¼åŠ é”ã€‚</p><p>æ˜¾ç¤ºåŠ è¡¨é”è¯­æ³•:</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">åŠ è¯»é” ï¼š lock table table_name read;åŠ å†™é” ï¼š lock table table_name writeï¼›<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>å¯¹MyISAM è¡¨çš„<strong>è¯»æ“ä½œ</strong>ï¼Œä¸ä¼šé˜»å¡å…¶ä»–ç”¨æˆ·å¯¹åŒä¸€è¡¨çš„<strong>è¯»è¯·æ±‚</strong>ï¼Œä½†ä¼šé˜»å¡å¯¹åŒä¸€è¡¨çš„<strong>å†™è¯·æ±‚</strong></li><li>å¯¹MyISAM è¡¨çš„<strong>å†™æ“ä½œ</strong>ï¼Œåˆ™ä¼šé˜»å¡å…¶ä»–ç”¨æˆ·å¯¹åŒä¸€è¡¨çš„<strong>è¯»å’Œå†™æ“ä½œ</strong></li></ul><p>è¯»é”ä¼šé˜»å¡å†™ï¼Œå†™é”ä¼šé˜»å¡è¯»å’Œå†™</p><hr><h4 id="äº‹åŠ¡"><a href="#äº‹åŠ¡" class="headerlink" title="äº‹åŠ¡"></a>äº‹åŠ¡</h4><p>äº‹åŠ¡å…·æœ‰ä»¥ä¸‹4ä¸ªç‰¹æ€§ï¼Œç®€ç§°ä¸ºäº‹åŠ¡ACIDå±æ€§ã€‚</p><table><thead><tr><th>ACIDå±æ€§</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>åŸå­æ€§ï¼ˆAtomicityï¼‰</td><td>äº‹åŠ¡æ˜¯ä¸€ä¸ªåŸå­æ“ä½œå•å…ƒï¼Œå…¶å¯¹æ•°æ®çš„ä¿®æ”¹ï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚</td></tr><tr><td>ä¸€è‡´æ€§ï¼ˆConsistentï¼‰</td><td>åœ¨äº‹åŠ¡å¼€å§‹å’Œå®Œæˆæ—¶ï¼Œæ•°æ®éƒ½å¿…é¡»ä¿æŒä¸€è‡´çŠ¶æ€ã€‚</td></tr><tr><td>éš”ç¦»æ€§ï¼ˆIsolationï¼‰</td><td>æ•°æ®åº“ç³»ç»Ÿæä¾›ä¸€å®šçš„éš”ç¦»æœºåˆ¶ï¼Œä¿è¯äº‹åŠ¡åœ¨ä¸å—å¤–éƒ¨å¹¶å‘æ“ä½œå½±å“çš„ â€œç‹¬ç«‹â€ ç¯å¢ƒä¸‹è¿è¡Œã€‚</td></tr><tr><td>æŒä¹…æ€§ï¼ˆDurableï¼‰</td><td>äº‹åŠ¡å®Œæˆä¹‹åï¼Œå¯¹äºæ•°æ®çš„ä¿®æ”¹æ˜¯æ°¸ä¹…çš„ã€‚</td></tr></tbody></table><p><strong>å¹¶å‘äº‹åŠ¡å¤„ç†å¸¦æ¥çš„é—®é¢˜</strong></p><table><thead><tr><th>é—®é¢˜</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>ä¸¢å¤±æ›´æ–°ï¼ˆLost Updateï¼‰</td><td>å½“ä¸¤ä¸ªæˆ–å¤šä¸ªäº‹åŠ¡é€‰æ‹©åŒä¸€è¡Œï¼Œæœ€åˆçš„äº‹åŠ¡ä¿®æ”¹çš„å€¼ï¼Œä¼šè¢«åé¢çš„äº‹åŠ¡ä¿®æ”¹çš„å€¼è¦†ç›–ã€‚</td></tr><tr><td>è„è¯»ï¼ˆDirty Readsï¼‰</td><td>å½“ä¸€ä¸ªäº‹åŠ¡æ­£åœ¨è®¿é—®æ•°æ®ï¼Œå¹¶ä¸”å¯¹æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼Œè€Œè¿™ç§ä¿®æ”¹è¿˜æ²¡æœ‰æäº¤åˆ°æ•°æ®åº“ä¸­ï¼Œè¿™æ—¶ï¼Œå¦å¤–ä¸€ä¸ªäº‹åŠ¡ä¹Ÿè®¿é—®è¿™ä¸ªæ•°æ®ï¼Œç„¶åä½¿ç”¨äº†è¿™ä¸ªæ•°æ®ã€‚</td></tr><tr><td>ä¸å¯é‡å¤è¯»ï¼ˆNon-Repeatable Readsï¼‰</td><td>ä¸€ä¸ªäº‹åŠ¡åœ¨è¯»å–æŸäº›æ•°æ®åçš„æŸä¸ªæ—¶é—´ï¼Œå†æ¬¡è¯»å–ä»¥å‰è¯»è¿‡çš„æ•°æ®ï¼Œå´å‘ç°å’Œä»¥å‰è¯»å‡ºçš„æ•°æ®ä¸ä¸€è‡´ã€‚</td></tr><tr><td>å¹»è¯»ï¼ˆPhantom Readsï¼‰</td><td>ä¸€ä¸ªäº‹åŠ¡æŒ‰ç…§ç›¸åŒçš„æŸ¥è¯¢æ¡ä»¶é‡æ–°è¯»å–ä»¥å‰æŸ¥è¯¢è¿‡çš„æ•°æ®ï¼Œå´å‘ç°å…¶ä»–äº‹åŠ¡æ’å…¥äº†æ»¡è¶³å…¶æŸ¥è¯¢æ¡ä»¶çš„æ–°æ•°æ®ã€‚</td></tr></tbody></table><p><strong>äº‹åŠ¡éš”ç¦»çº§åˆ«</strong></p><p>ä¸ºäº†è§£å†³ä¸Šè¿°æåˆ°çš„äº‹åŠ¡å¹¶å‘é—®é¢˜ï¼Œæ•°æ®åº“æä¾›ä¸€å®šçš„äº‹åŠ¡éš”ç¦»æœºåˆ¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»è¶Šä¸¥æ ¼ï¼Œå¹¶å‘å‰¯ä½œç”¨è¶Šå°ï¼Œä½†ä»˜å‡ºçš„ä»£ä»·ä¹Ÿå°±è¶Šå¤§ï¼Œå› ä¸ºäº‹åŠ¡éš”ç¦»å®è´¨ä¸Šå°±æ˜¯ä½¿ç”¨äº‹åŠ¡åœ¨ä¸€å®šç¨‹åº¦ä¸Šâ€œä¸²è¡ŒåŒ–â€ è¿›è¡Œï¼Œè¿™æ˜¾ç„¶ä¸â€œå¹¶å‘â€ æ˜¯çŸ›ç›¾çš„ã€‚ </p><p>æ•°æ®åº“çš„éš”ç¦»çº§åˆ«æœ‰4ä¸ªï¼Œç”±ä½åˆ°é«˜ä¾æ¬¡ä¸ºRead uncommittedã€Read committedã€Repeatable readã€Serializableï¼Œè¿™å››ä¸ªçº§åˆ«å¯ä»¥é€ä¸ªè§£å†³è„å†™ã€è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»è¿™å‡ ç±»é—®é¢˜ã€‚</p><table><thead><tr><th>éš”ç¦»çº§åˆ«</th><th>ä¸¢å¤±æ›´æ–°</th><th>è„è¯»</th><th>ä¸å¯é‡å¤è¯»</th><th>å¹»è¯»</th></tr></thead><tbody><tr><td>Read uncommitted</td><td>Ã—</td><td>âˆš</td><td>âˆš</td><td>âˆš</td></tr><tr><td>Read committed</td><td>Ã—</td><td>Ã—</td><td>âˆš</td><td>âˆš</td></tr><tr><td>Repeatable readï¼ˆé»˜è®¤ï¼‰</td><td>Ã—</td><td>Ã—</td><td>Ã—</td><td>âˆš</td></tr><tr><td>Serializable</td><td>Ã—</td><td>Ã—</td><td>Ã—</td><td>Ã—</td></tr></tbody></table><p>å¤‡æ³¨ ï¼š âˆš  ä»£è¡¨å¯èƒ½å‡ºç° ï¼Œ Ã— ä»£è¡¨ä¸ä¼šå‡ºç° ã€‚</p><hr><h4 id="InnoDB-è¡Œé”"><a href="#InnoDB-è¡Œé”" class="headerlink" title="InnoDB è¡Œé”"></a>InnoDB è¡Œé”</h4><p><strong>è¡Œé”ç‰¹ç‚¹</strong> ï¼šåå‘InnoDB å­˜å‚¨å¼•æ“ï¼Œå¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦æœ€å°ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½,å¹¶å‘åº¦ä¹Ÿæœ€é«˜ã€‚</p><p>InnoDB ä¸ MyISAM çš„æœ€å¤§ä¸åŒæœ‰ä¸¤ç‚¹ï¼š<strong>ä¸€æ˜¯æ”¯æŒäº‹åŠ¡</strong>ï¼›<strong>äºŒæ˜¯ é‡‡ç”¨äº†è¡Œçº§é”</strong>ã€‚</p><p>InnoDB  å®ç°äº†ä»¥ä¸‹ä¸¤ç§ç±»å‹çš„è¡Œé”ã€‚</p><ul><li>å…±äº«é”ï¼ˆSï¼‰ï¼šåˆç§°ä¸ºè¯»é”ï¼Œç®€ç§°Sé”ï¼Œå…±äº«é”å°±æ˜¯å¤šä¸ªäº‹åŠ¡å¯¹äºåŒä¸€æ•°æ®å¯ä»¥å…±äº«ä¸€æŠŠé”ï¼Œéƒ½èƒ½è®¿é—®åˆ°æ•°æ®ï¼Œä½†æ˜¯åªèƒ½è¯»ä¸èƒ½ä¿®æ”¹ã€‚</li><li>æ’ä»–é”ï¼ˆXï¼‰ï¼šåˆç§°ä¸ºå†™é”ï¼Œç®€ç§°Xé”ï¼Œæ’ä»–é”å°±æ˜¯ä¸èƒ½ä¸å…¶ä»–é”å¹¶å­˜ï¼Œå¦‚ä¸€ä¸ªäº‹åŠ¡è·å–äº†ä¸€ä¸ªæ•°æ®è¡Œçš„æ’ä»–é”ï¼Œå…¶ä»–äº‹åŠ¡å°±ä¸èƒ½å†è·å–è¯¥è¡Œçš„å…¶ä»–é”ï¼ŒåŒ…æ‹¬å…±äº«é”å’Œæ’ä»–é”ï¼Œä½†æ˜¯è·å–æ’ä»–é”çš„äº‹åŠ¡æ˜¯å¯ä»¥å¯¹æ•°æ®å°±è¡Œè¯»å–å’Œä¿®æ”¹ã€‚</li></ul><p>å¯¹äºUPDATEã€DELETEå’ŒINSERTè¯­å¥ï¼ŒInnoDBä¼šè‡ªåŠ¨ç»™æ¶‰åŠæ•°æ®é›†åŠ æ’ä»–é”ï¼ˆX)ï¼›</p><p>å¯¹äºæ™®é€šSELECTè¯­å¥ï¼ŒInnoDBä¸ä¼šåŠ ä»»ä½•é”ï¼›</p><ul><li>å¦‚æœæ˜¯æ ¹æ®ç´¢å¼•è¿›è¡Œæ£€ç´¢æ•°æ®ä¿®æ”¹ï¼Œé‚£ä¹ˆæ˜¯è¡Œé”</li></ul><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201129143820635.png" alt="è¡Œé”"></p><ul><li>å¦‚æœä¸é€šè¿‡ç´¢å¼•æ¡ä»¶æ£€ç´¢æ•°æ®ï¼Œé‚£ä¹ˆInnoDBå°†<strong>å¯¹è¡¨ä¸­çš„æ‰€æœ‰è®°å½•åŠ é”</strong>ï¼Œç›¸å½“äºè¡¨é”</li></ul><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201129144352146.png" alt="image-20201129144352146"></p><hr><h4 id="é—´éš™é”å±å®³"><a href="#é—´éš™é”å±å®³" class="headerlink" title="é—´éš™é”å±å®³"></a>é—´éš™é”å±å®³</h4><p>å½“æˆ‘ä»¬ç”¨èŒƒå›´æ¡ä»¶ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç›¸ç­‰æ¡ä»¶æ£€ç´¢æ•°æ®ï¼Œå¹¶è¯·æ±‚å…±äº«æˆ–æ’ä»–é”æ—¶ï¼ŒInnoDBä¼šç»™ç¬¦åˆæ¡ä»¶çš„å·²æœ‰æ•°æ®è¿›è¡ŒåŠ é”ï¼› å¯¹äºé”®å€¼åœ¨æ¡ä»¶èŒƒå›´å†…ä½†å¹¶ä¸å­˜åœ¨çš„è®°å½•ï¼Œå«åš â€œé—´éš™ï¼ˆGAPï¼‰â€ ï¼Œ InnoDBä¹Ÿä¼šå¯¹è¿™ä¸ª â€œé—´éš™â€ åŠ é”ï¼Œè¿™ç§é”æœºåˆ¶å°±æ˜¯æ‰€è°“çš„ é—´éš™é”ï¼ˆNext-Keyé”ï¼‰</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">update emp set age &#x3D; 1221  where id &#x3D; 1update emp set age &#x3D; 111  where id &lt;3  æ­¤æ—¶ä¼šé˜»å¡Aè¡¨commitå  Bè¡¨é˜»å¡æ¶ˆå¤±<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201129144907344.png" alt="image-20201129144907344"></p><hr><h4 id="InnoDB-è¡Œé”äº‰ç”¨æƒ…å†µ"><a href="#InnoDB-è¡Œé”äº‰ç”¨æƒ…å†µ" class="headerlink" title="InnoDB è¡Œé”äº‰ç”¨æƒ…å†µ"></a>InnoDB è¡Œé”äº‰ç”¨æƒ…å†µ</h4><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">show</span>  <span class="token keyword">status</span> <span class="token operator">like</span> <span class="token string">'innodb_row_lock%'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>![1556455943670](E:/å­¦ä¹ æ¡†æ¶/MySQL é«˜çº§ - day-03/æ–‡æ¡£/assets/1556455943670.png)</p><pre class="line-numbers language-none"><code class="language-none">Innodb_row_lock_current_waits: å½“å‰æ­£åœ¨ç­‰å¾…é”å®šçš„æ•°é‡Innodb_row_lock_time: ä»ç³»ç»Ÿå¯åŠ¨åˆ°ç°åœ¨é”å®šæ€»æ—¶é—´é•¿åº¦Innodb_row_lock_time_avg:æ¯æ¬¡ç­‰å¾…æ‰€èŠ±å¹³å‡æ—¶é•¿Innodb_row_lock_time_max:ä»ç³»ç»Ÿå¯åŠ¨åˆ°ç°åœ¨ç­‰å¾…æœ€é•¿çš„ä¸€æ¬¡æ‰€èŠ±çš„æ—¶é—´Innodb_row_lock_waits: ç³»ç»Ÿå¯åŠ¨ååˆ°ç°åœ¨æ€»å…±ç­‰å¾…çš„æ¬¡æ•°å½“ç­‰å¾…çš„æ¬¡æ•°å¾ˆé«˜ï¼Œè€Œä¸”æ¯æ¬¡ç­‰å¾…çš„æ—¶é•¿ä¹Ÿä¸å°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦åˆ†æç³»ç»Ÿä¸­ä¸ºä»€ä¹ˆä¼šæœ‰å¦‚æ­¤å¤šçš„ç­‰å¾…ï¼Œç„¶åæ ¹æ®åˆ†æç»“æœç€æ‰‹åˆ¶å®šä¼˜åŒ–è®¡åˆ’ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><blockquote><p>ä¼˜åŒ–å»ºè®®ï¼š</p></blockquote><ul><li>å°½å¯èƒ½è®©æ‰€æœ‰æ•°æ®æ£€ç´¢éƒ½èƒ½é€šè¿‡ç´¢å¼•æ¥å®Œæˆï¼Œ<strong>é¿å…æ— ç´¢å¼•è¡Œé”å‡çº§ä¸ºè¡¨é”</strong>ã€‚</li><li>åˆç†è®¾è®¡ç´¢å¼•ï¼Œå°½é‡ç¼©å°é”çš„èŒƒå›´</li><li>å°½å¯èƒ½å‡å°‘ç´¢å¼•æ¡ä»¶ï¼ŒåŠç´¢å¼•èŒƒå›´ï¼Œ<strong>é¿å…é—´éš™é”</strong></li><li>å°½é‡æ§åˆ¶äº‹åŠ¡å¤§å°ï¼Œ<strong>å‡å°‘é”å®šèµ„æºé‡å’Œæ—¶é—´é•¿åº¦</strong></li><li>å°½å¯<strong>ä½¿ç”¨ä½çº§åˆ«äº‹åŠ¡éš”ç¦»</strong>ï¼ˆä½†æ˜¯éœ€è¦ä¸šåŠ¡å±‚é¢æ»¡è¶³éœ€æ±‚ï¼‰</li></ul><hr><h3 id="æ—¥å¿—"><a href="#æ—¥å¿—" class="headerlink" title="æ—¥å¿—"></a>æ—¥å¿—</h3><p>tail -f æ—¥å¿—åç§°</p><p>å®æ—¶çš„æ›´æ–°</p><h3 id="ä¸»ä»å¤åˆ¶"><a href="#ä¸»ä»å¤åˆ¶" class="headerlink" title="ä¸»ä»å¤åˆ¶"></a>ä¸»ä»å¤åˆ¶</h3><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201130135049541.png" alt="image-20201130135049541"></p>]]></content>
      
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javaå¹¶å‘ç¼–ç¨‹ä»0åˆ°n</title>
      <link href="2020/10/29/java-bing-fa-bian-cheng-cong-0-dao-n/"/>
      <url>2020/10/29/java-bing-fa-bian-cheng-cong-0-dao-n/</url>
      
        <content type="html"><![CDATA[<h1 id="å¹¶å‘ç¼–ç¨‹"><a href="#å¹¶å‘ç¼–ç¨‹" class="headerlink" title="å¹¶å‘ç¼–ç¨‹"></a>å¹¶å‘ç¼–ç¨‹</h1><h2 id="1-è¿›ç¨‹ä¸çº¿ç¨‹"><a href="#1-è¿›ç¨‹ä¸çº¿ç¨‹" class="headerlink" title="1. è¿›ç¨‹ä¸çº¿ç¨‹"></a>1. è¿›ç¨‹ä¸çº¿ç¨‹</h2><h3 id="1-1-è¿›ç¨‹"><a href="#1-1-è¿›ç¨‹" class="headerlink" title="1.1 è¿›ç¨‹"></a>1.1 è¿›ç¨‹</h3><ul><li>è¿›ç¨‹å¯ä»¥è§†ä¸ºç¨‹åºçš„ä¸€ä¸ªå®ä¾‹ï¼Œå¤§éƒ¨åˆ†ç¨‹åºå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªå®ä¾‹è¿›ç¨‹ï¼Œä¹Ÿæœ‰ç¨‹åºåªèƒ½å¯åŠ¨ä¸€ä¸ªå®ä¾‹è¿›ç¨‹</li><li>ç¨‹åºç”±æŒ‡ä»¤å’Œæ•°æ®ç»„æˆï¼Œè¿™äº›æŒ‡ä»¤è¦è¿è¡Œï¼Œæ•°æ®è¦è¯»å†™ï¼Œå°±å¿…é¡»å°†æŒ‡ä»¤åŠ è½½è‡³cpuï¼Œæ•°æ®åŠ è½½è‡³å†…å­˜ï¼Œåœ¨æŒ‡ä»¤è¿è¡Œè¿‡ç¨‹ä¸­è¿˜éœ€è¦ç”¨åˆ°ç£ç›˜ã€ç½‘ç»œç­‰è®¾å¤‡ã€‚è¿›ç¨‹å°±æ˜¯ç”¨æ¥åŠ è½½æŒ‡ä»¤ã€ç®¡ç†å†…å­˜ã€ç®¡ç†ioçš„ã€‚</li><li>è¿›ç¨‹è¢«è¿è¡Œçš„æ—¶å€™ï¼Œä»ç£ç›˜åŠ è½½è¿™ä¸ªç¨‹åºçš„ä»£ç åˆ°å†…å­˜ï¼Œè¿™æ—¶å€™å°±å¼€å¯äº†ä¸€ä¸ªè¿›ç¨‹ã€‚</li></ul><hr><h3 id="1-2-çº¿ç¨‹"><a href="#1-2-çº¿ç¨‹" class="headerlink" title="1.2 çº¿ç¨‹"></a>1.2 çº¿ç¨‹</h3><ul><li>ä¸€ä¸ªè¿›ç¨‹ä¹‹é—´å¯ä»¥åˆ†ä¸º1åˆ°å¤šä¸ªçº¿ç¨‹</li><li>ä¸€ä¸ªçº¿ç¨‹æ˜¯ä¸€ä¸ªæŒ‡ä»¤æµï¼Œå°†æŒ‡ä»¤æµä¸­çš„ä¸€æ¡æ¡æŒ‡ä»¤ä»¥ä¸€å®šçš„é¡ºåºäº¤ç»™cpuæ‰§è¡Œ</li><li>javaä¸­ï¼Œçº¿ç¨‹ä½œä¸ºæœ€å°è°ƒåº¦å•ä½ï¼Œè¿›ç¨‹ä½œä¸ºèµ„æºåˆ†é…çš„æœ€å°å•ä½ã€‚åœ¨Windowsä¸­è¿›ç¨‹æ˜¯ä¸æ´»åŠ¨çš„ï¼Œåªæ˜¯ä½œä¸ºçº¿ç¨‹çš„å®¹å™¨ã€‚</li></ul><hr><h3 id="1-3-äºŒè€…å¯¹æ¯”"><a href="#1-3-äºŒè€…å¯¹æ¯”" class="headerlink" title="1.3 äºŒè€…å¯¹æ¯”"></a>1.3 äºŒè€…å¯¹æ¯”</h3><ul><li>è¿›ç¨‹ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œçº¿ç¨‹å­˜åœ¨äºè¿›ç¨‹å†…</li><li>è¿›ç¨‹æ‹¥æœ‰å…±äº«çš„èµ„æºï¼Œå¦‚å†…å­˜ç©ºé—´ï¼Œä¾›å…¶å†…éƒ¨çš„çº¿ç¨‹å…±äº«</li><li>è¿›ç¨‹é—´é€šä¿¡è¾ƒä¸ºå¤æ‚<ul><li>åŒä¸€å°è®¡ç®—æœºçš„è¿›ç¨‹é€šä¿¡å«åšIPCï¼ˆinter process communicationï¼‰</li><li>ä¸åŒè®¡ç®—æœºä¹‹é—´çš„è¿›ç¨‹é€šä¿¡ï¼Œéœ€è¦é€šè¿‡ç½‘ç»œï¼Œå¹¶éµå®ˆå…±åŒçš„åè®®</li></ul></li><li>çº¿ç¨‹é€šä¿¡ç›¸å¯¹ç®€å•ï¼Œä»–ä»¬å…±äº«è¿›ç¨‹çš„å†…å­˜ï¼Œå°±å¥½æ¯”å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªå˜é‡</li><li>çº¿ç¨‹æ›´è½»é‡ï¼Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æˆæœ¬ä¸€èˆ¬è¦æ¯”è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ä½</li></ul><hr><h3 id="1-4-å¹¶è¡Œä¸å¹¶å‘"><a href="#1-4-å¹¶è¡Œä¸å¹¶å‘" class="headerlink" title="1.4 å¹¶è¡Œä¸å¹¶å‘"></a>1.4 å¹¶è¡Œä¸å¹¶å‘</h3><h4 id="å¹¶å‘"><a href="#å¹¶å‘" class="headerlink" title="å¹¶å‘"></a>å¹¶å‘</h4><blockquote><p>åŒä¸€æ—¶é—´åº”å¯¹å¤šä»¶äº‹æƒ…çš„èƒ½åŠ›</p></blockquote><p>ä¸€ä¸ªcpuï¼Œå•æ ¸å¿ƒåœ¨åŒä¸€ä¹‹é—´æ®µå†…åœ¨çº¿ç¨‹ä¸­æ¥å›è°ƒåº¦ï¼Œå«åšå¹¶å‘</p><h4 id="å¹¶è¡Œ"><a href="#å¹¶è¡Œ" class="headerlink" title="å¹¶è¡Œ"></a>å¹¶è¡Œ</h4><blockquote><p>åŒä¸€æ—¶é—´åŠ¨æ‰‹åšå¤šä»¶äº‹æƒ…çš„èƒ½åŠ›</p></blockquote><p>å¤šä¸ªcpuæˆ–è€…å¤šä¸ªæ ¸å¿ƒï¼Œåœ¨åŒä¸€æ—¶åˆ»å†…åŒæ—¶å·¥ä½œä¸¤ä¸ªä»¥ä¸Šçš„çº¿ç¨‹</p><p><img src="https://s1.ax1x.com/2020/10/29/BGZFQU.png" alt="BGZFQU.png"></p><hr><h3 id="1-5-åº”ç”¨"><a href="#1-5-åº”ç”¨" class="headerlink" title="1.5 åº”ç”¨"></a>1.5 åº”ç”¨</h3><p><strong>å¼‚æ­¥è°ƒç”¨</strong></p><blockquote><p>å¤šçº¿ç¨‹å¯ä»¥è®©æ–¹æ³•æ‰§è¡Œå˜ä¸ºå¼‚æ­¥çš„ï¼Œæ¯”å¦‚è¯´è¯»å–ç£ç›˜æ–‡ä»¶æ—¶ï¼Œå‡è®¾è¯»å–æ“ä½œèŠ±è´¹äº†5sï¼Œå¦‚æœæ²¡æœ‰çº¿ç¨‹è°ƒåº¦æœºåˆ¶ï¼Œè¿™5sè°ƒç”¨è€…å•¥ä¹Ÿåšä¸äº†ï¼Œå…¶ä»–ä»£ç è¿˜å¾—æš‚åœ</p></blockquote><p>ç»“è®ºï¼š</p><ul><li>åœ¨é¡¹ç›®ä¸­ï¼Œè§†é¢‘æ–‡ä»¶éœ€è¦è½¬æ¢æ ¼å¼ç­‰æ“ä½œæ¯”è¾ƒè´¹æ—¶ï¼Œè¿™æ—¶å¯ä»¥å¼€ä¸€ä¸ªæ–°çš„çº¿ç¨‹å¤„ç†è§†é¢‘åˆ‡æ¢ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹</li><li>uiç¨‹åºä¸­ï¼Œå¼€çº¿ç¨‹è¿›è¡Œå…¶ä»–æ“ä½œï¼Œé¿å…uiçº¿ç¨‹é˜»å¡</li></ul><hr><p><strong>æé«˜æ•ˆç‡</strong></p><ul><li><p>å•æ ¸cpuä¸‹å¤šçº¿ç¨‹ä¸èƒ½å®é™…æé«˜ç¨‹åºè¿è¡Œæ•ˆç‡ï¼Œåªæ˜¯ä¸ºäº†èƒ½å¤Ÿåœ¨ä¸åŒçš„ä»»åŠ¡ä¹‹é—´åˆ‡æ¢ï¼Œä¸åŒçº¿ç¨‹è½®æµä½¿ç”¨cpuï¼Œä¸è‡³äºä¸€ä¸ªçº¿ç¨‹æ€»å ç”¨cpuï¼Œåˆ«çš„çº¿ç¨‹å•¥ä¹Ÿä¸å¹²</p></li><li><p>å¤šæ ¸cpuå¯ä»¥å¹¶è¡Œè·‘å¤šä¸ªçº¿ç¨‹ï¼Œæœ‰çš„ä»»åŠ¡ç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œæ‹†åˆ†åå¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œæé«˜æ•ˆç‡ï¼Œä½†æœ‰çš„ä»»åŠ¡å°±æ²¡å¿…è¦æ‹†åˆ†ã€‚</p></li><li><p>IOæ“ä½œä¸å ç”¨cpuï¼Œåªæ˜¯æˆ‘ä»¬ä¸€èˆ¬copyæ–‡ä»¶ä½¿ç”¨çš„æ˜¯ã€é˜»å¡IOã€‘ï¼Œè¿™æ—¶ç›¸å½“äºçº¿ç¨‹è™½ç„¶ä¸ç”¨cpuï¼Œä½†éœ€è¦ä¸€ç›´ç­‰å¾…IOæ“ä½œï¼Œæ²¡èƒ½å……åˆ†åˆ©ç”¨çº¿ç¨‹ã€‚</p></li></ul><hr><h2 id="2-Javaçº¿ç¨‹"><a href="#2-Javaçº¿ç¨‹" class="headerlink" title="2. Javaçº¿ç¨‹"></a>2. Javaçº¿ç¨‹</h2><h3 id="2-1-åˆ›å»ºå’Œè¿è¡Œçº¿ç¨‹"><a href="#2-1-åˆ›å»ºå’Œè¿è¡Œçº¿ç¨‹" class="headerlink" title="2.1 åˆ›å»ºå’Œè¿è¡Œçº¿ç¨‹"></a>2.1 åˆ›å»ºå’Œè¿è¡Œçº¿ç¨‹</h3><h4 id="æ–¹æ³•ä¸€ï¼šç›´æ¥ä½¿ç”¨Thread"><a href="#æ–¹æ³•ä¸€ï¼šç›´æ¥ä½¿ç”¨Thread" class="headerlink" title="æ–¹æ³•ä¸€ï¼šç›´æ¥ä½¿ç”¨Thread"></a>æ–¹æ³•ä¸€ï¼šç›´æ¥ä½¿ç”¨Thread</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"running"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"t1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"running"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æ–¹æ³•äºŒï¼šä½¿ç”¨Runnableé…åˆThread"><a href="#æ–¹æ³•äºŒï¼šä½¿ç”¨Runnableé…åˆThread" class="headerlink" title="æ–¹æ³•äºŒï¼šä½¿ç”¨Runnableé…åˆThread"></a>æ–¹æ³•äºŒï¼šä½¿ç”¨Runnableé…åˆThread</h4><blockquote><p>æŠŠã€çº¿ç¨‹ã€‘å’Œã€ä»»åŠ¡ã€‘åˆ†å¼€</p><ul><li>Threadä»£è¡¨çº¿ç¨‹</li><li>Runnableé‡å†™runæ–¹æ³•ï¼Œåšå¯è¿è¡Œçš„ä»»åŠ¡</li></ul></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Runnable</span> runnable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"runæ–¹æ³•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>runnable<span class="token punctuation">,</span><span class="token string">"t2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"mainæ–¹æ³•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Lambdaè¡¨è¾¾å¼å¯ä»¥ç®€åŒ–ä»£ç </strong></p><h4 id="æ–¹æ³•ä¸‰ï¼šFutureTaskåˆ›å»º"><a href="#æ–¹æ³•ä¸‰ï¼šFutureTaskåˆ›å»º" class="headerlink" title="æ–¹æ³•ä¸‰ï¼šFutureTaskåˆ›å»º"></a>æ–¹æ³•ä¸‰ï¼šFutureTaskåˆ›å»º</h4><blockquote><p>Futuretaské—´æ¥çš„ç»§æ‰¿äº†Runnableæ¥å£ï¼Œä¸Runnableä¸åŒçš„æ˜¯ï¼Œä»–æœ‰è¿”å›å€¼</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">FutureTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> futureTask <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FutureTask</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Callable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"running========="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">100</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>futureTask<span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span>    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"&#123;&#125;"</span><span class="token punctuation">,</span>            futureTask<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ExecutionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="2-2-çº¿ç¨‹è¿è¡ŒåŸç†"><a href="#2-2-çº¿ç¨‹è¿è¡ŒåŸç†" class="headerlink" title="2.2 çº¿ç¨‹è¿è¡ŒåŸç†"></a>2.2 çº¿ç¨‹è¿è¡ŒåŸç†</h3><h4 id="æ ˆä¸æ ˆå¸§"><a href="#æ ˆä¸æ ˆå¸§" class="headerlink" title="æ ˆä¸æ ˆå¸§"></a>æ ˆä¸æ ˆå¸§</h4><p><img src="https://s1.ax1x.com/2020/10/29/BGW1mt.png"></p><ul><li>æ¯ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸€ä¸ªæ´»åŠ¨æ ˆå¸§ï¼Œå¯¹åº”ç€å½“å‰çš„é‚£ä¸ªæ–¹æ³•</li></ul><blockquote><p>æ ˆå¸§çš„ç›¸å…³å†…å®¹å‚è€ƒJVM</p></blockquote><h4 id="çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢"><a href="#çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢" class="headerlink" title="çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢"></a>çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢</h4><blockquote><p>ä»¥ä¸‹ä¼šå¯¼è‡´çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„åŸå› ï¼š</p></blockquote><ul><li>çº¿ç¨‹çš„cpuæ—¶é—´ç‰‡ç”¨å®Œ</li><li>åƒåœ¾å›æ”¶</li><li>æœ‰æ›´é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹è¿è¡Œ</li><li>çº¿ç¨‹è‡ªå·±è°ƒç”¨äº† sleep yield  wait  join  park  synchronized  lock ç­‰æ–¹æ³•</li></ul><p>å½“Context Switchå‘ç”Ÿæ—¶ï¼Œéœ€è¦ç”±æ“ä½œç³»ç»Ÿä¿å­˜å½“å‰çº¿ç¨‹çš„çŠ¶æ€ï¼Œå¹¶æ¢å¤å¦ä¸€ä¸ªçº¿ç¨‹çš„çŠ¶æ€ï¼ŒJavaä¸­å¯¹åº”çš„æ¦‚å¿µå°±æ˜¯ç¨‹åºè®¡æ•°å™¨ï¼Œ</p><ul><li>çŠ¶æ€åŒ…æ‹¬ï¼Œç¨‹åºè®¡æ•°å™¨ï¼Œè™šæ‹Ÿæœºæ ˆä¸­çš„æ¯ä¸ªæ ˆå¸§çš„ä¿¡æ¯</li><li>Context Switché¢‘ç¹æ“ä½œå¯èƒ½ä¼šå½±å“æ€§èƒ½</li></ul><h3 id="2-3-å¸¸è§æ–¹æ³•"><a href="#2-3-å¸¸è§æ–¹æ³•" class="headerlink" title="2.3 å¸¸è§æ–¹æ³•"></a>2.3 å¸¸è§æ–¹æ³•</h3><blockquote><p>å‚è€ƒjdk api æ–‡æ¡£</p></blockquote><h4 id="sleep"><a href="#sleep" class="headerlink" title="sleep"></a>sleep</h4><ul><li><p>è°ƒç”¨sleepä¼šä½¿å¾—å½“å‰çº¿ç¨‹ä»runningçŠ¶æ€å˜æˆtime waitingçŠ¶æ€</p></li><li><p>å…¶ä»–çº¿ç¨‹å¯ä»¥ä½¿ç”¨interruptæ–¹æ³•æ‰“æ–­æ­£åœ¨ç¡çœ çš„çº¿ç¨‹ï¼Œæ­¤æ—¶sleepæ–¹æ³•ä¼šæŠ›å‡ºInterruptedException</p></li><li><p>ç¡çœ ç»“æŸåçš„çº¿ç¨‹æœªå¿…æ¯”ä¼šç«‹åˆ»å¾—åˆ°æ‰§è¡Œ</p></li><li><p>å»ºè®®ä½¿ç”¨TimeUnitçš„sleepä»£æ›¿Threadçš„sleepæ¥è·å¾—æ›´å¥½çš„å¯è¯»æ€§</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">åœ¨JUCåŒ…ä¸­ï¼Œ<span class="token class-name">TimeUnit</span>é‡Œè¾¹åŒ…è£…äº†ä¸€å®šçš„æ—¶é—´ï¼Œå¯è¯»æ€§æ›´å¥½<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><hr><h4 id="yield"><a href="#yield" class="headerlink" title="yield"></a>yield</h4><ul><li><p>è°ƒç”¨yieldä¼šè®©å½“å‰çº¿ç¨‹ä»Runningè¿›å…¥RunnableçŠ¶æ€ï¼Œç„¶åè°ƒåº¦æ‰§è¡Œå…¶ä»–åŒä¼˜å…ˆçº§çš„çº¿ç¨‹ï¼Œ<strong>å¦‚æœè¿™æ—¶æ²¡æœ‰åŒä¼˜å…ˆçº§çš„çº¿ç¨‹ï¼Œé‚£ä¹ˆä¸èƒ½ä¿è¯è®©å½“å‰çº¿ç¨‹æš‚åœçš„æ•ˆæœ</strong></p></li><li><p>å…·ä½“çš„æ˜¯è¥¿å®‰ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„ä»»åŠ¡è°ƒåº¦å™¨</p></li></ul><hr><h4 id="çº¿ç¨‹ä¼˜å…ˆçº§"><a href="#çº¿ç¨‹ä¼˜å…ˆçº§" class="headerlink" title="çº¿ç¨‹ä¼˜å…ˆçº§"></a>çº¿ç¨‹ä¼˜å…ˆçº§</h4><ul><li>çº¿ç¨‹ä¼˜å…ˆçº§ä¼šæç¤ºè°ƒåº¦å™¨ä¼˜å…ˆè°ƒåº¦è¯¥çº¿ç¨‹ï¼Œä½†å®ƒä»…ä»…æ˜¯ä¸€ä¸ªæç¤ºï¼Œè°ƒåº¦å™¨å¯ä»¥å¿½ç•¥å®ƒ</li><li>å¦‚æœCPUæ¯”è¾ƒå¿™ï¼Œé‚£ä¹ˆä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹ä¼šè·å¾—æ›´å¤šçš„æ—¶é—´ç‰‡ï¼Œä½†CPUé—²æ—¶ï¼Œä¼˜å…ˆçº§å‡ ä¹æ²¡ä½œç”¨</li></ul><hr><h4 id="join"><a href="#join" class="headerlink" title="join"></a>join</h4><blockquote><p>è°è°ƒç”¨joinï¼Œå°±ç­‰å¾…è°ç»“æŸ</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>    a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"t1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/10/29/BJPAFf.png"></p><h4 id="interruptæ–¹æ³•è¯¦è§£"><a href="#interruptæ–¹æ³•è¯¦è§£" class="headerlink" title="interruptæ–¹æ³•è¯¦è§£"></a>interruptæ–¹æ³•è¯¦è§£</h4><h5 id="æ‰“æ–­sleepã€waitã€joinçš„çº¿ç¨‹"><a href="#æ‰“æ–­sleepã€waitã€joinçš„çº¿ç¨‹" class="headerlink" title="æ‰“æ–­sleepã€waitã€joinçš„çº¿ç¨‹"></a>æ‰“æ–­sleepã€waitã€joinçš„çº¿ç¨‹</h5><p>æ‰“æ–­sleepçš„çº¿ç¨‹ï¼Œä¼šæ¸…ç©ºæ‰“æ–­çŠ¶æ€ï¼Œä»¥sleepä¸ºä¾‹</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">&#123;</span> <span class="token class-name">Thread</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">"t1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t1<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">" æ‰“æ–­çŠ¶æ€: &#123;&#125;"</span><span class="token punctuation">,</span> t1<span class="token punctuation">.</span><span class="token function">isInterrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="æ‰“æ–­æ­£å¸¸è¿è¡Œçš„çº¿ç¨‹"><a href="#æ‰“æ–­æ­£å¸¸è¿è¡Œçš„çº¿ç¨‹" class="headerlink" title="æ‰“æ–­æ­£å¸¸è¿è¡Œçš„çº¿ç¨‹"></a>æ‰“æ–­æ­£å¸¸è¿è¡Œçš„çº¿ç¨‹</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">&#123;</span> <span class="token class-name">Thread</span> t2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token class-name">Thread</span> current <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">boolean</span> interrupted <span class="token operator">=</span> current<span class="token punctuation">.</span><span class="token function">isInterrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>interrupted<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">" æ‰“æ–­çŠ¶æ€: &#123;&#125;"</span><span class="token punctuation">,</span> interrupted<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">"t2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t2<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t2<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="æ‰“æ–­-park-çº¿ç¨‹"><a href="#æ‰“æ–­-park-çº¿ç¨‹" class="headerlink" title="æ‰“æ–­ park çº¿ç¨‹"></a>æ‰“æ–­ park çº¿ç¨‹</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">&#123;</span> <span class="token class-name">Thread</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"park..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">LockSupport</span><span class="token punctuation">.</span><span class="token function">park</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"unpark..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"æ‰“æ–­çŠ¶æ€ï¼š&#123;&#125;"</span><span class="token punctuation">,</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isInterrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">"t1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t1<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å¦‚æœæ‰“æ–­æ ‡è®°å·²ç»æ˜¯trueï¼Œåˆ™parkä¼šå¤±æ•ˆ</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"park----"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">LockSupport</span><span class="token punctuation">.</span><span class="token function">park</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"unpark---"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"æ‰“æ–­çŠ¶æ€ï¼š&#123;&#125;"</span><span class="token punctuation">,</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isInterrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">LockSupport</span><span class="token punctuation">.</span><span class="token function">park</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">/////////è¿™é‡Œä¼šç«‹å³åœæ­¢</span>    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"unpark---"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"t1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ä¸¤é˜¶æ®µç»ˆæ­¢æ¨¡å¼"><a href="#ä¸¤é˜¶æ®µç»ˆæ­¢æ¨¡å¼" class="headerlink" title="ä¸¤é˜¶æ®µç»ˆæ­¢æ¨¡å¼"></a>ä¸¤é˜¶æ®µç»ˆæ­¢æ¨¡å¼</h4><blockquote><p>åœ¨çº¿ç¨‹T1ä¸­å¦‚ä½•â€œä¼˜é›…â€ç»ˆæ­¢çº¿ç¨‹T2ï¼Ÿè¿™é‡Œçš„ã€ä¼˜é›…ã€‘æŒ‡çš„æ˜¯ç»™T2ä¸€ä¸ªæ–™ç†åäº‹çš„æœºä¼šï¼Ÿ</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/29/BJI44x.png"></p><h3 id="2-4-ä¸»çº¿ç¨‹ä¸å®ˆæŠ¤çº¿ç¨‹"><a href="#2-4-ä¸»çº¿ç¨‹ä¸å®ˆæŠ¤çº¿ç¨‹" class="headerlink" title="2.4 ä¸»çº¿ç¨‹ä¸å®ˆæŠ¤çº¿ç¨‹"></a>2.4 ä¸»çº¿ç¨‹ä¸å®ˆæŠ¤çº¿ç¨‹</h3><blockquote><p>å®ˆæŠ¤çº¿ç¨‹ï¼Œ<strong>åªè¦å…¶å®ƒéå®ˆæŠ¤çº¿ç¨‹è¿è¡Œç»“æŸäº†ï¼Œå³ä½¿å®ˆæŠ¤çº¿ç¨‹çš„ä»£ç æ²¡æœ‰æ‰§è¡Œå®Œï¼Œä¹Ÿä¼šå¼ºåˆ¶ç»“æŸ</strong></p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Thread</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isInterrupted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// å¦‚æœå®ˆæŠ¤çº¿ç¨‹æ­£å¸¸ç»“æŸï¼Œæ‰ä¼šæ‰§è¡Œ</span>    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"ç»“æŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"t1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>t1<span class="token punctuation">.</span><span class="token function">setDaemon</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>t1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"mainç»“æŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åƒåœ¾å›æ”¶å™¨çº¿ç¨‹æ˜¯ä¸€ç§å®ˆæŠ¤çº¿ç¨‹</li><li>Tomcatä¸­çš„Acceptorå’ŒPollerçº¿ç¨‹éƒ½æ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Œæ‰€ä»¥Tomcatæ¥æ”¶åˆ°shutdownå‘½ä»¤åï¼Œä¸ä¼šç­‰å¾…ä»–ä»¬å¤„ç†å®Œå½“å‰è¯·æ±‚</li></ul><h3 id="2-5-çº¿ç¨‹çŠ¶æ€"><a href="#2-5-çº¿ç¨‹çŠ¶æ€" class="headerlink" title="2.5 çº¿ç¨‹çŠ¶æ€"></a>2.5 çº¿ç¨‹çŠ¶æ€</h3><blockquote><p>åœ¨æ“ä½œç³»ç»Ÿå±‚é¢</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/30/BYNFC6.png"></p><ul><li>ã€åˆå§‹çŠ¶æ€ã€‘ä»…ä»…æ˜¯åœ¨è¯­è¨€å±‚é¢åˆ›å»ºäº†çº¿ç¨‹å¯¹è±¡ï¼Œè¿˜æœªä¸æ“ä½œç³»ç»Ÿçº¿ç¨‹å…³è”</li><li>ã€å¯è¿è¡ŒçŠ¶æ€ã€‘ï¼ˆå°±ç»ªçŠ¶æ€ï¼‰æŒ‡è¯¥çº¿ç¨‹å·²è¢«åˆ›å»ºï¼Œå¯ä»¥ç”±cpuè°ƒåº¦æ‰§è¡Œ</li><li>ã€è¿è¡ŒçŠ¶æ€ã€‘æŒ‡è·å–äº†CPUæ—¶é—´ç‰‡è¿è¡Œä¸­çš„çŠ¶æ€<ul><li>å½“CPUæ—¶é—´ç‰‡ç”¨å®Œï¼Œä¼šä»ã€è¿è¡ŒçŠ¶æ€ã€‘è½¬æ¢è‡³ã€å¯è¿è¡ŒçŠ¶æ€ã€‘ï¼Œä¼šå¯¼è‡´çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢</li></ul></li><li>ã€é˜»å¡çŠ¶æ€ã€‘<ul><li>å¦‚æœè°ƒç”¨äº†é˜»å¡APIï¼Œå¦‚BIOè¯»å†™æ–‡ä»¶ï¼Œè¿™æ—¶è¯¥çº¿ç¨‹å®é™…ä¸Šä¸ä¼šç”¨åˆ°CPUï¼Œä¼šå¯¼è‡´çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè¿›å…¥ã€é˜»å¡çŠ¶æ€ã€‘</li><li>ç­‰BIOæ“ä½œå®Œæ¯•ï¼Œä¼šç”±æ“ä½œç³»ç»Ÿå”¤é†’é˜»å¡çš„çº¿ç¨‹ï¼Œè½¬æ¢è‡³ã€å¯è¿è¡ŒçŠ¶æ€ã€‘</li></ul></li><li>ã€ç»ˆæ­¢çŠ¶æ€ã€‘è¡¨ç¤ºçº¿ç¨‹ä»¥åŠæ‰§è¡Œå®Œæ¯•ï¼Œç”Ÿå‘½å‘¨æœŸå·²ç»ç»“æŸï¼Œä¸ä¼šå†è½¬æ¢ä¸ºå…¶ä»–çŠ¶æ€</li></ul><blockquote><p>åœ¨javaå±‚é¢</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/30/BYUUyD.png"></p><h3 id="2-6-å°ç»“"><a href="#2-6-å°ç»“" class="headerlink" title="2.6 å°ç»“"></a>2.6 å°ç»“</h3><ul><li><p>çº¿ç¨‹çš„åˆ›å»º</p></li><li><p>çº¿ç¨‹çš„é‡è¦api</p></li><li><p>çº¿ç¨‹çš„çŠ¶æ€</p></li><li><p><strong>åº”ç”¨æ–¹é¢</strong></p><ul><li>å¼‚æ­¥è°ƒç”¨ï¼šä¸»çº¿ç¨‹æ‰§è¡ŒæœŸé—´ï¼Œå…¶ä»–çº¿ç¨‹å¼‚æ­¥æ‰§è¡Œè€—æ—¶æ“ä½œ</li><li>æé«˜æ•ˆç‡ï¼šå¹¶è¡Œè®¡ç®—ï¼Œç¼©çŸ­è¿è¡Œæ—¶é—´</li><li>åŒæ­¥ç­‰å¾…ï¼šjoin</li><li>ç»Ÿç­¹è§„åˆ’ï¼šåˆç†ä½¿ç”¨çº¿ç¨‹ï¼Œå¾—åˆ°æœ€ä¼˜ç»“æœ</li></ul></li><li><p><strong>åŸç†æ–¹é¢</strong></p><ul><li>çº¿ç¨‹è¿è¡Œæµç¨‹ï¼šæ ˆã€æ ˆå¸§ã€ä¸Šä¸‹æ–‡åˆ‡æ¢ã€ç¨‹åºè®¡æ•°å™¨</li><li>Threadä¸¤ç§åˆ›å»ºæ–¹å¼çš„æºç </li></ul></li><li><p><strong>æ¨¡å¼æ–¹é¢</strong></p><ul><li>ä¸¤é˜¶æ®µç»ˆæ­¢æ¨¡å¼</li></ul></li></ul><h2 id="3-å…±äº«æ¨¡å‹ä¹‹ç®¡ç¨‹"><a href="#3-å…±äº«æ¨¡å‹ä¹‹ç®¡ç¨‹" class="headerlink" title="3. å…±äº«æ¨¡å‹ä¹‹ç®¡ç¨‹"></a>3. å…±äº«æ¨¡å‹ä¹‹ç®¡ç¨‹</h2><h3 id="3-1-å…±äº«å¸¦æ¥çš„é—®é¢˜"><a href="#3-1-å…±äº«å¸¦æ¥çš„é—®é¢˜" class="headerlink" title="3.1 å…±äº«å¸¦æ¥çš„é—®é¢˜"></a>3.1 å…±äº«å¸¦æ¥çš„é—®é¢˜</h3><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201031134251.png"></p><h4 id="ä¸´ç•ŒåŒº"><a href="#ä¸´ç•ŒåŒº" class="headerlink" title="ä¸´ç•ŒåŒº"></a>ä¸´ç•ŒåŒº</h4><ul><li>ä¸€ä¸ªç¨‹åºè¿è¡Œå¤šä¸ªiancæœ¬èº«æ˜¯æ²¡æœ‰é—®é¢˜çš„</li><li>é—®é¢˜å‡ºç°åœ¨å¤šä¸ªçº¿ç¨‹è®¿é—®<strong>å…±äº«èµ„æº</strong>ï¼Œåœ¨å¤šä¸ªçº¿ç¨‹å¯¹<strong>å…±äº«èµ„æº</strong>çš„è¯»å†™æ“ä½œå‘ç”Ÿäº†æŒ‡ä»¤äº¤é”™ï¼Œå°±ä¼šå‡ºç°é—®é¢˜</li><li>ä¸€æ®µä»£ç å†…å¦‚æœå­˜åœ¨å¯¹<strong>å…±äº«èµ„æº</strong>çš„å¤šçº¿ç¨‹è¯»å†™æ“ä½œï¼Œç§°è¿™å—ä»£ç ä¸º <strong>ä¸´ç•ŒåŒº</strong></li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// ä¸´ç•ŒåŒº</span>    counter<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// ä¸´ç•ŒåŒº</span>    counter<span class="token operator">--</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ç«æ€æ¡ä»¶-Race-Condition"><a href="#ç«æ€æ¡ä»¶-Race-Condition" class="headerlink" title="ç«æ€æ¡ä»¶ Race Condition"></a>ç«æ€æ¡ä»¶ Race Condition</h4><h3 id="3-2-synchronizedè§£å†³æ–¹æ¡ˆ"><a href="#3-2-synchronizedè§£å†³æ–¹æ¡ˆ" class="headerlink" title="3.2 synchronizedè§£å†³æ–¹æ¡ˆ"></a>3.2 synchronizedè§£å†³æ–¹æ¡ˆ</h3><blockquote><p>ä¿—ç§°â€œå¯¹è±¡é”â€ï¼Œé‡‡ç”¨äº’æ–¥çš„æ–¹å¼è®©åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤ŸæŒæœ‰ã€å¯¹è±¡é”ã€‘ï¼Œå…¶ä»–çº¿ç¨‹å†æƒ³è·å–è¿™ä¸ªã€å¯¹è±¡é”ã€‘å°±ä¼šé˜»å¡ã€‚ä¸ç”¨æ‹…å¿ƒä¸Šä¸‹æ–‡åˆ‡æ¢</p></blockquote><p><strong>æ³¨æ„</strong></p><p>è™½ç„¶javaä¸­ï¼Œäº’æ–¥å’ŒåŒæ­¥éƒ½èƒ½é‡‡ç”¨synchronizedå…³é”®å­—å®Œæˆï¼Œä½†æ˜¯ä»–ä»¬æœ‰æœ¬è´¨åŒºåˆ«ï¼š</p><ul><li>äº’æ–¥æ˜¯ä¿è¯ä¸´ç•ŒåŒºçš„ç«æ€æ¡ä»¶å‘ç”Ÿï¼ŒåŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä¸´ç•ŒåŒºä»£ç </li><li>åŒæ­¥æ˜¯ç”±äºçº¿ç¨‹æ‰§è¡Œçš„å…ˆåã€é¡ºåºä¸åŒã€éœ€è¦ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹è¿è¡Œåˆ°æŸä¸ªç‚¹</li></ul><h4 id="synchronized"><a href="#synchronized" class="headerlink" title="synchronized"></a>synchronized</h4><p><strong>è¯­æ³•</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">synchronized</span> <span class="token punctuation">(</span>å¯¹è±¡<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// ä¸´ç•ŒåŒº</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>æ€è€ƒ</strong></p><p>synchronizedå®é™…æ˜¯ç”¨<strong>å¯¹è±¡é”</strong>ä¿è¯äº† <strong>ä¸´ç•ŒåŒºå†…ä»£ç çš„åŸå­æ€§</strong>ï¼Œä¸´ç•ŒåŒºå†…çš„ä»£ç å¯¹å¤–æ˜¯ä¸å¯åˆ†å‰²çš„ï¼Œä¸ä¼šè¢«çº¿ç¨‹åˆ‡æ¢æ‰€æ‰“æ–­ã€‚</p><p><strong>é—®é¢˜</strong></p><blockquote><p>å¦‚æœæŠŠsynchronized(obj)æ”¾åœ¨forå¾ªç¯çš„å¤–é¢ï¼Œå¦‚ä½•ç†è§£ï¼Ÿ</p></blockquote><p>åŸå­æ€§</p><blockquote><p>å¦‚æœt1 synchronized(obj1) è€Œ t2 synchronized(obj2) ä¼šæ€æ ·è¿ä½œï¼Ÿ</p></blockquote><p>é”å¯¹è±¡è¦ä¸€è‡´ï¼Œä¸ç„¶æ²¡ç”¨</p><blockquote><p>å¦‚æœt1 synchronized(obj)è€Œt2æ²¡æœ‰åŠ ä¼šæ€ä¹ˆæ ·ï¼Ÿå¦‚ä½•ç†è§£ï¼Ÿ</p></blockquote><p>t2æ²¡æœ‰åŠ ï¼Œå½“æ‰§è¡Œå®ƒçš„ä»£ç ç‰‡çš„æ—¶å€™ï¼Œå®ƒå¹¶ä¸ä¼šå»è·å–é”å¯¹è±¡ï¼Œè€Œæ˜¯ç›´æ¥æ‰§è¡Œä»£ç </p><h4 id="æ–¹æ³•ä¸Šçš„synchronized"><a href="#æ–¹æ³•ä¸Šçš„synchronized" class="headerlink" title="æ–¹æ³•ä¸Šçš„synchronized"></a>æ–¹æ³•ä¸Šçš„synchronized</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">decrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// ä¸´ç•ŒåŒº</span>    counter<span class="token operator">--</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¿™é‡Œçœ‹ä¼¼åŠ åœ¨æ–¹æ³•ä¸Šï¼Œå…¶å®é”ä½çš„æ˜¯è°ƒç”¨å®ƒçš„å¯¹è±¡</p></blockquote><h4 id="çº¿ç¨‹å…«é”"><a href="#çº¿ç¨‹å…«é”" class="headerlink" title="çº¿ç¨‹å…«é”"></a>çº¿ç¨‹å…«é”</h4><p>æƒ…å†µ1ï¼š<u>ç«‹åˆ»å‡ºç°1å’Œ2ï¼Œæˆ–è€…ç«‹åˆ»å‡ºç°2å’Œ1</u></p><pre class="line-numbers language-java" data-language="java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Number</span> n1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"begin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            n1<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"begin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            n1<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Slf4j</span><span class="token punctuation">(</span>topic <span class="token operator">=</span> <span class="token string">"c.Number"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Number</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æƒ…å†µ2ï¼š<u>1såå‡ºç°1 2æˆ–è€…2 1såå‡ºç°1</u></p><pre class="line-numbers language-java" data-language="java"><code class="language-java">   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Number</span> n1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"begin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            n1<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"begin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            n1<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Slf4j</span><span class="token punctuation">(</span>topic <span class="token operator">=</span> <span class="token string">"c.Number"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Number</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">ThreadUtil</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">///è®©çº¿ç¨‹1ç¡çœ 1s</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æƒ…å†µ3ï¼š<u>3 2 1så1ï¼Œ3 1så 1 2 ï¼Œ2 3 1så1</u></p><pre class="line-numbers language-java" data-language="java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Number</span> n1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"begin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            n1<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"begin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            n1<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"begin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            n1<span class="token punctuation">.</span><span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Slf4j</span><span class="token punctuation">(</span>topic <span class="token operator">=</span> <span class="token string">"c.Number"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Number</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">ThreadUtil</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æƒ…å†µ4ï¼š<u>1 2ï¼Œ2 1</u></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token punctuation">(</span>topic <span class="token operator">=</span> <span class="token string">"c.Number"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Number</span><span class="token punctuation">&#123;</span> <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token class-name">Number</span> n1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">Number</span> n2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span> n1<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span> n2<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æƒ…å†µ5ï¼š2 1s å 1</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token punctuation">(</span>topic <span class="token operator">=</span> <span class="token string">"c.Number"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Number</span><span class="token punctuation">&#123;</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>åŒ—äº¬å¸‚æ˜Œå¹³åŒºå»ºæåŸè¥¿è·¯é‡‘ç‡•é¾™åŠå…¬æ¥¼ä¸€å±‚ ç”µè¯ï¼š<span class="token number">400</span><span class="token operator">-</span><span class="token number">618</span><span class="token operator">-</span><span class="token number">9090</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token class-name">Number</span> n1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span> n1<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span> n1<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æƒ…å†µ6ï¼š1s å12ï¼Œ æˆ– 2 1så 1</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token punctuation">(</span>topic <span class="token operator">=</span> <span class="token string">"c.Number"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Number</span><span class="token punctuation">&#123;</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token class-name">Number</span> n1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span> n1<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span> n1<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æƒ…å†µ7ï¼š2 1s å 1</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token punctuation">(</span>topic <span class="token operator">=</span> <span class="token string">"c.Number"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Number</span><span class="token punctuation">&#123;</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token class-name">Number</span> n1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">Number</span> n2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span> n1<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span> n2<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æƒ…å†µ8ï¼š1s å12ï¼Œ æˆ– 2 1så 1</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Slf4j</span><span class="token punctuation">(</span>topic <span class="token operator">=</span> <span class="token string">"c.Number"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Number</span><span class="token punctuation">&#123;</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token class-name">Number</span> n1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">Number</span> n2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span> n1<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span> n2<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-3-å˜é‡çš„çº¿ç¨‹å®‰å…¨åˆ†æ"><a href="#3-3-å˜é‡çš„çº¿ç¨‹å®‰å…¨åˆ†æ" class="headerlink" title="3.3 å˜é‡çš„çº¿ç¨‹å®‰å…¨åˆ†æ"></a>3.3 å˜é‡çš„çº¿ç¨‹å®‰å…¨åˆ†æ</h3><blockquote><p><strong>æˆå‘˜å˜é‡å’Œé™æ€å˜é‡æ˜¯å¦çº¿ç¨‹å®‰å…¨ï¼Ÿ</strong></p></blockquote><ul><li>å¦‚æœä»–ä»¬æ²¡æœ‰å…±äº«ï¼Œåˆ™çº¿ç¨‹å®‰å…¨</li><li>å¦‚æœä»–ä»¬è¢«å…±äº«äº†ï¼Œæ ¹æ®ä»–ä»¬çš„çŠ¶æ€æ˜¯å¦èƒ½å¤Ÿæ”¹å˜ï¼Œåˆåˆ†ä¸ºï¼š<ul><li>å¦‚æœæ˜¯åªè¯»æ“ä½œï¼Œåˆ™çº¿ç¨‹å®‰å…¨</li><li>å¦‚æœæ˜¯è¯»å†™æ“ä½œï¼Œåˆ™è¿™æ®µä»£ç æ˜¯ä¸´ç•ŒåŒºï¼Œéœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨é—®é¢˜</li></ul></li></ul><blockquote><p><strong>å±€éƒ¨å˜é‡æ˜¯å¦çº¿ç¨‹å®‰å…¨ï¼Ÿ</strong></p></blockquote><ul><li>å±€éƒ¨å˜é‡æ˜¯çº¿ç¨‹å®‰å…¨çš„</li><li>å±€éƒ¨å˜é‡å¼•ç”¨çš„å¯¹è±¡æœªå¿…æ˜¯å®‰å…¨çš„ï¼š<ul><li>å¦‚æœè¯¥å¯¹è±¡æ²¡æœ‰é€ƒç¦»æ–¹æ³•çš„ä½œç”¨è®¿é—®ï¼Œå®ƒæ˜¯çº¿ç¨‹å®‰å…¨çš„</li><li>å¦‚æœè¯¥å¯¹è±¡é€ƒç¦»æ–¹æ³•çš„ä½œç”¨èŒƒå›´ï¼Œåˆ™éœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨</li></ul></li></ul><h3 id="3-4-å¸¸è§çš„çº¿ç¨‹å®‰å…¨ç±»"><a href="#3-4-å¸¸è§çš„çº¿ç¨‹å®‰å…¨ç±»" class="headerlink" title="3.4 å¸¸è§çš„çº¿ç¨‹å®‰å…¨ç±»"></a>3.4 å¸¸è§çš„çº¿ç¨‹å®‰å…¨ç±»</h3><ul><li>String</li><li>Integer</li><li>StringBuffer</li><li>Random</li><li>Vector</li><li>HashTable</li><li>JUCåŒ…ä¸‹çš„ç±»</li></ul><blockquote><p>è¿™é‡Œè¯´ä»–ä»¬çš„çº¿ç¨‹å®‰å…¨æ˜¯æŒ‡ï¼Œå¤šä¸ªçº¿ç¨‹è°ƒç”¨ä»–ä»¬<strong>åŒä¸€ä¸ªå®ä¾‹çš„æŸä¸ªæ–¹æ³•æ—¶</strong>ï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„</p></blockquote><h3 id="3-5Monitor-ç›‘è§†å™¨"><a href="#3-5Monitor-ç›‘è§†å™¨" class="headerlink" title="3.5Monitor ç›‘è§†å™¨"></a>3.5Monitor ç›‘è§†å™¨</h3><blockquote><p><strong>å¯¹è±¡å¤´</strong></p></blockquote><p>æ™®é€šå¯¹è±¡</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201031193830.png"></p><p>æ•°ç»„å¯¹è±¡</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201031193901.png"></p><p>Mark Wordçš„ç»“æ„ä¸º</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201031193942.png"></p><p>64ä½è™šæ‹ŸæœºMark Word</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201031194046.png"></p><h4 id="MonitoråŸç†"><a href="#MonitoråŸç†" class="headerlink" title="MonitoråŸç†"></a>MonitoråŸç†</h4><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201103174042.png" alt="ç›‘è§†å™¨å·¥ä½œåŸç†"></p><ul><li>åˆšå¼€å§‹Monitorä¸­çš„Ownerä¸ºnull</li><li>å½“Thread-2æ‰§è¡Œsynchronized(obj)å°±ä¼šå°†Monitorçš„æ‰€æœ‰è€…Ownerç½®ä¸ºThread-2ï¼ŒMonitorä¸­åªèƒ½æœ‰ä¸€ä¸ªOwner</li><li>å½“Thread-2ä¸Šé”çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœThread-3ï¼ŒThread-4ï¼ŒThread-5ä¹Ÿæ¥æ‰§è¡Œsynchronized(obj)ï¼Œå°±ä¼šè¿›å…¥EntryListä¸­ï¼Œè¿›å…¥é˜»å¡çŠ¶æ€</li><li>å½“Thread-2æ‰§è¡Œå®ŒåŒæ­¥ä»£ç å—ä¸­çš„å†…å®¹ï¼Œç„¶åå”¤é†’EntryListä¸­çš„ç­‰å¾…çº¿ç¨‹æ¥ç«äº‰é”ï¼Œ<strong>ç«äº‰é”çš„è¿‡ç¨‹æ˜¯éå…¬å¹³çš„</strong></li><li>WAITINGä¸­çš„çº¿ç¨‹æ˜¯ï¼šä¹‹å‰è·å¾—è¿‡é”ï¼Œä½†æ¡ä»¶åˆä¸æ»¡è¶³è¿›å…¥WAITINGçŠ¶æ€çš„çº¿ç¨‹</li></ul><hr><h3 id="3-6-è½»é‡çº§é”"><a href="#3-6-è½»é‡çº§é”" class="headerlink" title="3.6 è½»é‡çº§é”"></a>3.6 è½»é‡çº§é”</h3><blockquote><p>å¦‚æœä¸€ä¸ªå¯¹è±¡è™½ç„¶æœ‰å¤šä¸ªçº¿ç¨‹è®¿é—®ï¼Œä½†å¤šçº¿ç¨‹è®¿é—®çš„æ—¶é—´æ˜¯é”™å¼€çš„ï¼ˆ<strong>æ²¡æœ‰ç«äº‰</strong>ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨è½»é‡çº§é”æ¥ä¼˜åŒ–</p><p>è½»é‡çº§é”å¯¹ä½¿ç”¨è€…æ˜¯é€æ˜çš„ï¼Œè¯­æ³•ä»ç„¶æ˜¯synchronized</p></blockquote><p>å‡è®¾æœ‰ä¸¤ä¸ªæ–¹æ³•åŒæ­¥ä»£ç å—ï¼Œ åˆ©ç”¨åŒä¸€ä¸ªå¯¹è±¡åŠ é”</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span>  <span class="token keyword">final</span> <span class="token class-name">Object</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// åŒæ­¥å—A</span>        <span class="token function">method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// åŒæ­¥å—B</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>åˆ›å»ºé”è®°å½•å¯¹è±¡ï¼Œæ¯ä¸ªçº¿ç¨‹çš„æ ˆå¸§ä¸­éƒ½ä¼šåŒ…å«ä¸€ä¸ªé”è®°å½•çš„ç»“æ„ï¼Œå†…å­˜å¯ä»¥å­˜å‚¨é”å®šå¯¹è±¡çš„Mark Word</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201103213042.png"></p></li><li><p>è®©é”è®°å½•ä¸­Object referenceæŒ‡å‘é”å¯¹è±¡ï¼Œå¹¶å°è¯•ç”¨CASæ›¿æ¢Objectçš„Mark Wordï¼Œå°†Mark Wordçš„å€¼å­˜å…¥é”è®°å½•ä¸­</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201103213844.png"></p></li><li><p>å¦‚æœCASæ›¿æ¢æˆåŠŸï¼Œ<strong>å¯¹è±¡å¤´ä¸­å­˜å‚¨äº†æ‰€è®°å½•åœ°å€å’ŒçŠ¶æ€00</strong>ï¼Œè¡¨ç¤ºç”±è¯¥çº¿ç¨‹ç»™å¯¹è±¡åŠ é”ï¼Œè¿™æ—¶å¦‚ä¸‹å›¾ç¤ºï¼š</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201103214200.png"></p></li><li><p>å¦‚æœCASå¤±è´¥ï¼š</p><ul><li><p>å¦‚æœæ˜¯å…¶ä»–çº¿ç¨‹å·²ç»æŒæœ‰äº†è¯¥å¯¹è±¡çš„è½»é‡çº§é”ï¼Œè¿™æ˜¯è¡¨æ˜æœ‰ç«äº‰ï¼Œè¿›å…¥é”è†¨èƒ€è¿‡ç¨‹</p></li><li><p>å¦‚æœæ˜¯è‡ªå·±æ‰§è¡Œäº†synchronizedé”é‡å…¥ï¼Œé‚£ä¹ˆå†æ·»åŠ ä¸€æ¡Lock Recordä½œä¸ºé‡å…¥çš„è®¡æ•°</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201103214743.png" alt="synchronized é”é‡å…¥ï¼å­˜å…¥null"></p></li><li><p>å½“é€€å‡ºsynchronizedä»£ç å—ï¼Œè¿›è¡Œè§£é”ï¼Œå¦‚æœæœ‰å–å€¼ä¸ºnullçš„é”è®°å½•ï¼Œè¡¨ç¤ºæœ‰é‡å…¥ï¼Œè¿™æ—¶å……å€¼é”è®°å½•ï¼Œè¡¨ç¤ºé‡å…¥è®¡æ•°å‡ä¸€</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201103214200.png"></p></li><li><p>å½“æ¨å‡ºsynchronizedä»£ç å—ï¼Œè¿›è¡Œè§£é”ï¼Œå¦‚æœé”è®°å½•çš„å€¼ä¸ä¸ºnullï¼Œè¿™æ—¶ç”¨caså°†Mark Wordçš„å€¼æ¢å¤ç»™å¯¹è±¡å¤´</p><ul><li>æˆåŠŸï¼šè§£é”æˆåŠŸ</li><li>å¤±è´¥ï¼šè¯´æ˜è½»é‡çº§é”è¿›è¡Œäº†é”è†¨èƒ€æˆ–è€…å·²ç»å‡çº§ä¸ºé‡é‡çº§é”ï¼Œè¿›å…¥é‡é‡çº§é”è§£é”æµç¨‹</li></ul></li></ul></li></ul><hr><h3 id="3-7-é”è†¨èƒ€"><a href="#3-7-é”è†¨èƒ€" class="headerlink" title="3.7 é”è†¨èƒ€"></a>3.7 é”è†¨èƒ€</h3><blockquote><p>å¦‚æœå†å°è¯•åŠ è½»é‡çº§é”çš„è¿‡ç¨‹ä¸­ï¼ŒCASæ“ä½œæ— æ³•æˆåŠŸï¼Œè¿™æ—¶ä¸€ç§æƒ…å†µå°±æ˜¯æœ‰å…¶ä»–çº¿ç¨‹ä¸ºæ­¤å¯¹è±¡åŠ ä¸Šäº†è½»é‡çº§é”ï¼ˆæœ‰ç«äº‰ï¼‰ï¼Œè¿™æ—¶å°±éœ€è¦è¿›è¡Œé”è†¨èƒ€ï¼Œå°†è½»é‡çº§é”å˜ä¸ºé‡é‡çº§é”ã€‚</p></blockquote><ul><li><p>å½“Thread-1è¿›è¡Œè½»é‡çº§åŠ é”æ—¶ï¼ŒThread-0å·²ç»å¯¹è¯¥å¯¹è±¡åŠ äº†è½»é‡çº§é”</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201103220659.png"></p></li><li><p>è¿™æ—¶Thread-1åŠ è½»é‡çº§é”å¤±è´¥ï¼Œè¿›å…¥é”è†¨èƒ€æµç¨‹</p><ul><li>å³ä¸ºObjectå¯¹è±¡ç”³è¯·Monitoré”ï¼Œè®©ObjectæŒ‡å‘é‡é‡çº§é”åœ°å€</li><li>ç„¶åè‡ªå·±è¿›å…¥Monitorçš„EntryList BLOCKED</li></ul><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201104104249.png"></p></li><li><p>å½“Thread-0é€€å‡ºåŒæ­¥å—è§£é”æ—¶ï¼Œä½¿ç”¨caså°†Mark Wordçš„å€¼æ¢å¤ç»™å¯¹è±¡å¤´ï¼Œå¤±è´¥ã€‚è¿™æ—¶ä¼šè¿›å…¥é‡é‡çº§è§£é”æµç¨‹ï¼Œå³æŒ‰ç…§Monitoråœ°å€æ‰¾åˆ°Monitorå¯¹è±¡ï¼Œè®¾ç½®Ownerä¸ºnullï¼Œå”¤é†’EntryListä¸­çš„BLOCKEDçº¿ç¨‹</p></li></ul><hr><h3 id="3-8-è‡ªæ—‹"><a href="#3-8-è‡ªæ—‹" class="headerlink" title="3.8 è‡ªæ—‹"></a>3.8 è‡ªæ—‹</h3><blockquote><p>å¯¹äºè‡ªæ—‹æœ‰å¥½å¤šä¸åŒçš„ç‰ˆæœ¬ï¼Œæœ‰çš„è¯´æ˜¯åœ¨è½»é‡çº§é”çš„æ—¶å€™è‡ªæ—‹ï¼Œæœ‰çš„è¯´æ˜¯åœ¨é‡é‡çº§é”çš„æ—¶å€™è‡ªæ—‹ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p></blockquote><p><strong>é‡é‡çº§é”ç«äº‰çš„æ—¶å€™</strong>ï¼Œä½¿ç”¨è‡ªæ—‹æ¥è¿›è¡Œä¼˜åŒ–ï¼Œå¦‚æœå½“å‰çº¿ç¨‹è‡ªæ—‹æˆåŠŸï¼ˆè¿™æ—¶å€™æŒé”çº¿ç¨‹å·²ç»æ¨å‡ºäº†åŒæ­¥å—ï¼Œé‡Šæ”¾äº†é”ï¼‰ï¼Œè¿™æ—¶å½“å‰çº¿ç¨‹å°±å¯ä»¥é¿å…é˜»å¡ã€‚</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201104144726.png" alt="è‡ªæ—‹æˆåŠŸ"></p><p>è‡ªæ—‹å¤±è´¥ä¼šè¿›å…¥entryListä¸­ï¼Œè¿›å…¥BLOCKEDçŠ¶æ€</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201104144859.png" alt="è‡ªæ—‹å¤±è´¥"></p><p><strong>è¡¥å……</strong></p><ul><li>java6ä»¥åè‡ªæ—‹é”æ˜¯è‡ªé€‚åº”çš„ï¼Œæ¯”å¦‚å¯¹è±¡æ æ†çš„ä¸€æ¬¡è‡ªæ—‹æ“ä½œæˆåŠŸè¿‡ï¼Œé‚£ä¹ˆè®¤ä¸ºè¿™æ¬¡è‡ªæ—‹æˆåŠŸçš„å¯èƒ½æ€§ä¼šé«˜ï¼Œå°±å¤šè‡ªæ—‹å‡ æ¬¡ï¼›åä¹‹å°±å°‘è‡ªæ—‹ç”šè‡³ä¸è‡ªæ—‹ï¼Œæ™ºèƒ½æ§åˆ¶ã€‚</li><li>è‡ªæ—‹ä¼šå ç”¨cpuæ—¶é—´ï¼Œå¤šæ ¸cpuæ‰èƒ½å‘æŒ¥ä¼˜åŠ¿</li><li>java7ä¹‹åä¸èƒ½æ§åˆ¶æ˜¯å¦å¼€å¯è‡ªæ—‹åŠŸèƒ½</li></ul><h3 id="3-9-åå‘é”"><a href="#3-9-åå‘é”" class="headerlink" title="3.9 åå‘é”"></a>3.9 åå‘é”</h3><blockquote><p>å½“è½»é‡çº§é”åœ¨æ²¡æœ‰ç«äº‰çš„æ—¶å€™ï¼Œæ¯æ¬¡é‡å…¥ä»ç„¶éœ€è¦è¿›è¡Œä¸€æ¬¡CASï¼Œç›¸å½“æµªè´¹å•Š</p><p>æ‰€ä»¥java6ä¸­å¼•å…¥äº†åå‘é”æ¥è¿›è¡Œè¿›ä¸€æ­¥ä¼˜åŒ–ï¼šåªæœ‰ç¬¬ä¸€æ¬¡CAS<strong>å°†çº¿ç¨‹IDè®¾ç½®åˆ°å¯¹è±¡å¤´çš„Mark Wordä¸­</strong>ï¼Œä¹‹åå‘ç°è¿™ä¸ªçº¿ç¨‹IDæ˜¯è‡ªå·±çš„å°±è¡¨ç¤ºæ²¡æœ‰ç«äº‰ï¼Œä¸ç”¨é‡æ–°CASã€‚ä»¥ååªè¦ä¸å‘ç”Ÿç«äº‰ï¼Œè¿™ä¸ªå¯¹è±¡å°±å½’è¯¥çº¿ç¨‹æ‰€æœ‰ã€‚</p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201104162409.png"></p><h4 id="åå‘çŠ¶æ€"><a href="#åå‘çŠ¶æ€" class="headerlink" title="åå‘çŠ¶æ€"></a>åå‘çŠ¶æ€</h4><p>ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶ï¼š</p><ul><li>å¦‚æœå¼€å¯äº†åå‘é”ï¼ˆé»˜è®¤å¼€å¯ï¼‰ï¼Œé‚£ä¹ˆå¯¹è±¡åˆ›å»ºåï¼ŒMark Wordå€¼ä¸º0x05å³æœ€å3ä½ä¸º101ï¼Œè¿™æ—¶å®ƒçš„threadã€epochã€ageéƒ½ä¸º0</li><li>åå‘é”æ˜¯é»˜è®¤æ˜¯å»¶è¿Ÿçš„ï¼Œä¸ä¼šåœ¨ç¨‹åºå¯åŠ¨ç«‹å³ç”Ÿæ•ˆï¼Œå¦‚æœæƒ³é¿å…å»¶è¿Ÿï¼Œå¯ä»¥åŠ VMå‚æ•° <code>-XX:BiasedLockingStrartupDelay=0</code>æ¥ç¦ç”¨å»¶è¿Ÿ</li><li>å¦‚æœæ²¡æœ‰å¼€å¯åå‘é”ï¼Œé‚£ä¹ˆå¯¹è±¡åˆ›å»ºåï¼ŒMark Wordå€¼ä¸º0x01 å³æœ€å3ä½ä¸º001ï¼Œè¿™æ—¶å®ƒçš„hash codeã€ageéƒ½ä¸º0ï¼Œç¬¬ä¸€æ¬¡ç”¨åˆ°hash codeæ—¶æ‰ä¼šèµ‹å€¼ <strong>å¹¶ä¸”ï¼Œç®—å‡ºhash codeä»¥åï¼Œåå‘é”å°±ä¼šå¤±æ•ˆï¼Œå› ä¸ºæ”¾ä¸ä¸‹äº†,å½“ä¸€ä¸ªå¯¹è±¡å½“å‰æ­£å¤„äºåå‘é”çŠ¶æ€ï¼Œå¹¶ä¸”éœ€è¦è®¡ç®—å…¶identity hash codeçš„è¯ï¼Œåˆ™å®ƒçš„åå‘é”ä¼šè¢«æ’¤é”€ï¼Œå¹¶ä¸”é”ä¼šè†¨èƒ€ä¸ºé‡é‡çº§é”</strong></li></ul><h4 id="æ’¤é”€-è°ƒç”¨å¯¹è±¡hashCode"><a href="#æ’¤é”€-è°ƒç”¨å¯¹è±¡hashCode" class="headerlink" title="æ’¤é”€-è°ƒç”¨å¯¹è±¡hashCode"></a>æ’¤é”€-è°ƒç”¨å¯¹è±¡hashCode</h4><blockquote><p>è°ƒç”¨äº†å¯¹è±¡çš„hashCodeï¼Œä½†åå‘é”çš„å¯¹è±¡Mark Wordä¸­å­˜å‚¨çš„æ—¶çº¿ç¨‹idï¼Œå¦‚æœè°ƒç”¨hash Codeä¼šå¯¼è‡´åå‘é”è¢«æ’¤é”€</p></blockquote><ul><li>è½»é‡çº§é”ä¼šåœ¨é”è®°å½•ä¸­è®°å½•hash Code</li><li>é‡é‡çº§é”ä¼šåœ¨Monitorä¸­è®°å½•hash Code</li></ul><p>è°ƒç”¨hash Codeåä½¿ç”¨åå‘é”ï¼Œè®°å¾—å»æ‰ <code>-XX:-UserBiasedLocking</code></p><h4 id="æ’¤é”€-å…¶ä»–çº¿ç¨‹ä½¿ç”¨å¯¹è±¡"><a href="#æ’¤é”€-å…¶ä»–çº¿ç¨‹ä½¿ç”¨å¯¹è±¡" class="headerlink" title="æ’¤é”€-å…¶ä»–çº¿ç¨‹ä½¿ç”¨å¯¹è±¡"></a>æ’¤é”€-å…¶ä»–çº¿ç¨‹ä½¿ç”¨å¯¹è±¡</h4><blockquote><p>å½“æœ‰å…¶ä»–çº¿ç¨‹ä½¿ç”¨åå‘é”çš„æ—¶å€™ï¼Œä¼šå‡çº§ä¸ºè½»é‡çº§é”</p></blockquote><h4 id="æ’¤é”€-è°ƒç”¨wait-notify"><a href="#æ’¤é”€-è°ƒç”¨wait-notify" class="headerlink" title="æ’¤é”€-è°ƒç”¨wait/notify"></a>æ’¤é”€-è°ƒç”¨wait/notify</h4><h4 id="æ‰¹é‡é‡åå‘"><a href="#æ‰¹é‡é‡åå‘" class="headerlink" title="æ‰¹é‡é‡åå‘"></a>æ‰¹é‡é‡åå‘</h4><blockquote><p>å¦‚æœå¯¹è±¡è™½ç„¶è¢«å¤šä¸ªçº¿ç¨‹è®¿é—®ï¼Œä½†æ²¡æœ‰ç«äº‰ï¼Œè¿™æ—¶åå‘äº†çº¿ç¨‹T1çš„å¯¹è±¡ä»æœ‰æœºä¼šé‡æ–°åå‘T2ï¼Œé‡åå‘ä¼šé‡ç½®å¯¹è±¡çš„Thread ID</p><p>å½“æ’¤é”€åå‘é”é˜ˆå€¼è¶…è¿‡20æ¬¡åï¼ŒJVMä¼šç»™è¿™äº›å¯¹è±¡åŠ é”æ—¶é‡æ–°åå‘è‡³åŠ é”çº¿ç¨‹</p></blockquote><h4 id="æ‰¹é‡æ’¤é”€"><a href="#æ‰¹é‡æ’¤é”€" class="headerlink" title="æ‰¹é‡æ’¤é”€"></a>æ‰¹é‡æ’¤é”€</h4><blockquote><p>å½“æ’¤é”€åå‘é”é˜ˆå€¼è¶…è¿‡40æ¬¡ï¼Œjvmä¼šæŠŠæ•´ä¸ªç±»çš„æ‰€æœ‰å¯¹è±¡éƒ½å˜ä¸ºä¸å¯åå‘çš„ï¼Œæ–°åˆ›å»ºçš„å¯¹è±¡ä¹Ÿæ˜¯ä¸å¯åå‘çš„ã€‚</p></blockquote><h3 id="3-10-é”æ¶ˆé™¤"><a href="#3-10-é”æ¶ˆé™¤" class="headerlink" title="3.10 é”æ¶ˆé™¤"></a>3.10 é”æ¶ˆé™¤</h3><p>xxx</p><h3 id="3-11-é”ç²—åŒ–"><a href="#3-11-é”ç²—åŒ–" class="headerlink" title="3.11 é”ç²—åŒ–"></a>3.11 é”ç²—åŒ–</h3><h2 id="4-wait-notify"><a href="#4-wait-notify" class="headerlink" title="4. wait notify"></a>4. wait notify</h2><blockquote><p>åŸç†</p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201104212224.png"></p><ul><li>Ownerçº¿ç¨‹å‘ç°æ¡ä»¶ä¸æ»¡è¶³ï¼Œè°ƒç”¨waitæ–¹æ³•ï¼Œå³å¯è¿›å…¥WaitSetå˜ä¸ºWAITINGçŠ¶æ€</li><li>BLOCKEDå’ŒWAITINGçš„çº¿ç¨‹éƒ½å¤„äºé˜»å¡çŠ¶æ€ï¼Œä¸å ç”¨CPUæ—¶é—´ç‰‡æ®µ</li><li>BLOCKEDçº¿ç¨‹ä¼šåœ¨OWnerçº¿ç¨‹é‡Šæ”¾é”æ—¶å”¤é†’</li><li>WAITINGçº¿ç¨‹è¿½åœ¨Ownerçº¿ç¨‹è°ƒç”¨notifyæˆ–notifyAllæ—¶å”¤é†’ï¼Œä½†å”¤é†’åå¹¶ä¸æ„å‘³ç€ç«‹åˆ»è·å¾—é”ï¼Œä»éœ€è¿›å…¥EntryListé‡æ–°ç«äº‰</li></ul><h3 id="APIä»‹ç»"><a href="#APIä»‹ç»" class="headerlink" title="APIä»‹ç»"></a>APIä»‹ç»</h3><ul><li>obj.wait()è®©è¿›å…¥objectè¿‘åæœŸçš„çº¿ç¨‹åˆ°waitSetç­‰å¾…</li><li>obj.notify()åœ¨objectä¸Šæ­£åœ¨waitSetç­‰å¾…çš„çº¿ç¨‹ä¸­æŒ‘ä¸€ä¸ªå”¤é†’</li><li>obj.notifyAll()è®©objectä¸Šæ­£åœ¨waitSetç­‰å¾…çš„çº¿ç¨‹å…¨éƒ¨å”¤é†’</li></ul><p><strong>è°ƒç”¨è¿™äº›æ–¹æ³•å¿…é¡»è·å–è¿™ä¸ªå¯¹è±¡çš„é”æ‰èƒ½è°ƒç”¨</strong> </p><h3 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h3><blockquote><p><strong>sleep(long n)**å’Œ</strong>wait(long n)**çš„åŒºåˆ«</p></blockquote><p>1ï¼‰sleepæ˜¯Threadæ–¹æ³•ï¼Œwaitæ˜¯Objectæ–¹æ³•</p><p>2ï¼‰sleepä¸éœ€è¦å¼ºåˆ¶å’Œsynchronizedé…åˆä½¿ç”¨ï¼Œä½†waitéœ€è¦å’Œsynchronizedä¸€èµ·ä½¿ç”¨</p><p>3ï¼‰<strong>sleepåœ¨ç¡çœ çš„åŒæ—¶ï¼Œä¸ä¼šé‡Šæ”¾å¯¹è±¡é”çš„</strong>ï¼Œä½†<strong>waitåœ¨ç­‰å¾…çš„æ—¶å€™ä¼šé‡Šæ”¾å¯¹è±¡é”</strong></p><p>4ï¼‰ä»–ä»¬çš„çŠ¶æ€éƒ½æ˜¯WAITING</p><p><strong>è§„èŒƒå†™æ³•</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ç­‰å¾…</span><span class="token keyword">synchronized</span> <span class="token punctuation">(</span>å¯¹è±¡<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>æ¡ä»¶ä¸æˆç«‹<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        lock<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// do other things</span><span class="token punctuation">&#125;</span><span class="token comment">// å”¤é†’</span><span class="token keyword">synchronized</span> <span class="token punctuation">(</span>å¯¹è±¡<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    lock<span class="token punctuation">.</span><span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ¨¡å¼â€”â€”ä¿æŠ¤æ€§æš‚åœ"><a href="#æ¨¡å¼â€”â€”ä¿æŠ¤æ€§æš‚åœ" class="headerlink" title="æ¨¡å¼â€”â€”ä¿æŠ¤æ€§æš‚åœ"></a>æ¨¡å¼â€”â€”ä¿æŠ¤æ€§æš‚åœ</h3><blockquote><p>ç”¨äºä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹çš„æ‰§è¡Œç»“æœ</p></blockquote><p>è¦ç‚¹ï¼š</p><ul><li>æœ‰ä¸€ä¸ªç»“æœéœ€è¦ä»ä¸€ä¸ªçº¿ç¨‹ä¼ é€’åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œè®©ä»–ä»¬å…³è”åŒä¸€ä¸ªGuardedObject</li><li>å¦‚æœæœ‰ç»“æœä¸æ–­ä»ä¸€ä¸ªçº¿ç¨‹åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨<strong>æ¶ˆæ¯é˜Ÿåˆ—</strong></li><li>jdkä¸­ï¼Œjoinå®ç°ã€Futureçš„å®ç°ï¼Œé‡‡ç”¨çš„å°±æ˜¯æ­¤æ¨¡å¼</li><li>å› ä¸ºè¦ç­‰å¾…å¦ä¸€æ–¹çš„ç»“æœï¼Œå› æ­¤å½’ç±»åˆ°<strong>åŒæ­¥æ¨¡å¼</strong></li></ul><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201105190354.png"></p><h3 id="æ¨¡å¼â€”â€”ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼"><a href="#æ¨¡å¼â€”â€”ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼" class="headerlink" title="æ¨¡å¼â€”â€”ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼"></a>æ¨¡å¼â€”â€”ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼</h3><blockquote><p>ç”Ÿäº§è€…è´Ÿè´£äº§ç”Ÿç»“æœæ•°æ®ï¼Œä¸å…³å¿ƒæ•°æ®å¦‚ä½•å¤„ç†</p><p>æ¶ˆè´¹è€…ä¸“å¿ƒå¤„ç†ç»“æœæ•°æ®</p><p>æ¶ˆæ¯é˜Ÿåˆ—æ˜¯ç”±å®¹é‡é™åˆ¶çš„ï¼Œæ»¡æ—¶ä¸ä¼šå†åŠ å…¥æ•°æ®ï¼Œç©ºæ—¶ä¸ä¼šå†æ¶ˆè€—æ•°æ®</p><p>jdkä¸­å„ç§é˜»å¡é˜Ÿåˆ—ï¼Œé‡‡ç”¨çš„å°±æ˜¯è¿™ç§æ¨¡å¼</p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201105202048.png"></p><p><strong>å‚è€ƒä»£ç </strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>study<span class="token punctuation">.</span>n8</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">LinkedList</span><span class="token punctuation">;</span><span class="token comment">/** * @author: Zhang Haoyu * @date: 2020/11/5 20:28 * @description: */</span><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">MessageQueue</span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MessageQueue</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> id <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>                queue<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Message</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">"å€¼"</span><span class="token operator">+</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"ç”Ÿäº§è€…"</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token class-name">Message</span> take <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"æ¶ˆè´¹æ¶ˆæ¯"</span><span class="token operator">+</span>take<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"æ¶ˆè´¹è€…"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Message</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> value<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"Message&#123;"</span> <span class="token operator">+</span>                <span class="token string">"id="</span> <span class="token operator">+</span> id <span class="token operator">+</span>                <span class="token string">", value='"</span> <span class="token operator">+</span> value <span class="token operator">+</span> <span class="token string">'\''</span> <span class="token operator">+</span>                <span class="token string">'&#125;'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> value<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> id<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">Message</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">class</span> <span class="token class-name">MessageQueue</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Message</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> capcity<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">MessageQueue</span><span class="token punctuation">(</span><span class="token keyword">int</span> capcity<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>capcity <span class="token operator">=</span> capcity<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// å–å‡ºæ¶ˆæ¯</span>    <span class="token keyword">public</span> <span class="token class-name">Message</span> <span class="token function">take</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>list<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"é˜Ÿåˆ—ä¸ºç©º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    list<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">// ä»é˜Ÿåˆ—å¤´éƒ¨å–</span>            <span class="token class-name">Message</span> message <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">removeFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"å·²ç»æ¶ˆè´¹æ¶ˆæ¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            list<span class="token punctuation">.</span><span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> message<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// å­˜å…¥æ¶ˆæ¯</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span>capcity<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"é˜Ÿåˆ—å·²æ»¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    list<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            list<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// å”¤é†’</span>            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"å·²ç»ç”Ÿäº§æ¶ˆæ¯"</span><span class="token operator">+</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>            list<span class="token punctuation">.</span><span class="token function">notifyAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>20:46:56.977 [ç”Ÿäº§è€…1] DEBUG com.study.n8.MessageQueue - å·²ç»ç”Ÿäº§æ¶ˆæ¯Message{id=1, value=â€™å€¼1â€™}<br>20:46:56.979 [ç”Ÿäº§è€…0] DEBUG com.study.n8.MessageQueue - å·²ç»ç”Ÿäº§æ¶ˆæ¯Message{id=0, value=â€™å€¼0â€™}<br>20:46:56.979 [ç”Ÿäº§è€…2] DEBUG com.study.n8.MessageQueue - é˜Ÿåˆ—å·²æ»¡<br>20:46:57.976 [æ¶ˆè´¹è€…] DEBUG com.study.n8.MessageQueue - å·²ç»æ¶ˆè´¹æ¶ˆæ¯<br>20:46:57.976 [æ¶ˆè´¹è€…] DEBUG com.study.n8.Test - æ¶ˆè´¹æ¶ˆæ¯Message{id=1, value=â€™å€¼1â€™}<br>20:46:57.976 [ç”Ÿäº§è€…2] DEBUG com.study.n8.MessageQueue - å·²ç»ç”Ÿäº§æ¶ˆæ¯Message{id=2, value=â€™å€¼2â€™}<br>20:46:58.976 [æ¶ˆè´¹è€…] DEBUG com.study.n8.MessageQueue - å·²ç»æ¶ˆè´¹æ¶ˆæ¯<br>20:46:58.976 [æ¶ˆè´¹è€…] DEBUG com.study.n8.Test - æ¶ˆè´¹æ¶ˆæ¯Message{id=0, value=â€™å€¼0â€™}<br>20:46:59.977 [æ¶ˆè´¹è€…] DEBUG com.study.n8.MessageQueue - å·²ç»æ¶ˆè´¹æ¶ˆæ¯<br>20:46:59.977 [æ¶ˆè´¹è€…] DEBUG com.study.n8.Test - æ¶ˆè´¹æ¶ˆæ¯Message{id=2, value=â€™å€¼2â€™}<br>20:47:00.977 [æ¶ˆè´¹è€…] DEBUG com.study.n8.MessageQueue - é˜Ÿåˆ—ä¸ºç©º</p></blockquote><h2 id="5-Parkå’ŒUnpark"><a href="#5-Parkå’ŒUnpark" class="headerlink" title="5.Parkå’ŒUnpark"></a>5.Parkå’ŒUnpark</h2><p><strong>åŸºæœ¬ä½¿ç”¨</strong></p><blockquote><p>æ˜¯å±äºLockSupportç±»ä¸­çš„æ–¹æ³•</p></blockquote><p>æš‚åœå½“å‰çº¿ç¨‹ï¼š<code>LockSupport.park()</code></p><p>æ¢å¤æŸä¸ªçº¿ç¨‹çš„è¿è¡Œï¼š<code>LockSupport.unpark(æš‚åœçº¿ç¨‹å¯¹è±¡)</code></p><p><strong>ç‰¹ç‚¹æ¯”è¾ƒ</strong></p><ul><li>waitå’ŒnotifyAllå¿…é¡»é…åˆObject Monitorä¸€èµ·ä½¿ç”¨ï¼Œè€Œunparkä¸å¿…</li><li>park&amp;unparkæ˜¯ä»¥çº¿ç¨‹ä¸ºå•ä½æ¥é˜»å¡å’Œå”¤é†’çº¿ç¨‹çš„ï¼Œç›¸å¯¹äºwaitå’ŒnotifyAllï¼Œè¿™ä¸ªæ›´åŠ ç²¾ç¡®</li><li>park&amp;unparkå¯ä»¥å…ˆunparkï¼Œè€Œwait&amp;notifyä¸èƒ½å…ˆnotify</li></ul><p><strong>åŸç†</strong></p><blockquote><p>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªParkerå¯¹è±¡ï¼Œç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š<strong>mutex</strong>ã€<strong>cond</strong>ã€<strong>counter</strong></p></blockquote><h2 id="çº¿ç¨‹çŠ¶æ€è½¬æ¢"><a href="#çº¿ç¨‹çŠ¶æ€è½¬æ¢" class="headerlink" title="çº¿ç¨‹çŠ¶æ€è½¬æ¢"></a>çº¿ç¨‹çŠ¶æ€è½¬æ¢</h2><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201105210741.png"></p><ol><li><p>NEWâ€”RUNNABLE</p><p><code>start()</code></p></li><li><p>RUNNABLEâ€”WAITING</p><blockquote><ul><li>çº¿ç¨‹ä½¿ç”¨synchronizedè·å–å¯¹è±¡é”åï¼Œ<ul><li>è°ƒç”¨wait()æ–¹æ³•è¿›å…¥WAITINGçŠ¶æ€</li><li>è°ƒç”¨notify()æˆ–è€…notifyAll()æˆ–è€…interrupt()æ–¹æ³•æ—¶<ul><li>ç«äº‰é”æˆåŠŸï¼Œè¿›å…¥RUNNABLEçŠ¶æ€</li><li>ç«äº‰é”å¤±è´¥ï¼Œè¿›å…¥BLOCKEDçŠ¶æ€</li></ul></li></ul></li></ul></blockquote></li><li><p>RUNNABLEâ€”WAITING</p><blockquote><p>å½“å‰çº¿ç¨‹è°ƒç”¨<code>t.join()</code>ï¼Œå½“å‰çº¿ç¨‹ä»RUNNABLEâ€”&gt;WAITING</p><ul><li>å½“å‰çº¿ç¨‹åœ¨tçº¿ç¨‹å¯¹è±¡çš„ç›‘è§†å™¨ä¸Šç­‰å¾…</li><li>tçº¿ç¨‹è¿è¡Œç»“æŸï¼Œæˆ–è°ƒç”¨äº†å½“å‰çº¿ç¨‹çš„interrupt()æ—¶ï¼Œå½“å‰çº¿ç¨‹ä»WAITINGâ€”&gt;RUNNABLE</li></ul></blockquote></li><li><p>RUNNABLEâ€”WAITING</p><blockquote><ul><li>å½“å‰çº¿ç¨‹è°ƒç”¨ LockSupport.park() æ–¹æ³•ä¼šè®©å½“å‰çº¿ç¨‹ä»RUNNABLEâ€“&gt;WAITING</li><li>è°ƒç”¨LockSupport.unpark(ç›®æ ‡çº¿ç¨‹)æˆ–è€…è°ƒç”¨äº†interrupt()ï¼Œä¼šè®©ç›®æ ‡çº¿ç¨‹ä»WAITINGâ€”&gt;RUNNABLE</li></ul></blockquote></li><li><p>RUNNABLEâ€”TIMED_WAITING</p><blockquote><p>çº¿ç¨‹ä½¿ç”¨synchronizedè·å–å¯¹è±¡é”å</p><ul><li>è°ƒç”¨ <code>t.wait(long n)</code>ã€‚tçº¿ç¨‹ä»RUNNABLEâ€“&gt;TIMED_WAITING</li><li>tçº¿ç¨‹ç­‰å¾…æ—¶é—´è¶…è¿‡äº†næ¯«ç§’ï¼Œæˆ–è€…è°ƒç”¨äº†notify()ï¼ŒnotifyAll()ï¼Œinterrupt()æ—¶<ul><li>ç«äº‰é”æˆåŠŸï¼Œtçº¿ç¨‹ä»TIMED_WAITING â€”&gt;RUNNABLE</li><li>ç«äº‰é”å¤±è´¥ï¼Œtçº¿ç¨‹ä»TIMED_WAITING â€”&gt;BLOCKED</li></ul></li></ul></blockquote></li><li><p>RUNNABLEâ€”TIMED_WAITING</p><blockquote><ul><li>å½“å‰çº¿ç¨‹è°ƒç”¨äº†t.join(n)æ–¹æ³•ï¼Œå½“å‰çº¿ç¨‹ä¼šè¿›å…¥TIMED_WAITINGçŠ¶æ€<ul><li>æ³¨æ„æ˜¯ <strong>å½“å‰çº¿ç¨‹</strong>åœ¨<strong>tçº¿ç¨‹å¯¹è±¡çš„ç›‘è§†å™¨</strong>ä¸Šçš„ç­‰å¾…</li></ul></li><li><strong>å½“å‰çº¿ç¨‹</strong>ç­‰å¾…æ—¶é—´è¶…è¿‡næ¯«ç§’ï¼Œæˆ–è€…tçº¿ç¨‹è¿è¡Œç»“æŸï¼Œæˆ–è€…è°ƒç”¨äº†å½“å‰çº¿ç¨‹çš„interrupt()æ—¶ï¼Œ<strong>å½“å‰çº¿ç¨‹</strong>ä¼šä»TIMED_WAITING â€”&gt;RUNNABLE</li></ul></blockquote></li><li><p>RUNNABLEâ€”TIMED_WAITING</p><blockquote><ul><li>å½“å‰çº¿ç¨‹è°ƒç”¨Thread.sleep(long n)ï¼Œå½“å‰çº¿ç¨‹ä¼šè¿›å…¥TIMED_WAITINGçŠ¶æ€</li><li>å½“å‰çº¿ç¨‹ç­‰å¾…æ—¶é—´è¶…è¿‡äº†næ¯«ç§’ï¼Œå½“å‰çº¿ç¨‹ä»TIMED_WAITING â€”&gt;RUNNABLE</li></ul></blockquote></li><li><p>RUNNABLE â€” TIMED_WAITING</p><blockquote><p>å½“å‰çº¿ç¨‹è°ƒç”¨äº† LockSupport.parkNanos(long nanos)æˆ–è€…LockSupport.parkUntil(long millis)æ—¶ï¼Œå½“å‰çº¿ç¨‹ä»RUNNABLEã€€â€”&gt;TIMED_WAITING</p><p> è°ƒç”¨LockSupport.unpark(ç›®æ ‡çº¿ç¨‹)æˆ–è€…è°ƒç”¨äº†çº¿ç¨‹çš„interrupt()ï¼Œæˆ–è€…ç­‰å¾…è¶…æ—¶ï¼Œä¼šè®©ç›®æ ‡çº¿ç¨‹ä»TIMED_WAITINGçŠ¶æ€è¿›å…¥RUNNABLEçŠ¶æ€</p></blockquote></li><li><p>RUNNABLE â€” BLOCKED</p><blockquote><ul><li><strong>çº¿ç¨‹</strong>ç”¨synchronizedè·å–å¯¹è±¡é”å¦‚æœç«äº‰å¤±è´¥ï¼Œä¼šè¿›å…¥entryListä¸­ï¼Œè¿›å…¥BLOCKEDçŠ¶æ€</li><li>æŒæœ‰objé”çº¿ç¨‹çš„åŒæ­¥ä»£ç å—æ‰§è¡Œå®Œæ¯•ï¼Œä¼šå”¤é†’è¯¥å¯¹è±¡ä¸Šæ‰€æœ‰BLOCKEDçš„çº¿ç¨‹é‡æ–°ç«äº‰ï¼Œå¦‚æœå…¶ä¸­tçº¿ç¨‹ç«äº‰æˆåŠŸï¼Œä¼šä»BLOCKEDçŠ¶æ€å˜ä¸ºRUNNABLEï¼Œå…¶ä»–å¤±è´¥çš„ä»ç„¶ä¼šæ˜¯BLOCKEDçŠ¶æ€</li></ul></blockquote></li><li><p>RUNNABLE â€” TERMINATED</p><blockquote><p>å½“çº¿ç¨‹çš„æ‰€æœ‰ä»£ç è¿è¡Œå®Œæ¯•ï¼Œä¼šè¿›å…¥TERMINATEDçŠ¶æ€</p></blockquote></li></ol><h2 id="6-ReentrantLock"><a href="#6-ReentrantLock" class="headerlink" title="6. ReentrantLock"></a>6. ReentrantLock</h2><blockquote><p>ç›¸å¯¹äºsynchronizedå®ƒå…·å¤‡çš„ç‰¹ç‚¹æ˜¯:</p><ul><li>å¯ä¸­æ–­</li><li>å¯ä»¥è®¾ç½®è¶…æ—¶æ—¶é—´</li><li>å¯ä»¥è®¾ç½®ä¸ºå…¬å¹³é”</li><li>æ”¯æŒå¤šä¸ªæ¡ä»¶å˜é‡</li></ul><p>ä¸synchronizedä¸€æ ·æ”¯æŒå¯é‡å…¥</p></blockquote><p>åŸºæœ¬è¯­æ³•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ReentrantLock</span> reentrantLock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// åŠ é”</span>reentrantLock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// ä¸´ç•ŒåŒº</span><span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// é‡Šæ”¾é”</span>    reentrantLock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å¯é‡å…¥"><a href="#å¯é‡å…¥" class="headerlink" title="å¯é‡å…¥"></a>å¯é‡å…¥</h3><blockquote><p>å¯é‡å…¥æ˜¯æŒ‡åŒä¸€ä¸ªçº¿ç¨‹å¦‚æœé¦–æ¬¡è·å¾—äº†è¿™æŠŠé”ï¼Œé‚£ä¹ˆå› ä¸ºå®ƒæ˜¯è¿™æŠŠé”çš„æ‹¥æœ‰è€…ï¼Œå› æ­¤æœ‰æƒåˆ©å†æ¬¡è·å–è¿™æŠŠé”ï¼Œå¦‚æœæ˜¯ä¸å¯é‡å…¥é”ï¼Œé‚£ä¹ˆç¬¬äºŒæ¬¡è·å¾—é”æ—¶ï¼Œè‡ªå·±ä¹Ÿä¼šè¢«é”æŒ¡ä½</p></blockquote><h3 id="å¯æ‰“æ–­"><a href="#å¯æ‰“æ–­" class="headerlink" title="å¯æ‰“æ–­"></a>å¯æ‰“æ–­</h3><blockquote><p>åœ¨ç­‰å¾…é”çš„è¿‡ç¨‹ä¸­ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥ä½¿ç”¨interrupt()æ¥æ‰“æ–­ï¼Œ<strong>ä½¿ç”¨<code>lock.inteeruptibly()</code>ä¸ºå¯æ‰“æ–­ï¼Œï¼ŒåŸå…ˆçš„<code>lock.lock()</code>ä¸ºä¸å¯æ‰“æ–­</strong></p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ReentrantLock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Thread</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"å¯åŠ¨..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">try</span> <span class="token punctuation">&#123;</span> lock<span class="token punctuation">.</span><span class="token function">lockInterruptibly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//å°è¯•è·å¾—é”</span> <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// å¦‚æœè¢«æ‰“æ–­ä¼šæŠ›å¼‚å¸¸ï¼Œè¿›è€Œé€€å‡º</span> e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"ç­‰é”çš„è¿‡ç¨‹ä¸­è¢«æ‰“æ–­"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">try</span> <span class="token punctuation">&#123;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"è·å¾—äº†é”"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span> lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">"t1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//å…ˆç”¨ä¸»çº¿ç¨‹è·å¾—é”</span>log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"è·å¾—äº†é”"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>t1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯åŠ¨t1çº¿ç¨‹ï¼Œè¿™æ—¶å€™t1è·å¾—ä¸äº†æ‰€</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t1<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ä¸»çº¿ç¨‹ä¸­æ‰“æ–­t1çº¿ç¨‹</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"æ‰§è¡Œæ‰“æ–­"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span> lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="é”è¶…æ—¶"><a href="#é”è¶…æ—¶" class="headerlink" title="é”è¶…æ—¶"></a>é”è¶…æ—¶</h3><blockquote><p>ä½¿ç”¨ <code>tryLock()</code> æ–¹æ³•æ¥å°è¯•è·å¾—é”</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ReentrantLock</span> lock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Thread</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"å¯åŠ¨..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>lock<span class="token punctuation">.</span><span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"è·å–ç«‹åˆ»å¤±è´¥ï¼Œè¿”å›"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">try</span> <span class="token punctuation">&#123;</span> log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"è·å¾—äº†é”"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span> lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token string">"t1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>lock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"è·å¾—äº†é”"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Thread</span> t1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"å°è¯•è·å–é”"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// å®šä¹‰ç­‰å¾…æœ€å¤š1ç§’ï¼Œå¦‚æœè¿˜æ˜¯è·å–ä¸åˆ°ï¼Œå°±ç»“æŸï¼Œï¼Œè¯¥æ–¹æ³•å¯ä»¥è¢«æ‰“æ–­</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>lock<span class="token punctuation">.</span><span class="token function">tryLock</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"è·å–ä¸åˆ°é”"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// å…¶ä»–çº¿ç¨‹è°ƒç”¨interruptæ–¹æ³•æ‰“æ–­</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"è·å–åˆ°é”äº†"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>        lock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"t1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>t1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å…¬å¹³é”"><a href="#å…¬å¹³é”" class="headerlink" title="å…¬å¹³é”"></a>å…¬å¹³é”</h3><blockquote><p>é»˜è®¤æ˜¯ä¸å…¬å¹³çš„é”ï¼Œé€šè¿‡æ„é€ æ–¹æ³•å¯ä»¥æ§åˆ¶</p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201107155721.png"></p><p>æ›´å®¹æ˜“å…ˆè¿›å…ˆå¾—ï¼Œä½†æ˜¯æ²¡å¿…è¦ï¼Œ<strong>ä¼šé™ä½å¹¶å‘åº¦</strong></p><h3 id="æ¡ä»¶å˜é‡"><a href="#æ¡ä»¶å˜é‡" class="headerlink" title="æ¡ä»¶å˜é‡"></a>æ¡ä»¶å˜é‡</h3><blockquote><p>synchronizedä¸­ä¹Ÿæœ‰æ¡ä»¶å˜é‡ï¼Œå°±æ˜¯å½“ æ¡ä»¶ä¸æ»¡è¶³çš„æ—¶å€™ï¼Œä¼šè¿›å…¥waitSetç­‰å¾…</p><p>ReentrantLockçš„æ¡ä»¶å˜é‡å¼ºå¤§ä¹‹å¤„åœ¨äº<strong>å®ƒæ”¯æŒå¤šä¸ªæ¡ä»¶å˜é‡</strong></p></blockquote><p><strong>ä½¿ç”¨æµç¨‹</strong></p><ul><li>await å‰éœ€è¦è·å¾—é”</li><li>awaitæ‰§è¡Œåï¼Œä¼šé‡Šæ”¾é”ï¼Œè¿›å…¥conditionObjectç­‰å¾…</li><li>awaitçš„çº¿ç¨‹è¢«å”¤é†’ï¼ˆæˆ–æ‰“æ–­ï¼Œæˆ–è¶…æ—¶ï¼‰å»é‡æ–°ç«äº‰locké”</li><li>ç«äº‰locké”æˆåŠŸåï¼Œä»awaitåç»§ç»­æ‰§è¡Œ</li></ul><h3 id="æ¨¡å¼â€”â€”é¡ºåºæ§åˆ¶"><a href="#æ¨¡å¼â€”â€”é¡ºåºæ§åˆ¶" class="headerlink" title="æ¨¡å¼â€”â€”é¡ºåºæ§åˆ¶"></a>æ¨¡å¼â€”â€”é¡ºåºæ§åˆ¶</h3><p><strong>å›ºå®šè¿è¡Œé¡ºåº</strong></p><p>synchronized+wait+notifyï¼ˆnotifyAllï¼‰</p><p>ReentrantLock+condition+await+signalï¼ˆsignalAllï¼‰</p><p>LockSupport+park+unpark</p><h2 id="7-å…±äº«æ¨¡å‹ä¹‹å†…å­˜"><a href="#7-å…±äº«æ¨¡å‹ä¹‹å†…å­˜" class="headerlink" title="7. å…±äº«æ¨¡å‹ä¹‹å†…å­˜"></a>7. å…±äº«æ¨¡å‹ä¹‹å†…å­˜</h2><blockquote><p>å…±äº«å˜é‡åœ¨å¤šçº¿ç¨‹é—´çš„ã€å¯è§æ€§ã€‘é—®é¢˜ä¸å¤šæ¡æŒ‡ä»¤æ‰§è¡Œæ—¶çš„ã€æœ‰åºæ€§ã€‘é—®é¢˜</p></blockquote><h3 id="javaå†…å­˜æ¨¡å‹"><a href="#javaå†…å­˜æ¨¡å‹" class="headerlink" title="javaå†…å­˜æ¨¡å‹"></a>javaå†…å­˜æ¨¡å‹</h3><blockquote><p>JMMå³ï¼ˆjava memory modelï¼‰ï¼Œå®ƒå®šä¹‰äº†ä¸»å­˜ï¼Œå·¥ä½œå†…å­˜æŠ½è±¡æ¦‚å¿µï¼Œåº•å±‚å¯¹åº”ç€CPUå¯„å­˜å™¨ï¼Œç¼“å­˜ï¼Œç¡¬ä»¶å†…å­˜ï¼ŒCPUæŒ‡ä»¤ä¼˜åŒ–ç­‰</p></blockquote><p>JMMä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢</p><ul><li>åŸå­æ€§==ä¿è¯æŒ‡ä»¤ä¸ä¼šå—åˆ°çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å½±å“</li><li>å¯è§æ€§==ä¿è¯æŒ‡ä»¤ä¸ä¼šå—CPUç¼“å­˜çš„å½±å“</li><li>æœ‰åºæ€§==ä¿è¯æŒ‡ä»¤ä¸ä¼šå—CPUæŒ‡ä»¤å¹¶è¡Œä¼˜åŒ–çš„å½±å“</li></ul><h3 id="å¯è§æ€§"><a href="#å¯è§æ€§" class="headerlink" title="å¯è§æ€§"></a>å¯è§æ€§</h3><p><strong>é€€ä¸å‡ºå»çš„å¾ªç¯</strong></p><p>å…ˆæ¥çœ‹ä¸€ä¸ªç°è±¡ï¼Œmain çº¿ç¨‹å¯¹ run å˜é‡çš„ä¿®æ”¹å¯¹äº t çº¿ç¨‹ä¸å¯è§ï¼Œå¯¼è‡´äº† t çº¿ç¨‹æ— æ³•åœæ­¢ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">boolean</span> run <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">&#123;</span> <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span> <span class="token keyword">while</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token comment">// ....</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> run <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// çº¿ç¨‹tä¸ä¼šå¦‚é¢„æƒ³çš„åœä¸‹æ¥</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>åˆå§‹çŠ¶æ€ä¸‹ï¼Œtçº¿ç¨‹åˆšå¼€å§‹ä»ä¸»å†…å­˜ä¸­è¯»å–äº†runçš„å€¼åˆ°å·¥ä½œå†…å­˜</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201107204134.png"></p></li><li><p>å› ä¸º t çº¿ç¨‹è¦é¢‘ç¹ä»ä¸»å†…å­˜ä¸­è¯»å– run çš„å€¼ï¼Œ<strong>JIT ç¼–è¯‘å™¨ä¼šå°† run çš„å€¼ç¼“å­˜è‡³è‡ªå·±å·¥ä½œå†…å­˜ä¸­çš„é«˜é€Ÿç¼“å­˜ä¸­ï¼Œå‡å°‘å¯¹ä¸»å­˜ä¸­ run çš„è®¿é—®ï¼Œæé«˜æ•ˆç‡</strong></p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201107204229.png"></p></li><li><p>1 ç§’ä¹‹åï¼Œmain çº¿ç¨‹ä¿®æ”¹äº† run çš„å€¼ï¼Œå¹¶åŒæ­¥è‡³ä¸»å­˜ï¼Œ<strong>è€Œ t æ˜¯ä»è‡ªå·±å·¥ä½œå†…å­˜ä¸­çš„é«˜é€Ÿç¼“å­˜ä¸­è¯»å–è¿™ä¸ªå˜é‡</strong></p><p><strong>çš„å€¼</strong>ï¼Œç»“æœæ°¸è¿œæ˜¯æ—§å€¼</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201107204324.png"></p></li></ul><p><strong>è§£å†³åŠæ³•ï¼švolatileå…³é”®å­—</strong></p><blockquote><p>å®ƒå¯ä»¥ç”¨æ¥ä¿®é¥°æˆå‘˜å˜é‡å’Œé™æ€æˆå‘˜å˜é‡ï¼Œä»–å¯ä»¥<strong>é¿å…çº¿ç¨‹ä»è‡ªå·±çš„å·¥ä½œç¼“å­˜ä¸­æŸ¥æ‰¾å˜é‡çš„å€¼ï¼Œå¿…é¡»åˆ°ä¸»å­˜ä¸­è·å–å®ƒçš„å€¼</strong>ï¼Œçº¿ç¨‹æ“ä½œ volatile å˜é‡éƒ½æ˜¯ç›´æ¥æ“ä½œä¸»å­˜</p></blockquote><hr><h3 id="å¯è§æ€§-vs-åŸå­æ€§"><a href="#å¯è§æ€§-vs-åŸå­æ€§" class="headerlink" title="å¯è§æ€§ vs åŸå­æ€§"></a>å¯è§æ€§ vs åŸå­æ€§</h3><blockquote><p>ä¸€ä¸ªçº¿ç¨‹å¯¹volatileå˜é‡çš„ä¿®æ”¹å¯¹å¦ä¸€ä¸ªçº¿ç¨‹å¯è§ï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯åŸå­æ€§ï¼Œ<strong>ä»…ç”¨åœ¨ä¸€ä¸ªå†™çº¿ç¨‹ï¼Œå¤šä¸ªè¯»çº¿ç¨‹çš„æƒ…å†µä¸‹</strong></p></blockquote><p>æ‰€ä»¥ç”¨volatileå»å¤„ç†åŸå­æ€§é—®é¢˜æ˜¯ä¸æ­£ç¡®çš„ï¼ï¼ï¼ï¼</p><p><strong>æ³¨æ„çš„ä¸€ç‚¹ï¼š</strong></p><p>synchronized æ—¢å¯ä»¥ä¿è¯åŸå­æ€§ï¼Œåˆå¯ä»¥ä¿è¯å¯è§æ€§ï¼Œä½†æ˜¯ç¼ºç‚¹æ˜¯synchronizedå±äºé‡é‡çº§æ“ä½œï¼Œæ€§èƒ½ç›¸å¯¹æ›´ä½ã€‚</p><hr><h3 id="æ¨¡å¼â€”â€”ä¸¤é˜¶æ®µç»ˆæ­¢æ¨¡å¼"><a href="#æ¨¡å¼â€”â€”ä¸¤é˜¶æ®µç»ˆæ­¢æ¨¡å¼" class="headerlink" title="æ¨¡å¼â€”â€”ä¸¤é˜¶æ®µç»ˆæ­¢æ¨¡å¼"></a>æ¨¡å¼â€”â€”ä¸¤é˜¶æ®µç»ˆæ­¢æ¨¡å¼</h3><blockquote><p>ç”¨volatile é‡å†™è¿™ä¸ªæ¨¡å¼</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * TODO: æ›´æ”¹ä¸¤é˜¶æ®µç»ˆæ­¢æ¨¡å¼===volatile *           * @author Zhang Hao yu * @date 2020/11/8 14:32 */</span><span class="token annotation punctuation">@Slf4j</span><span class="token punctuation">(</span>topic <span class="token operator">=</span> <span class="token string">"c.TwoPhaseTermination"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TwoPhaseTermination</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**ç›‘æ§çº¿ç¨‹*/</span>    <span class="token keyword">private</span> <span class="token class-name">Thread</span> monitorThread<span class="token punctuation">;</span>    <span class="token comment">/**ç”¨äºæ§åˆ¶çº¿ç¨‹ç»§ç»­å·¥ä½œ*/</span>    <span class="token keyword">volatile</span> <span class="token keyword">private</span> <span class="token keyword">boolean</span> stop <span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token comment">/** TODO: åœæ­¢ç›‘æ§çº¿ç¨‹     * @author ZhangHaoyu     * @return void     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// è®¾ç½®åœæ­¢æ ‡è®°ä¸ºçœŸ</span>        stop <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        monitorThread<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/** TODO: å¯åŠ¨ç›‘æ§çº¿ç¨‹     * @author ZhangHaoyu     * @return void     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        monitorThread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token class-name">Thread</span> current <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>stop<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"æ‰§è¡Œå…³é—­èµ„æºç­‰æ“ä½œ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"æ‰§è¡Œç›‘æ§è®°å½•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"æ‰“æ–­çº¿ç¨‹æ‰§è¡Œçš„æ“ä½œ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"monitor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        monitorThread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ç¼ºç‚¹</strong></p><p>å½“å¤šä¸ªçº¿ç¨‹æˆ–æœ¬çº¿ç¨‹åŒæ—¶åšäº†startæ“ä½œçš„æ—¶å€™ï¼Œä¼šåˆ›å»ºå¤šä¸ªçº¿ç¨‹ï¼Œè¿™å¾ˆæµªè´¹ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªå°±å¤Ÿäº†ã€‚</p><hr><h3 id="æ¨¡å¼â€”â€”Balkingï¼ˆçŠ¹è±«ï¼‰"><a href="#æ¨¡å¼â€”â€”Balkingï¼ˆçŠ¹è±«ï¼‰" class="headerlink" title="æ¨¡å¼â€”â€”Balkingï¼ˆçŠ¹è±«ï¼‰"></a>æ¨¡å¼â€”â€”Balkingï¼ˆçŠ¹è±«ï¼‰</h3><blockquote><p>çŠ¹è±«æ¨¡å¼åœ¨ä¸€ä¸ªçº¿ç¨‹å‘ç°å¦ä¸€ä¸ªçº¿ç¨‹æˆ–æœ¬åœ°çº¿ç¨‹åšäº†æŸä¸€ä»¶ç›¸åŒçš„äº‹æƒ…ï¼Œé‚£ä¹ˆæœ¬åœ°çº¿ç¨‹å°±æ— éœ€å†åšäº†ï¼Œç›´æ¥ç»“æŸè¿”å›</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>study<span class="token punctuation">.</span>n9</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span><span class="token punctuation">;</span><span class="token comment">/** * TODO: æ›´æ”¹ä¸¤é˜¶æ®µç»ˆæ­¢æ¨¡å¼===volatile * * @author Zhang Hao yu * @date 2020/11/8 14:32 */</span><span class="token annotation punctuation">@Slf4j</span><span class="token punctuation">(</span>topic <span class="token operator">=</span> <span class="token string">"c.TwoPhaseTermination"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TwoPhaseTermination</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**ç›‘æ§çº¿ç¨‹*/</span>    <span class="token keyword">private</span> <span class="token class-name">Thread</span> monitorThread<span class="token punctuation">;</span>    <span class="token comment">/**ç”¨äºæ§åˆ¶çº¿ç¨‹ç»§ç»­å·¥ä½œ*/</span>    <span class="token keyword">volatile</span> <span class="token keyword">private</span> <span class="token keyword">boolean</span> stop <span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token comment">/**çŠ¹è±«æ¨¡å¼ï¼šåˆ¤æ–­æ˜¯å¦æ‰§è¡Œè¿‡startæ–¹æ³•ï¼Œå¦‚æœæ‰§è¡Œè¿‡ï¼Œå°±ä¸è®©ä»–å†æ¬¡æ‰§è¡Œäº†*/</span>    <span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token keyword">boolean</span> starting <span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token comment">/** TODO: åœæ­¢ç›‘æ§çº¿ç¨‹     * @author ZhangHaoyu     * @return void     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// è®¾ç½®åœæ­¢æ ‡è®°ä¸ºçœŸ</span>        stop <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        monitorThread<span class="token punctuation">.</span><span class="token function">interrupt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/** TODO: å¯åŠ¨ç›‘æ§çº¿ç¨‹     * @author ZhangHaoyu     * @return void     */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">/*         è¿™é‡Œç”¨åŒé‡ifæ¥å‡å°‘çº¿ç¨‹è·å–é”çš„é¢‘ç‡         */</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>starting<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>starting<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">return</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">// è®¾ç½®å¯åŠ¨æ ‡è®°ä¸ºæ­£åœ¨æ‰§è¡Œ</span>            starting <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        monitorThread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token class-name">Thread</span> current <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>stop<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"æ‰§è¡Œå…³é—­èµ„æºç­‰æ“ä½œ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    starting <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"æ‰§è¡Œç›‘æ§è®°å½•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"æ‰“æ–­çº¿ç¨‹æ‰§è¡Œçš„æ“ä½œ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token string">"monitor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        monitorThread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨è¿™é‡Œæˆ‘ä»¬é€šè¿‡çŠ¹è±«æ¨¡å¼ï¼Œå¯ä»¥è§£å†³è¿™ç±»é—®é¢˜ã€‚</p><hr><p><strong>åº”ç”¨åœºæ™¯</strong></p><p>ä¸€èˆ¬æˆ‘ä»¬æŠŠè¿™ä¸ªæ¨¡å¼è¿ç”¨åœ¨webç¯å¢ƒä¸‹ï¼Œå½“å‰ç«¯å‘è¿‡æ¥å¤šä¸ªè¯·æ±‚ï¼Œtomcatå°±éœ€è¦å»çº¿ç¨‹æ± ä¸­ä½¿ç”¨çº¿ç¨‹å»å¤„ç†ï¼Œæˆ‘ä»¬å°±éœ€è¦è€ƒè™‘åˆ°synchronizedçš„é—®é¢˜äº†ã€‚å½“å‰ç«¯é¡µé¢å¤šæ¬¡ç‚¹å‡»æŒ‰é’®è°ƒç”¨ start æ—¶ï¼Œåº”è¯¥åˆ¤æ–­ç›‘æ§çº¿ç¨‹æ˜¯å¦å·²ç»å¯åŠ¨ã€‚</p><p>å®ƒè¿˜ç»å¸¸ç”¨æ¥å®ç°çº¿ç¨‹å®‰å…¨çš„å•ä¾‹</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token punctuation">&#125;</span>     <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> INSTANCE <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span>INSTANCE <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>      INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å¯¹æ¯”ä¿æŠ¤æ€§æš‚åœæ¨¡å¼</strong>ï¼šä¿æŠ¤æ€§æš‚åœæ¨¡å¼ç”¨åœ¨ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹çš„æ‰§è¡Œç»“æœï¼Œå½“æ¡ä»¶ä¸æ»¡è¶³æ—¶çº¿ç¨‹ç­‰å¾…ã€‚</p><hr><h3 id="æœ‰åºæ€§"><a href="#æœ‰åºæ€§" class="headerlink" title="æœ‰åºæ€§"></a>æœ‰åºæ€§</h3><blockquote><p>JVMä¼šåœ¨ä¸å½±å“æ­£ç¡®æ€§çš„å‰æä¸‹ï¼Œè°ƒæ•´è¯­å¥çš„æ‰§è¡Œé¡ºåº</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span><span class="token keyword">static</span> <span class="token keyword">int</span> j<span class="token punctuation">;</span>i <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>j <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>å¯ä»¥æ˜¯å…ˆç»™ i èµ‹å€¼ï¼Œå†ç»™ j èµ‹å€¼    ä¹Ÿå¯ä»¥æ˜¯å…ˆç»™ j èµ‹å€¼ï¼Œå†ç»™ i èµ‹å€¼ï¼›<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>iå’Œjçš„èµ‹å€¼æ“ä½œé¡ºåºï¼Œå¯¹äºå•çº¿ç¨‹æ¥è¯´ï¼Œå¯¹æœ€ç»ˆçš„ç»“æœæ˜¯ä¸ä¼šäº§ç”Ÿå½±å“çš„ï¼Œè¿™ç§ç‰¹æ€§å°±å«åšã€<strong>æŒ‡ä»¤é‡æ’</strong>ã€‘</p><blockquote><p>ä¸ºä½•è¦è¿™ä¹ˆåšï¼ŸæŒ‡ä»¤é‡æ’çš„ä¼˜åŒ–</p></blockquote><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201108155042.png" alt="å‚è€ƒé»‘é©¬çš„ä¾‹å­"></p><p><strong>ä¼˜åŒ–</strong></p><p>äº‹å®ä¸Šï¼Œç°ä»£å¤„ç†å™¨ä¼šè®¾è®¡ä¸ºä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå®Œæˆä¸€æ¡æ‰§è¡Œæ—¶é—´æœ€é•¿çš„ CPU æŒ‡ä»¤ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆåšå‘¢ï¼Ÿå¯ä»¥æƒ³åˆ°æŒ‡ä»¤è¿˜å¯ä»¥å†åˆ’åˆ†æˆä¸€ä¸ªä¸ªæ›´å°çš„é˜¶æ®µï¼Œä¾‹å¦‚ï¼Œæ¯æ¡æŒ‡ä»¤éƒ½å¯ä»¥åˆ†ä¸ºï¼š <strong>å–æŒ‡ä»¤</strong> - <strong>æŒ‡ä»¤è¯‘ç </strong> - <strong>æ‰§è¡ŒæŒ‡ä»¤</strong> - <strong>å†…å­˜è®¿é—®</strong> - <strong>æ•°æ®å†™å›</strong> è¿™ 5 ä¸ªé˜¶æ®µ</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201108155248.png"></p><blockquote><p><strong>æœ¯è¯­å‚è€ƒï¼š</strong></p><ul><li>instruction fetch (IF)</li><li>instruction decode (ID)</li><li>execute (EX)</li><li>memory access (MEM)</li><li>register write back (WB)</li></ul></blockquote><p>åœ¨ä¸æ”¹å˜ç¨‹åºç»“æœçš„å‰æä¸‹ï¼Œè¿™äº›æŒ‡ä»¤çš„å„ä¸ªé˜¶æ®µå¯ä»¥é€šè¿‡<strong>é‡æ’åº</strong>å’Œ<strong>ç»„åˆ</strong>æ¥å®ç°<strong>æŒ‡ä»¤çº§å¹¶è¡Œ</strong>ï¼Œè¿™ä¸€æŠ€æœ¯åœ¨ 80å¹´ä»£ä¸­å¶åˆ° 90å¹´ä»£ä¸­å¶å æ®äº†è®¡ç®—æ¶æ„çš„é‡è¦åœ°ä½ã€‚</p><blockquote><p>æç¤ºï¼š</p><p>åˆ†é˜¶æ®µï¼Œåˆ†å·¥æ˜¯æå‡æ•ˆç‡çš„å…³é”®ï¼</p></blockquote><p>æŒ‡ä»¤é‡æ’çš„å‰æå°±æ˜¯<strong>é‡æ’çš„æŒ‡ä»¤ä¸å½±å“ç»“æœ</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// å¯ä»¥é‡æ’çš„ä¾‹å­</span><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// æŒ‡ä»¤1</span><span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token comment">// æŒ‡ä»¤2</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span> a <span class="token operator">+</span> b <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä¸èƒ½é‡æ’çš„ä¾‹å­</span><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// æŒ‡ä»¤1</span><span class="token keyword">int</span> b <span class="token operator">=</span> a <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// æŒ‡ä»¤2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h4 id="ä¸€ç§æƒ…å†µ"><a href="#ä¸€ç§æƒ…å†µ" class="headerlink" title="ä¸€ç§æƒ…å†µ"></a>ä¸€ç§æƒ…å†µ</h4><p><strong>è¯¡å¼‚çš„ç»“æœ</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">boolean</span> ready <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token comment">// çº¿ç¨‹1 æ‰§è¡Œæ­¤æ–¹æ³•</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">actor1</span><span class="token punctuation">(</span><span class="token class-name">I_Result</span> r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">if</span><span class="token punctuation">(</span>ready<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> r<span class="token punctuation">.</span>r1 <span class="token operator">=</span> num <span class="token operator">+</span> num<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> r<span class="token punctuation">.</span>r1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// çº¿ç¨‹2 æ‰§è¡Œæ­¤æ–¹æ³•</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">actor2</span><span class="token punctuation">(</span><span class="token class-name">I_Result</span> r<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  num <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> ready <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>I_Result æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæœ‰ä¸€ä¸ªå±æ€§ r1 ç”¨æ¥ä¿å­˜ç»“æœï¼Œé—®ï¼Œå¯èƒ½çš„ç»“æœæœ‰å‡ ç§ï¼Ÿ</p><p>æœ‰åŒå­¦è¿™ä¹ˆåˆ†æ</p><p>æƒ…å†µ1ï¼šçº¿ç¨‹1 å…ˆæ‰§è¡Œï¼Œè¿™æ—¶ ready = falseï¼Œæ‰€ä»¥è¿›å…¥ else åˆ†æ”¯ç»“æœä¸º 1</p><p>æƒ…å†µ2ï¼šçº¿ç¨‹2 å…ˆæ‰§è¡Œ num = 2ï¼Œä½†æ²¡æ¥å¾—åŠæ‰§è¡Œ ready = trueï¼Œçº¿ç¨‹1 æ‰§è¡Œï¼Œè¿˜æ˜¯è¿›å…¥ else åˆ†æ”¯ï¼Œç»“æœä¸º1</p><p>æƒ…å†µ3ï¼šçº¿ç¨‹2 æ‰§è¡Œåˆ° ready = trueï¼Œçº¿ç¨‹1 æ‰§è¡Œï¼Œè¿™å›è¿›å…¥ if åˆ†æ”¯ï¼Œç»“æœä¸º 4ï¼ˆå› ä¸º num å·²ç»æ‰§è¡Œè¿‡äº†ï¼‰</p><p><strong>æƒ…å†µ4</strong>ï¼šç»“æœè¿˜æœ‰å¯èƒ½æ˜¯ 0 ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p><p>è¿™ç§æƒ…å†µä¸‹æ˜¯ï¼šçº¿ç¨‹2 æ‰§è¡Œ ready = trueï¼Œåˆ‡æ¢åˆ°çº¿ç¨‹1ï¼Œè¿›å…¥ if åˆ†æ”¯ï¼Œç›¸åŠ ä¸º 0ï¼Œå†åˆ‡å›çº¿ç¨‹2 æ‰§è¡Œ num = 2</p><p><strong>è¿™ç§ç°è±¡å°±å«åšæŒ‡ä»¤é‡æ’</strong>ï¼Œæ˜¯ JIT ç¼–è¯‘å™¨åœ¨è¿è¡Œæ—¶çš„ä¸€äº›ä¼˜åŒ–ï¼Œè¿™ä¸ªç°è±¡éœ€è¦é€šè¿‡å¤§é‡æµ‹è¯•æ‰èƒ½å¤ç°ã€‚</p><blockquote><p>è§£å†³åŠæ³•ï¼š</p><p>åœ¨readyå˜é‡å‰åŠ ä¸Švolatileå…³é”®å­—</p><p><strong>å› ä¸ºvolatile å¯ä»¥é˜²æ­¢åœ¨ä»–ä¹‹å‰çš„ä»£ç è¢«æŒ‡ä»¤é‡æ’ï¼</strong></p></blockquote><hr><h3 id="volatile-åŸç†"><a href="#volatile-åŸç†" class="headerlink" title="volatile åŸç†"></a>volatile åŸç†</h3><p>volatileçš„åº•å±‚å®ç°åŸç†æ˜¯å†…å­˜å±éšœï¼ŒMemory Barrierï¼ˆMemory Fenceï¼‰</p><ul><li>å¯¹volatileå˜é‡çš„å†™æŒ‡ä»¤åä¼šåŠ å…¥<strong>å†™å±éšœ</strong></li><li>å¯¹volatileå˜é‡çš„è¯»æŒ‡ä»¤å‰ä¼šåŠ å…¥<strong>è¯»å±éšœ</strong></li></ul><h4 id="å¦‚ä½•ä¿è¯å¯è§æ€§ï¼Ÿ"><a href="#å¦‚ä½•ä¿è¯å¯è§æ€§ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä¿è¯å¯è§æ€§ï¼Ÿ"></a>å¦‚ä½•ä¿è¯å¯è§æ€§ï¼Ÿ</h4><ul><li><p>å†™å±éšœã€sfenceã€‘ä¿è¯<strong>åœ¨è¯¥å±éšœä¹‹å‰çš„ï¼Œå¯¹å…±äº«å˜é‡çš„æ”¹åŠ¨ï¼Œéƒ½åŒæ­¥åˆ°ä¸»å­˜å½“ä¸­</strong></p></li><li><pre><code class="java">public void actor2(I_Result r) &#123; num = 2; ready = true; // ready æ˜¯ volatile èµ‹å€¼å¸¦å†™å±éšœ // å†™å±éšœ&#125;<pre class="line-numbers language-none"><code class="language-none">- è¯»å±éšœã€lfenceã€‘ä¿è¯**åœ¨è¯¥å±éšœä¹‹åï¼Œå¯¹å…±äº«å˜é‡çš„è¯»å–ï¼ŒåŠ è½½çš„æ˜¯ä¸»å­˜ä¸­æœ€æ–°æ•°æ®**- &#96;&#96;&#96;java  public void actor1(I_Result r) &#123;   &#x2F;&#x2F; è¯»å±éšœ   &#x2F;&#x2F; ready æ˜¯ volatile è¯»å–å€¼å¸¦è¯»å±éšœ   if(ready) &#123;   r.r1 &#x3D; num + num;   &#125; else &#123;   r.r1 &#x3D; 1;   &#125;  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>![](https://gitee.com/zhang_hao_yu123/images/raw/master/20201108162528.png)</code></pre></li></ul><hr><h4 id="å¦‚ä½•ä¿è¯æœ‰åºæ€§ï¼Ÿ"><a href="#å¦‚ä½•ä¿è¯æœ‰åºæ€§ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä¿è¯æœ‰åºæ€§ï¼Ÿ"></a>å¦‚ä½•ä¿è¯æœ‰åºæ€§ï¼Ÿ</h4><ul><li>å†™å±éšœä¼šç¡®ä¿æŒ‡ä»¤é‡æ’åºæ—¶ï¼Œä¸ä¼šå°†å†™å±éšœä¹‹å‰çš„ä»£ç æ’åœ¨å†™å±éšœä¹‹å</li><li>è¯»å±éšœä¼šç¡®ä¿æŒ‡ä»¤é‡æ’åºæ—¶ï¼Œä¸ä¼šå°†è¯»å±éšœä¹‹åçš„ä»£ç æ’åœ¨è¯»å±éšœä¹‹å‰</li></ul><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201108165137.png"></p><blockquote><p>ä¸èƒ½è§£å†³æŒ‡ä»¤çš„äº¤é”™ï¼Œ<strong>å³ä¸èƒ½ä¿è¯åŸå­æ€§</strong></p></blockquote><ul><li>å†™å±éšœä»…ä»…ä¿è¯ä¹‹åçš„è¯»æ“ä½œèƒ½å¤Ÿè¯»åˆ°æœ€æ–°çš„ç»“æœï¼Œä½†ä¸èƒ½ä¿è¯è¯»æ“ä½œåœ¨å†™å±éšœä¹‹å‰</li><li>æœ‰åºæ€§çš„ä¿è¯ä¹Ÿåªæ˜¯ä¿è¯äº†æœ¬çº¿ç¨‹å†…ç›¸å…³ä»£ç ä¸è¢«é‡æ’åº</li></ul><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201108165342.png"></p><p>t2çº¿ç¨‹è¯»å–æ“ä½œå‘ç”Ÿåœ¨t1çº¿ç¨‹å†™å…¥ä¸»å­˜ä¹‹å‰ï¼Œè¿™æ ·å°±è¯æ˜äº†ä¸èƒ½ä¿è¯åŸå­æ€§</p><hr><h4 id="dclé—®é¢˜ï¼ˆdouble-checked-lockingï¼‰"><a href="#dclé—®é¢˜ï¼ˆdouble-checked-lockingï¼‰" class="headerlink" title="dclé—®é¢˜ï¼ˆdouble-checked lockingï¼‰"></a>dclé—®é¢˜ï¼ˆdouble-checked lockingï¼‰</h4><p>ä»¥è‘—åçš„ double-checked locking å•ä¾‹æ¨¡å¼ä¸ºä¾‹</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>     <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> INSTANCE <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span>INSTANCE <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// t2</span>         <span class="token comment">// é¦–æ¬¡è®¿é—®ä¼šåŒæ­¥ï¼Œè€Œä¹‹åçš„ä½¿ç”¨æ²¡æœ‰ synchronized</span>                 <span class="token keyword">synchronized</span><span class="token punctuation">(</span><span class="token class-name">Singleton</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                     <span class="token keyword">if</span> <span class="token punctuation">(</span>INSTANCE <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// t1</span>                     INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span>         <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç‰¹ç‚¹ï¼š</p><ul><li>æ‡’æƒ°å®ä¾‹åŒ–</li><li>é¦–æ¬¡ä½¿ç”¨getInstance()æ‰ä½¿ç”¨synchronizedåŠ é”ï¼Œåç»­ä½¿ç”¨æ—¶æ— éœ€åŠ é”</li><li>æœ‰éšå«çš„ï¼Œä½†å¾ˆå…³é”®çš„ä¸€ç‚¹ï¼šç¬¬ä¸€ä¸ªifä½¿ç”¨äº†INSTANCEå˜é‡ï¼Œä½†æ˜¯åœ¨åŒæ­¥ä»£ç å—ä¹‹å¤–ï¼Œå¹¶ä¸”synchronizedå¯ä»¥ä¿è¯å¯è§æ€§ï¼Œå´ä¸èƒ½è§£å†³æŒ‡ä»¤é‡æ’</li></ul><p>getInstanceçš„å­—èŠ‚ç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token number">0</span><span class="token operator">:</span> getstatic #<span class="token number">2</span> <span class="token comment">// Field INSTANCE:Lcn/itcast/n5/Singleton;</span><span class="token number">3</span><span class="token operator">:</span> ifnonnull <span class="token number">37</span><span class="token number">6</span><span class="token operator">:</span> ldc #<span class="token number">3</span> <span class="token comment">// class cn/itcast/n5/Singleton</span><span class="token number">8</span><span class="token operator">:</span> dup<span class="token number">9</span><span class="token operator">:</span> astore_0<span class="token number">10</span><span class="token operator">:</span> monitorenter<span class="token number">11</span><span class="token operator">:</span> getstatic #<span class="token number">2</span> <span class="token comment">// Field INSTANCE:Lcn/itcast/n5/Singleton;</span><span class="token number">14</span><span class="token operator">:</span> ifnonnull <span class="token number">27</span><span class="token number">17</span><span class="token operator">:</span> <span class="token keyword">new</span> #<span class="token number">3</span> <span class="token comment">// class cn/itcast/n5/Singleton</span><span class="token number">20</span><span class="token operator">:</span> dup<span class="token number">21</span><span class="token operator">:</span> invokespecial #<span class="token number">4</span> <span class="token comment">// Method "&lt;init>":()V</span><span class="token number">24</span><span class="token operator">:</span> putstatic #<span class="token number">2</span> <span class="token comment">// Field INSTANCE:Lcn/itcast/n5/Singleton;</span><span class="token number">27</span><span class="token operator">:</span> aload_0<span class="token number">28</span><span class="token operator">:</span> monitorexit<span class="token number">29</span><span class="token operator">:</span> <span class="token keyword">goto</span> <span class="token number">37</span><span class="token number">32</span><span class="token operator">:</span> astore_1<span class="token number">33</span><span class="token operator">:</span> aload_0<span class="token number">34</span><span class="token operator">:</span> monitorexit<span class="token number">35</span><span class="token operator">:</span> aload_1<span class="token number">36</span><span class="token operator">:</span> athrow<span class="token number">37</span><span class="token operator">:</span> getstatic #<span class="token number">2</span> <span class="token comment">// Field INSTANCE:Lcn/itcast/n5/Singleton;</span><span class="token number">40</span><span class="token operator">:</span> areturn<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼š</p><ul><li>17 è¡¨ç¤ºåˆ›å»ºå¯¹è±¡ï¼Œå°†å¯¹è±¡å¼•ç”¨å…¥æ ˆ   // new Singleton</li><li>20 è¡¨ç¤ºå¤åˆ¶ä¸€ä»½å¯¹è±¡å¼•ç”¨   // å¼•ç”¨åœ°å€</li><li>21 è¡¨ç¤ºåˆ©ç”¨ä¸€ä¸ªå¯¹è±¡å¼•ç”¨ï¼Œè°ƒç”¨æ„é€ æ–¹æ³•</li><li>24 è¡¨ç¤ºåˆ©ç”¨ä¸€ä¸ªå¯¹è±¡å¼•ç”¨ï¼Œèµ‹å€¼ç»™static INSTANCE</li></ul><p><strong>ä¹Ÿè®¸JVMä¼šä¼˜åŒ–ä¸ºï¼Œå…ˆæ‰§è¡Œ24ï¼Œå†æ‰§è¡Œ21</strong></p><p>åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼šå› ä¸ºå¤–é¢ä¹Ÿæœ‰ä¸€ä¸ªifè°ƒç”¨äº†INSTANCEï¼Œæ‰€ä»¥å¯èƒ½ä¼šå‘ç”Ÿå±é™©ï¼ï¼</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201108174038.png"></p><p>å…³é”®åœ¨äº0ï¼šgetStaticè¿™è¡Œä»£ç åœ¨synchronizedä¹‹å¤–ï¼Œå¯ä»¥è¶Šè¿‡monitorè¯»å–INSTANCEå˜é‡çš„å€¼</p><p>è¿™æ—¶t1è¿˜æœªå®Œå…¨å°†æ„é€ æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼Œå¦‚æœåœ¨æ„é€ æ–¹æ³•ä¸­è¦æ‰§è¡Œå¾ˆå¤šåˆå§‹åŒ–æ“ä½œï¼Œé‚£ä¹ˆt2æ‹¿åˆ°çš„å°†ä¼šæ˜¯ä¸€ä¸ªæœªåˆå§‹åŒ–å®Œæ¯•çš„å®ä¾‹</p><p>å¯¹INSTANCEä½¿ç”¨volatileä¿®é¥°å³å¯ï¼Œå¯ä»¥ç¦ç”¨æŒ‡ä»¤é‡æ’ï¼Œä½†è¦æ³¨æ„jdk5ä»¥ä¸Šæ‰ä¼šæœ‰æ•ˆ</p><hr><h4 id="dclé—®é¢˜è§£å†³"><a href="#dclé—®é¢˜è§£å†³" class="headerlink" title="dclé—®é¢˜è§£å†³"></a>dclé—®é¢˜è§£å†³</h4><blockquote><p>åœ¨INSTANCEå‰åŠ ä¸Švolatile</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// -------------------------------------> åŠ å…¥å¯¹ INSTANCE å˜é‡çš„è¯»å±éšœ</span><span class="token number">0</span><span class="token operator">:</span> getstatic #<span class="token number">2</span> <span class="token comment">// Field INSTANCE:Lcn/itcast/n5/Singleton;</span><span class="token number">3</span><span class="token operator">:</span> ifnonnull <span class="token number">37</span><span class="token number">6</span><span class="token operator">:</span> ldc #<span class="token number">3</span> <span class="token comment">// class cn/itcast/n5/Singleton</span><span class="token number">8</span><span class="token operator">:</span> dup<span class="token number">9</span><span class="token operator">:</span> astore_0<span class="token number">10</span><span class="token operator">:</span> monitorenter <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-></span> ä¿è¯åŸå­æ€§ã€å¯è§æ€§<span class="token number">11</span><span class="token operator">:</span> getstatic #<span class="token number">2</span> <span class="token comment">// Field INSTANCE:Lcn/itcast/n5/Singleton;</span><span class="token number">14</span><span class="token operator">:</span> ifnonnull <span class="token number">27</span><span class="token number">17</span><span class="token operator">:</span> <span class="token keyword">new</span> #<span class="token number">3</span> <span class="token comment">// class cn/itcast/n5/Singleton</span><span class="token number">20</span><span class="token operator">:</span> dup<span class="token number">21</span><span class="token operator">:</span> invokespecial #<span class="token number">4</span> <span class="token comment">// Method "&lt;init>":()V</span><span class="token number">24</span><span class="token operator">:</span> putstatic #<span class="token number">2</span> <span class="token comment">// Field INSTANCE:Lcn/itcast/n5/Singleton;</span><span class="token comment">// -------------------------------------> åŠ å…¥å¯¹ INSTANCE å˜é‡çš„å†™å±éšœ</span><span class="token number">27</span><span class="token operator">:</span> aload_0<span class="token number">28</span><span class="token operator">:</span> monitorexit <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">></span> ä¿è¯åŸå­æ€§ã€å¯è§æ€§<span class="token number">29</span><span class="token operator">:</span> <span class="token keyword">goto</span> <span class="token number">37</span><span class="token number">32</span><span class="token operator">:</span> astore_1<span class="token number">33</span><span class="token operator">:</span> aload_0<span class="token number">34</span><span class="token operator">:</span> monitorexit<span class="token number">35</span><span class="token operator">:</span> aload_1<span class="token number">36</span><span class="token operator">:</span> athrow<span class="token number">37</span><span class="token operator">:</span> getstatic #<span class="token number">2</span> <span class="token comment">// Field INSTANCE:Lcn/itcast/n5/Singleton;</span><span class="token number">40</span><span class="token operator">:</span> areturn<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯»å†™volatileå˜é‡çš„æ—¶å€™ä¼šåŠ è¯»å†™å±éšœï¼Œä¿è¯ä¸‹é¢ä¸¤ç‚¹ï¼š</p><ul><li>å¯è§æ€§<ul><li>å†™å±éšœï¼ˆsfenceï¼‰ä¿è¯åœ¨è¯¥å±éšœä¹‹å‰çš„t1å¯¹å…±äº«å˜é‡çš„æ”¹åŠ¨ï¼Œéƒ½åŒæ­¥åˆ°ä¸»å­˜å½“ä¸­</li><li>è€Œè¯»å±éšœï¼ˆlfenceï¼‰ä¿è¯åœ¨è¯¥å±éšœä¹‹åt2å¯¹å…±äº«å˜é‡çš„è¯»å–ï¼ŒåŠ è½½çš„æ˜¯ä¸»å­˜ä¸­æœ€æ–°æ•°æ®</li></ul></li><li>æœ‰åºæ€§<ul><li>å†™å±éšœä¼šç¡®ä¿æŒ‡ä»¤é‡æ’åºæ—¶ï¼Œä¸ä¼šå°†å†™å±éšœä¹‹å‰çš„ä»£ç æ’åœ¨å†™å±éšœä¹‹å</li><li>è¯»å±éšœä¼šç¡®ä¿æŒ‡ä»¤é‡æ’åºæ—¶ï¼Œä¸ä¼šå°†è¯»å±éšœä¹‹åçš„ä»£ç æ’åœ¨è¯»å±éšœä¹‹å‰</li></ul></li><li>æ›´åº•å±‚æ˜¯ï¼Œè¯»å†™å˜é‡æ—¶ä½¿ç”¨lockæŒ‡ä»¤æ¥æ§åˆ¶å¤šæ ¸cpuä¹‹é—´çš„å¯è§æ€§ä¸æœ‰åºæ€§</li></ul><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201108180237.png"></p><hr><h3 id="happens-beforeè§„åˆ™"><a href="#happens-beforeè§„åˆ™" class="headerlink" title="happens-beforeè§„åˆ™"></a>happens-beforeè§„åˆ™</h3><p> è§„å®šäº† <strong>å¯¹å…±äº«å˜é‡çš„å†™æ“ä½œå¯¹å…¶ä»–çº¿ç¨‹çš„è¯»æ“ä½œå¯è§</strong>ï¼Œå®ƒæ˜¯å¯è§æ€§ä¸æœ‰åºæ€§çš„ä¸€å¥—è§„åˆ™æ€»ç»“ã€‚</p><ul><li><p>çº¿ç¨‹m è§£é”ä¹‹å‰å¯¹å˜é‡çš„å†™ï¼Œå¯¹äºæ¥ä¸‹æ¥è·å–mé”çš„å…¶ä»–çº¿ç¨‹æ¥è¯´åº”è¯¥æ˜¯è¯»å¯è§</p></li><li><p>çº¿ç¨‹å¯¹volatileå˜é‡çš„å†™ï¼Œå¯¹æ¥ä¸‹æ¥å…¶ä»–çº¿ç¨‹å¯¹è¯¥å˜é‡çš„è¯»å¯è§</p></li><li><p>çº¿ç¨‹åœ¨startä¹‹å‰ï¼Œå¯¹å˜é‡çš„å†™ï¼Œå¯¹è¯¥çº¿ç¨‹å¼€å§‹åå¯¹è¯¥å˜é‡çš„è¯»å¯è§</p></li><li><p>çº¿ç¨‹ç»“æŸå‰å¯¹å˜é‡çš„å†™ï¼Œå¯¹å…¶ä»–çº¿ç¨‹å¾—çŸ¥å®ƒç»“æŸåçš„è¯»å¯è§ï¼ˆæ¯”å¦‚å…¶ä»–çº¿ç¨‹è°ƒç”¨ isAlive()æˆ– join()ï¼‰</p></li><li><p>çº¿ç¨‹Aæ‰“æ–­çº¿ç¨‹Bå‰ï¼Œå¯¹å˜é‡çš„å†™ï¼Œå¯¹äºå…¶ä»–çº¿ç¨‹å¾—çŸ¥Bè¢«æ‰“æ–­åï¼Œå¯¹å˜é‡çš„è¯»å¯è§</p></li><li><p>å¯¹å˜é‡é»˜è®¤å€¼ï¼ˆ0ï¼Œnullï¼Œfalseï¼‰çš„å†™å…¥ï¼Œå¯¹äºå…¶ä»–çº¿ç¨‹è¯»å¯è§</p></li><li><p>å…·æœ‰ä¼ é€’æ€§ï¼Œå¦‚æœ x hb-&gt;y  y hb-&gt;z é‚£ä¹ˆ x hb-&gt;zï¼Œé…åˆvolatileçš„é˜²æŒ‡ä»¤é‡æ’ï¼Œå¯ä»¥å¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201109105927.png"></p></li></ul><h3 id="å•ä¾‹æ¨¡å¼çº¿ç¨‹å®‰å…¨é—®é¢˜"><a href="#å•ä¾‹æ¨¡å¼çº¿ç¨‹å®‰å…¨é—®é¢˜" class="headerlink" title="å•ä¾‹æ¨¡å¼çº¿ç¨‹å®‰å…¨é—®é¢˜"></a>å•ä¾‹æ¨¡å¼çº¿ç¨‹å®‰å…¨é—®é¢˜</h3><p>å®ç°1ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// é—®é¢˜1ï¼šä¸ºä»€ä¹ˆåŠ  final</span><span class="token comment">// é—®é¢˜2ï¼šå¦‚æœå®ç°äº†åºåˆ—åŒ–æ¥å£, è¿˜è¦åšä»€ä¹ˆæ¥é˜²æ­¢ååºåˆ—åŒ–ç ´åå•ä¾‹</span><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>     <span class="token comment">// é—®é¢˜3ï¼šä¸ºä»€ä¹ˆè®¾ç½®ä¸ºç§æœ‰? æ˜¯å¦èƒ½é˜²æ­¢åå°„åˆ›å»ºæ–°çš„å®ä¾‹?</span>     <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>     <span class="token comment">// é—®é¢˜4ï¼šè¿™æ ·åˆå§‹åŒ–æ˜¯å¦èƒ½ä¿è¯å•ä¾‹å¯¹è±¡åˆ›å»ºæ—¶çš„çº¿ç¨‹å®‰å…¨?</span>     <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Singleton</span> INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// é—®é¢˜5ï¼šä¸ºä»€ä¹ˆæä¾›é™æ€æ–¹æ³•è€Œä¸æ˜¯ç›´æ¥å°† INSTANCE è®¾ç½®ä¸º public, è¯´å‡ºä½ çŸ¥é“çš„ç†ç”±</span>     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>     <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">readResolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°2ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// é—®é¢˜1ï¼šæšä¸¾å•ä¾‹æ˜¯å¦‚ä½•é™åˆ¶å®ä¾‹ä¸ªæ•°çš„</span><span class="token comment">// é—®é¢˜2ï¼šæšä¸¾å•ä¾‹åœ¨åˆ›å»ºæ—¶æ˜¯å¦æœ‰å¹¶å‘é—®é¢˜</span><span class="token comment">// é—®é¢˜3ï¼šæšä¸¾å•ä¾‹èƒ½å¦è¢«åå°„ç ´åå•ä¾‹</span><span class="token comment">// é—®é¢˜4ï¼šæšä¸¾å•ä¾‹èƒ½å¦è¢«ååºåˆ—åŒ–ç ´åå•ä¾‹</span><span class="token comment">// é—®é¢˜5ï¼šæšä¸¾å•ä¾‹å±äºæ‡’æ±‰å¼è¿˜æ˜¯é¥¿æ±‰å¼</span><span class="token comment">// é—®é¢˜6ï¼šæšä¸¾å•ä¾‹å¦‚æœå¸Œæœ›åŠ å…¥ä¸€äº›å•ä¾‹åˆ›å»ºæ—¶çš„åˆå§‹åŒ–é€»è¾‘è¯¥å¦‚ä½•åš</span><span class="token keyword">enum</span> <span class="token class-name">Singleton</span> <span class="token punctuation">&#123;</span>  INSTANCE<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°3ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">&#123;</span> <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> INSTANCE <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>     <span class="token comment">// åˆ†æè¿™é‡Œçš„çº¿ç¨‹å®‰å…¨, å¹¶è¯´æ˜æœ‰ä»€ä¹ˆç¼ºç‚¹</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">if</span><span class="token punctuation">(</span> INSTANCE <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>      INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°4ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">&#123;</span> <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span> <span class="token comment">// é—®é¢˜1ï¼šè§£é‡Šä¸ºä»€ä¹ˆè¦åŠ  volatile ?</span> <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">volatile</span> <span class="token class-name">Singleton</span> INSTANCE <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment">// é—®é¢˜2ï¼šå¯¹æ¯”å®ç°3, è¯´å‡ºè¿™æ ·åšçš„æ„ä¹‰ </span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>INSTANCE <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>         <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Singleton</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token comment">// é—®é¢˜3ï¼šä¸ºä»€ä¹ˆè¿˜è¦åœ¨è¿™é‡ŒåŠ ä¸ºç©ºåˆ¤æ–­, ä¹‹å‰ä¸æ˜¯åˆ¤æ–­è¿‡äº†å—</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>INSTANCE <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// t2 </span>         <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>         INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">return</span> INSTANCE<span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°5ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span>     <span class="token comment">// é—®é¢˜1ï¼šå±äºæ‡’æ±‰å¼è¿˜æ˜¯é¥¿æ±‰å¼</span>     <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">LazyHolder</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Singleton</span> INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>     <span class="token comment">// é—®é¢˜2ï¼šåœ¨åˆ›å»ºæ—¶æ˜¯å¦æœ‰å¹¶å‘é—®é¢˜</span>     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">return</span> <span class="token class-name">LazyHolder</span><span class="token punctuation">.</span>INSTANCE<span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="8-å…±äº«æ¨¡å‹ä¹‹æ— é”"><a href="#8-å…±äº«æ¨¡å‹ä¹‹æ— é”" class="headerlink" title="8. å…±äº«æ¨¡å‹ä¹‹æ— é”"></a>8. å…±äº«æ¨¡å‹ä¹‹æ— é”</h2><h3 id="CAS"><a href="#CAS" class="headerlink" title="CAS"></a>CAS</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> amount<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token comment">// éœ€è¦ä¸æ–­å°è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢</span>         <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 <span class="token comment">// æ¯”å¦‚æ‹¿åˆ°äº†æ—§å€¼ 1000</span>                 <span class="token keyword">int</span> prev <span class="token operator">=</span> balance<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// åœ¨è¿™ä¸ªåŸºç¡€ä¸Š 1000-10 = 990</span>                 <span class="token keyword">int</span> next <span class="token operator">=</span> prev <span class="token operator">-</span> amount<span class="token punctuation">;</span>                 <span class="token comment">/*                 compareAndSet æ­£æ˜¯åšè¿™ä¸ªæ£€æŸ¥ï¼Œåœ¨ set å‰ï¼Œå…ˆæ¯”è¾ƒ prev ä¸å½“å‰å€¼                 - ä¸ä¸€è‡´äº†ï¼Œnext ä½œåºŸï¼Œè¿”å› false è¡¨ç¤ºå¤±è´¥                 æ¯”å¦‚ï¼Œåˆ«çš„çº¿ç¨‹å·²ç»åšäº†å‡æ³•ï¼Œå½“å‰å€¼å·²ç»è¢«å‡æˆäº† 990                 é‚£ä¹ˆæœ¬çº¿ç¨‹çš„è¿™æ¬¡ 990 å°±ä½œåºŸäº†ï¼Œè¿›å…¥ while ä¸‹æ¬¡å¾ªç¯é‡è¯•                 - ä¸€è‡´ï¼Œä»¥ next è®¾ç½®ä¸ºæ–°å€¼ï¼Œè¿”å› true è¡¨ç¤ºæˆåŠŸ                 */</span>                  <span class="token keyword">if</span> <span class="token punctuation">(</span>balance<span class="token punctuation">.</span><span class="token function">compareAndSet</span><span class="token punctuation">(</span>prev<span class="token punctuation">,</span> next<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token keyword">break</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­çš„å…³é”®æ˜¯ compareAndSetï¼Œå®ƒçš„ç®€ç§°å°±æ˜¯ CAS ï¼ˆä¹Ÿæœ‰ Compare And Swap çš„è¯´æ³•ï¼‰ï¼Œå®ƒå¿…é¡»æ˜¯åŸå­æ“ä½œã€‚</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201113205128.png"></p><blockquote><p><strong>æ³¨æ„</strong>  </p><ul><li><p>å…¶å® CAS çš„åº•å±‚æ˜¯ lock cmpxchg æŒ‡ä»¤ï¼ˆX86 æ¶æ„ï¼‰ï¼Œåœ¨å•æ ¸ CPU å’Œå¤šæ ¸ CPU ä¸‹éƒ½èƒ½å¤Ÿä¿è¯ã€æ¯”è¾ƒ-äº¤æ¢ã€‘çš„åŸå­æ€§ã€‚</p></li><li><p>åœ¨å¤šæ ¸çŠ¶æ€ä¸‹ï¼ŒæŸä¸ªæ ¸æ‰§è¡Œåˆ°å¸¦ lock çš„æŒ‡ä»¤æ—¶ï¼ŒCPU ä¼šè®©æ€»çº¿é”ä½ï¼Œå½“è¿™ä¸ªæ ¸æŠŠæ­¤æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ï¼Œå†å¼€å¯æ€»çº¿ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸ä¼šè¢«çº¿ç¨‹çš„è°ƒåº¦æœºåˆ¶æ‰€æ‰“æ–­ï¼Œä¿è¯äº†å¤šä¸ªçº¿ç¨‹å¯¹å†…å­˜æ“ä½œçš„å‡†ç¡®æ€§ï¼Œæ˜¯åŸå­çš„ã€‚****</p></li></ul></blockquote><hr><p><strong>volatile</strong></p><p>è·å–å…±äº«å˜é‡æ—¶ï¼Œä¸ºäº†ä¿è¯è¯¥å˜é‡çš„å¯è§æ€§ï¼Œéœ€è¦ä½¿ç”¨ volatile ä¿®é¥°</p><p>å®ƒå¯ä»¥ç”¨æ¥ä¿®é¥°æˆå‘˜å˜é‡å’Œé™æ€æˆå‘˜å˜é‡ï¼Œä»–å¯ä»¥é¿å…çº¿ç¨‹ä»è‡ªå·±çš„å·¥ä½œç¼“å­˜ä¸­æŸ¥æ‰¾å˜é‡çš„å€¼ï¼Œå¿…é¡»åˆ°ä¸»å­˜ä¸­è·å–å®ƒçš„å€¼ï¼Œçº¿ç¨‹æ“ä½œ volatile å˜é‡éƒ½æ˜¯ç›´æ¥æ“ä½œä¸»å­˜ã€‚å³ä¸€ä¸ªçº¿ç¨‹å¯¹ volatile å˜é‡çš„ä¿®æ”¹ï¼Œå¯¹å¦ä¸€ä¸ªçº¿ç¨‹å¯è§ã€‚</p><blockquote><p><strong>æ³¨æ„</strong></p><p>volatile ä»…ä»…ä¿è¯äº†å…±äº«å˜é‡çš„å¯è§æ€§ï¼Œè®©å…¶å®ƒçº¿ç¨‹èƒ½å¤Ÿçœ‹åˆ°æœ€æ–°å€¼ï¼Œä½†ä¸èƒ½è§£å†³æŒ‡ä»¤äº¤é”™é—®é¢˜ï¼ˆä¸èƒ½ä¿è¯åŸå­æ€§ï¼‰</p></blockquote><p>CAS å¿…é¡»å€ŸåŠ© volatile æ‰èƒ½è¯»å–åˆ°å…±äº«å˜é‡çš„æœ€æ–°å€¼æ¥å®ç°ã€æ¯”è¾ƒå¹¶äº¤æ¢ã€‘çš„æ•ˆæœ</p><p><strong>ä¸ºä»€ä¹ˆæ— é”æ•ˆç‡é«˜</strong></p><ul><li><p>æ— é”æƒ…å†µä¸‹ï¼Œå³ä½¿é‡è¯•å¤±è´¥ï¼Œçº¿ç¨‹å§‹ç»ˆåœ¨é«˜é€Ÿè¿è¡Œï¼Œæ²¡æœ‰åœæ­‡ï¼Œè€Œ synchronized ä¼šè®©çº¿ç¨‹åœ¨æ²¡æœ‰è·å¾—é”çš„æ—¶å€™ï¼Œå‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè¿›å…¥é˜»å¡ã€‚æ‰“ä¸ªæ¯”å–»</p></li><li><p>çº¿ç¨‹å°±å¥½åƒé«˜é€Ÿè·‘é“ä¸Šçš„èµ›è½¦ï¼Œé«˜é€Ÿè¿è¡Œæ—¶ï¼Œé€Ÿåº¦è¶…å¿«ï¼Œä¸€æ—¦å‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå°±å¥½æ¯”èµ›è½¦è¦å‡é€Ÿã€ç†„ç«ï¼Œç­‰è¢«å”¤é†’åˆå¾—é‡æ–°æ‰“ç«ã€å¯åŠ¨ã€åŠ é€Ÿâ€¦ æ¢å¤åˆ°é«˜é€Ÿè¿è¡Œï¼Œä»£ä»·æ¯”è¾ƒå¤§</p></li><li><p>ä½†æ— é”æƒ…å†µä¸‹ï¼Œå› ä¸ºçº¿ç¨‹è¦ä¿æŒè¿è¡Œï¼Œéœ€è¦é¢å¤– CPU çš„æ”¯æŒï¼ŒCPU åœ¨è¿™é‡Œå°±å¥½æ¯”é«˜é€Ÿè·‘é“ï¼Œæ²¡æœ‰é¢å¤–çš„è·‘é“ï¼Œçº¿ç¨‹æƒ³é«˜é€Ÿè¿è¡Œä¹Ÿæ— ä»è°ˆèµ·ï¼Œè™½ç„¶ä¸ä¼šè¿›å…¥é˜»å¡ï¼Œä½†ç”±äºæ²¡æœ‰åˆ†åˆ°æ—¶é—´ç‰‡ï¼Œä»ç„¶ä¼šè¿›å…¥å¯è¿è¡ŒçŠ¶æ€ï¼Œè¿˜æ˜¯ä¼šå¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p></li></ul><p><strong>CAS</strong> <strong>çš„ç‰¹ç‚¹</strong></p><p>ç»“åˆ CAS å’Œ volatile å¯ä»¥å®ç°æ— é”å¹¶å‘ï¼Œé€‚ç”¨äºçº¿ç¨‹æ•°å°‘ã€å¤šæ ¸ CPU çš„åœºæ™¯ä¸‹ã€‚</p><ul><li><p>CAS æ˜¯åŸºäºä¹è§‚é”çš„æ€æƒ³ï¼šæœ€ä¹è§‚çš„ä¼°è®¡ï¼Œä¸æ€•åˆ«çš„çº¿ç¨‹æ¥ä¿®æ”¹å…±äº«å˜é‡ï¼Œå°±ç®—æ”¹äº†ä¹Ÿæ²¡å…³ç³»ï¼Œæˆ‘åƒäºç‚¹å†é‡è¯•å‘—ã€‚</p></li><li><p>synchronized æ˜¯åŸºäºæ‚²è§‚é”çš„æ€æƒ³ï¼šæœ€æ‚²è§‚çš„ä¼°è®¡ï¼Œå¾—é˜²ç€å…¶å®ƒçº¿ç¨‹æ¥ä¿®æ”¹å…±äº«å˜é‡ï¼Œæˆ‘ä¸Šäº†é”ä½ ä»¬éƒ½åˆ«æƒ³æ”¹ï¼Œæˆ‘æ”¹å®Œäº†è§£å¼€é”ï¼Œä½ ä»¬æ‰æœ‰æœºä¼šã€‚</p></li><li><p>CAS ä½“ç°çš„æ˜¯æ— é”å¹¶å‘ã€æ— é˜»å¡å¹¶å‘ï¼Œè¯·ä»”ç»†ä½“ä¼šè¿™ä¸¤å¥è¯çš„æ„æ€</p><ul><li>å› ä¸ºæ²¡æœ‰ä½¿ç”¨ synchronizedï¼Œæ‰€ä»¥çº¿ç¨‹ä¸ä¼šé™·å…¥é˜»å¡ï¼Œè¿™æ˜¯æ•ˆç‡æå‡çš„å› ç´ ä¹‹ä¸€</li><li>ä½†å¦‚æœç«äº‰æ¿€çƒˆï¼Œå¯ä»¥æƒ³åˆ°é‡è¯•å¿…ç„¶é¢‘ç¹å‘ç”Ÿï¼Œåè€Œæ•ˆç‡ä¼šå—å½±å“</li></ul></li></ul><hr><p><strong>åŸå­æ•´æ•°</strong></p><p>J.U.C å¹¶å‘åŒ…æä¾›äº†ï¼š</p><ul><li>AtomicBoolean</li><li>AtomicInteger</li><li>AtomicLong</li></ul><hr><p><strong>åŸå­å¼•ç”¨</strong></p><ul><li>AtomicReference</li><li>AtomicMarkableReference</li><li>AtomicStampedReference</li></ul><hr><p><strong>ABAé—®é¢˜åŠè§£å†³</strong></p><blockquote><p>ä¸»çº¿ç¨‹ä»…èƒ½åˆ¤æ–­å‡ºå…±äº«å˜é‡çš„å€¼ä¸æœ€åˆå€¼ A æ˜¯å¦ç›¸åŒï¼Œä¸èƒ½æ„ŸçŸ¥åˆ°è¿™ç§ä» A æ”¹ä¸º B åˆ æ”¹å› A çš„æƒ…å†µï¼Œå¦‚æœä¸»çº¿ç¨‹å¸Œæœ›ï¼š</p><p>åªè¦æœ‰å…¶å®ƒçº¿ç¨‹ã€åŠ¨è¿‡äº†ã€‘å…±äº«å˜é‡ï¼Œé‚£ä¹ˆè‡ªå·±çš„ cas å°±ç®—å¤±è´¥ï¼Œè¿™æ—¶ï¼Œä»…æ¯”è¾ƒå€¼æ˜¯ä¸å¤Ÿçš„ï¼Œéœ€è¦å†åŠ ä¸€ä¸ªç‰ˆæœ¬å·</p></blockquote><p><em>AtomicStampedReference</em></p><p> å¯ä»¥ç»™åŸå­å¼•ç”¨åŠ ä¸Šç‰ˆæœ¬å·ï¼Œè¿½è¸ªåŸå­å¼•ç”¨æ•´ä¸ªçš„å˜åŒ–è¿‡ç¨‹ï¼Œå¦‚ï¼š A -&gt; B -&gt; A -&gt; C ï¼Œé€šè¿‡<strong>AtomicStampedReference</strong>ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¼•ç”¨å˜é‡ä¸­é€”è¢«æ›´æ”¹äº†å‡ æ¬¡ã€‚ä½†æ˜¯æœ‰æ—¶å€™ï¼Œå¹¶ä¸å…³å¿ƒå¼•ç”¨å˜é‡æ›´æ”¹äº†å‡ æ¬¡ï¼Œåªæ˜¯å•çº¯çš„å…³å¿ƒ<strong>æ˜¯å¦æ›´æ”¹è¿‡</strong>ï¼Œæ‰€ä»¥å°±æœ‰äº†<strong>AtomicMarkableReference</strong></p><hr><p><strong>åŸå­æ•°ç»„</strong></p><ul><li><p>AtomicIntegerArray</p></li><li><p>AtomicLongArray</p></li><li><p>AtomicReferenceArray</p></li></ul><hr><p><strong>å­—æ®µæ›´æ–°å™¨</strong></p><ul><li><p>AtomicReferenceFieldUpdater // åŸŸ å­—æ®µ</p></li><li><p>AtomicIntegerFieldUpdater</p></li><li><p>AtomicLongFieldUpdater</p></li></ul><h3 id="unsafe"><a href="#unsafe" class="headerlink" title="unsafe"></a>unsafe</h3><blockquote><p>Unsafe å¯¹è±¡æä¾›äº†éå¸¸åº•å±‚çš„ï¼Œæ“ä½œå†…å­˜ã€çº¿ç¨‹çš„æ–¹æ³•ï¼ŒUnsafeå¯¹è±¡ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼Œåªèƒ½é€šè¿‡åå°„è·å¾—</p></blockquote><h2 id="å…±äº«æ¨¡å‹ä¹‹ä¸å¯å˜"><a href="#å…±äº«æ¨¡å‹ä¹‹ä¸å¯å˜" class="headerlink" title="å…±äº«æ¨¡å‹ä¹‹ä¸å¯å˜"></a>å…±äº«æ¨¡å‹ä¹‹ä¸å¯å˜</h2><p><strong>ä¸å¯å˜æ€§</strong></p><blockquote><p>ä¿æŠ¤æ€§copyæœºåˆ¶ï¼Œå‚è€ƒString</p></blockquote><p><strong>final</strong></p><ul><li><p>è®¾ç½®finalå˜é‡çš„åŸç†</p><blockquote><p>åœ¨èµ‹å€¼æ“ä½œ(putfield)ååŠ å…¥äº†å†™å±éšœï¼Œ</p><p>å†™å±éšœä¿è¯äº†åœ¨æ­¤ä¹‹å‰çš„å˜åŒ–éƒ½åŒæ­¥åˆ°ä¸»å­˜ä¸­ï¼Œå¹¶ä¸”åœ¨æ­¤ä¹‹å‰çš„ä»£ç ä¸ä¼šé‡æ’åºåˆ°å†™å±éšœåé¢</p><p>è¿™æ ·å°±èƒ½ä¿è¯å…¶ä»–çº¿ç¨‹è¯»å–åˆ°å®ƒçš„å€¼æ—¶ä¸ä¼šå‡ºç°0çš„æƒ…å†µ</p></blockquote></li><li><p>è·å–finalå˜é‡çš„åŸç†</p><blockquote><p>BIPUSH è¯»å–å…¶ä»–ç±»ä¸­çš„finalå˜é‡ï¼Œä¼šç›´æ¥å¤åˆ¶ä¸€ä»½æ”¾åˆ°å½“å‰çš„æ ˆä¸­ï¼Œç›¸å½“äºåœ¨æ ˆä¸­è®¿é—®</p><p>GETSTATIC ä¼šå»åˆ«çš„ç±»ä¸­è¯»å–ä»–ä»¬çš„finalå˜é‡ï¼Œç›¸å½“äºåœ¨å †ä¸­è®¿é—®</p></blockquote></li></ul><p><strong>äº«å…ƒ</strong></p><h2 id="çº¿ç¨‹æ± "><a href="#çº¿ç¨‹æ± " class="headerlink" title="çº¿ç¨‹æ± "></a>çº¿ç¨‹æ± </h2><h3 id="è‡ªå®šä¹‰çº¿ç¨‹æ± "><a href="#è‡ªå®šä¹‰çº¿ç¨‹æ± " class="headerlink" title="è‡ªå®šä¹‰çº¿ç¨‹æ± "></a>è‡ªå®šä¹‰çº¿ç¨‹æ± </h3><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201116171518.png"></p><h3 id="ThreadPoolExecutor"><a href="#ThreadPoolExecutor" class="headerlink" title="ThreadPoolExecutor"></a>ThreadPoolExecutor</h3><p><strong>çº¿ç¨‹æ± çŠ¶æ€</strong></p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201116165735.png"></p><p>è¿™äº›ä¿¡æ¯å­˜å‚¨åœ¨ä¸€ä¸ªåŸå­å˜é‡ctlä¸­ï¼Œç›®çš„æ˜¯å°†çº¿ç¨‹æ± çŠ¶æ€å’Œçº¿ç¨‹ä¸ªæ•°åˆäºŒä¸ºä¸€ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨ä¸€æ¬¡casæ“ä½œè¿›è¡Œèµ‹å€¼</p><h3 id="åˆ›å»ºå¤šå°‘çº¿ç¨‹åˆé€‚"><a href="#åˆ›å»ºå¤šå°‘çº¿ç¨‹åˆé€‚" class="headerlink" title="åˆ›å»ºå¤šå°‘çº¿ç¨‹åˆé€‚"></a>åˆ›å»ºå¤šå°‘çº¿ç¨‹åˆé€‚</h3><ul><li><p>cpuå¯†é›†å‹è¿ç®—</p><blockquote><p>cpuæ ¸æ•°+1ï¼Œ+1ä¿è¯å½“å‰çº¿ç¨‹ç”±äºé¡µç¼ºå¤±æ•…éšœï¼ˆæ“ä½œç³»ç»Ÿï¼‰æˆ–å…¶ä»–åŸå› å¯¼è‡´æš‚åœæ—¶ï¼Œé¢å¤–çš„è¿™ä¸ªçº¿ç¨‹å°±èƒ½é¡¶ä¸Šå»ï¼Œä¿è¯cpuå‘¨æœŸä¸è¢«æµªè´¹</p></blockquote></li><li><p>I/Oå¯†é›†å‹è¿ç®—</p><blockquote><p>çº¿ç¨‹æ•° = æ ¸æ•° * æœŸæœ›CPUåˆ©ç”¨ç‡ * æ€»æ—¶é—´ï¼ˆCPUè®¡ç®—æ—¶é—´+ç­‰å¾…æ—¶é—´ï¼‰/CPUè®¡ç®—æ—¶é—´</p></blockquote></li></ul><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201116214358.png"></p><h2 id="Tomcatçº¿ç¨‹æ± "><a href="#Tomcatçº¿ç¨‹æ± " class="headerlink" title="Tomcatçº¿ç¨‹æ± "></a>Tomcatçº¿ç¨‹æ± </h2><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201117201639.png"></p><h2 id="fork-join"><a href="#fork-join" class="headerlink" title="fork/join"></a>fork/join</h2><blockquote><p>åˆ†æ²»æ€æƒ³ï¼Œå¯¹ä»»åŠ¡è¿›è¡Œæ‹†åˆ†çš„cpuå¯†é›†å‹è¿ç®—ï¼Œ</p></blockquote><h2 id="JUC"><a href="#JUC" class="headerlink" title="JUC"></a>JUC</h2><h3 id="AQSåŸç†"><a href="#AQSåŸç†" class="headerlink" title="AQSåŸç†"></a>AQSåŸç†</h3><blockquote><p>AbstractQueueSynchronizerï¼Œæ˜¯ä¸€ä¸ªé˜»å¡å¼é”å’Œç›¸å…³çš„åŒæ­¥å™¨å·¥å…·çš„æ¡†æ¶</p></blockquote><p>ç‰¹ç‚¹ï¼š</p><ul><li><p>ç”¨stateå±æ€§æ¥è¡¨ç¤ºèµ„æºçš„çŠ¶æ€ï¼ˆç‹¬å å¼å’Œå…±äº«æ¨¡å¼ï¼‰ï¼Œå­ç±»éœ€è¦å®šä¹‰å¦‚ä½•ç»´æŠ¤è¿™ä¸ªçŠ¶æ€ï¼Œæ§åˆ¶å¦‚ä½•è·å–é”å’Œé‡Šæ”¾é”</p><ul><li><p><code>getState</code>  è·å–stateè£…å¡«</p></li><li><p><code>setState</code>  è®¾ç½®stateçŠ¶æ€</p></li><li><p><code>compareAndSetState</code>  ä¹è§‚é”æœºåˆ¶è®¾ç½®stateçŠ¶æ€</p></li><li><p>ç‹¬å æ¨¡å¼æ˜¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè®¿é—®èµ„æºï¼Œè€Œå…±äº«æ¨¡å¼å¯ä»¥å…è®¸å¤šä¸ªçº¿ç¨‹è®¿é—®èµ„æº</p></li></ul></li><li><p>æä¾›äº†åŸºäºFIFOçš„ç­‰å¾…é˜Ÿåˆ—ï¼Œç±»ä¼¼äºMonitorçš„EntryList</p></li><li><p>æ¡ä»¶å˜é‡æ¥å®ç°çš„ç­‰å¾…ã€å”¤é†’æœºåˆ¶ã€æ”¯æŒå¤šä¸ªæ¡ä»¶å˜é‡ï¼Œç±»ä¼¼äºMonitorçš„WaitSet</p></li></ul><p>å­ç±»ä¸»è¦å®ç°çš„æ–¹æ³•ï¼š</p><ul><li><code>tryAcquire</code></li><li><code>tryRelease</code></li><li><code>tryAcquireShared</code></li><li><code>tryReleaseShared</code></li><li><code>isHeldExclusively</code></li></ul><p><strong>ç›®æ ‡</strong></p><p>AQSè¦å®ç°çš„åŠŸèƒ½ç›®æ ‡</p><ul><li>é˜»å¡ç‰ˆæœ¬è·å–é”acquireå’Œéé˜»å¡çš„ç‰ˆæœ¬å°è¯•è·å–é”tryAcquire</li><li>è·å–é”è¶…æ—¶æœºåˆ¶</li><li>é€šè¿‡æ‰“æ–­å–æ¶ˆæœºåˆ¶</li><li>ç‹¬å æœºåˆ¶åŠå…±äº«æœºåˆ¶</li><li>æ¡ä»¶ä¸æ»¡è¶³æ—¶çš„ç­‰å¾…æœºåˆ¶</li></ul><p><strong>è®¾è®¡</strong></p><p>AQSçš„åŸºæœ¬æ€æƒ³å¾ˆç®€å•</p><blockquote><p>è·å–é”çš„é€»è¾‘</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">while</span><span class="token punctuation">(</span>state çŠ¶æ€ä¸å…è®¸è·å–<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>é˜Ÿåˆ—ä¸­è¿˜æ²¡æœ‰æ­¤çº¿ç¨‹<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        å…¥é˜Ÿå¹¶é˜»å¡    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>å½“å‰çº¿ç¨‹å‡ºé˜Ÿ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>é‡Šæ”¾é”çš„é€»è¾‘</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>state çŠ¶æ€å…è®¸äº†<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    æ¢å¤é˜»å¡çš„çº¿ç¨‹<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>è¦ç‚¹</strong></p><ul><li><p><strong>stateè®¾è®¡</strong></p><ul><li>stateä½¿ç”¨volatileé…åˆcasä¿è¯å…¶ä¿®æ”¹æ—¶çš„åŸå­æ€§</li><li>stateä½¿ç”¨äº†32bit intæ¥ç»´æŠ¤åŒæ­¥çŠ¶æ€ï¼Œå› ä¸ºå½“æ—¶ä½¿ç”¨longåœ¨å¾ˆå¤šå¹³å°ä¸‹æµ‹è¯•ç»“æœå¹¶ä¸ç†æƒ³</li></ul></li><li><p><strong>é˜»å¡æ¢å¤è®¾è®¡</strong></p><ul><li>ä½¿ç”¨park&amp;unparkæ¥å®ç°çº¿ç¨‹çš„æš‚åœå’Œæ¢å¤</li><li>park &amp;unparkæ˜¯é’ˆå¯¹çº¿ç¨‹çš„ï¼Œè€Œä¸æ˜¯é’ˆå¯¹åŒæ­¥å™¨çš„ï¼Œå› æ­¤æ§åˆ¶ç²’åº¦æ›´ä¸ºç²¾ç»†</li><li>parkçº¿ç¨‹è¿˜å¯ä»¥ç”¨interruptå®ç°</li></ul></li><li><p><strong>é˜Ÿåˆ—è®¾è®¡</strong></p><ul><li>ä½¿ç”¨FIFOå…ˆå…¥å…ˆå‡ºé˜Ÿåˆ—ï¼Œå¹¶ä¸æ”¯æŒä¼˜å…ˆçº§é˜Ÿåˆ—</li><li>è®¾è®¡æ—¶å€Ÿé‰´äº†CLHé˜Ÿåˆ—ï¼Œå®ƒæ˜¯ä¸€ç§å•é¡¹æ— é”é˜Ÿåˆ—</li></ul><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201119113019.png"></p><p>é˜Ÿåˆ—ä¸­æœ‰ head å’Œ tail ä¸¤ä¸ªæŒ‡é’ˆèŠ‚ç‚¹ï¼Œéƒ½ç”¨ volatile ä¿®é¥°é…åˆ cas ä½¿ç”¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰ state ç»´æŠ¤èŠ‚ç‚¹çŠ¶æ€</p><blockquote><p>å…¥é˜Ÿä¼ªä»£ç ï¼Œåªéœ€è¦è€ƒè™‘ tail èµ‹å€¼çš„åŸå­æ€§</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">do</span><span class="token punctuation">&#123;</span>    <span class="token comment">// åŸæ¥çš„tail</span>    <span class="token class-name">Node</span> prev <span class="token operator">=</span> tail<span class="token punctuation">;</span>    <span class="token comment">// ç”¨casåœ¨åŸæ¥çš„tailçš„åŸºç¡€ä¸Šæ”¹ä¸ºnode</span><span class="token punctuation">&#125;</span><span class="token keyword">while</span><span class="token punctuation">(</span>tail<span class="token punctuation">.</span><span class="token function">compareAndSet</span><span class="token punctuation">(</span>prev<span class="token punctuation">,</span>node<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å‡ºé˜Ÿä¼ªä»£ç </p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// prevæ˜¯ä¸Šä¸€ä¸ªèŠ‚ç‚¹</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Node</span> prev <span class="token operator">=</span> node<span class="token punctuation">.</span>prev<span class="token punctuation">)</span><span class="token punctuation">.</span>state <span class="token operator">!=</span> å”¤é†’çŠ¶æ€<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span><span class="token comment">// è®¾ç½®å¤´èŠ‚ç‚¹</span>head <span class="token operator">=</span> node<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>CLH å¥½å¤„ï¼š</p><ul><li><strong>æ— é”ï¼Œä½¿ç”¨è‡ªæ—‹</strong></li><li><strong>å¿«é€Ÿï¼Œæ— é˜»å¡</strong></li></ul></li></ul><h3 id="ReentrantLockåŸç†"><a href="#ReentrantLockåŸç†" class="headerlink" title="ReentrantLockåŸç†"></a>ReentrantLockåŸç†</h3><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201117211318.png"></p><h4 id="éå…¬å¹³é”å®ç°åŸç†"><a href="#éå…¬å¹³é”å®ç°åŸç†" class="headerlink" title="éå…¬å¹³é”å®ç°åŸç†"></a>éå…¬å¹³é”å®ç°åŸç†</h4><h5 id="åŠ é”è§£é”æµç¨‹"><a href="#åŠ é”è§£é”æµç¨‹" class="headerlink" title="åŠ é”è§£é”æµç¨‹"></a>åŠ é”è§£é”æµç¨‹</h5><p>æ„é€ å™¨</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// é»˜è®¤æ˜¯éå…¬å¹³é”ï¼ŒNofairSyncç»§æ‰¿è‡ªAQS</span> sync <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NonfairSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ²¡æœ‰ç«äº‰æ—¶</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201119151112.png"></p><p>ç¬¬ä¸€ä¸ªç«äº‰è€…å‡ºç°æ—¶</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201119151130.png"></p><p>Thread-1æ‰§è¡Œäº†ä»¥ä¸‹ï¼š</p><ol><li>CASå°è¯•æŠŠstateç”±0æ”¹ä¸º1ï¼Œå¤±è´¥</li><li>è¿›å…¥tryAcquireé€»è¾‘ï¼Œæ­¤æ—¶stateå·²ç»æ˜¯1ï¼Œç»“æœä»»ç„¶æ˜¯å¤±è´¥</li><li>æ¥ä¸‹æ¥è¿›å…¥addWaiteré€»è¾‘ï¼Œæ„é€ Nodeé˜Ÿåˆ—<ol><li>æ¯ä¸€ä¸ªnodeéƒ½ç»´æŠ¤ä¸€ä¸ªwaitStatusçŠ¶æ€ï¼Œå…¶ä¸­0ä¸ºé»˜è®¤æ­£å¸¸çŠ¶æ€</li><li>Nodeçš„åˆ›å»ºæ˜¯æ‡’æƒ°çš„</li><li>å…¶ä¸­ç¬¬ä¸€ä¸ªNodeè¢«ç§°ä¸ºå“‘å…ƒæˆ–è€…å“¨å…µï¼Œç”¨æ¥å ä½ï¼Œä¸å…³è”çº¿ç¨‹</li></ol></li></ol><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201119151652850.png" alt="image-20201119151652850"></p><p>å½“çº¿ç¨‹è¿›å…¥acquireQueuedé€»è¾‘</p><ol><li>acquireQueuedä¼šåœ¨ä¸€ä¸ªæ­»å¾ªç¯ä¸­ä¸æ–­å°è¯•è·å¾—é”ï¼Œå¤±è´¥åè¿›å…¥parké˜»å¡</li><li>å¦‚æœè‡ªå·±æ˜¯è€äºŒï¼ˆç´§æŒ¨ç€headï¼‰ï¼Œé‚£ä¹ˆå†æ¬¡tryAcquireå°è¯•è·å–é”ï¼Œå½“ç„¶è¿™æ—¶stateä»ä¸º1ï¼Œå¤±è´¥</li><li>è¿›å…¥shouldParkAfterFailedAcquireé€»è¾‘ï¼Œå°†å‰é©±nodeï¼Œå³headçš„waitStatusæ”¹ä¸º-1ï¼Œ<strong>æ„ä¸ºè¿™ä¸ªèŠ‚ç‚¹æœ‰è´£ä»»å”¤é†’åé¢çš„ä¸€ä¸ªèŠ‚ç‚¹</strong>ï¼Œè¿™æ¬¡è¿”å›false</li></ol><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201119152344.png"></p><ol start="4"><li>shouldParkAfterFailedAcquireæ‰§è¡Œå®Œæ¯•å›åˆ°acquireQueuedï¼Œå†æ¬¡tryAcquireå°è¯•è·å–é”ï¼Œ  æ­¤æ—¶stateè¿˜æ˜¯1ï¼Œå¤±è´¥</li><li>å½“å†æ¬¡è¿›å…¥shouldParkAfterFailedAcquireæ—¶ï¼Œå› ä¸ºå®ƒçš„å‰é©±nodeçš„waitStatuså·²ç»æ˜¯-1ï¼Œè¿™æ¬¡è¿”å›true</li><li>å½“è¿›å…¥parkAndCheckInterruptï¼ŒThread-1 è¢«parkäº†</li></ol><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201119152619.png"></p><p>å†æ¬¡æœ‰å¤šä¸ªçº¿ç¨‹ç»å†ä¸Šè¿°è¿‡ç¨‹ç«äº‰å¤±è´¥ï¼Œå˜æˆè¿™ä¸ªæ ·å­</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201119152636.png"></p><p>Thread-0 é‡Šæ”¾é”ï¼Œè¿›å…¥ tryRelease æµç¨‹ï¼Œå¦‚æœæˆåŠŸ</p><ul><li>è®¾ç½®exclusiveOwnerThreadä¸ºNull</li><li>state=0</li></ul><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201119152736.png"></p><p>å½“å‰é˜Ÿåˆ—ä¸ä¸º nullï¼Œå¹¶ä¸” head çš„ waitStatus = -1ï¼Œè¿›å…¥ unparkSuccessor æµç¨‹</p><p>æ‰¾åˆ°é˜Ÿåˆ—ä¸­ç¦» head æœ€è¿‘çš„ä¸€ä¸ª Nodeï¼ˆæ²¡å–æ¶ˆçš„ï¼‰ï¼Œunpark æ¢å¤å…¶è¿è¡Œï¼Œæœ¬ä¾‹ä¸­å³ä¸º Thread-1</p><p>å›åˆ° Thread-1 çš„ acquireQueued æµç¨‹</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201119153103.png"></p><p>å¦‚æœåŠ é”æˆåŠŸï¼ˆæ²¡æœ‰ç«äº‰ï¼‰ï¼Œä¼šè®¾ç½®</p><ul><li>exclusiveOwnerThreadä¸ºThread-1ï¼Œstate=1</li><li>headæŒ‡å‘åˆšåˆšThread-1æ‰€åœ¨çš„nodeï¼Œè¯¥nodeæ¸…ç©ºThread</li><li>åŸæœ¬çš„headå› ä¸ºä»é“¾è¡¨æ–­å¼€ï¼Œ<strong>å¯ä»¥è¢«åƒåœ¾å›æ”¶</strong></li></ul><p>è¿™æ—¶å€™å¦‚æœç”±å…¶ä»–çº¿ç¨‹ç«äº‰ï¼Œï¼ˆéå…¬å¹³çš„æƒ…å†µï¼‰</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201119153259.png"></p><p>å¦‚æœè¢«thread-4æŠ¢å…ˆ</p><ul><li>threadè¢«è®¾ç½®ä¸ºexclusiveOwnerThreadï¼Œstate=1</li><li>Thread-1å†æ¬¡è¿›å…¥acquireQueuedæµç¨‹ï¼Œè·å–é”å¤±è´¥ï¼Œé‡æ–°è¿›å…¥parké˜»å¡</li></ul><hr><h5 id="åŠ é”æºç "><a href="#åŠ é”æºç " class="headerlink" title="åŠ é”æºç "></a>åŠ é”æºç </h5><h5 id="è§£é”æºç "><a href="#è§£é”æºç " class="headerlink" title="è§£é”æºç "></a>è§£é”æºç </h5><h4 id="å¯é‡å…¥åŸç†"><a href="#å¯é‡å…¥åŸç†" class="headerlink" title="å¯é‡å…¥åŸç†"></a>å¯é‡å…¥åŸç†</h4><h4 id="å¯æ‰“æ–­åŸç†"><a href="#å¯æ‰“æ–­åŸç†" class="headerlink" title="å¯æ‰“æ–­åŸç†"></a>å¯æ‰“æ–­åŸç†</h4><h5 id="ä¸å¯æ‰“æ–­æ¨¡å¼"><a href="#ä¸å¯æ‰“æ–­æ¨¡å¼" class="headerlink" title="ä¸å¯æ‰“æ–­æ¨¡å¼"></a>ä¸å¯æ‰“æ–­æ¨¡å¼</h5><h5 id="å¯æ‰“æ–­æ¨¡å¼"><a href="#å¯æ‰“æ–­æ¨¡å¼" class="headerlink" title="å¯æ‰“æ–­æ¨¡å¼"></a>å¯æ‰“æ–­æ¨¡å¼</h5><h4 id="å…¬å¹³é”å®ç°åŸç†"><a href="#å…¬å¹³é”å®ç°åŸç†" class="headerlink" title="å…¬å¹³é”å®ç°åŸç†"></a>å…¬å¹³é”å®ç°åŸç†</h4><h4 id="æ¡ä»¶å˜é‡å®ç°åŸç†"><a href="#æ¡ä»¶å˜é‡å®ç°åŸç†" class="headerlink" title="æ¡ä»¶å˜é‡å®ç°åŸç†"></a>æ¡ä»¶å˜é‡å®ç°åŸç†</h4><blockquote><p>æ¯ä¸ªæ¡ä»¶å˜é‡å…¶å®å°±å¯¹åº”ç€ä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—ï¼Œå…¶å®ç°ç±»æ˜¯ ConditionObject</p></blockquote><h5 id="awaitæµç¨‹"><a href="#awaitæµç¨‹" class="headerlink" title="awaitæµç¨‹"></a>awaitæµç¨‹</h5><p>å¼€å§‹ Thread-0 æŒæœ‰é”ï¼Œè°ƒç”¨ awaitï¼Œè¿›å…¥ ConditionObject çš„ addConditionWaiter æµç¨‹</p><p>åˆ›å»ºæ–°çš„ Node çŠ¶æ€ä¸º -2ï¼ˆNode.CONDITIONï¼‰ï¼Œå…³è” Thread-0ï¼ŒåŠ å…¥ç­‰å¾…é˜Ÿåˆ—å°¾éƒ¨</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201119154940.png"></p><p>æ¥ä¸‹æ¥è¿›å…¥ AQS çš„ fullyRelease æµç¨‹ï¼Œé‡Šæ”¾åŒæ­¥å™¨ä¸Šçš„é”</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201119155013.png"></p><p>unpark AQS é˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç«äº‰é”ï¼Œå‡è®¾æ²¡æœ‰å…¶ä»–ç«äº‰çº¿ç¨‹ï¼Œé‚£ä¹ˆ Thread-1 ç«äº‰æˆåŠŸ</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201119155032735.png"></p><p>park é˜»å¡ Thread-0</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201119155043919.png"></p><h5 id="signalæµç¨‹"><a href="#signalæµç¨‹" class="headerlink" title="signalæµç¨‹"></a>signalæµç¨‹</h5><p>å‡è®¾ Thread-1 è¦æ¥å”¤é†’ Thread-0</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201119155129.png"></p><p>è¿›å…¥ ConditionObject çš„ doSignal æµç¨‹ï¼Œå–å¾—ç­‰å¾…é˜Ÿåˆ—ä¸­ç¬¬ä¸€ä¸ª Nodeï¼Œå³ Thread-0 æ‰€åœ¨ Node</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/20201119164221.png"></p><p>æ‰§è¡Œ transferForSignal æµç¨‹ï¼Œå°†è¯¥ Node åŠ å…¥ AQS é˜Ÿåˆ—å°¾éƒ¨ï¼Œå°† Thread-0 çš„ waitStatus æ”¹ä¸º 0ï¼ŒThread-3 çš„</p><p>waitStatus æ”¹ä¸º -1</p><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201119164420461.png"></p><p>Thread-1 é‡Šæ”¾é”ï¼Œè¿›å…¥ unlock æµç¨‹</p><h4 id="è¯»å†™é”"><a href="#è¯»å†™é”" class="headerlink" title="è¯»å†™é”"></a>è¯»å†™é”</h4><p><strong>ReentrantReadWriteLock</strong></p><p>å½“è¯»æ“ä½œè¿œè¿œé«˜äºå†™æ“ä½œæ—¶ï¼Œè¿™æ—¶å€™ä½¿ç”¨<code>è¯»å†™é”</code> è®©<code>è¯»</code>å¯ä»¥å¹¶å‘ï¼Œæé«˜æ€§èƒ½ã€‚ ç±»ä¼¼äºæ•°æ®åº“ä¸­çš„ <code>select ...from ... lock in share mode</code></p><p>æä¾›ä¸€ä¸ª<code>æ•°æ®å®¹å™¨ç±»</code>å†…éƒ¨åˆ†åˆ«ä½¿ç”¨è¯»é”ä¿æŠ¤æ•°æ®çš„<code>read()</code>æ–¹æ³•ï¼Œå†™é”ä¿æŠ¤æ•°æ®çš„<code>write()</code>æ–¹æ³•</p><ul><li>è¯»é”å’Œè¯»é”ä¹‹é—´ä¸ä¼šé˜»å¡</li><li>è¯»é”å’Œå†™é”ä¹‹é—´ä¼šé˜»å¡</li><li>å†™é”å’Œå†™é”ä¹‹é—´ä¼šé˜»å¡</li></ul><h5 id="è¯»å†™é”åŸç†"><a href="#è¯»å†™é”åŸç†" class="headerlink" title="è¯»å†™é”åŸç†"></a>è¯»å†™é”åŸç†</h5><h5 id="StampedLock"><a href="#StampedLock" class="headerlink" title="StampedLock"></a>StampedLock</h5><h5 id="Semaphore"><a href="#Semaphore" class="headerlink" title="Semaphore"></a>Semaphore</h5><blockquote><p>é™åˆ¶åŒæ—¶è®¿é—®å…±äº«èµ„æºçš„çº¿ç¨‹ä¸Šé™ï¼Œä¿¡å·é‡ </p></blockquote><h5 id="countdownLatch"><a href="#countdownLatch" class="headerlink" title="countdownLatch"></a>countdownLatch</h5><blockquote><p>ç”¨æ¥è¿›è¡Œçº¿ç¨‹åŒæ­¥å†™ä½œï¼Œç­‰å¾…æ‰€æœ‰çº¿ç¨‹å®Œæˆå€’è®¡æ—¶</p><p>å…¶ä¸­æ„é€ å‡½æ•°ç”¨æ¥åˆå§‹åŒ–ç­‰å¾…è®¡æ•°å€¼ï¼Œawait()ç”¨æ¥ç­‰å¾…è®¡æ•°å½’é›¶ï¼ŒcountDown()ç”¨æ¥è®©è®¡æ•°å‡ä¸€</p></blockquote><h4 id="çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»"><a href="#çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»" class="headerlink" title="çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»"></a>çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»</h4><p><img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201123111413273.png" alt="image-20201123111413273"></p><h2 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h2><blockquote><p>å¤„ç†å™¨å¦‚ä½•å®ç°åŸå­æ“ä½œï¼Ÿ</p></blockquote><ol><li><p>ä½¿ç”¨<strong>æ€»çº¿é”</strong>ä¿è¯åŸå­æ€§</p><p>åœ¨å¤šä¸ªå¤„ç†å™¨å¤„ç†åŒä¸€å—å…±äº«å˜é‡çš„æ—¶å€™ï¼Œä½¿ç”¨å¤„ç†å™¨æä¾›çš„ä¸€ä¸ª<strong>LOCK#ä¿¡å·</strong>ï¼Œå½“ä¸€ä¸ªå¤„ç†å™¨åœ¨æ€»çº¿ä¸Šè¾“å‡ºæ­¤ä¿¡å·ï¼Œ<strong>å…¶ä»–å¤„ç†å™¨çš„è¯·æ±‚å°†è¢«é˜»å¡ä½</strong>ï¼Œé‚£ä¹ˆè¯¥å¤„ç†å™¨å¯ä»¥<strong>ç‹¬äº«</strong>è¯¥å…±äº«å†…å­˜</p></li><li><p>ä½¿ç”¨<strong>ç¼“å­˜é”å®š</strong>ä¿è¯åŸå­æ€§</p><p>é¢‘ç¹ä½¿ç”¨å†…å­˜ä¼šç¼“å­˜åœ¨å¤„ç†å™¨ä¸­çš„L1ã€L2ã€L3çš„é«˜é€Ÿç¼“å­˜ä¸­ï¼Œé‚£ä¹ˆåŸå­æ“ä½œå¯ä»¥ç›´æ¥åœ¨å¤„ç†å™¨å†…éƒ¨ç¼“å­˜ä¸­æ‰§è¡Œï¼Œä¸ç”¨å†å£°æ˜æ€»çº¿é”ã€‚</p><p>æ‰€è°“çš„â€œç¼“å­˜é”å®šâ€ï¼š<img src="https://gitee.com/zhang_hao_yu123/images/raw/master/image-20201123152344569.png" alt="image-20201123152344569"></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> å¹¶å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¹¶å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jvmé¢è¯•é¢˜</title>
      <link href="2020/10/25/jvm-mian-shi-ti/"/>
      <url>2020/10/25/jvm-mian-shi-ti/</url>
      
        <content type="html"><![CDATA[<h1 id="JVMç›¸å…³é¢è¯•é¢˜"><a href="#JVMç›¸å…³é¢è¯•é¢˜" class="headerlink" title="JVMç›¸å…³é¢è¯•é¢˜"></a>JVMç›¸å…³é¢è¯•é¢˜</h1><h2 id="jvmçš„å†…å­˜æ¨¡å‹ä»¥åŠåˆ†åŒºæƒ…å†µå’Œä½œç”¨"><a href="#jvmçš„å†…å­˜æ¨¡å‹ä»¥åŠåˆ†åŒºæƒ…å†µå’Œä½œç”¨" class="headerlink" title="jvmçš„å†…å­˜æ¨¡å‹ä»¥åŠåˆ†åŒºæƒ…å†µå’Œä½œç”¨"></a>jvmçš„å†…å­˜æ¨¡å‹ä»¥åŠåˆ†åŒºæƒ…å†µå’Œä½œç”¨</h2><blockquote><p>jvmå†…å­˜æ¨¡å‹</p></blockquote><p>jvmå†…å­˜æ¨¡å‹åˆ†ä¸º5ä¸ªéƒ¨åˆ†ï¼Œè™šæ‹Ÿæœºæ ˆï¼Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œç¨‹åºè®¡æ•°å™¨ï¼Œå †ï¼Œæ–¹æ³•åŒºã€‚å…¶ä¸­è™šæ‹Ÿæœºæ ˆï¼Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œç¨‹åºè®¡æ•°å™¨æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼›å †å’Œæ–¹æ³•åŒºæ˜¯çº¿ç¨‹å…±äº«çš„ã€‚</p><p>é¦–å…ˆæ˜¯ç¨‹åºè®¡æ•°å™¨ï¼Œæ˜¯ç”¨æ¥è®°å½•æ‰§è¡Œå¼•æ“ä¸‹ä¸€æ¡æ‰§è¡Œçš„å­—èŠ‚ç åœ°å€çš„ï¼Œå› ä¸ºä»…ä»…å­˜ä¸€ä¸ªåœ°å€ï¼Œæ‰€ä»¥ä¸å­˜åœ¨OOMå’ŒGCçš„æƒ…å†µï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸæ˜¯è´¯ç©¿æ•´ä¸ªè™šæ‹Ÿæœºçš„ä¸€ç”Ÿã€‚å½“ä»–æ‰§è¡Œæœ¬åœ°æ–¹æ³•çš„æ—¶å€™ï¼Œè®°å½•çš„å€¼æ˜¯undifinedï¼Œå¦åˆ™ä»–å°±æ˜¯è®°å½•ç€ä¸‹ä¸€æ¡æ‰§è¡Œçš„å­—èŠ‚ç åœ°å€ã€‚é˜²æ­¢çº¿ç¨‹åœ¨è¢«å†æ¬¡è°ƒåº¦åä¸çŸ¥é“ä¸Šæ¬¡æ‰§è¡Œåˆ°å“ªé‡Œäº†ã€‚</p><p>ç¬¬äºŒæ˜¯è™šæ‹Ÿæœºæ ˆï¼Œè™šæ‹Ÿæœºæ ˆæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œå½“è¦æ‰§è¡ŒæŸä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œå°±ä¼šæŠŠè¿™ä¸ªæ–¹æ³•å‹å…¥æ ˆä¸­ï¼Œæˆä¸ºä¸€ä¸ªæ ˆå¸§ï¼Œæ ˆå¸§ä¸­åŒ…æ‹¬ å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•è¿”å›åœ°å€ã€å…¶ä»–çš„ä¸€äº›é™„åŠ ä¿¡æ¯ç­‰ã€‚</p><p>å±€éƒ¨å˜é‡è¡¨xxxxxxxxxx</p><p>ç¬¬ä¸‰ä¸ªæ˜¯æœ¬åœ°æ–¹æ³•æ ˆï¼Œæœ¬åœ°æ–¹æ³•æ ˆæ˜¯ä¸ºnativeæ–¹æ³•æ‰§è¡ŒæœåŠ¡ï¼Œä½œç”¨ä¸è™šæ‹Ÿæœºæ ˆå·®ä¸å¤šç›¸åŒ</p><p>ç¬¬å››ä¸ªæ˜¯æ–¹æ³•åŒº</p><p>ç¬¬äº”ä¸ªæ˜¯å †</p><blockquote><p>åˆ†åŒºæƒ…å†µ</p></blockquote><hr><h2 id="Javaä¸­å¸¸è§çš„å†…å­˜æ³„æ¼ä¾‹å­"><a href="#Javaä¸­å¸¸è§çš„å†…å­˜æ³„æ¼ä¾‹å­" class="headerlink" title="Javaä¸­å¸¸è§çš„å†…å­˜æ³„æ¼ä¾‹å­"></a>Javaä¸­å¸¸è§çš„å†…å­˜æ³„æ¼ä¾‹å­</h2><blockquote><p>åœ¨javaä¸­æˆ‘ä»¬ä¸èƒ½ç”¨ å¼•ç”¨è®¡æ•°æ³•çš„é‚£ä¸ªä¾‹å­æ¥è¯´</p><p>å¯¹äºå¯è¾¾æ€§åˆ†ææ³•ï¼š<strong>ä¸å†ä¼šè¢«ä½¿ç”¨çš„å¯¹è±¡çš„å†…å­˜ä¸èƒ½è¢«å›æ”¶ï¼Œå°±æ˜¯å†…å­˜æ³„éœ²ã€‚</strong></p></blockquote><p><strong>å¦‚æœé•¿ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡æŒæœ‰çŸ­ç”Ÿå‘½å‘¨æœŸçš„å¼•ç”¨ï¼Œé‚£ä¹ˆå°±å¯èƒ½å‡ºç°å†…å­˜æ³„æ¼</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Simple</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Object</span> object<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//...å…¶ä»–ä»£ç </span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œçš„Objectå®ä¾‹ï¼Œåœ¨æ–¹æ³•ä¸­newçš„æ—¶å€™ï¼Œæˆ‘ä»¬æƒ³è®©ä»–çš„ç”Ÿå‘½å‘¨æœŸå°±åœ¨æ–¹æ³•ä¸­ï¼Œä½†æ˜¯æˆ‘ä»¬å´å‘ç°ï¼Œæ–¹æ³•ç»“æŸåè¢«å¼¹å‡ºæ ˆåï¼Œobjectè¿˜ä¿ç•™ç€åŸæ¥çš„å¼•ç”¨ï¼Œè¿™ä¸ªnewçš„å¯¹è±¡ä¸èƒ½è¢«åŠæ—¶çš„é‡Šæ”¾æ‰ï¼Œè¿™å°±æ˜¯ä¸€ç§<strong>å†…å­˜æ³„éœ²</strong>ã€‚è§£å†³çš„åŠæ³•å°±æ˜¯æŠŠobjectå˜æˆæ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡ï¼Œæˆ–è€…æœ€ç»ˆè®¾ç½®ä¸ºnullï¼ˆå¦‚ä¸‹ï¼‰</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Simple</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Object</span> object<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//...å…¶ä»–ä»£ç </span>        object <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ç§è®¾ä¸ºNULLçš„æ˜¯å¾ˆæœ‰å¿…è¦çš„æ“ä½œã€‚</p><blockquote><p>é™æ€é›†åˆ</p></blockquote><p>åƒHashMapã€Vectorã€Listç­‰çš„ä½¿ç”¨æœ€å®¹æ˜“å‡ºç°å†…å­˜æ³„æ¼ï¼Œè¿™äº›é™æ€å˜é‡çš„ç”Ÿå‘½å‘¨æœŸå’Œåº”ç”¨ç¨‹åºä¸€è‡´ï¼Œæ‰€æœ‰çš„å¯¹è±¡Objectä¹Ÿä¸èƒ½è¢«é‡Šæ”¾</p><blockquote><p>å„ç§è¿æ¥å¯¹è±¡ï¼ˆIOæµå¯¹è±¡ã€æ•°æ®åº“è¿æ¥å¯¹è±¡ã€ç½‘ç»œè¿æ¥å¯¹è±¡ï¼‰æœªå…³é—­</p></blockquote><p>IOæµå¯¹è±¡ã€æ•°æ®åº“è¿æ¥å¯¹è±¡ã€ç½‘ç»œè¿æ¥å¯¹è±¡å±äºç‰©ç†è¿æ¥ï¼Œå’Œç¡¬ç›˜æˆ–ç½‘ç»œè¿æ¥ï¼Œä¸ä½¿ç”¨çš„æ—¶å€™ä¸€å®šè¦å…³é—­</p><blockquote><p>ç›‘å¬å™¨çš„ä½¿ç”¨</p></blockquote><p>é‡Šæ”¾å¯¹è±¡æ—¶ï¼Œæ²¡æœ‰åˆ é™¤å¯¹åº”çš„ç›‘å¬å™¨</p><hr><h2 id="ä»€ä¹ˆæ˜¯GCï¼Ÿä¸ºä»€ä¹ˆè¦GCï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯GCï¼Ÿä¸ºä»€ä¹ˆè¦GCï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯GCï¼Ÿä¸ºä»€ä¹ˆè¦GCï¼Ÿ"></a>ä»€ä¹ˆæ˜¯GCï¼Ÿä¸ºä»€ä¹ˆè¦GCï¼Ÿ</h2><blockquote><p>GCæ˜¯åƒåœ¾å›æ”¶çš„æ„æ€ï¼Œé‚£äº›ä¸å†ä½¿ç”¨çš„å¯¹è±¡ï¼Œæˆ–è€…å¯è¾¾æ€§åˆ†ææ³•æ— æ³•åˆ°è¾¾çš„å¯¹è±¡å°±æ˜¯åƒåœ¾ï¼Œjavaé€šè¿‡gcåŠŸèƒ½è‡ªåŠ¨ç›‘æµ‹å¯¹è±¡æ˜¯å¦è¾¾åˆ°äº†è‡ªåŠ¨å›æ”¶å†…å­˜çš„ç›®çš„ï¼Œjavaä¸­æ²¡æœ‰æ˜¾ç¤ºé‡Šæ”¾å†…å­˜çš„æ–¹æ³•ã€‚</p></blockquote><hr><h2 id="è¯´è¯´javaä¸­çš„åƒåœ¾å›æ”¶æœºåˆ¶"><a href="#è¯´è¯´javaä¸­çš„åƒåœ¾å›æ”¶æœºåˆ¶" class="headerlink" title="è¯´è¯´javaä¸­çš„åƒåœ¾å›æ”¶æœºåˆ¶"></a>è¯´è¯´javaä¸­çš„åƒåœ¾å›æ”¶æœºåˆ¶</h2><p>åœ¨jvmä¸­ï¼Œæœ‰ä¸€ä¸ªåƒåœ¾å›æ”¶çº¿ç¨‹ï¼Œå®ƒæ˜¯ä½ä¼˜å…ˆçº§çš„ï¼Œåœ¨æ­£å¸¸æƒ…å†µä¸‹æ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œåªæœ‰åœ¨è™šæ‹Ÿæœºç©ºé—´æˆ–è€…å½“å‰å †å†…å­˜ä¸è¶³æ—¶ï¼Œæ‰ä¼šè§¦å‘æ‰§è¡Œï¼Œæ‰«ææ²¡æœ‰è¢«ä»»ä½•å¼•ç”¨çš„å¯¹è±¡ï¼ŒæŠŠä»–ä»¬æ·»åŠ åˆ°è¦å›æ”¶çš„é›†åˆä¸­ï¼Œè¿›è¡Œå›æ”¶ã€‚</p><hr><h2 id="å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡å­˜æ´»ï¼Ÿ"><a href="#å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡å­˜æ´»ï¼Ÿ" class="headerlink" title="å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡å­˜æ´»ï¼Ÿ"></a>å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡å­˜æ´»ï¼Ÿ</h2><blockquote><p>å¼•ç”¨è®¡æ•°æ³•</p></blockquote><p>æ¯ä¸ªå¯¹è±¡éƒ½ç»´æŠ¤ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œå½“æœ‰åˆ«çš„ä¸œè¥¿å¼•ç”¨ä»–çš„æ—¶å€™ï¼Œå°±è®©å¼•ç”¨è®¡æ•°å™¨+1ï¼Œå½“GCçš„æ—¶å€™ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨è®¡æ•°å™¨ä¸º0ï¼Œå¯ä»¥è¯´æ˜è¿™ä¸ªå¯¹è±¡æ˜¯æ²¡æœ‰è¢«å¼•ç”¨çš„ï¼Œå°†ä¼šè¢«åƒåœ¾å›æ”¶ã€‚ä¸è¿‡å¼•ç”¨è®¡æ•°æ³•åœ¨javaä¸­æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼š<strong>å¾ªç¯å¼•ç”¨</strong>ï¼Œ  æ¯”å¦‚ï¼ŒAä½œä¸ºæ ¹èŠ‚ç‚¹ï¼ŒAå¼•ç”¨äº†Bï¼ŒBå¼•ç”¨äº†Cï¼ŒCå¼•ç”¨äº†Bï¼Œå½“Aåˆ‡æ–­ä¸Bçš„å¼•ç”¨çš„æ—¶å€™ï¼ŒBçš„å¼•ç”¨è®¡æ•°å™¨ä¸º1ï¼ŒCçš„å¼•ç”¨è®¡æ•°å™¨ä¸º1ï¼Œä»–ä»¬ä¸¤ä¸ªç›¸äº’å¼•ç”¨ï¼Œä½¿å¾—GCä¸èƒ½å¤Ÿå›æ”¶ä»–ä»¬ã€‚</p><blockquote><p>å¯è¾¾æ€§åˆ†ææ³•</p></blockquote><p>æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œä»ä¸€ä¸ªæ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œå‘ä¸‹éå†ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡åˆ°æ ¹èŠ‚ç‚¹æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾é“¾æ¥ï¼Œé‚£ä¹ˆå°±è¯´æ˜è¯¥å¯¹è±¡ä¸å¯ç”¨ã€‚</p><hr><h3 id="å¯ä½œä¸ºGC-rootçš„æœ‰ï¼Ÿ"><a href="#å¯ä½œä¸ºGC-rootçš„æœ‰ï¼Ÿ" class="headerlink" title="å¯ä½œä¸ºGC rootçš„æœ‰ï¼Ÿ"></a>å¯ä½œä¸ºGC rootçš„æœ‰ï¼Ÿ</h3><ul><li>xxxxxxxxxxxxxxxxx</li></ul><hr><h3 id="å¯¹è±¡çš„finalizationæœºåˆ¶ï¼Ÿ"><a href="#å¯¹è±¡çš„finalizationæœºåˆ¶ï¼Ÿ" class="headerlink" title="å¯¹è±¡çš„finalizationæœºåˆ¶ï¼Ÿ"></a>å¯¹è±¡çš„finalizationæœºåˆ¶ï¼Ÿ</h3><p>å¯¹è±¡è¢«å½“ä½œåƒåœ¾å›æ”¶çš„æ—¶å€™ï¼Œä¸ä¼šç«‹å³å›æ”¶ï¼Œå¦‚æœè¦å›æ”¶è¿˜éœ€è¦ç»å†<strong>ä¸¤æ¬¡æ ‡è®°</strong>ï¼Œç¬¬ä¸€æ¬¡æ˜¯ä»æ ¹èŠ‚ç‚¹æ²¡æœ‰å¼•ç”¨é“¾å¯ä»¥æŒ‡å‘å®ƒçš„æ—¶å€™ï¼Œå¹¶ä¸”ä¼šè¿›è¡Œä¸€æ¬¡ç­›é€‰ï¼Œæ¡ä»¶æ˜¯æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•ï¼Œå½“å¯¹è±¡æ²¡æœ‰é‡å†™finalize()æ–¹æ³•æˆ–è€…å·²ç»è¢«è°ƒç”¨è¿‡ä¸€æ¬¡äº†ï¼Œé‚£ä¹ˆå°±ä¼šè¢«è®¤ä¸ºæ˜¯æ²¡å¿…è¦çš„ã€‚å¦‚æœæœ‰å¿…è¦æ‰§è¡Œï¼Œå°±æ”¾åˆ°ä¸€ä¸ªF-Queueé˜Ÿåˆ—ä¸­ï¼Œjvmä¼šè§¦å‘ä¸€ä¸ªFinalizeçº¿ç¨‹å»æ‰§è¡Œï¼Œè¿™æ˜¯ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹ã€‚ä½†æ˜¯å¦‚æœfinalize()æ‰§è¡Œçš„è¿‡æ…¢æˆ–è€…å‘ç”Ÿæ­»é”å¯¼è‡´F-Queueé˜Ÿåˆ—ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¯¼è‡´å†…å­˜å›æ”¶ç³»ç»Ÿçš„å´©æºƒã€‚GCå°±ä¼šå †F-Queueä¸­çš„å¯¹è±¡è¿›è¡Œç¬¬äºŒæ¬¡æ ‡è®°ï¼Œè¿™æ—¶å€™ï¼Œå¯¹è±¡ä¼šè¢«ç§»é™¤F-Queueï¼Œç­‰å¾…å›æ”¶ã€‚</p><hr><h2 id="ä¸²è¡Œæ”¶é›†å™¨å’Œååé‡æ”¶é›†å™¨çš„åŒºåˆ«æ˜¯ï¼Ÿ"><a href="#ä¸²è¡Œæ”¶é›†å™¨å’Œååé‡æ”¶é›†å™¨çš„åŒºåˆ«æ˜¯ï¼Ÿ" class="headerlink" title="ä¸²è¡Œæ”¶é›†å™¨å’Œååé‡æ”¶é›†å™¨çš„åŒºåˆ«æ˜¯ï¼Ÿ"></a>ä¸²è¡Œæ”¶é›†å™¨å’Œååé‡æ”¶é›†å™¨çš„åŒºåˆ«æ˜¯ï¼Ÿ</h2><p>xxx</p><hr><h2 id="javaå†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥-ä»¥åŠMinor-GCå’ŒMajor-GC"><a href="#javaå†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥-ä»¥åŠMinor-GCå’ŒMajor-GC" class="headerlink" title="javaå†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥ ä»¥åŠMinor GCå’ŒMajor GC"></a>javaå†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥ ä»¥åŠMinor GCå’ŒMajor GC</h2><blockquote><p>å†…å­˜åˆ†é…</p></blockquote><p>å¯¹è±¡é¦–å…ˆè¢«åˆ†é…åˆ°EdenåŒºï¼Œå¦‚æœæ˜¯å¤§å¯¹è±¡ï¼Œä¼šç›´æ¥æ”¾å…¥è€å¹´ä»£ï¼›</p>]]></content>
      
      
      <categories>
          
          <category> jvm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JVM09</title>
      <link href="2020/10/22/jvm09/"/>
      <url>2020/10/22/jvm09/</url>
      
        <content type="html"><![CDATA[<h1 id="åƒåœ¾å›æ”¶å™¨ç›¸å…³"><a href="#åƒåœ¾å›æ”¶å™¨ç›¸å…³" class="headerlink" title="åƒåœ¾å›æ”¶å™¨ç›¸å…³"></a>åƒåœ¾å›æ”¶å™¨ç›¸å…³</h1><h2 id="GCåˆ†ç±»ä¸æ€§èƒ½æŒ‡æ ‡"><a href="#GCåˆ†ç±»ä¸æ€§èƒ½æŒ‡æ ‡" class="headerlink" title="GCåˆ†ç±»ä¸æ€§èƒ½æŒ‡æ ‡"></a>GCåˆ†ç±»ä¸æ€§èƒ½æŒ‡æ ‡</h2><blockquote><p>åˆ†ç±»</p></blockquote><ul><li>çº¿ç¨‹æ•°  ä¸²è¡Œå’Œå¹¶è¡Œ</li><li>å·¥ä½œæ¨¡å¼   å¹¶å‘å¼åƒåœ¾å›æ”¶  å’Œ  ç‹¬å å¼åƒåœ¾å›æ”¶</li><li>ç¢ç‰‡å¤„ç†æ–¹å¼<ul><li>å‹ç¼©å¼ï¼Œåˆ†é…å¯¹è±¡ç”¨æŒ‡é’ˆç¢°æ’</li><li>éå‹ç¼©å¼ï¼Œåˆ†é…å¯¹è±¡ç”¨ç©ºé—²åˆ—è¡¨</li></ul></li><li>å·¥ä½œçš„å†…å­˜åŒºé—´<ul><li>å¹´è½»ä»£åƒåœ¾æ”¶é›†å™¨</li><li>è€å¹´ä»£åƒåœ¾æ”¶é›†å™¨</li></ul></li></ul><blockquote><p>æ€§èƒ½æŒ‡æ ‡</p></blockquote><ul><li><strong>ååé‡ï¼šè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´å æ€»è¿è¡Œæ—¶é—´çš„æ¯”ä¾‹</strong><ul><li>æ€»è¿è¡Œæ—¶é—´ï¼šç¨‹åºçš„è¿è¡Œæ—¶é—´+å†…å­˜å›æ”¶çš„æ—¶é—´</li></ul></li><li>åƒåœ¾æ”¶é›†å¼€é”€ï¼šååé‡çš„è¡¥æ•°</li><li><strong><font color = "red">æš‚åœæ—¶é—´ï¼šæ‰§è¡ŒGCæ—¶ï¼Œç¨‹åºçš„å·¥ä½œçº¿ç¨‹è¢«æš‚åœçš„æ—¶é—´</font></strong></li><li>æ”¶é›†é¢‘ç‡ï¼šç›¸å¯¹äºåº”ç”¨ç¨‹åºçš„æ‰§è¡Œï¼Œæ”¶é›†æ“ä½œå‘ç”Ÿçš„é¢‘ç‡</li><li><strong>å†…å­˜å ç”¨ï¼šjavaå †åŒºæ‰€å çš„å†…å­˜å¤§å°</strong></li><li>å¿«é€Ÿï¼šä¸€ä¸ªå¯¹è±¡ä»è¯ç”Ÿåˆ°è¢«å›æ”¶æ‰€ç»å†çš„æ—¶é—´</li></ul><p><img src="https://img01.sogoucdn.com/app/a/100520146/29eadcb517bddc8e7d8bf9665679ed6a"></p><h2 id="ä¸åŒçš„åƒåœ¾å›æ”¶å™¨æ¦‚è¿°-é¢è¯•ä¼šé—®"><a href="#ä¸åŒçš„åƒåœ¾å›æ”¶å™¨æ¦‚è¿°-é¢è¯•ä¼šé—®" class="headerlink" title="ä¸åŒçš„åƒåœ¾å›æ”¶å™¨æ¦‚è¿°(é¢è¯•ä¼šé—®)"></a>ä¸åŒçš„åƒåœ¾å›æ”¶å™¨æ¦‚è¿°(é¢è¯•ä¼šé—®)</h2><p><img src="https://img03.sogoucdn.com/app/a/100520146/e71ca3bc35fec312db08fc9f227cb00b" alt="UTOOLS1603418671399.png"></p><ul><li>ä¸²è¡Œå›æ”¶ï¼š Serialã€Serial old</li><li>å¹¶è¡Œå›æ”¶ï¼šParNewã€Parallelã€Scavengeã€Parallel old</li><li>å¹¶å‘å›æ”¶ï¼šCMSã€G1</li></ul><blockquote><p>åƒåœ¾å›æ”¶å™¨çš„ç»„åˆå…³ç³»</p></blockquote><p><img src="https://img03.sogoucdn.com/app/a/100520146/003f4646493bfd2852b7bd4a3842034b" alt="åˆ†ä»£åƒåœ¾æ”¶é›†å™¨"></p><p><img src="https://img04.sogoucdn.com/app/a/100520146/f27f9f03ee4bc028e9308f08e64d5f4b" alt="åƒåœ¾æ”¶é›†å™¨çš„ç»„åˆå…³ç³»"></p><h2 id="Serialå›æ”¶å™¨ï¼šä¸²è¡Œå›æ”¶"><a href="#Serialå›æ”¶å™¨ï¼šä¸²è¡Œå›æ”¶" class="headerlink" title="Serialå›æ”¶å™¨ï¼šä¸²è¡Œå›æ”¶"></a>Serialå›æ”¶å™¨ï¼šä¸²è¡Œå›æ”¶</h2><blockquote><p>æœ€åŸºæœ¬æœ€æ‚ ä¹…çš„<strong>å•cpu</strong>åƒåœ¾æ”¶é›†å™¨</p></blockquote><ul><li><p>é‡‡ç”¨ <strong>å¤åˆ¶ç®—æ³•</strong>ã€<strong>ä¸²è¡Œå›æ”¶</strong>å’Œ <strong>STWæœºåˆ¶çš„æ–¹å¼æ‰§è¡Œå†…å­˜å›æ”¶</strong></p></li><li><p>é™¤äº†å¹´è½»ä»£ä»¥å¤–ï¼ŒSerialæ”¶é›†å™¨è¿˜æä¾›ç”¨äºæ‰§è¡Œè€å¹´ä»£åƒåœ¾æ”¶é›†çš„Serial Oldæ”¶é›†å™¨ã€‚<strong>Serial Oldæ”¶é›†å™¨åŒæ ·ä¹Ÿé‡‡ç”¨äº†ä¸²è¡Œå›æ”¶å’ŒSTWæœºåˆ¶ï¼Œåªä¸è¿‡å†…å­˜å›æ”¶ç®—æ³•ä½¿ç”¨çš„æ˜¯æ ‡è®°-å‹ç¼©ç®—æ³•ã€‚</strong></p><ul><li>Serial Oldæ˜¯è¿è¡Œåœ¨Clientæ¨¡å¼ä¸‹é»˜è®¤çš„è€å¹´ä»£çš„åƒåœ¾å›æ”¶å™¨</li><li>Serial Oldåœ¨Serveræ¨¡å¼ä¸‹ä¸»è¦æœ‰ä¸¤ä¸ªç”¨é€”ï¼šâ‘ ä¸æ–°ç”Ÿä»£çš„Parallel Scavengeé…åˆä½¿ç”¨ã€‚â‘¡ä½œä¸ºè€å¹´ä»£CMSæ”¶é›†å™¨çš„åå¤‡åƒåœ¾æ”¶é›†æ–¹æ¡ˆ</li></ul></li><li><p><strong>æ˜¯ä¸ªå•çº¿ç¨‹åƒåœ¾æ”¶é›†å™¨</strong></p></li></ul><blockquote><p>ä¼˜åŠ¿ï¼š</p></blockquote><ul><li><p><strong>ç®€å•è€Œé«˜æ•ˆ</strong>ï¼Œå¯¹äºé™å®šå•ä¸ªcpuçš„ç¯å¢ƒæ¥è¯´ï¼ŒSerialæ”¶é›†å™¨ç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œä¸“å¿ƒåšGCè‡ªç„¶å¯ä»¥è·å¾—æœ€é«˜çš„æ•ˆç‡</p></li><li><p>åœ¨ç”¨æˆ·çš„æ¡Œé¢å¼•ç”¨åœºæ™¯ä¸­å¯ä»¥ç”¨ä¸²è¡Œå›æ”¶å™¨</p></li><li><p>ä½¿ç”¨-XX:+UseSerialGC å‚æ•°å¯ä»¥æŒ‡å®šå¹´è½»ä»£å’Œè€å¹´ä»£éƒ½ä½¿ç”¨ä¸²è¡Œæ”¶é›†å™¨</p><ul><li>ç­‰ä»·äºæ–°ç”Ÿä»£ç”¨ Serial GC è€å¹´ä»£ç”¨ Serial Old GC</li></ul></li></ul><h2 id="ParNewå›æ”¶å™¨ï¼šå¹¶è¡Œå›æ”¶"><a href="#ParNewå›æ”¶å™¨ï¼šå¹¶è¡Œå›æ”¶" class="headerlink" title="ParNewå›æ”¶å™¨ï¼šå¹¶è¡Œå›æ”¶"></a>ParNewå›æ”¶å™¨ï¼šå¹¶è¡Œå›æ”¶</h2><blockquote><p>ParNewæ”¶é›†å™¨é™¤äº†é‡‡ç”¨ <strong>å¹¶è¡Œå›æ”¶</strong>çš„æ–¹å¼æ‰§è¡Œå†…å­˜å›æ”¶å¤–ï¼Œå‡ ä¹è·ŸSerial GCæ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚</p><p>ParNew<strong>åœ¨å¹´è½»ä»£ä¸­åŒæ ·é‡‡ç”¨å¤åˆ¶ç®—æ³•ï¼ŒSTWæœºåˆ¶</strong></p><p>ParNewæ˜¯å¾ˆå¤šJVMè¿è¡Œåœ¨Serveræ¨¡å¼ä¸‹æ–°ç”Ÿä»£çš„é»˜è®¤åƒåœ¾å›æ”¶å™¨</p></blockquote><ul><li>åœ¨å¤šcpuçš„ç¯å¢ƒä¸‹ï¼ŒParNewå¯ä»¥æ›´å¿«é€Ÿåœ°å®Œæˆåƒåœ¾æ”¶é›†ï¼Œæå‡ç¨‹åºçš„ååé‡</li><li>é™¤äº†Serialå¤–è¿˜èƒ½å’ŒCMSè¿›è¡Œé…åˆä½¿ç”¨</li></ul><h2 id="Parallelå›æ”¶å™¨ï¼šååé‡ä¼˜å…ˆ"><a href="#Parallelå›æ”¶å™¨ï¼šååé‡ä¼˜å…ˆ" class="headerlink" title="Parallelå›æ”¶å™¨ï¼šååé‡ä¼˜å…ˆ"></a>Parallelå›æ”¶å™¨ï¼šååé‡ä¼˜å…ˆ</h2><blockquote><p>hotspotä¸­æ”¶é›†æ–°ç”Ÿä»£çš„é™¤äº†ParNew GCæ˜¯åŸºäºå¹¶è¡Œå›æ”¶çš„ä¹‹å¤–ï¼ŒParallel Scavenge GCåŒæ · <strong>é‡‡ç”¨äº†å¤åˆ¶ç®—æ³•ï¼Œå¹¶è¡Œå›æ”¶å’ŒSTWæœºåˆ¶</strong></p><p>jdk8ä¸­é»˜è®¤çš„åƒåœ¾æ”¶é›†å™¨</p></blockquote><ul><li><strong>Parallelçš„å‡ºç°æ˜¯å¦å¤šæ­¤ä¸€ä¸¾ï¼Ÿ</strong><ul><li>Parallel scavenge GCæ”¶é›†å™¨çš„ç›®æ ‡æ˜¯<strong>è¾¾åˆ°ä¸€ä¸ªå¯æ§åˆ¶çš„ååé‡</strong>ï¼Œæ˜¯ä¸€ä¸ªååé‡ä¼˜å…ˆçš„åƒåœ¾æ”¶é›†å™¨</li><li><strong>è‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥</strong>ä¹Ÿæ˜¯Parallel Scavengeå’ŒParNewä¸ä¸€æ ·çš„åœ°æ–¹</li></ul></li><li>é«˜ååé‡åˆ™å¯ä»¥é«˜æ•ˆç‡åœ°åˆ©ç”¨cpuæ—¶é—´ï¼Œå°½å¿«å®Œæˆç¨‹åºçš„è¿ç®—ä»»åŠ¡ï¼Œä¸»è¦è¦<strong>é€‚åˆåœ¨åå°è¿ç®—è€Œä¸éœ€è¦å¤ªå¤šäº¤äº’çš„ä»»åŠ¡ã€‚</strong>å› æ­¤ï¼Œå¸¸è§åœ¨æœåŠ¡å™¨ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ä¾‹å¦‚æ‰¹é‡å¤„ç†ï¼Œè®¢å•å¤„ç†ï¼Œå·¥èµ„æ”¯ä»˜ï¼Œç§‘å­¦è®¡ç®—çš„åº”ç”¨ç¨‹åºã€‚</li><li>Parallel Old GCç”¨æ¥ä»£æ›¿è€å¹´ä»£çš„Serial Old GC</li><li>Parallel Oldæ”¶é›†å™¨é‡‡ç”¨äº† <strong>æ ‡è®°-å‹ç¼©ç®—æ³•</strong>ï¼Œä½†åŒæ ·ä¹Ÿæ˜¯<strong>åŸºäº å¹¶è¡Œå›æ”¶å’ŒSTWæœºåˆ¶çš„</strong></li></ul><blockquote><p>å‚æ•°è®¾ç½®</p></blockquote><ul><li>-XX:+UseParallelGC  æ‰‹åŠ¨æŒ‡å®šå¹´è½»ä»£ ParallelGC</li><li>-XX:+UseParallelOldGC  æ‰‹åŠ¨æŒ‡å®šè€å¹´ä»£ParallelOldGC</li><li>-XX:+UseSerialGC  è¡¨æ˜æ–°ç”Ÿä»£ä½¿ç”¨Serial GCï¼Œè€å¹´ä»£ç”¨Serial Old GC</li><li>-XX:+UseParNewGC  è¡¨æ˜æ–°ç”Ÿä»£ä½¿ç”¨ParNew GC</li><li>-XX:ParallelGCThreads è®¾ç½®å¹´è½»ä»£å¹¶è¡Œæ”¶é›†å™¨çš„çº¿ç¨‹æ•°<ul><li>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“cpuæ•°é‡å°äº8ä¸ªï¼ŒParallelGCThreadsçš„å€¼ç­‰äºCPUæ•°é‡</li><li>å½“CPUæ•°é‡å¤§äº8ä¸ªï¼ŒParallelGCThreadsçš„å€¼ç­‰äº3+[5*CPU_Count]/8</li></ul></li><li><img src="https://img02.sogoucdn.com/app/a/100520146/6736c6f7de5b3279191bf05fd9f6f725" alt="UTOOLS1603443657076.png"></li></ul><h2 id="CMSå›æ”¶å™¨ï¼šä½å»¶è¿Ÿ"><a href="#CMSå›æ”¶å™¨ï¼šä½å»¶è¿Ÿ" class="headerlink" title="CMSå›æ”¶å™¨ï¼šä½å»¶è¿Ÿ"></a>CMSå›æ”¶å™¨ï¼šä½å»¶è¿Ÿ</h2><blockquote><p>ç¬¬ä¸€æ¬¾ <strong>å¹¶å‘æ”¶é›†å™¨</strong>ï¼Œç¬¬ä¸€æ¬¡è®©åƒåœ¾æ”¶é›†çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹åŒæ—¶å·¥ä½œã€‚</p><p>GCç®—æ³•é‡‡ç”¨ <strong>æ ‡è®°-æ¸…é™¤ç®—æ³•</strong>ï¼Œä¹Ÿä¼šSTW</p></blockquote><ul><li>åªèƒ½ä¸ParNewå’ŒParalleläºŒé€‰ä¸€é…åˆå·¥ä½œ</li><li>jdk14CMSæ²¡äº†</li></ul><blockquote><p>å·¥ä½œåŸç†</p></blockquote><p><img src="https://img04.sogoucdn.com/app/a/100520146/a72dd7841db48c6357f7da617d670ba5"></p><ul><li>åˆå§‹æ ‡è®°ï¼š<strong>ä»…ä»…æ ‡è®°å‡ºGC Rootsèƒ½å¤Ÿç›´æ¥å…³è”åˆ°çš„å¯¹è±¡</strong>ï¼Œè¿™é‡Œçš„æ‰§è¡Œé€Ÿåº¦éå¸¸å¿«ï¼ŒSTWå¾ˆçŸ­æš‚</li><li>å¹¶å‘æ ‡è®°ï¼šä»GC Rootsçš„ç›´æ¥å…³è”å¯¹è±¡å¼€å§‹éå†æ•´ä¸ªå¯¹åƒå›¾çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹è€—æ—¶è¾ƒé•¿ï¼Œä½†æ˜¯<strong>ä¸éœ€è¦åœé¡¿ç”¨æˆ·çº¿ç¨‹</strong>ï¼Œå¯ä»¥ä¸åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸€èµ·å¹¶å‘è¿è¡Œ</li><li>é‡æ–°æ ‡è®°ï¼š <strong>ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´ï¼Œå› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•</strong>ï¼Œè¿™ä¸ªé˜¶æ®µçš„åœé¡¿æ—¶é—´é€šå¸¸ä¼šæ¯”åˆå§‹æ ‡è®°é˜¶æ®µç¨é•¿ä¸€äº›ï¼Œä½†ä¹Ÿè¿œæ¯”å¹¶å‘æ ‡è®°é˜¶æ®µçš„æ—¶é—´çŸ­</li><li>å¹¶å‘æ¸…é™¤ï¼šæ­¤é˜¶æ®µ<strong>æ¸…ç†åˆ é™¤æ‰æ ‡è®°é˜¶æ®µåˆ¤æ–­çš„å·²ç»æ­»äº¡çš„å¯¹è±¡ï¼Œé‡Šæ”¾å†…å­˜ç©ºé—´</strong>ã€‚ä¸éœ€è¦ç§»åŠ¨å­˜æ´»å¯¹è±¡ï¼Œå¯ä»¥ä¸ç”¨æˆ·çº¿ç¨‹åŒæ—¶å¹¶å‘æ‰§è¡Œ</li></ul><blockquote><p>ç‰¹ç‚¹</p></blockquote><ul><li><p><strong>ç”±äºæœ€è€—è´¹æ—¶é—´çš„å¹¶å‘æ ‡è®°ä¸å¹¶å‘æ¸…é™¤é˜¶æ®µéƒ½ä¸éœ€è¦æš‚åœå·¥ä½œï¼Œæ‰€ä»¥æ•´ä½“çš„å›æ”¶æ˜¯ä½åœé¡¿çš„ã€‚</strong></p></li><li><p>å› ä¸ºç”¨æˆ·çº¿ç¨‹å’ŒGCçº¿ç¨‹æ˜¯å¹¶è¡Œçš„ï¼Œæ‰€ä»¥<strong>CMSå›æ”¶çš„æ—¶å€™è¿˜åº”è¯¥ç¡®ä¿ç¨‹åºç”¨æˆ·çº¿ç¨‹æœ‰è¶³å¤Ÿçš„å†…å­˜å¯ç”¨</strong>ï¼Œæ‰€ä»¥CMSçš„GCæœºåˆ¶æ˜¯<strong>å½“å †å†…å­˜ä½¿ç”¨ç‡è¾¾åˆ°äº†ä¸€ä¸ªé˜ˆå€¼ï¼Œå°±ä¼šå¼€å§‹GC</strong>ã€‚</p></li><li><p>å¦‚æœåœ¨GCçš„æ—¶å€™ï¼Œç”¨æˆ·çº¿ç¨‹æŠŠå†…å­˜å¼„ä¸è¶³äº†ï¼Œå°±ä¼šå¯åŠ¨<strong>Serial Old æ”¶é›†å™¨æ¥è¿›è¡Œè€å¹´ä»£</strong>çš„GCï¼Œ<strong>åœé¡¿æ—¶é—´å°±ä¼šå˜é•¿</strong></p></li></ul><blockquote><p>é‡‡ç”¨æ ‡è®°-æ¸…é™¤ç®—æ³•ï¼Œï¼Œä½¿ç”¨ç©ºé—²åˆ—è¡¨</p></blockquote><p>å› ä¸ºç”¨æˆ·çº¿ç¨‹åœ¨å·¥ä½œä¸­ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨æŒ‡é’ˆç¢°æ’å’Œæ ‡è®°å‹ç¼©ç®—æ³•ã€‚ã€‚</p><blockquote><p>CMSçš„ä¼˜ç‚¹ï¼š</p></blockquote><ol><li>å¹¶å‘æ”¶é›†</li><li>ä½å»¶è¿Ÿ</li></ol><blockquote><p>CMSçš„å¼Šç«¯</p></blockquote><ul><li><p>ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡</p></li><li><p>CMSæ”¶é›†å™¨å¯¹cpuèµ„æºéå¸¸æ•æ„Ÿ</p><blockquote><p>åœ¨å¹¶å‘é˜¶æ®µï¼Œå®ƒè™½ç„¶ä¸ä¼šå¯¼è‡´ç”¨æˆ·åœé¡¿ï¼Œä½†æ˜¯ä¼šå› ä¸ºå ç”¨äº†ä¸€éƒ¨åˆ†çº¿ç¨‹è€Œå¯¼è‡´åº”ç”¨ç¨‹åºå˜æ…¢ï¼Œæ€»ååé‡é™ä½</p></blockquote></li><li><p>CMSæ”¶é›†å™¨æ— æ³•å¤„ç†<strong>æµ®åŠ¨åƒåœ¾</strong></p><blockquote><p><strong>åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µå¦‚æœäº§ç”Ÿæ–°çš„åƒåœ¾å¯¹è±¡ï¼ŒCMSå°†æ— æ³•å¯¹è¿™äº›åƒåœ¾å¯¹è±¡è¿›è¡Œæ ‡è®°ï¼Œæœ€ç»ˆä¼šå¯¼è‡´è¿™äº›æ–°äº§ç”Ÿçš„åƒåœ¾å¯¹è±¡æ²¡æœ‰è¢«åŠæ—¶å›æ”¶ï¼Œ</strong>ä»è€Œåªèƒ½åœ¨ä¸‹ä¸€æ¬¡æ‰§è¡ŒGCæ—¶é‡Šæ”¾è¿™äº›ä¹‹å‰æœªè¢«å›æ”¶çš„å†…å­˜ç©ºé—´ã€‚</p><p>æµ®åŠ¨åƒåœ¾ï¼šé‡æ–°æ ‡è®°ä¿®æ­£çš„é‚£äº›</p></blockquote></li></ul><blockquote><p>è®¾ç½®å‚æ•°</p></blockquote><ul><li>-XX:+UseConcMarkSweepGC æ‰‹åŠ¨æŒ‡å®šCMSæ”¶é›†å™¨æ‰§è¡Œå†…å­˜å›æ”¶ä»»åŠ¡ï¼ˆParNewæ”¶é›†å¹´è½»ä»£ CMSæ”¶é›†è€å¹´ä»£ï¼ŒSerial Oldä½œä¸ºå¤‡ç”¨æ”¶é›†è€å¹´ä»£ï¼‰</li><li>ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</li></ul><blockquote><p>å°ç»“</p></blockquote><p>æœ€å°åŒ–ä½¿ç”¨å†…å­˜å’Œæœ€å°åŒ–å¹¶è¡Œå¼€é”€  Serial GC</p><p>æœ€å¤§åŒ–åº”ç”¨ç¨‹åºååé‡  Parallel GC</p><p>æœ€å°åŒ–GCçš„ä¸­æ–­æˆ–åœé¡¿æ—¶é—´  CMS GC</p><h2 id="G1å›æ”¶å™¨ï¼šåŒºåŸŸåŒ–åˆ†ä»£å¼"><a href="#G1å›æ”¶å™¨ï¼šåŒºåŸŸåŒ–åˆ†ä»£å¼" class="headerlink" title="G1å›æ”¶å™¨ï¼šåŒºåŸŸåŒ–åˆ†ä»£å¼"></a>G1å›æ”¶å™¨ï¼šåŒºåŸŸåŒ–åˆ†ä»£å¼</h2><blockquote><p>å®˜æ–¹ç»™G1è®¾å®šçš„ç›®æ ‡æ˜¯<strong>åœ¨å»¶è¿Ÿå¯æ§çš„æƒ…å†µä¸‹è·å¾—å°½å¯èƒ½é«˜çš„ååé‡</strong>ï¼Œä¹Ÿå°±æ˜¯å˜æˆå…¨èƒ½çš„æ”¶é›†å™¨ã€‚</p></blockquote><ol><li>ç»“æ„ï¼š<ul><li>G1æ˜¯ä¸€ä¸ªå¹¶è¡Œå›æ”¶å™¨ï¼Œå®ƒæŠŠå †å†…å­˜åˆ†å‰²ä¸ºå¾ˆå¤šä¸ç›¸å…³çš„åŒºåŸŸ(Region)<strong>å¹¶ä¸”æ˜¯ç‰©ç†ä¸Šä¸è¿ç»­çš„</strong>ã€‚ä½¿ç”¨ä¸åŒçš„Regionæ¥è¡¨ç¤ºEdenã€å¹¸å­˜è€…0åŒºã€å¹¸å­˜è€…1åŒºï¼Œè€å¹´ä»£ç­‰ã€‚</li><li>G1 GCæœ‰è®¡åˆ’åœ°è§„é¿åœ¨æ•´ä¸ªJavaå †ä¸­è¿›è¡Œå…¨åŒºåŸŸçš„åƒåœ¾æ”¶é›†ã€‚G1è·Ÿè¸ªå„ä¸ªRegioné‡Œçš„åƒåœ¾å †ç§¯çš„ä»·å€¼å¤§å°ï¼ˆå›æ”¶æ‰€è·å¾—çš„ç©ºé—´å¤§å°ä»¥åŠå›æ”¶æ‰€éœ€æ—¶é—´çš„ç»éªŒå€¼ï¼‰ï¼Œåœ¨åå°ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆåˆ—è¡¨ï¼Œ<strong>æ¯æ¬¡æ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆå›æ”¶ä»·å€¼æœ€å¤§çš„Region</strong></li><li>ç”±äºè¿™ç§æ–¹å¼çš„ä¾§é‡ç‚¹åœ¨äºå›æ”¶åƒåœ¾æœ€å¤§é‡çš„åŒºé—´ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»™G1ä¸€ä¸ªåå­—ï¼š<strong>åƒåœ¾ä¼˜å…ˆ</strong></li></ul></li><li><img src="https://img02.sogoucdn.com/app/a/100520146/a5d0da53fa075959d95fe3e97b78c0ec" alt="UTOOLS1603456064907.png"></li></ol><blockquote><p>G1 çš„ç‰¹ç‚¹ä¼˜åŠ¿</p></blockquote><ul><li><p>å¹¶è¡Œä¸å¹¶å‘</p><ul><li>å¹¶è¡Œæ€§ï¼šG1åœ¨å›æ”¶æœŸé—´ï¼Œå¯ä»¥æœ‰å¤šä¸ªGCçº¿ç¨‹åŒæ—¶å·¥ä½œï¼Œæœ‰æ•ˆåˆ©ç”¨å¤šæ ¸è®¡ç®—èƒ½åŠ›ã€‚ç”¨æˆ·çº¿ç¨‹ä¼šSTW</li><li>å¹¶å‘æ€§ï¼šG1æ‹¥æœ‰ä¸åº”ç”¨ç¨‹åºäº¤æ›¿æ‰§è¡Œçš„èƒ½åŠ›ï¼Œéƒ¨åˆ†å·¥ä½œå¯ä»¥å’Œåº”ç”¨ç¨‹åºåŒæ—¶æ‰§è¡Œï¼Œå› æ­¤ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä¸ä¼šå†æ•´ä¸ªå›æ”¶é˜¶æ®µå‘ç”Ÿå®Œå…¨é˜»å¡åº”ç”¨ç¨‹åºçš„æƒ…å†µ</li></ul></li><li><p>åˆ†ä»£æ”¶é›†</p><ul><li>G1ä»ç„¶å±äºåˆ†ä»£å‹åƒåœ¾å›æ”¶å™¨ï¼Œä¼šåŒºåˆ†å¹´è½»ä»£å’Œè€å¹´ä»£ï¼Œå¹´è½»ä»£ä¾ç„¶æœ‰Edenå’ŒSurvivoråŒºã€‚ä»å †ç»“æ„ä¸Šçœ‹ï¼Œä»–ä»¬å¯ä»¥æ˜¯ä¸è¿ç»­çš„ï¼Œæ²¡æœ‰å›ºå®šçš„å¤§å°ï¼Œæ²¡æœ‰å›ºå®šçš„æ•°é‡ã€‚</li><li>å°†å †ç©ºé—´åˆ†ä¸ºè‹¥å¹²ä¸ªåŒºåŸŸï¼Œè¿™äº›åŒºåŸŸä¸­åŒ…å«äº†é€»è¾‘ä¸Šçš„å¹´è½»ä»£å’Œè€å¹´ä»£</li><li>å’Œä¹‹å‰çš„å„ç±»å›æ”¶å™¨ä¸åŒï¼Œå®ƒåŒæ—¶ <strong>å…¼é¡¾å¹´è½»ä»£å’Œè€å¹´ä»£</strong></li></ul></li><li><p>ç©ºé—´æ•´åˆ</p><ul><li>CMSï¼šâ€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•ã€å†…å­˜ç¢ç‰‡ã€è‹¥å¹²æ¬¡GCåè¿›è¡Œä»¥æ­¤ç¢ç‰‡æ•´ç†</li><li>G1å°†å†…å­˜åˆ’åˆ†ä¸ºä¸€ä¸ªä¸ªçš„regionã€‚å†…å­˜çš„å›æ”¶æ˜¯ä»¥regionä½œä¸ºåŸºæœ¬å•ä½çš„ã€‚<strong>Regionä¹‹é—´æ˜¯å¤åˆ¶ç®—æ³•</strong>ï¼Œæ•´ä½“ä¸Šå¯ä»¥çœ‹ä½œæ˜¯æ ‡è®°-å‹ç¼©ç®—æ³•ï¼Œä¸¤ä¸ªç®—æ³•éƒ½èƒ½é¿å…å†…å­˜ç¢ç‰‡ã€‚<strong>ä¸ä¼šå› ä¸ºåˆ†é…å¤§å¯¹è±¡çš„æ—¶å€™æ‰¾ä¸åˆ°è¿ç»­å†…å­˜ç©ºé—´è€Œæå‰è§¦å‘ä¸‹ä¸€æ¬¡GC</strong>ã€‚å½“javaå †ç‰¹åˆ«å¤§çš„æ—¶å€™ï¼ŒG1ä¼˜åŠ¿æ›´åŠ æ˜æ˜¾</li></ul></li><li><p>å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹</p><blockquote><p>åœ¨è¿½æ±‚ä½åœé¡¿çš„æƒ…å†µä¸‹ï¼Œï¼Œè¿˜å¯ä»¥<strong>å»ºç«‹ä¸€ä¸ªèƒ½å¤Ÿè®©ä½¿ç”¨è€…æ˜ç¡®æŒ‡å®šä¸€ä¸ªé•¿åº¦ä¸ºMæ¯«ç§’çš„æ—¶é—´ç‰‡æ®µå†…ï¼Œæ¶ˆè€—åœ¨GCä¸Šçš„æ—¶é—´ä¸èƒ½è¶…è¿‡Næ¯«ç§’</strong></p></blockquote><ul><li>ç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨ï¼Œè·Ÿè¸ªå„ä¸ªRegioné‡Œé¢çš„åƒåœ¾ä»·å€¼å¤§å°ï¼Œä¼˜å…ˆå›æ”¶ä»·å€¼æœ€å¤§çš„Regionæå‰GC</li></ul></li></ul><blockquote><p>G1çš„ä¸è¶³</p></blockquote><ul><li><p>G1æ¯”ä¼ ç»Ÿçš„åƒåœ¾å›æ”¶å™¨æœ‰æ›´é«˜çš„å†…å­˜å ç”¨ï¼Œé¢å¤–è´Ÿè½½æ›´å¤š</p></li><li><p>ä»ç»éªŒä¸Šæ¥è¯´ï¼Œåœ¨å°å†…å­˜åº”ç”¨ä¸ŠCMSçš„è¡¨ç°å¤§æ¦‚ç‡ä¼šä¼˜äºG1ï¼Œè€ŒG1åœ¨å¤§å†…å­˜åº”ç”¨ä¸Šåˆ™ä¼šå‘æŒ¥å…¶ä¼˜åŠ¿ã€‚å¹³è¡¡ç‚¹åœ¨6-8GBä¹‹é—´ã€‚</p></li></ul><blockquote><p>G1çš„å‚æ•°è®¾ç½®</p></blockquote><p><img src="https://img03.sogoucdn.com/app/a/100520146/3685edf0178147da780297b6fbb557f6"></p><blockquote><p>ä¸‰æ­¥èµ°</p></blockquote><ul><li>å¼€å¯G1åƒåœ¾æ”¶é›†å™¨</li><li>è®¾ç½®å †çš„æœ€å¤§å†…å­˜</li><li>è®¾ç½®æœ€å¤§åœé¡¿æ—¶é—´</li></ul><blockquote><p>ä½¿ç”¨åœºæ™¯</p></blockquote><ul><li>é¢å‘æœåŠ¡ç«¯åº”ç”¨ï¼Œé’ˆå¯¹å…·æœ‰å¤§å†…å­˜ï¼Œå¤šå¤„ç†å™¨çš„æœºå™¨</li><li>æœ€ä¸»è¦çš„åº”ç”¨æ˜¯éœ€è¦ä½GCå»¶è¿Ÿï¼Œå¹¶å…·æœ‰å¤§å †çš„åº”ç”¨ç¨‹åºæä¾›è§£å†³æ–¹æ¡ˆ</li><li>ç”¨æ¥æ›¿æ¢æ‰CMSæ”¶é›†å™¨ï¼š<ol><li>è¶…è¿‡50%çš„javaå †è¢«æ´»åŠ¨æ•°æ®å ç”¨</li><li>å¯¹è±¡åˆ†é…é¢‘ç‡æˆ–å¹´ä»£æå‡é¢‘ç‡å˜åŒ–å¾ˆå¤§</li><li>GCåœé¡¿æ—¶é—´è¿‡é•¿ï¼ˆ0.5-1sï¼‰</li></ol></li><li>Hotspotåƒåœ¾æ”¶é›†å™¨é‡Œï¼Œé™¤äº†G1å¤–ï¼Œå…¶ä»–çš„åƒåœ¾æ”¶é›†å™¨ä½¿ç”¨å†…ç½®çš„JVMçº¿ç¨‹æ‰§è¡ŒGCçš„å¤šçº¿ç¨‹æ“ä½œï¼Œè€ŒG1 GCå¯ä»¥é‡‡ç”¨åº”ç”¨ç¨‹åºçº¿ç¨‹æ‰¿æ‹…åå°è¿è¡Œçš„GCå·¥ä½œï¼Œå³å½“JVMçš„GCçº¿ç¨‹å¤„ç†é€Ÿåº¦æ…¢æ—¶ï¼Œç³»ç»Ÿä¼šè°ƒç”¨åº”ç”¨ç¨‹åºçº¿ç¨‹å¸®åŠ©åŠ é€Ÿåƒåœ¾å›æ”¶è¿‡ç¨‹ã€‚</li></ul><h3 id="åˆ†åŒºRegionï¼šåŒ–æ•´ä¸ºé›¶"><a href="#åˆ†åŒºRegionï¼šåŒ–æ•´ä¸ºé›¶" class="headerlink" title="åˆ†åŒºRegionï¼šåŒ–æ•´ä¸ºé›¶"></a>åˆ†åŒºRegionï¼šåŒ–æ•´ä¸ºé›¶</h3><p><img src="https://img04.sogoucdn.com/app/a/100520146/bbf6b356dd99b1bddb7094a66a55f9be"></p><ul><li>ä¸€ä¸ªregionæœ‰å¯èƒ½å±äºEdenï¼ŒSurvivor æˆ–è€…Old/Tenuredå†…å­˜åŒºåŸŸã€‚ä½†æ˜¯ä¸€ä¸ªregionåªå¯èƒ½å±äºä¸€ä¸ªè§’è‰²ã€‚</li><li>G1å¢åŠ äº†ä¸€ç§æ–°çš„å†…å­˜åŒºåŸŸï¼Œå«åšHumongouså†…å­˜åŒºåŸŸï¼Œå¦‚å›¾ä¸­çš„Hå—ï¼Œ<strong>ä¸»è¦ç”¨äºå­˜å‚¨å¤§å¯¹è±¡</strong>ï¼Œå¦‚æœè¶…è¿‡<strong>1.5</strong>ä¸ªregionï¼Œå°±æ”¾åˆ°H</li></ul><blockquote><p>regionçš„GC</p></blockquote><p>å½“edenåŒºæ»¡äº†ï¼Œä¼šæ‰§è¡ŒGCæ“ä½œï¼Œæœ€ç»ˆedenåŒºä¼šè¢«æ¸…ç©ºï¼Œå˜æˆç™½è‰²ï¼Œæ”¾å…¥ä¸€ä¸ªç©ºé—²åˆ—è¡¨ä¸­ï¼Œå°±å¯ä»¥ç”¨æ¥å­˜æ”¾ä»»ä½•ç±»å‹çš„æ•°æ®ï¼Œæ‹¥æœ‰è‡ªé€‚åº”çš„èƒ½åŠ›ã€‚</p><blockquote><p>ä¸ºä»€ä¹ˆè¦è®¾ç½®å¤§å¯¹è±¡HåŒºï¼Ÿ</p></blockquote><p>å¯¹äºå †ä¸­çš„å¤§å¯¹è±¡ï¼Œé»˜è®¤ä¼šç›´æ¥è¢«åˆ†é…åˆ°è€å¹´ä»£ï¼Œ<strong>ä½†æ˜¯å¦‚æœå®ƒæ˜¯ä¸€ä¸ªçŸ­æœŸå­˜åœ¨çš„å¤§å¯¹è±¡</strong>ï¼Œå°±ä¼šå¯¹åƒåœ¾æ”¶é›†å™¨é€ æˆè´Ÿé¢å½±å“ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒG1ä¸“é—¨åˆ’åˆ†äº†ä¸€ä¸ªHumongousåŒºï¼Œç”¨æ¥å­˜æ”¾å¤§å¯¹è±¡ã€‚<strong>å¦‚æœHåŒºè£…ä¸ä¸‹ï¼Œé‚£ä¹ˆG1ä¼šå¯»æ‰¾è¿ç»­çš„HåŒºæ¥å‚¨å­˜</strong>ã€‚ä¸ºäº†èƒ½æ‰¾åˆ°è¿ç»­çš„HåŒºï¼Œæœ‰æ—¶å€™ä¸å¾—ä¸å¯åŠ¨Full GCã€‚G1çš„å¤§å¤šæ•°è¡Œä¸ºéƒ½æŠŠHåŒºä½œä¸ºè€å¹´ä»£çš„ä¸€éƒ¨åˆ†æ¥çœ‹å¾…ã€‚</p><h3 id="G1å›æ”¶å™¨åƒåœ¾å›æ”¶è¿‡ç¨‹"><a href="#G1å›æ”¶å™¨åƒåœ¾å›æ”¶è¿‡ç¨‹" class="headerlink" title="G1å›æ”¶å™¨åƒåœ¾å›æ”¶è¿‡ç¨‹"></a>G1å›æ”¶å™¨åƒåœ¾å›æ”¶è¿‡ç¨‹</h3><blockquote><p>G1çš„åƒåœ¾å›æ”¶è¿‡ç¨‹æœ‰ä¸‰ä¸ªç¯èŠ‚ï¼š</p><ul><li>å¹´è½»ä»£GC ï¼ˆYoung GCï¼‰</li><li>è€å¹´ä»£å¹¶å‘æ ‡è®°è¿‡ç¨‹ï¼ˆConcurrent Markingï¼‰</li><li>æ··åˆå›æ”¶ï¼ˆMixed GCï¼‰</li><li>ï¼ˆå¦‚æœéœ€è¦ï¼Œå•çº¿ç¨‹ã€ç‹¬å å¼ã€é«˜å¼ºåº¦çš„Full GCè¿˜æ˜¯ç»§ç»­å­˜åœ¨çš„ã€‚å®ƒé’ˆå¯¹GCçš„è¯„ä¼°å¤±è´¥æä¾›äº†ä¸€ç§å¤±è´¥ä¿æŠ¤æœºåˆ¶ï¼Œå³å¼ºåŠ›å›æ”¶ï¼‰å…·ä½“çš„è·ŸCMSçš„å·®ä¸å¤š</li></ul></blockquote><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201024104256465.png"></p><p>â‘ å¹´è½»ä»£çš„<strong>EdenåŒºç”¨å°½</strong>å¼€å§‹å¹´è½»ä»£GCï¼šè¿™æ˜¯ä¸€ä¸ª<strong>å¹¶è¡Œçš„ç‹¬å å¼</strong>æ”¶é›†å™¨ã€‚åœ¨å¹´è½»ä»£å›æ”¶å™¨ï¼ŒG1 GCæš‚åœæ‰€æœ‰åº”ç”¨ç¨‹åºçº¿ç¨‹ï¼Œå¯åŠ¨å¤šçº¿ç¨‹æ‰§è¡Œå¹´è½»ä»£å›æ”¶ã€‚ç„¶å<strong>ä»å¹´è½»ä»£åŒºé—´ç§»åŠ¨å­˜æ´»å¯¹è±¡åˆ°SurvivoråŒºé—´æˆ–è€…è€å¹´ä»£åŒºé—´ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸¤ä¸ªåŒºé—´éƒ½ä¼šæ¶‰åŠ</strong>ã€‚</p><p>â‘¡å½“å †ä½¿ç”¨è¾¾åˆ°é˜ˆå€¼ï¼ˆé»˜è®¤45%ï¼‰ï¼Œå¼€å§‹è€å¹´ä»£å¹¶å‘æ ‡è®°è¿‡ç¨‹</p><p>â‘¢æ ‡è®°å®Œæˆé©¬ä¸Šå¼€å§‹æ··åˆå›æ”¶è¿‡ç¨‹ã€‚<font color="red">G1æŠŠè€å¹´åŒºå­˜æ´»ä¸‹æ¥çš„å¯¹è±¡ç§»åŠ¨åˆ°ç©ºé—²åŒºé—´ï¼Œè¿™äº›ç©ºé—²åŒºé—´å°±ä¼šå˜æˆè€å¹´åŒºã€‚G1çš„è€å¹´ä»£å›æ”¶å™¨ä¸éœ€è¦æ•´ä¸ªè€å¹´ä»£è¢«å›æ”¶ï¼Œä¸€æ¬¡åªéœ€è¦æ‰«æ/å›æ”¶ä¸€å°éƒ¨åˆ†è€å¹´ä»£çš„Regionå°±å¯ä»¥äº†</font>ã€‚è€å¹´ä»£å’Œå¹´è½»ä»£æ˜¯ä¸€èµ·è¢«å›æ”¶çš„ï¼Œæ‰€æœ‰å«æ··åˆå›æ”¶ã€‚</p><h3 id="è®°å¿†é›†å’Œå†™å±éšœ"><a href="#è®°å¿†é›†å’Œå†™å±éšœ" class="headerlink" title="è®°å¿†é›†å’Œå†™å±éšœ"></a>è®°å¿†é›†å’Œå†™å±éšœ</h3><blockquote><p>è§£å†³è·¨ä»£å¼•ç”¨å’Œåˆ†åŒºå¼•ç”¨çš„é—®é¢˜ã€‚</p></blockquote><p>å¦‚æœå­˜åœ¨è·¨ä»£å¼•ç”¨ï¼Œæˆ–è€…åƒG1 ZGC Partial GCç­‰åˆ†åŒºæ”¶é›†çš„ï¼Œç»™æ¯ä¸ªåŒºæ•´ä¸€ä¸ªè®°å¿†é›†ï¼Œç”¨æ¥å­˜æ”¾è°å¼•ç”¨äº†è¿™ä¸ªé‡Œè¾¹çš„å¯¹è±¡ï¼Œå¯ä»¥å‡å°‘éå†æ¬¡æ•°ã€‚ç”¨ç©ºé—´æ¢æ—¶é—´ã€‚</p><h3 id="G1åƒåœ¾å›æ”¶è¯¦ç»†è¯´æ˜"><a href="#G1åƒåœ¾å›æ”¶è¯¦ç»†è¯´æ˜" class="headerlink" title="G1åƒåœ¾å›æ”¶è¯¦ç»†è¯´æ˜"></a>G1åƒåœ¾å›æ”¶è¯¦ç»†è¯´æ˜</h3><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201024134206676.png"></p><blockquote><p>å¹´è½»ä»£</p></blockquote><ul><li><p>æ‰«ææ ¹</p><blockquote><p>staticå˜é‡æŒ‡å‘çš„å¯¹è±¡ï¼Œæ­£åœ¨æ‰§è¡Œçš„æ ˆå¸§è°ƒç”¨é“¾æ¡ä¸Šçš„å±€éƒ¨å˜é‡ç­‰ã€‚æ ¹å¼•ç”¨è¿åŒRSetè®°å½•çš„å¤–éƒ¨å¼•ç”¨ä½œä¸ºæ‰«æå­˜æ´»å¯¹è±¡çš„å…¥å£</p></blockquote></li><li><p>æ›´æ–°RSet</p><blockquote><p>å¤„ç†dirty card queueä¸­çš„cardï¼Œæ›´æ–°RSet</p></blockquote></li><li><p>å¤„ç†RSet</p><blockquote><p>è¯†åˆ«è¢«è€å¹´ä»£å¯¹è±¡æŒ‡å‘çš„Edenä¸­çš„å¯¹è±¡ï¼Œè¿™äº›è¢«æŒ‡å‘çš„Edenä¸­çš„å¯¹è±¡è¢«è®¤ä¸ºæ˜¯å­˜æ´»çš„å¯¹è±¡ã€‚</p></blockquote></li><li><p>å¤åˆ¶å¯¹è±¡</p><blockquote><p>EdenåŒºæ´»ä¸‹æ¥çš„å¯¹è±¡å¤åˆ¶åˆ°SurvivoråŒºä¸­ç©ºçš„å†…å­˜åˆ†æ®µï¼ŒSurvivoråŒºæ´»ä¸‹æ¥çš„ageæ²¡æœ‰è¾¾åˆ°é˜ˆå€¼ï¼Œage++å¹¶æ”¾åˆ°ç©ºçš„å†…å­˜åˆ†æ®µã€‚è¾¾åˆ°é˜ˆå€¼ï¼Œæ™‹å‡åˆ°OldåŒºç©ºçš„å†…å­˜åˆ†æ®µã€‚å¦‚æœSurvivorç©ºé—´ä¸å¤Ÿï¼ŒEdenåŒºéƒ¨åˆ†æ•°æ®ä¼šç›´æ¥æ™‹å‡åˆ°OldåŒºç©ºé—´</p></blockquote></li><li><p>å¤„ç†å¼•ç”¨</p><blockquote><p>å¤„ç† Softï¼ŒWeakï¼ŒPhantomï¼ŒFinalï¼ŒJNI Weakç­‰å¼•ç”¨ã€‚æœ€ç»ˆEdenåŒºçš„æ•°æ®ä¸ºç©ºï¼ŒGCåœæ­¢å·¥ä½œï¼Œè€Œä¸”ç›®æ ‡å†…å­˜ä¸­çš„å¯¹è±¡éƒ½æ˜¯è¿ç»­å­˜å‚¨çš„ï¼Œæ²¡æœ‰ç¢ç‰‡ï¼Œæ‰€æœ‰å¤åˆ¶è¿‡ç¨‹å¯ä»¥è¾¾åˆ°å†…å­˜æ•´ç†çš„æ•ˆæœï¼Œå‡å°‘ç¢ç‰‡ã€‚</p></blockquote></li></ul><blockquote><p>å¹¶å‘æ ‡è®°è¿‡ç¨‹</p></blockquote><ul><li>åˆå§‹æ ‡è®°é˜¶æ®µï¼šæ ‡è®°ä»æ ¹èŠ‚ç‚¹<strong>ç›´æ¥</strong>å¯è¾¾çš„å¯¹è±¡ã€‚è¿™ä¸ªé˜¶æ®µæ˜¯STWçš„ï¼Œå¹¶ä¸”ä¼šè§¦å‘ä¸€æ¬¡å¹´è½»ä»£ GC</li><li>æ ¹åŒºåŸŸæ‰«æï¼šG1æ‰«æSurvivoråŒºï¼Œç›´æ¥å¯è¾¾çš„è€å¹´ä»£åŒºåŸŸå¯¹è±¡ï¼Œå¹¶æ ‡è®°è¢«å¼•ç”¨çš„å¯¹è±¡ã€‚è¿™ä¸€è¿‡ç¨‹å¿…é¡»åœ¨young gcä¹‹å‰å®Œæˆ</li><li>å¹¶å‘æ ‡è®°ï¼šåœ¨æ•´ä¸ªå †ä¸­è¿›è¡Œå¹¶å‘æ ‡è®°ï¼Œæ­¤è¿‡ç¨‹å¯èƒ½è¢«young gcä¸­æ–­ã€‚åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µï¼Œè‹¥å‘ç°åŒºåŸŸå¯¹è±¡ä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯åƒåœ¾ï¼Œè¿™ä¸ªåŒºåŸŸä¼šè¢«ç«‹å³å›æ”¶ï¼ŒåŒæ—¶å¹¶å‘æ ‡è®°é˜¶æ®µä¼šè®¡ç®—æ¯ä¸ªåŒºåŸŸçš„å¯¹è±¡æ´»æ€§ã€‚</li><li>å†æ¬¡æ ‡è®°ï¼šç”±äºç”¨æˆ·çº¿ç¨‹æŒç»­è¿›è¡Œï¼Œéœ€è¦ä¿®æ­£ä¸Šä¸€æ¬¡çš„æ ‡è®°ç»“æœï¼ŒSTWæ€§è´¨ï¼Œç”¨çš„SATBç®—æ³•</li><li>ç‹¬å æ¸…ç†ï¼Œè®¡ç®—å„ä¸ªåŒºåŸŸçš„å­˜æ´»å¯¹è±¡å’ŒGCå›æ”¶æ¯”ä¾‹ï¼Œè¿›è¡Œæ’åºï¼Œè¯†åˆ«å¯èƒ½æ··åˆå›æ”¶çš„åŒºåŸŸã€‚ä¸ºä¸‹é˜¶æ®µåšé“ºå«ï¼ŒSTW</li><li>å¹¶å‘æ¸…ç†ï¼šè¯†åˆ«å¹¶æ¸…ç†å®Œå…¨ç©ºé—²çš„åŒºåŸŸ</li></ul><blockquote><p>æ··åˆå›æ”¶</p></blockquote><p>é™¤äº†ä¼šå›æ”¶æ•´ä¸ªYoung Regionè¿˜ä¼šå›æ”¶ä¸€éƒ¨åˆ†Old Region  <strong>æ˜¯ä¸€éƒ¨åˆ†è€å¹´ä»£ä¸æ˜¯å…¨éƒ¨è€å¹´ä»£</strong></p><p><img src="https://img03.sogoucdn.com/app/a/100520146/7f76e8914fd67eaa377965577b5b23a9"></p><h3 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h3><p>å¹´è½»ä»£å¤§å°</p><p>æš‚åœæ—¶é—´ç›®æ ‡ä¸è¦å¤ªä¸¥è‹›</p><h2 id="åƒåœ¾å›æ”¶å™¨æ€»ç»“"><a href="#åƒåœ¾å›æ”¶å™¨æ€»ç»“" class="headerlink" title="åƒåœ¾å›æ”¶å™¨æ€»ç»“"></a>åƒåœ¾å›æ”¶å™¨æ€»ç»“</h2><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201025160544477.png" alt="æ¯”è¾ƒ"></p><h2 id="GCæ—¥å¿—åˆ†æ"><a href="#GCæ—¥å¿—åˆ†æ" class="headerlink" title="GCæ—¥å¿—åˆ†æ"></a>GCæ—¥å¿—åˆ†æ</h2><h2 id="åƒåœ¾å›æ”¶å™¨çš„æ–°å‘å±•"><a href="#åƒåœ¾å›æ”¶å™¨çš„æ–°å‘å±•" class="headerlink" title="åƒåœ¾å›æ”¶å™¨çš„æ–°å‘å±•"></a>åƒåœ¾å›æ”¶å™¨çš„æ–°å‘å±•</h2>]]></content>
      
      
      <categories>
          
          <category> jvm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JVM08</title>
      <link href="2020/10/20/jvm08/"/>
      <url>2020/10/20/jvm08/</url>
      
        <content type="html"><![CDATA[<h1 id="åƒåœ¾å›æ”¶"><a href="#åƒåœ¾å›æ”¶" class="headerlink" title="åƒåœ¾å›æ”¶"></a>åƒåœ¾å›æ”¶</h1><h2 id="ä»€ä¹ˆæ˜¯åƒåœ¾"><a href="#ä»€ä¹ˆæ˜¯åƒåœ¾" class="headerlink" title="ä»€ä¹ˆæ˜¯åƒåœ¾"></a>ä»€ä¹ˆæ˜¯åƒåœ¾</h2><p><img src="https://s1.ax1x.com/2020/10/20/Bpo82t.png"></p><blockquote><p>åƒåœ¾æ”¶é›†çš„ä¸‰ä¸ªç»å…¸é—®é¢˜ï¼š</p><ul><li>å“ªäº›å†…å­˜éœ€è¦å›æ”¶</li><li>ä»€ä¹ˆæ—¶å€™å›æ”¶</li><li>å¦‚ä½•å›æ”¶</li></ul></blockquote><h3 id="é¢è¯•é¢˜"><a href="#é¢è¯•é¢˜" class="headerlink" title="é¢è¯•é¢˜"></a>é¢è¯•é¢˜</h3><p><img src="https://s1.ax1x.com/2020/10/20/BpTay6.png"></p><p><img src="https://s1.ax1x.com/2020/10/20/BpTsFH.png"></p><blockquote><p>ä»€ä¹ˆæ˜¯åƒåœ¾ï¼Ÿ</p></blockquote><p><strong>è¿è¡Œç¨‹åºä¸­æ²¡æœ‰ä»»ä½•æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡</strong></p><blockquote><p>ä¸ºä½•è¦gc</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/20/Bp7oDK.png"></p><h2 id="åƒåœ¾å›æ”¶ç›¸å…³ç®—æ³•"><a href="#åƒåœ¾å›æ”¶ç›¸å…³ç®—æ³•" class="headerlink" title="åƒåœ¾å›æ”¶ç›¸å…³ç®—æ³•"></a>åƒåœ¾å›æ”¶ç›¸å…³ç®—æ³•</h2><h3 id="æ ‡è®°é˜¶æ®µï¼šå¼•ç”¨è®¡æ•°æ³•"><a href="#æ ‡è®°é˜¶æ®µï¼šå¼•ç”¨è®¡æ•°æ³•" class="headerlink" title="æ ‡è®°é˜¶æ®µï¼šå¼•ç”¨è®¡æ•°æ³•"></a>æ ‡è®°é˜¶æ®µï¼šå¼•ç”¨è®¡æ•°æ³•</h3><blockquote><p><strong>æ­»äº¡å¯¹è±¡ï¼š</strong>å½“ä¸€ä¸ªå¯¹è±¡ä¸è¢«ä»»ä½•å­˜æ´»çš„å¯¹è±¡æ‰€å¼•ç”¨æ—¶ï¼Œ<strong>å°±å·²ç»å®£åˆ¤äº†æ­»äº¡</strong></p><p><strong>å¼•ç”¨è®¡æ•°æ³•ï¼š</strong>å¯¹æ¯ä¸€ä¸ªå¯¹è±¡ä¿å­˜ä¸€ä¸ªæ•´å‹çš„å¼•ç”¨è®¡æ•°å™¨å±æ€§ï¼Œç”¨äºå­˜æ”¾å¯¹è±¡è¢«å¼•ç”¨çš„æƒ…å†µ</p></blockquote><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>å®ç°ç®€å•ï¼Œåƒåœ¾å¯¹è±¡ä¾¿äºè¾¨è¯†ï¼›åˆ¤å®šç‡é«˜ï¼Œå›æ”¶æ²¡æœ‰å»¶è¿Ÿæ€§</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>å®ƒéœ€è¦å•ç‹¬çš„å­—æ®µå­˜å‚¨è®¡æ•°å™¨ï¼Œå¢åŠ äº†ç©ºé—´çš„å¼€é”€</li><li>æ¯æ¬¡èµ‹å€¼éœ€è¦æ›´æ–°è®¡æ•°å™¨ï¼Œä¼´éšç€åŠ å‡æ³•çš„æ“ä½œï¼Œå¢åŠ äº†æ—¶é—´çš„å¼€é”€</li><li>å¼•ç”¨è®¡æ•°å™¨ä¸èƒ½å¤„ç† <strong>å¾ªç¯å¼•ç”¨çš„æƒ…å†µ</strong> ï¼ˆaå¼•ç”¨äº†bï¼Œï¼Œbå¼•ç”¨äº†aï¼Œä½†æ˜¯äºŒè€…éƒ½ä¸ä¼šè¢«ä½¿ç”¨ï¼Œæ‰€ä»¥ä¼šé€ æˆ<strong>å†…å­˜æ³„æ¼</strong>ï¼‰</li></ul><p><img src="https://s1.ax1x.com/2020/10/21/B9wxp9.png"></p><h3 id="æ ‡è®°é˜¶æ®µï¼šå¯è¾¾æ€§åˆ†ææ³•"><a href="#æ ‡è®°é˜¶æ®µï¼šå¯è¾¾æ€§åˆ†ææ³•" class="headerlink" title="æ ‡è®°é˜¶æ®µï¼šå¯è¾¾æ€§åˆ†ææ³•"></a>æ ‡è®°é˜¶æ®µï¼šå¯è¾¾æ€§åˆ†ææ³•</h3><blockquote><p>ä¸»è¦æ˜¯ç”¨æ¥è§£å†³åœ¨å¼•ç”¨è®¡æ•°æ³•ä¸­çš„å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼çš„å‘ç”Ÿã€‚</p></blockquote><p>åŸºæœ¬æ€è·¯ï¼š</p><ul><li>å¯è¾¾æ€§åˆ†æç®—æ³•æ˜¯ä»¥æ ¹å¯¹è±¡é›†åˆä¸ºèµ·å§‹ç‚¹ï¼ŒæŒ‰ç…§ä»ä¸Šåˆ°ä¸‹çš„æ–¹å¼ <strong>æœç´¢è¢«æ ¹å¯¹è±¡é›†åˆæ‰€è¿æ¥çš„ç›®æ ‡å¯¹è±¡æ˜¯å¦å¯è¾¾</strong>ã€‚</li><li>ä½¿ç”¨å¯è¾¾æ€§åˆ†æç®—æ³•åï¼Œå†…å­˜ä¸­çš„å­˜æ´»å¯¹è±¡éƒ½ä¼šè¢«æ ¹å¯¹è±¡é›†åˆç›´æ¥æˆ–é—´æ¥é“¾æ¥ç€ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸º <strong>å¼•ç”¨é“¾</strong>ã€‚</li><li>å¦‚æœç›®æ ‡å¯¹è±¡æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼Œåˆ™æ˜¯ä¸å¯è¾¾çš„ï¼Œå°±æ„å‘³ç€è¯¥å¯¹è±¡å·²ç»æ­»äº¡ï¼Œå¯ä»¥æ ‡è®°ä¸ºåƒåœ¾å¯¹è±¡ã€‚</li><li>åœ¨å¯è¾¾æ€§åˆ†æç®—æ³•ä¸­ï¼Œåªæœ‰èƒ½å¤Ÿè¢«æ ¹å¯¹è±¡é›†åˆç›´æ¥æˆ–è€…é—´æ¥é“¾æ¥çš„å¯¹è±¡æ‰æ˜¯å­˜æ´»å¯¹è±¡ã€‚</li></ul><p><img src="https://s1.ax1x.com/2020/10/21/B96mcQ.png"></p><h4 id="é¢è¯•ï¼šåœ¨javaè¯­è¨€ä¸­ï¼Œè°å¯ä»¥ä½œä¸ºGC-Roots"><a href="#é¢è¯•ï¼šåœ¨javaè¯­è¨€ä¸­ï¼Œè°å¯ä»¥ä½œä¸ºGC-Roots" class="headerlink" title="é¢è¯•ï¼šåœ¨javaè¯­è¨€ä¸­ï¼Œè°å¯ä»¥ä½œä¸ºGC Roots??"></a>é¢è¯•ï¼šåœ¨javaè¯­è¨€ä¸­ï¼Œè°å¯ä»¥ä½œä¸ºGC Roots??</h4><blockquote><ul><li>è™šæ‹Ÿæœºæ ˆä¸­å¼•ç”¨çš„å¯¹è±¡</li><li>æœ¬åœ°æ–¹æ³•æ ˆJNIå¼•ç”¨çš„å¯¹è±¡</li><li>æ–¹æ³•åŒºç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡</li><li>æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡</li><li>æ‰€æœ‰è¢«åŒæ­¥é”synchronizedæŒæœ‰çš„å¯¹è±¡</li><li>javaè™šæ‹Ÿæœºå†…éƒ¨çš„å¼•ç”¨</li><li>åæ˜ javaè™šæ‹Ÿæœºå†…éƒ¨æƒ…å†µçš„JMXBeanã€JVMTIä¸­æ³¨å†Œçš„å›è°ƒã€æœ¬åœ°ä»£ç ç¼“å­˜ç­‰</li><li>é™¤äº†è¿™äº›å›ºå®šçš„GC Rootsé›†åˆä»¥å¤–ï¼Œæ ¹æ®ç”¨æˆ·æ‰€é€‰ç”¨çš„åƒåœ¾æ”¶é›†å™¨ä»¥åŠå½“å‰å›æ”¶çš„å†…å­˜åŒºåŸŸä¸åŒï¼Œè¿˜å¯ä»¥æœ‰å…¶ä»–å¯¹è±¡â€œä¸´æ—¶æ€§â€åŠ å…¥ï¼Œå…±åŒæ„å»ºå‡ºGC Rootsé›†åˆã€‚æ¯”å¦‚ï¼š<strong>åˆ†ä»£æ”¶é›†å’Œå±€éƒ¨å›æ”¶</strong></li></ul></blockquote><p><strong>å°æŠ€å·§ï¼š</strong></p><p>ç”±äºRooté‡‡ç”¨æ ˆæ–¹å¼å­˜æ”¾å˜é‡å’ŒæŒ‡é’ˆï¼Œæ‰€ä»¥å¦‚æœä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒä¿å­˜äº†å †å†…å­˜é‡Œé¢çš„å¯¹è±¡ï¼Œä½†æ˜¯è‡ªå·±åˆä¸åœ¨å †ä¸­ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ªroot</p><h3 id="å¯¹è±¡çš„finalizationæœºåˆ¶"><a href="#å¯¹è±¡çš„finalizationæœºåˆ¶" class="headerlink" title="å¯¹è±¡çš„finalizationæœºåˆ¶"></a>å¯¹è±¡çš„finalizationæœºåˆ¶</h3><p><strong>finalize()æ–¹æ³•çš„è°ƒç”¨</strong></p><blockquote><p>å½“åƒåœ¾å›æ”¶çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨åƒåœ¾çš„è¿™ä¸ªæ–¹æ³•ï¼Œä»–æ˜¯çˆ¶ç±»Objectçš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é‡å†™å®ƒã€‚<strong>ç”¨äºèµ„æºé‡Šæ”¾ï¼Œå…³é—­æ–‡ä»¶ï¼Œæ–­å¼€æ•°æ®åº“é“¾æ¥ï¼Œå…³é—­å¥—æ¥å­—ç­‰ç­‰ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</strong></p></blockquote><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201021105110443.png" alt="image-20201021105110443"></p><p><strong>ä¸‰ç§å¯èƒ½çš„çŠ¶æ€</strong>ï¼š</p><ul><li><strong>å¯è§¦åŠçš„</strong>ï¼Œä»æ ¹èŠ‚ç‚¹å¯ä»¥è®¿é—®åˆ°è¿™ä¸ªå¯¹è±¡</li><li><strong>å¯å¤æ´»çš„</strong>ï¼Œå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«é‡Šæ”¾ï¼Œä½†æ˜¯å¯¹è±¡å¯èƒ½åœ¨finalize()ä¸­å¤æ´»</li><li><strong>ä¸å¯è§¦åŠçš„</strong>ï¼Œå¯¹è±¡çš„finalize()è¢«è°ƒç”¨äº†ï¼Œå¹¶ä¸”æ²¡æœ‰å¤æ´»ï¼Œé‚£ä¹ˆå°±ä¼šè§¦åŠåˆ°ä¸å¯è§¦åŠçš„çŠ¶æ€ï¼Œå› ä¸º<strong>finalize()åªä¼šè§¦å‘ä»¥æ­¤</strong></li></ul><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201021110219387.png" alt="image-20201021110219387"></p><h3 id="MATä¸JProfilerçš„GC-rootæº¯æº"><a href="#MATä¸JProfilerçš„GC-rootæº¯æº" class="headerlink" title="MATä¸JProfilerçš„GC rootæº¯æº"></a>MATä¸JProfilerçš„GC rootæº¯æº</h3><blockquote><p>ç•¥ï¼Œdumpæ–‡ä»¶å’Œjprofilerçš„è®¤è¯†</p></blockquote><h3 id="æ¸…é™¤é˜¶æ®µï¼šæ ‡è®°æ¸…é™¤ç®—æ³•"><a href="#æ¸…é™¤é˜¶æ®µï¼šæ ‡è®°æ¸…é™¤ç®—æ³•" class="headerlink" title="æ¸…é™¤é˜¶æ®µï¼šæ ‡è®°æ¸…é™¤ç®—æ³•"></a>æ¸…é™¤é˜¶æ®µï¼šæ ‡è®°æ¸…é™¤ç®—æ³•</h3><blockquote><p>Mark-Sweepç®—æ³•</p></blockquote><p><strong>æ‰§è¡Œè¿‡ç¨‹</strong>ï¼š</p><p>å½“å†…å­˜ä¸­çš„æœ‰æ•ˆç©ºé—´è¢«è€—å°½çš„æ—¶å€™ï¼Œå°±ä¼šåœæ­¢æ•´ä¸ªç¨‹åºSTWï¼Œç„¶åè¿›è¡Œä¸¤é¡¹å·¥ä½œï¼šæ ‡è®°ï¼Œæ¸…é™¤</p><ul><li><strong>æ ‡è®°</strong>ï¼šCollerctorä»æ ¹èŠ‚ç‚¹å¼€å§‹éå†ï¼Œ<strong>æ ‡è®°æ‰€æœ‰è¢«å¼•ç”¨çš„å¯¹è±¡</strong>ï¼ï¼ï¼ï¼ï¼ï¼ï¼Œæ˜¯éåƒåœ¾å¯¹è±¡ã€‚ä¸€èˆ¬æ˜¯åœ¨å¯¹è±¡çš„Headerä¸­è®°å½•å¯è¾¾å¯¹è±¡ã€‚</li><li><strong>æ¸…é™¤</strong>ï¼šCollectorå¯¹å †å†…å­˜ä»å¤´åˆ°å°¾è¿›è¡Œçº¿æ€§çš„éå†ï¼Œå¦‚æœå‘ç°æŸä¸ªå¯¹è±¡åœ¨å…¶Headerä¸­æ²¡æœ‰æ ‡è®°ä¸ºå¯è¾¾å¯¹è±¡ï¼Œåˆ™å°†å…¶å›æ”¶ã€‚</li></ul><img src="https://img02.sogoucdn.com/app/a/100520146/43f91e8295dd41d570c4cc65d86cbc71" alt="UTOOLS1603263356735.png" title="UTOOLS1603263356735.png" /><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>æ•ˆç‡ä¸ç®—é«˜</li><li>åœ¨GCçš„æ—¶å€™ï¼Œéœ€è¦åœæ­¢æ•´ä¸ªåº”ç”¨ç¨‹åºï¼Œå¯¼è‡´ç”¨æˆ·ä½“éªŒå·®</li><li>è¿™ç§æ–¹å¼æ¸…ç†å‡ºæ¥çš„ç©ºé—²å†…å­˜æ˜¯ä¸è¿ç»­çš„ï¼Œä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Œéœ€è¦ç»´æŠ¤ä¸€ä¸ª<strong>ç©ºé—²åˆ—è¡¨</strong></li></ul><p><strong>æ³¨æ„ï¼šä½•ä¸ºæ¸…é™¤ï¼Ÿ</strong></p><ul><li>è¿™é‡Œæ‰€è°“çš„æ¸…é™¤å¹¶ä¸æ˜¯ç½®ç©ºï¼Œè€Œæ˜¯<strong>æŠŠéœ€è¦æ¶ˆé™¤çš„å¯¹è±¡åœ°å€ä¿å­˜åœ¨ç©ºé—²çš„åœ°å€åˆ—è¡¨ä¸­</strong>ã€‚ä¸‹æ¬¡æœ‰æ–°å¯¹è±¡éœ€è¦åŠ è½½æ—¶ï¼Œåˆ¤æ–­åƒåœ¾çš„ä½ç½®ç©ºé—´æ˜¯å¦å¤Ÿï¼Œå¦‚æœå¤Ÿï¼Œå°±å­˜æ”¾ã€‚</li></ul><h3 id="æ¸…é™¤é˜¶æ®µï¼šå¤åˆ¶ç®—æ³•"><a href="#æ¸…é™¤é˜¶æ®µï¼šå¤åˆ¶ç®—æ³•" class="headerlink" title="æ¸…é™¤é˜¶æ®µï¼šå¤åˆ¶ç®—æ³•"></a>æ¸…é™¤é˜¶æ®µï¼šå¤åˆ¶ç®—æ³•</h3><blockquote><p>ä¸ºäº†è§£å†³æ ‡è®°æ¸…é™¤ç®—æ³•åœ¨åƒåœ¾æ”¶é›†æ•ˆç‡æ–¹é¢çš„ç¼ºé™·ï¼Œæ‰€ä»¥å‡ºç°</p></blockquote><p><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong></p><p>å°†æ´»ç€çš„å†…å­˜ç©ºé—´åˆ†ä¸ºä¸¤å—ï¼Œæ¯æ¬¡åªæ˜¯ç”¨å…¶ä¸­ä¸€å—ï¼Œåœ¨åƒåœ¾å›æ”¶æ—¶å°†æ­£åœ¨ä½¿ç”¨çš„å†…å­˜ä¸­çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°ä¸ºä½¿ç”¨çš„å†…å­˜å¿«ä¸­ï¼Œä¹‹åæ¸…é™¤æ­£åœ¨ä½¿ç”¨çš„å†…å­˜å—ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œäº¤æ¢ä¸¤ä¸ªå†…å­˜çš„è§’è‰²ï¼Œå®Œæˆåƒåœ¾å›æ”¶ã€‚</p><p><img src="https://img04.sogoucdn.com/app/a/100520146/2a65b0db2928d712e3a9c0b2533ce53e" alt="UTOOLS1603264536577.png"></p><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>æ²¡æœ‰æ ‡è®°å’Œæ¸…é™¤è¿‡ç¨‹ï¼Œå®ç°ç®€å•ï¼Œè¿è¡Œé«˜æ•ˆ</li><li>å¤åˆ¶è¿‡å»ä»¥åä¿è¯ç©ºé—´çš„è¿ç»­æ€§ï¼Œä¸ä¼šå‡ºç°â€œç¢ç‰‡â€é—®é¢˜</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>æ­¤ç®—æ³•ä½¿å¾—æˆ‘ä»¬éœ€è¦ä¸¤å€çš„å†…å­˜ç©ºé—´</li><li>å¯¹äºG1è¿™ç§åˆ†æ‹†æˆä¸ºå¤§é‡regionçš„GCï¼Œå¤åˆ¶è€Œä¸æ˜¯ç§»åŠ¨ï¼Œæ„å‘³ç€GCéœ€è¦ç»´æŠ¤regionä¹‹é—´å¯¹è±¡å¼•ç”¨å…³ç³»ï¼Œä¸ç®¡æ˜¯å†…å­˜å ç”¨è¿˜æ˜¯æ—¶é—´å¼€é”€éƒ½ä¸å°</li></ul><p><strong>ç‰¹åˆ«çš„ï¼š</strong></p><blockquote><p>å¦‚æœç³»ç»Ÿä¸­åƒåœ¾å¯¹è±¡ä¸æ˜¯å¾ˆå¤šï¼Œå¤åˆ¶ç®—æ³•éœ€è¦å¤åˆ¶çš„å­˜æ´»å¯¹è±¡æ•°é‡å°±ä¼šå¾ˆå¤§ã€‚</p><p>æ­£æ˜¯æˆ‘ä»¬æƒ³åˆ°æ–°ç”Ÿä»£é‡Œé€šå¸¸å¯ä»¥å›æ”¶70%-99%çš„å†…å­˜ç©ºé—´ï¼Œå›æ”¶æ€§ä»·æ¯”å¾ˆé«˜ï¼Œæ‰€ä»¥æ–°ç”Ÿä»£ç”¨æ­¤åƒåœ¾å›æ”¶ç®—æ³•éå¸¸åˆé€‚ï¼ï¼ï¼ï¼</p></blockquote><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201021152950491.png" alt="image-20201021152950491"></p><h3 id="æ¸…é™¤é˜¶æ®µï¼šæ ‡è®°-å‹ç¼©-Mark-Compact-ç®—æ³•"><a href="#æ¸…é™¤é˜¶æ®µï¼šæ ‡è®°-å‹ç¼©-Mark-Compact-ç®—æ³•" class="headerlink" title="æ¸…é™¤é˜¶æ®µï¼šæ ‡è®°-å‹ç¼©(Mark-Compact)ç®—æ³•"></a>æ¸…é™¤é˜¶æ®µï¼šæ ‡è®°-å‹ç¼©(Mark-Compact)ç®—æ³•</h3><blockquote><p>å¤åˆ¶ç®—æ³•çš„é«˜æ•ˆæ€§æ˜¯å»ºç«‹åœ¨ <strong>å­˜æ´»å¯¹è±¡æ¯”è¾ƒå°‘ï¼Œåƒåœ¾å¯¹è±¡æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹</strong>ã€‚</p><p>åŸºäº<strong>è€å¹´ä»£è¿™ç§å­˜æ´»å¯¹è±¡å¾ˆå¤šï¼Œåƒåœ¾å¾ˆå°‘çš„æƒ…å†µ</strong>ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨å…¶ä»–çš„ç®—æ³•</p></blockquote><p><strong>æ‰§è¡Œè¿‡ç¨‹ï¼š</strong></p><ul><li><p>ç¬¬ä¸€é˜¶æ®µå’Œæ ‡è®°-æ¸…é™¤ç®—æ³•ä¸€æ ·ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹<strong>æ ‡è®°æ‰€æœ‰è¢«å¼•ç”¨å¯¹è±¡</strong></p></li><li><p>ç¬¬äºŒé˜¶æ®µ<strong>å°†æ‰€æœ‰å­˜æ´»å¯¹è±¡å‹ç¼©åˆ°å†…å­˜çš„ä¸€ç«¯</strong>ï¼ŒæŒ‰é¡ºåºæ’æ”¾</p></li><li><p>ä¹‹å<strong>æ¸…ç†è¾¹ç•Œå¤–æ‰€æœ‰çš„ç©ºé—´</strong></p></li></ul><p><img src="https://img01.sogoucdn.com/app/a/100520146/652a44131a13048a2b40512e3574a3a2" alt="UTOOLS1603266197927.png"></p><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>æ¶ˆé™¤äº†æ ‡è®°-æ¸…é™¤ç®—æ³•å½“ä¸­ï¼Œå†…å­˜åŒºåŸŸåˆ†æ•£çš„ç¼ºç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ç»™æ–°å¯¹è±¡åˆ†é…å†…å­˜æ—¶ï¼ŒJVMåªéœ€è¦æŒæœ‰ä¸€ä¸ªå†…å­˜çš„èµ·å§‹åœ°å€å³å¯ã€‚</li><li>æ¶ˆé™¤äº†å¤åˆ¶ç®—æ³•å½“ä¸­ï¼Œå†…å­˜å‡åŠçš„é«˜é¢ä»£ä»·</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>ä»æ•ˆç‡ä¸Šï¼Œæ¯”ä¸è¿‡å¤åˆ¶ç®—æ³•</li><li>ç§»åŠ¨å¯¹è±¡çš„åŒæ—¶ï¼Œå¦‚æœå¯¹è±¡è¢«å…¶ä»–å¯¹è±¡å¼•ç”¨ï¼Œåˆ™è¿˜éœ€è¦è°ƒæ•´å¼•ç”¨çš„åœ°å€</li><li>ç§»åŠ¨è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å…¨ç¨‹æš‚åœç”¨æˆ·åº”ç”¨ç¨‹åºã€‚STW</li></ul><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><blockquote><p>æ•ˆç‡</p></blockquote><p>å¤åˆ¶ç®—æ³•æ˜¯å½“ä¹‹æ— æ„§çš„è€å¤§ï¼Œä½†æ˜¯å´æµªè´¹äº†å¤ªå¤šçš„å†…å­˜</p><blockquote><p>ç©ºé—´å¼€é”€</p></blockquote><p>æ ‡è®°æ¸…é™¤ç®—æ³•å¾ˆå¿«ï¼Œå¤åˆ¶ç®—æ³•éœ€è¦é¢å¤–çš„ç©ºé—´æ¥ç»´æŠ¤å­˜æ´»å¯¹è±¡çš„å­˜æ”¾å’Œç©ºé—²åˆ—è¡¨</p><blockquote><p>ç§»åŠ¨å¯¹è±¡</p></blockquote><p>å¤åˆ¶ç®—æ³•è¦æ¯”æ ‡è®°å‹ç¼©ç®—æ³•å¿«</p><h3 id="åˆ†ä»£æ”¶é›†ç®—æ³•"><a href="#åˆ†ä»£æ”¶é›†ç®—æ³•" class="headerlink" title="åˆ†ä»£æ”¶é›†ç®—æ³•"></a>åˆ†ä»£æ”¶é›†ç®—æ³•</h3><blockquote><p>åŸºäºï¼šä¸åŒå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸ä¸€æ ·çš„ï¼Œ<strong>å› æ­¤ä¸åŒç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡å¯ä»¥é‡‡å–ä¸åŒçš„æ”¶é›†æ–¹å¼ï¼Œä»¥ä¾¿æé«˜å›æ”¶æ•ˆç‡ã€‚</strong>ä¸€èˆ¬æŠŠjavaå †åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®å„ä¸ªå¹´ä»£çš„ç‰¹ç‚¹ä½¿ç”¨ä¸åŒçš„åƒåœ¾å›æ”¶ç®—æ³•</p></blockquote><p><strong>å‡ ä¹æ‰€æœ‰çš„GCéƒ½æ˜¯é‡‡ç”¨åˆ†ä»£æ”¶é›†ç®—æ³•æ‰§è¡Œåƒåœ¾å›æ”¶çš„</strong></p><h3 id="å¢é‡æ”¶é›†ç®—æ³•"><a href="#å¢é‡æ”¶é›†ç®—æ³•" class="headerlink" title="å¢é‡æ”¶é›†ç®—æ³•"></a>å¢é‡æ”¶é›†ç®—æ³•</h3><blockquote><p>åœ¨ä¹‹å‰çš„ç®—æ³•ä¸­ï¼Œåº”ç”¨è½¯ä»¶å°†å¤„äºSTWçš„çŠ¶æ€ï¼Œå¦‚æœåƒåœ¾å›æ”¶æ—¶é—´è¿‡é•¿ï¼Œå°±ä¼šä¸¥é‡å½±å“ç”¨æˆ·ä½“éªŒæˆ–è€…ç³»ç»Ÿç¨³å®šæ€§ã€‚</p></blockquote><p><strong>è§£å†³æ€è·¯</strong>ï¼š</p><p>æ¯æ¬¡ï¼Œåƒåœ¾æ”¶é›†çº¿ç¨‹<strong>åªæ”¶é›†ä¸€å°ç‰‡åŒºåŸŸçš„å†…å­˜ç©ºé—´</strong>ï¼Œæ¥ç€åˆ‡æ¢åˆ°åº”ç”¨ç¨‹åºçº¿ç¨‹ï¼Œä¾æ¬¡åå¤ï¼Œç›´åˆ°åƒåœ¾æ”¶é›†å®Œæˆã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œå¢é‡æ”¶é›†ç®—æ³•çš„åŸºç¡€ä»æ˜¯ä¼ ç»Ÿçš„æ ‡è®°-æ¸…é™¤å’Œå¤åˆ¶ç®—æ³•ã€‚å¢é‡æ”¶é›†ç®—æ³•é€šè¿‡ <strong>å¯¹çº¿ç¨‹é—´å†²çªçš„å¦¥å–„å¤„ç†ï¼Œå…è®¸åƒåœ¾æ”¶é›†çº¿ç¨‹ä»¥åˆ†é˜¶æ®µçš„æ–¹å¼å®Œæˆæ ‡è®°ï¼Œæ¸…ç†æˆ–å¤åˆ¶å·¥ä½œã€‚</strong></p><p><strong>ç¼ºç‚¹</strong>ï¼š</p><p>ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œç”±äºåœ¨åƒåœ¾å›æ”¶è¿‡ç¨‹ä¸­ï¼Œé—´æ–­æ€§åœ°è¿˜æ‰§è¡Œäº†åº”ç”¨ç¨‹åºä»£ç ï¼Œæ‰€ä»¥èƒ½å‡å°‘ç³»ç»Ÿçš„åœé¡¿æ—¶é—´ã€‚ä½†æ˜¯ï¼Œå› ä¸ºçº¿ç¨‹åˆ‡æ¢å’Œä¸Šä¸‹æ–‡è½¬æ¢çš„å°å·ï¼Œä¼šä½¿å¾—åƒåœ¾å›æ”¶çš„æ€»ä½“æˆæœ¬ä¸Šå‡ï¼Œ<strong>é€ æˆç³»ç»Ÿååé‡çš„ä¸‹é™</strong></p><h3 id="åˆ†åŒºç®—æ³•"><a href="#åˆ†åŒºç®—æ³•" class="headerlink" title="åˆ†åŒºç®—æ³•"></a>åˆ†åŒºç®—æ³•</h3><blockquote><p>ç›®çš„ï¼šä¸ºäº†æ›´å¥½çš„æ§åˆ¶GCäº§ç”Ÿçš„åœé¡¿æ—¶é—´ï¼Œå°†ä¸€å—å¤§çš„å†…å­˜åŒºåŸŸåˆ†å‰²æˆå¤šä¸ªå°å—ï¼Œæ ¹æ®ç›®æ ‡çš„åœé¡¿æ—¶é—´ï¼Œæ¯æ¬¡åˆç†åœ°å›æ”¶è‹¥å¹²ä¸ªå°åŒºé—´ region ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå †ç©ºé—´ï¼Œä»è€Œå‡å°‘ä¸€æ¬¡gcæ‰€äº§ç”Ÿçš„åœé¡¿ã€‚</p><p>æ¯ä¸ªå°åŒºé—´éƒ½ç‹¬ç«‹ä½¿ç”¨ï¼Œç‹¬ç«‹å›æ”¶ã€‚</p></blockquote><p><img src="https://img01.sogoucdn.com/app/a/100520146/b93984920170e301aa380981ad69315c" alt="UTOOLS1603270969499.png"></p><h2 id="åƒåœ¾å›æ”¶ç›¸å…³æ¦‚å¿µ"><a href="#åƒåœ¾å›æ”¶ç›¸å…³æ¦‚å¿µ" class="headerlink" title="åƒåœ¾å›æ”¶ç›¸å…³æ¦‚å¿µ"></a>åƒåœ¾å›æ”¶ç›¸å…³æ¦‚å¿µ</h2><h3 id="System-gcçš„ç†è§£"><a href="#System-gcçš„ç†è§£" class="headerlink" title="System.gcçš„ç†è§£"></a>System.gcçš„ç†è§£</h3><blockquote><p>é€šè¿‡System.gcå’ŒRuntime.getRuntime().gc() ä¼šæ˜¾ç¤ºçš„è§¦å‘ <strong>full gc</strong></p></blockquote><p><strong>ç„¶è€Œ</strong>ï¼ŒSystem.gc()è°ƒç”¨é™„å¸¦ä¸€ä¸ªå…è´£å£°æ˜ï¼Œæ— æ³•ä¿è¯å¯¹åƒåœ¾æ”¶é›†å™¨çš„è°ƒç”¨</p><p><img src="https://img04.sogoucdn.com/app/a/100520146/41269ef6fa92e05832fe313bb29cc247" alt="UTOOLS1603272636302.png"></p><p>ç¨‹åºç»“æŸäº†ï¼Œä½†æ˜¯gcè¿˜æ˜¯æ²¡æœ‰å‘ç”Ÿï¼Œä½†æ˜¯æœ‰æ—¶å€™å¯ä»¥ã€‚</p><p>æˆ‘ä»¬å¯ä»¥è°ƒç”¨ System.runFinalization(); ä¼šå¼ºåˆ¶è°ƒç”¨ä½¿ç”¨å¼•ç”¨çš„å¯¹è±¡çš„finalize()æ–¹æ³•</p><h3 id="å†…å­˜æº¢å‡ºå’Œå†…å­˜æ³„æ¼"><a href="#å†…å­˜æº¢å‡ºå’Œå†…å­˜æ³„æ¼" class="headerlink" title="å†…å­˜æº¢å‡ºå’Œå†…å­˜æ³„æ¼"></a>å†…å­˜æº¢å‡ºå’Œå†…å­˜æ³„æ¼</h3><blockquote><p>å†…å­˜æº¢å‡º</p></blockquote><ul><li>æ²¡æœ‰ç©ºé—²å†…å­˜ï¼Œå¹¶ä¸”åƒåœ¾æ”¶é›†å™¨ä¹Ÿæ— æ³•æä¾›æ›´å¤šå†…å­˜</li></ul><p>åŸå› ï¼š</p><ul><li>javaè™šæ‹Ÿæœºçš„å †å†…å­˜è®¾ç½®ä¸å¤Ÿ</li><li>ä»£ç ä¸­åˆ›å»ºäº†å¤§é‡å¤§å¯¹è±¡ï¼Œå¹¶ä¸”é•¿æ—¶é—´ä¸èƒ½è¢«åƒåœ¾æ”¶é›†å™¨æ”¶é›†ï¼ˆæœ‰å¼•ç”¨ï¼‰</li></ul><blockquote><p>å†…å­˜æ³„æ¼</p></blockquote><ul><li><p>ä¸¥æ ¼æ„ä¹‰ä¸Šå°†ï¼Œ<strong>åªæœ‰å¯¹è±¡ä¸ä¼šè¢«ç¨‹åºç”¨åˆ°äº†ï¼Œå¹¶ä¸”GCåˆä¸èƒ½å›æ”¶ä»–ä»¬çš„æƒ…å†µ</strong>ï¼Œå«åšå†…å­˜æ³„æ¼ã€‚</p></li><li><p>ä½†å®é™…æƒ…å†µä¸­ï¼Œå¾ˆå¤šæ—¶å€™ä¸€äº›ä¸å¤ªå¥½çš„ç–å¿½ä¼š<strong>å¯¼è‡´å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå˜å¾—å¾ˆé•¿ç”šè‡³å¯¼è‡´OOM</strong>ã€‚ä¹Ÿå¯ä»¥å«åš<strong>å®½æ³›æ„ä¹‰</strong>ä¸Šçš„â€œå†…å­˜æ³„æ¼â€</p></li></ul><p><img src="https://img03.sogoucdn.com/app/a/100520146/c7c5b0b31f6c15f07bb9b2668f2c6b7a" alt="UTOOLS1603284239687.png"></p><p>å¿˜è®°æ–­å¼€äº†å¼•ç”¨é“¾ï¼Œï¼Œè®©æœ¬è¯¥é‡Šæ”¾çš„å¯¹è±¡ï¼Œè¿˜è¢«å¼•ç”¨ç€ï¼Œä¸èƒ½è¢«é‡Šæ”¾</p><p><strong>ä¸¾ä¾‹ï¼š</strong></p><ol><li><p>å•ä¾‹æ¨¡å¼</p><blockquote><p>å•ä¾‹æ¨¡å¼çš„ç”Ÿå‘½å‘¨æœŸå’Œåº”ç”¨ç¨‹åºæ˜¯ä¸€æ ·é•¿çš„ï¼Œæ‰€ä»¥<strong>å•ä¾‹ç¨‹åº</strong>ä¸­ï¼Œå¦‚æœ<strong>æŒæœ‰å¯¹å¤–éƒ¨å¯¹è±¡çš„å¼•ç”¨çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªå¤–éƒ¨å¯¹è±¡æ˜¯ä¸èƒ½å›æ”¶çš„</strong>ï¼Œåˆ™ä¼šå¯¼è‡´å†…å­˜æ³„æ¼çš„å‘ç”Ÿã€‚</p></blockquote><p><img src="https://img01.sogoucdn.com/app/a/100520146/2897cee1accd74b0e563477bd51f2c43"></p></li><li><p>ä¸€äº›æä¾›closeçš„èµ„æºæœªå…³é—­å¯¼è‡´å†…å­˜æ³„æ¼</p><blockquote><p>è·Ÿæ•°æ®åº“ï¼Œç½‘ç»œé“¾æ¥ï¼Œioé“¾æ¥å¿…é¡»æ‰‹åŠ¨å…³é—­ï¼Œå¦åˆ™æ˜¯ä¸èƒ½è¢«å›æ”¶çš„ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p></blockquote></li></ol><h3 id="STW"><a href="#STW" class="headerlink" title="STW"></a>STW</h3><blockquote><p>GCäº‹ä»¶å‘ç”Ÿè¿‡ç¨‹ä¸­ï¼Œä¼šäº§ç”Ÿç¨‹åºçš„åœé¡¿ï¼Œçº¿ç¨‹ä¼šè¢«æš‚åœï¼Œæ²¡æœ‰ä»»ä½•å“åº”ï¼Œè¿™ä¸ªåœé¡¿ç§°ä¸ºSTW</p></blockquote><ul><li>å¯è¾¾æ€§åˆ†æç®—æ³•ä¸­æšä¸¾æ ¹èŠ‚ç‚¹ä¼šå¯¼è‡´æ‰€æœ‰javaæ‰§è¡Œçš„çº¿ç¨‹åœé¡¿<ul><li>åˆ†æå·¥ä½œå¿…é¡»åœ¨ä¸€ä¸ªèƒ½ç¡®ä¿ä¸€è‡´æ€§çš„å¿«ç…§ä¸­è¿›è¡Œ</li><li>ä¸€è‡´æ€§æŒ‡æ•´ä¸ªåˆ†ææœŸé—´æ•´ä¸ªæ‰§è¡Œç³»ç»Ÿçœ‹èµ·æ¥åƒè¢«å†»ç»“åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Š</li><li><strong>å¦‚æœå‡ºç°åˆ†æè¿‡ç¨‹ä¸­å¯¹è±¡å¼•ç”¨å…³ç³»è¿˜åœ¨ä¸æ–­å˜åŒ–ï¼Œåˆ™åˆ†æè¿‡ç¨‹çš„å‡†ç¡®æ€§æ— æ³•ä¿è¯</strong></li></ul></li><li>è¢«STWä¸­æ–­çš„åº”ç”¨ç¨‹åºçº¿ç¨‹ä¼šåœ¨å®ŒæˆGCåæ¢å¤ï¼Œé¢‘ç¹çš„STWä¼šè®©ç”¨æˆ·ä½“éªŒæ„Ÿæå·®ï¼Œæ‰€æœ‰è¦å‡å°‘ </li></ul><h3 id="åƒåœ¾å›æ”¶çš„å¹¶è¡Œä¸å¹¶å‘"><a href="#åƒåœ¾å›æ”¶çš„å¹¶è¡Œä¸å¹¶å‘" class="headerlink" title="åƒåœ¾å›æ”¶çš„å¹¶è¡Œä¸å¹¶å‘"></a>åƒåœ¾å›æ”¶çš„å¹¶è¡Œä¸å¹¶å‘</h3><blockquote><p><strong>å¹¶å‘</strong>ï¼šä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„â€œåŒæ—¶æ‰§è¡Œâ€ï¼Œåªæ˜¯CPUæŠŠä¸€ä¸ªæ—¶é—´æ®µåˆ’åˆ†æˆå‡ ä¸ªæ—¶é—´ç‰‡æ®µï¼ˆæ—¶é—´åŒºé—´ï¼‰ï¼Œç„¶ååœ¨è¿™å‡ ä¸ªæ—¶é—´åŒºé—´ä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œç”±äºCPUå¤„ç†çš„é€Ÿåº¦éå¸¸å¿«ï¼Œåªè¦æ—¶é—´é—´éš”å¤„ç†å¾—å½“ï¼Œå³å¯è®©ç”¨æˆ·æ„Ÿè§‰æ˜¯å¤šä¸ªåº”ç”¨ç¨‹åºåŒæ—¶åœ¨è¿›è¡Œã€‚</p><p><strong>å¹¶è¡Œ</strong>ï¼šå½“ç³»ç»Ÿæœ‰ä¸€ä¸ªä»¥ä¸ŠCPUæ—¶ï¼Œå½“ä¸€ä¸ªCPUæ‰§è¡Œä¸€ä¸ªè¿›ç¨‹ï¼Œå¦ä¸€ä¸ªCPUå¯ä»¥æ‰§è¡Œå¦ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸¤ä¸ªè¿›ç¨‹äº’ä¸æŠ¢å CPUèµ„æºï¼Œå¯ä»¥åŒæ—¶è¿›è¡Œï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º<strong>å¹¶è¡Œ</strong></p><ul><li>å†³å®šå¹¶è¡Œçš„ä¸æ˜¯cpuæ•°é‡ï¼Œè€Œæ˜¯cpuæ ¸å¿ƒæ•°é‡ï¼Œä¸€ä¸ªcpuå¤šæ ¸ä¹Ÿèƒ½å¹¶è¡Œ</li><li>é€‚åˆç§‘å­¦è®¡ç®—ï¼Œåå°å¤„ç†ç­‰å¼±äº¤äº’åœºæ™¯</li></ul></blockquote><p>å¹¶å‘ï¼š<strong>åœ¨ä¸€ä¸ªæ—¶é—´æ®µå†…åŒæ—¶å‘ç”Ÿäº†</strong></p><p><img src="https://img03.sogoucdn.com/app/a/100520146/6eaac6b00ac4b10c6c82730c3643d60e" alt="UTOOLS1603286445704.png"></p><p>å¹¶è¡Œï¼š<strong>åœ¨ä¸€ä¸ªæ—¶é—´ç‚¹ä¸ŠåŒæ—¶å‘ç”Ÿäº†</strong></p><p><img src="https://img04.sogoucdn.com/app/a/100520146/bb13aee526a47dd0975ad3e895b3c8b5" alt="UTOOLS1603286412378.png"></p><h3 id="å®‰å…¨ç‚¹ä¸å®‰å…¨åŒºåŸŸ"><a href="#å®‰å…¨ç‚¹ä¸å®‰å…¨åŒºåŸŸ" class="headerlink" title="å®‰å…¨ç‚¹ä¸å®‰å…¨åŒºåŸŸ"></a>å®‰å…¨ç‚¹ä¸å®‰å…¨åŒºåŸŸ</h3><blockquote><p>ç¨‹åºæ‰§è¡Œæ—¶ï¼Œå¹¶éæ˜¯åœ¨æ‰€æœ‰åœ°æ–¹éƒ½èƒ½åœé¡¿ä¸‹æ¥GCï¼Œåªæœ‰åœ¨ç‰¹å®šçš„ä½ç½®æ‰å¯ï¼Œè¿™äº›ä½ç½®ç§°ä¸ºâ€œå®‰å…¨ç‚¹â€ï¼ˆsafe pointï¼‰</p></blockquote><h4 id="å¦‚ä½•åœ¨GCå‘ç”Ÿæ—¶ï¼Œæ£€æŸ¥æ‰€æœ‰çº¿ç¨‹éƒ½è·‘åˆ°æœ€è¿‘çš„å®‰å…¨ç‚¹åœé¡¿ä¸‹æ¥ï¼Ÿ"><a href="#å¦‚ä½•åœ¨GCå‘ç”Ÿæ—¶ï¼Œæ£€æŸ¥æ‰€æœ‰çº¿ç¨‹éƒ½è·‘åˆ°æœ€è¿‘çš„å®‰å…¨ç‚¹åœé¡¿ä¸‹æ¥ï¼Ÿ" class="headerlink" title="å¦‚ä½•åœ¨GCå‘ç”Ÿæ—¶ï¼Œæ£€æŸ¥æ‰€æœ‰çº¿ç¨‹éƒ½è·‘åˆ°æœ€è¿‘çš„å®‰å…¨ç‚¹åœé¡¿ä¸‹æ¥ï¼Ÿ"></a>å¦‚ä½•åœ¨GCå‘ç”Ÿæ—¶ï¼Œæ£€æŸ¥æ‰€æœ‰çº¿ç¨‹éƒ½è·‘åˆ°æœ€è¿‘çš„å®‰å…¨ç‚¹åœé¡¿ä¸‹æ¥ï¼Ÿ</h4><ul><li><p><strong>æŠ¢å…ˆå¼ä¸­æ–­</strong>ï¼šï¼ˆç›®å‰æ²¡æœ‰è™šæ‹Ÿæœºä½¿ç”¨äº†ï¼‰</p><blockquote><p>é¦–å…ˆä¸­æ–­æ‰€æœ‰çº¿ç¨‹ï¼Œå¦‚æœè¿˜æœ‰çº¿ç¨‹ä¸åœ¨å®‰å…¨ç‚¹ï¼Œå°±æ¢å¤çº¿ç¨‹ï¼Œè®©çº¿ç¨‹è·‘åˆ°å®‰å…¨ç‚¹</p></blockquote></li><li><p><strong>ä¸»åŠ¨å¼ä¸­æ–­</strong>ï¼š</p><blockquote><p>è®¾ç½®ä¸€ä¸ªä¸­æ–­æ ‡å¿—ï¼Œå„ä¸ªçº¿ç¨‹è¿è¡Œåˆ°Safe Pointçš„æ—¶å€™ä¸»åŠ¨è½®è¯¢è¿™ä¸ªæ ‡å¿—ï¼Œå¦‚æœä¸­æ–­æ ‡å¿—ä¸ºçœŸï¼Œåˆ™å°†è‡ªå·±è¿›è¡Œä¸­æ–­æŒ‚èµ·</p></blockquote></li></ul><p><strong>å®‰å…¨åŒºåŸŸ</strong></p><blockquote><p>å®‰å…¨åŒºåŸŸæ˜¯æŒ‡åœ¨ä¸€æ®µä»£ç ç‰‡æ®µä¸­ï¼Œå¯¹è±¡çš„å¼•ç”¨å…³ç³»ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œåœ¨è¿™ä¸ªåŒºåŸŸä¸­çš„ä»»ä½•ä½ç½®å¼€å§‹GCéƒ½æ˜¯å®‰å…¨çš„ Safe Region</p></blockquote><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><blockquote><p>æˆ‘ä»¬å¸Œæœ›èƒ½æè¿°è¿™æ ·ä¸€ç±»å¯¹è±¡ï¼šå½“å†…å­˜ç©ºé—´è¿˜å¾ˆè¶³æ—¶ï¼Œåˆ™èƒ½ä¿å­˜åœ¨å†…å­˜ä¸­ï¼›å¦‚æœå†…å­˜ç©ºé—´åœ¨è¿›è¡Œåƒåœ¾æ”¶é›†åè¿˜æ˜¯å¾ˆç´§å¼ ï¼Œåˆ™å¯ä»¥æŠ›å¼ƒè¿™äº›å¯¹è±¡</p></blockquote><h4 id="ã€å³åé—¨åˆé«˜é¢‘çš„é¢è¯•é¢˜ã€‘"><a href="#ã€å³åé—¨åˆé«˜é¢‘çš„é¢è¯•é¢˜ã€‘" class="headerlink" title="ã€å³åé—¨åˆé«˜é¢‘çš„é¢è¯•é¢˜ã€‘"></a>ã€å³åé—¨åˆé«˜é¢‘çš„é¢è¯•é¢˜ã€‘</h4><blockquote><p>å¼ºå¼•ç”¨ï¼Œè½¯å¼•ç”¨ï¼Œå¼±å¼•ç”¨ï¼Œè™šå¼•ç”¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå…·ä½“ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p><strong>å¼ºåº¦å¯¹æ¯”ï¼š</strong>å¼ºå¼•ç”¨-&gt;è½¯å¼•ç”¨-&gt;å¼±å¼•ç”¨-&gt;è™šå¼•ç”¨</p><p><img src="https://img04.sogoucdn.com/app/a/100520146/3a999af1a2e69f4a387d0ba1e6e5d951" alt="UTOOLS1603288830450.png"></p><h4 id="å¼ºå¼•ç”¨ï¼ˆæ­»ä¹Ÿä¸å›æ”¶ï¼‰"><a href="#å¼ºå¼•ç”¨ï¼ˆæ­»ä¹Ÿä¸å›æ”¶ï¼‰" class="headerlink" title="å¼ºå¼•ç”¨ï¼ˆæ­»ä¹Ÿä¸å›æ”¶ï¼‰"></a>å¼ºå¼•ç”¨ï¼ˆæ­»ä¹Ÿä¸å›æ”¶ï¼‰</h4><blockquote><p><strong>æœ€ä¼ ç»Ÿçš„å¼•ç”¨å®šä¹‰</strong>ï¼Œæ˜¯æŒ‡åœ¨ç¨‹åºä»£ç ä¹‹ä¸­æ™®éå­˜åœ¨çš„å¼•ç”¨èµ‹å€¼ï¼Œ<strong>æ— è®ºä»»ä½•æƒ…å†µä¸‹éƒ½ä¸ä¼šå›æ”¶</strong> </p></blockquote><ul><li>å¼ºå¼•ç”¨å¯¹è±¡æ—¶å¯è§¦åŠçš„ï¼Œ<strong>GCæ°¸è¿œä¸ä¼šå›æ”¶æ‰è¢«å¼•ç”¨çš„å¯¹è±¡</strong></li><li><strong>å¼ºå¼•ç”¨æ—¶é€ æˆjavaå†…å­˜æ³„æ¼çš„ä¸»è¦åŸå› ä¹‹ä¸€</strong></li></ul><h4 id="è½¯å¼•ç”¨-å†…å­˜ä¸å¤Ÿæ‰å›æ”¶"><a href="#è½¯å¼•ç”¨-å†…å­˜ä¸å¤Ÿæ‰å›æ”¶" class="headerlink" title="è½¯å¼•ç”¨(å†…å­˜ä¸å¤Ÿæ‰å›æ”¶)"></a>è½¯å¼•ç”¨(å†…å­˜ä¸å¤Ÿæ‰å›æ”¶)</h4><blockquote><p>åœ¨ç³»ç»Ÿæ²¡æœ‰å‘ç”Ÿå†…å­˜ä¸è¶³å‰ï¼Œä¸€åˆ‡æ­£å¸¸ã€‚<strong>å½“ç³»ç»Ÿå†…å­˜æº¢å‡ºä¹‹å‰ï¼Œä¼šæŠŠè¿™äº›å¯¹è±¡åˆ—å…¥å›æ”¶èŒƒå›´ä¸­è¿›è¡ŒäºŒæ¬¡å›æ”¶</strong>ã€‚å¦‚æœè¿™æ¬¡å›æ”¶è¿˜æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œæ‰ä¼šæŠ›å‡ºå†…å­˜æº¢å‡ºå¼‚å¸¸</p></blockquote><ul><li>è½¯å¼•ç”¨é€šå¸¸ç”¨æ¥å®ç°å†…å­˜æ•æ„Ÿçš„ç¼“å­˜ï¼Œæ¯”å¦‚ <strong>é«˜é€Ÿç¼“å­˜</strong>å°±æœ‰ç”¨åˆ°è½¯å¼•ç”¨ï¼Œå¦‚æœåˆç©ºé—²çš„å†…å­˜å°±ä¼šä¿ç•™ï¼ŒåŠ å¿«æ‰§è¡Œæ•ˆç‡ï¼Œå¦‚æœå†…å­˜ä¸è¶³ï¼Œå°±æ¸…ç†æ‰</li><li><code>SoftReference</code>æ¥å®ç°è½¯å¼•ç”¨ </li><li>ä½†æ˜¯ï¼Œå¦‚æœåœ¨ä¼Šç”¸å›­åŒºä¸å¤Ÿäº†ï¼Œè€å¹´ä»£è¿˜æ˜¯å¤Ÿå‘¢ï¼Œå°±ä¼šæŠŠè½¯å¼•ç”¨æ”¾åœ¨è€å¹´ä»£ä¸­</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">SoftReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> softRef <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SoftReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>xxx<span class="token punctuation">)</span><span class="token punctuation">)</span>   ç”¨æ­¤æ¥æ„å»ºè½¯å¼•ç”¨        softRef<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  å¯ä»¥è·å¾—è½¯å¼•ç”¨ä¸­çš„å¯¹è±¡<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="å¼±å¼•ç”¨"><a href="#å¼±å¼•ç”¨" class="headerlink" title="å¼±å¼•ç”¨"></a>å¼±å¼•ç”¨</h4><blockquote><p><strong>åªè¢«å¼±å¼•ç”¨å…³è”</strong>çš„å¯¹è±¡åªèƒ½ç”Ÿå­˜åœ¨ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶ä¹‹å‰ï¼Œï¼Œ<strong>GCå·¥ä½œçš„æ—¶å€™ï¼Œä¸ç®¡ä½ å†…å­˜å¤Ÿä¸å¤Ÿï¼Œéƒ½ä¼šæŠŠå¼±å¼•ç”¨å›æ”¶</strong>ï¼Œä½†æ˜¯åƒåœ¾å›æ”¶å™¨çš„çº¿ç¨‹é€šå¸¸ä¼˜å…ˆçº§å¾ˆä½ï¼Œæ‰€ä»¥ä¸ä¸€å®šå¾ˆå¿«åœ°å‘ç°æŒæœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<strong>å¼±å¼•ç”¨å¯¹è±¡å¯ä»¥å­˜åœ¨è¾ƒé•¿çš„æ—¶é—´</strong>ã€‚</p></blockquote><ul><li>æ„é€ å¼±å¼•ç”¨æ—¶ï¼ŒæŒ‡å®šä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—ï¼Œå½“å¼±å¼•ç”¨å¯¹è±¡è¢«å›æ”¶æ—¶ï¼Œå°±ä¼šåŠ å…¥æŒ‡å®šçš„å¼•ç”¨é˜Ÿåˆ—ï¼Œé€šè¿‡è¿™ä¸ªé˜Ÿåˆ—å¯ä»¥è¿½è¸ªå¯¹è±¡çš„å›æ”¶æƒ…å†µ</li><li>è·Ÿè½¯å¼•ç”¨ä¸€æ ·ï¼Œé€‚åˆä¿å­˜é‚£äº›å¯æœ‰å¯æ— çš„ç¼“å­˜æ•°æ®</li><li><code>WeakReference&lt;T&gt;</code>å¯ä»¥åˆ›å»ºè½¯å¼•ç”¨</li></ul><h5 id="é¢è¯•é¢˜ï¼šå¼€å‘ä¸­ç”¨è¿‡WeakHashMapå—ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ"><a href="#é¢è¯•é¢˜ï¼šå¼€å‘ä¸­ç”¨è¿‡WeakHashMapå—ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ" class="headerlink" title="é¢è¯•é¢˜ï¼šå¼€å‘ä¸­ç”¨è¿‡WeakHashMapå—ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ"></a>é¢è¯•é¢˜ï¼šå¼€å‘ä¸­ç”¨è¿‡WeakHashMapå—ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</h5><blockquote><p>å†…éƒ¨ç±»entityç»§æ‰¿äº†weakReferenceï¼Œå®ç°äº†å¼±å¼•ç”¨</p></blockquote><p><img src="https://img03.sogoucdn.com/app/a/100520146/e235696434669c44185a411d02ce78e6" alt="UTOOLS1603373350703.png"></p><h4 id="è™šå¼•ç”¨ï¼ˆå¯¹è±¡è·Ÿè¸ª-ï¼‰"><a href="#è™šå¼•ç”¨ï¼ˆå¯¹è±¡è·Ÿè¸ª-ï¼‰" class="headerlink" title="è™šå¼•ç”¨ï¼ˆå¯¹è±¡è·Ÿè¸ª ï¼‰"></a>è™šå¼•ç”¨ï¼ˆå¯¹è±¡è·Ÿè¸ª ï¼‰</h4><blockquote><p><strong>å”¯ä¸€ç›®çš„æ—¶èƒ½å¤Ÿåœ¨è¿™ä¸ªå¯¹è±¡å›æ”¶ä¹‹å‰æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿçš„é€šçŸ¥</strong>ï¼Œç”¨äºå¯¹è±¡å›æ”¶è·Ÿè¸ª</p></blockquote><ul><li>ä¸ºä¸€ä¸ªå¯¹è±¡è®¾ç½®è™šå¼•ç”¨å…³è”çš„å”¯ä¸€ç›®çš„åœ¨äº <strong>è·Ÿè¸ªåƒåœ¾å›æ”¶è¿‡ç¨‹</strong>ã€‚æ¯”å¦‚ï¼šèƒ½åœ¨è¿™ä¸ªå¯¹è±¡è¢«æ”¶é›†å™¨å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥</li><li><strong>è™šå¼•ç”¨å¿…é¡»è·Ÿå¼•ç”¨é˜Ÿåˆ—ä¸€èµ·ä½¿ç”¨</strong>ã€‚è™šå¼•ç”¨åœ¨åˆ›å»ºæ—¶å¿…é¡»æä¾›ä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—ä½œä¸ºå‚æ•°ã€‚å½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒæœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨å›æ”¶å¯¹è±¡åï¼Œå°†è¿™ä¸ªè™šå¼•ç”¨åŠ å…¥å¼•ç”¨é˜Ÿåˆ—ï¼Œä»¥é€šçŸ¥åº”ç”¨ç¨‹åºå¯¹è±¡çš„å›æ”¶æƒ…å†µ</li><li><strong>ç”±äºè™šå¼•ç”¨å¯ä»¥è·Ÿè¸ªå¯¹è±¡çš„å›æ”¶æ—¶é—´</strong>ï¼Œå› æ­¤ï¼Œ<strong>å¯ä»¥å°†ä¸€äº›èµ„æºé‡Šæ”¾æ“ä½œæ”¾ç½®åœ¨è™šå¼•ç”¨ä¸­æ‰§è¡Œå’Œè®°å½•</strong></li><li>PhantomReference å®ç°è™šå¼•ç”¨</li><li>è™šå¼•ç”¨ä¸èƒ½é€šè¿‡ xxx.get()æ–¹æ³•è·å–åˆ°ï¼ï¼ï¼ï¼ï¼ï¼</li></ul><h4 id="ç»ˆç»“å™¨å¼•ç”¨"><a href="#ç»ˆç»“å™¨å¼•ç”¨" class="headerlink" title="ç»ˆç»“å™¨å¼•ç”¨"></a>ç»ˆç»“å™¨å¼•ç”¨</h4><blockquote><p><strong>ç”¨æ¥å®ç°å¯¹è±¡çš„finalize()æ–¹æ³•</strong>ï¼Œä¹Ÿç§°ä¸ºç»ˆç»“å™¨å¼•ç”¨ã€‚</p></blockquote><ul><li>æ— éœ€æ‰‹åŠ¨ç¼–ç ï¼Œå…¶å†…éƒ¨é…åˆå¼•ç”¨é˜Ÿåˆ—ä½¿ç”¨</li><li>gcæ—¶ï¼ŒæŠŠç»ˆç»“å™¨æ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ï¼Œç”¨Finalizerçº¿ç¨‹é€šè¿‡ç»ˆç»“å™¨å¼•ç”¨æ‰¾åˆ°è¢«å¼•ç”¨å¯¹è±¡ï¼Œå¹¶è°ƒç”¨å®ƒçš„finalize()æ–¹æ³•ï¼Œç¬¬äºŒæ¬¡GCçš„æ—¶å€™æ‰ä¼šå›æ”¶è¢«å¼•ç”¨çš„å¯¹è±¡</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JVM07</title>
      <link href="2020/10/18/jvm07/"/>
      <url>2020/10/18/jvm07/</url>
      
        <content type="html"><![CDATA[<h1 id="String-Table"><a href="#String-Table" class="headerlink" title="String Table"></a>String Table</h1><h2 id="Stringçš„åŸºæœ¬ç‰¹æ€§"><a href="#Stringçš„åŸºæœ¬ç‰¹æ€§" class="headerlink" title="Stringçš„åŸºæœ¬ç‰¹æ€§"></a>Stringçš„åŸºæœ¬ç‰¹æ€§</h2><blockquote><p><strong>Stringæ˜¯finalçš„ï¼Œä¸å¯è¢«ç»§æ‰¿</strong>ï¼Œ<strong>ä¸å¯å˜</strong></p><p>Stringçš„åˆ›å»ºæ–¹å¼</p><ul><li>String s1 = â€œzhanghaoyunbâ€; // å­—é¢é‡å®šä¹‰æ–¹å¼</li><li>String s2 = new String(â€œhelloâ€);  newå®ä¾‹åŒ–çš„æ–¹å¼</li></ul></blockquote><p>Stringçš„åº•å±‚å­˜å‚¨æ˜¯<strong>charç±»å‹çš„æ•°ç»„</strong>ï¼Œè¿™ä¸ªæ˜¯1.9ä¹‹å‰çš„ï¼Œåœ¨1.9çš„æ—¶å€™ç”¨<strong>byte[]æ¥å­˜å‚¨æ•°æ®</strong>,<strong>èŠ‚çº¦äº†ç©ºé—´</strong></p><blockquote><p>String ä»£è¡¨<strong>ä¸å¯å˜</strong>çš„å­—ç¬¦åºåˆ—ï¼š</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token string">"123"</span><span class="token punctuation">;</span> <span class="token comment">//å­—é¢é‡å®šä¹‰çš„æ–¹å¼ï¼Œ"123"å­˜å‚¨åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­</span>    <span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">"123"</span><span class="token punctuation">;</span>    s1 <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s1<span class="token operator">==</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><font color = red><strong>å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æ˜¯ä¸ä¼šå­˜å‚¨ç›¸åŒå†…å®¹çš„å­—ç¬¦ä¸²çš„</strong></font></li><li>Stringçš„String pool æ˜¯ä¸€ä¸ªå›ºå®šå¤§å°çš„Hash Tableï¼Œjdk6é»˜è®¤å€¼å¤§å°é•¿åº¦æ˜¯1009ã€‚å¦‚æœæ”¾è¿›String Poolçš„Stringè¿‡å¤šï¼Œå°±ä¼šé€ æˆhashå†²çªï¼Œå¯¼è‡´å¾ˆé•¿çš„é“¾è¡¨ã€‚ä»è€Œå½±å“äº†String,internæ—¶å€™çš„æ€§èƒ½ã€‚<strong>jdk7é»˜è®¤å¤§å°60013</strong>ï¼Œjdk8<strong>å¼€å§‹</strong>ï¼Œ1009æ˜¯å¯ä»¥è®¾ç½®çš„æœ€å°å€¼</li></ul><p>æµ‹è¯•ï¼š</p><blockquote><p>æŠŠ10wæ¡æ•°æ®æ’å…¥å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ï¼Œ1009çš„é•¿åº¦ï¼Œæ’å…¥æ—¶é—´ä¸º147msã€‚100009çš„é•¿åº¦ï¼Œæ’å…¥æ—¶é—´ä¸º43ms</p></blockquote><h2 id="Stringçš„å†…å­˜åˆ†é…"><a href="#Stringçš„å†…å­˜åˆ†é…" class="headerlink" title="Stringçš„å†…å­˜åˆ†é…"></a>Stringçš„å†…å­˜åˆ†é…</h2><blockquote><p>Stringç±»å‹çš„å¸¸é‡æ± <strong>ä¸»è¦çš„ä½¿ç”¨æ–¹æ³•æœ‰ä¸¤ç§</strong>ï¼š</p><ul><li>ç›´æ¥ä½¿ç”¨â€œâ€å£°æ˜å‡ºæ¥çš„Stringå¯¹è±¡ä¼šç›´æ¥å­˜å‚¨åœ¨å¸¸é‡æ± ä¸­ï¼šString info = â€œæˆ‘è¢«ç›´æ¥æ”¾åœ¨å¸¸é‡æ± ä¸­â€</li><li>å¦‚æœä¸æ˜¯â€œâ€å£°æ˜çš„å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨Stringæä¾›çš„internï¼ˆï¼‰æ–¹æ³•ã€‚ï¼ˆ<strong>é‡ç‚¹</strong>ï¼‰</li></ul></blockquote><p><strong>å†å²</strong></p><ul><li>java 6ä»¥å‰<strong>å­—ç¬¦ä¸²å¸¸é‡æ± æ”¾åœ¨æ°¸ä¹…ä»£</strong></li></ul><p><a href="https://imgchr.com/i/0Xb6eJ"><img src="https://s1.ax1x.com/2020/10/18/0Xb6eJ.png"></a></p><ul><li>java 7ä¸­<strong>å­—ç¬¦ä¸²å¸¸é‡æ± æ”¾åœ¨å †ä¸­</strong><ul><li>å­—ç¬¦ä¸²éƒ½ä¿å­˜åœ¨å †ä¸­ï¼Œè¿™æ ·è°ƒä¼˜æ—¶ä»…ä»…è°ƒæ•´å †å¤§å°å°±å¯ä»¥äº†</li><li>å­—ç¬¦ä¸²å¸¸é‡æ± æ¦‚å¿µåŸæœ¬ä½¿ç”¨çš„æ¯”è¾ƒå¤šï¼Œä½†æ˜¯è¿™ä¸ªæ”¹åŠ¨ä½¿å¾—æˆ‘ä»¬æœ‰è¶³å¤Ÿçš„ç†ç”±è®©æˆ‘ä»¬é‡æ–°è€ƒè™‘åœ¨java 7ä¸­ä½¿ç”¨String,intern()</li></ul></li><li>java 8 æ°¸ä¹…ä»£æ”¹åä¸ºå…ƒç©ºé—´ï¼Œå­—ç¬¦ä¸²å¸¸é‡è¿˜æ˜¯åœ¨å †ä¸­</li></ul><p><img src="https://s1.ax1x.com/2020/10/18/0XboOe.png"></p><h3 id="String-Tableä¸ºä»€ä¹ˆè¦è°ƒæ•´"><a href="#String-Tableä¸ºä»€ä¹ˆè¦è°ƒæ•´" class="headerlink" title="String Tableä¸ºä»€ä¹ˆè¦è°ƒæ•´"></a><strong>String Tableä¸ºä»€ä¹ˆè¦è°ƒæ•´</strong></h3><ul><li>é˜²æ­¢æ°¸ä¹…ä»£å†…å­˜æº¢å‡º</li><li>æ°¸ä¹…ä»£åƒåœ¾å›æ”¶é¢‘ç‡ä½</li></ul><h2 id="Stringçš„åŸºæœ¬æ“ä½œ"><a href="#Stringçš„åŸºæœ¬æ“ä½œ" class="headerlink" title="Stringçš„åŸºæœ¬æ“ä½œ"></a>Stringçš„åŸºæœ¬æ“ä½œ</h2><blockquote><p>ç”¨â€œâ€åˆ›å»ºçš„å­—ç¬¦ä¸²åªä¼šåœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­åˆ›å»ºä¸€æ¬¡</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å› ä¸ºä¹‹å‰åˆ›å»ºè¿‡äº†ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨çš„æ˜¯ä¹‹å‰åˆ›å»ºçš„</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œ"><a href="#å­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œ" class="headerlink" title="å­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œ"></a>å­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œ</h2><ol><li><p>å¸¸é‡ä¸å¸¸é‡çš„æ‹¼æ¥ç»“æœåœ¨å¸¸é‡æ± ï¼ŒåŸç†æ˜¯<strong>ç¼–è¯‘å™¨ä¼˜åŒ–</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token string">"a"</span><span class="token operator">+</span><span class="token string">"b"</span><span class="token operator">+</span><span class="token string">"c"</span><span class="token punctuation">;</span><span class="token comment">// ç­‰åŒäº abc</span><span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span> <span class="token comment">// abc ä¸€å®šæ˜¯æ”¾åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ï¼Œå°†åœ°å€èµ‹å€¼ç»™s2</span><span class="token comment">/*å¸¸é‡ä¸å¸¸é‡è¿›è¡Œæ‹¼æ¥ï¼Œç»“æœæ”¾å…¥å¸¸é‡æ± ï¼ŒåŸç†æ˜¯ç¼–è¯‘æœŸä¼˜åŒ–å­—èŠ‚ç åç¼–è¯‘åï¼šString s1 = "abc";String s2 = "abc"; */</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s1 <span class="token operator">==</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// true</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/10/19/0xaZFI.md.png" alt="0xaZFI.md.png"></p></li><li><p><strong>å¸¸é‡æ± ä¸­ä¸ä¼šå­˜åœ¨ç›¸åŒå†…å®¹çš„å¸¸é‡</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token string">"javaEE"</span><span class="token punctuation">;</span><span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">"javaEE"</span><span class="token punctuation">;</span><span class="token function">sout</span><span class="token punctuation">(</span>s1<span class="token operator">==</span>s2<span class="token punctuation">)</span> <span class="token comment">// true</span>         <span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token string">"javaEE"</span><span class="token punctuation">;</span><span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">"hadoop"</span><span class="token punctuation">;</span><span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token string">"javaEEhadoop"</span><span class="token punctuation">;</span><span class="token class-name">String</span> s4 <span class="token operator">=</span> <span class="token string">"javaEE"</span><span class="token operator">+</span><span class="token string">"hadoop"</span><span class="token punctuation">;</span>  <span class="token comment">// ç¼–è¯‘å™¨ä¼˜åŒ–</span><span class="token class-name">String</span> s5 <span class="token operator">=</span> s1 <span class="token operator">+</span> <span class="token string">"hadoop"</span><span class="token punctuation">;</span>  <span class="token comment">// æ‹¼æ¥ç¬¦å·å‰åå‡ºç°äº†å˜é‡ï¼Œåˆ™éœ€è¦åœ¨å †ç©ºé—´ä¸­newä¸€ä¸ªï¼Œå…·ä½“å†…å®¹ä¸ºæ‹¼æ¥ç»“æœ</span><span class="token class-name">String</span> s6 <span class="token operator">=</span> <span class="token string">"javaEE"</span> <span class="token operator">+</span> s2<span class="token punctuation">;</span><span class="token class-name">String</span> s7 <span class="token operator">=</span> s1 <span class="token operator">+</span> s2<span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3<span class="token operator">==</span>s4<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true å¸¸é‡ç›¸åŠ ç»“æœæ”¾å…¥å¸¸é‡æ± </span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3<span class="token operator">==</span>s5<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3<span class="token operator">==</span>s6<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3<span class="token operator">==</span>s7<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s5<span class="token operator">==</span>s6<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s5<span class="token operator">==</span>s7<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s6<span class="token operator">==</span>s7<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span><span class="token comment">// intern() å¦‚æœå¸¸é‡æ± ä¸­æ²¡æœ‰è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå°±ä¼šæ·»åŠ ä¸€ä¸ªè¿›å»ï¼Œå¹¶è¿”å›æ­¤å¯¹è±¡ï¼ˆs6ï¼‰çš„åœ°å€</span><span class="token comment">// å¦‚æœæœ‰ï¼Œå°±è¿”å›å¸¸é‡æ± ä¸­çš„åœ°å€</span><span class="token class-name">String</span> s8 <span class="token operator">=</span> s6<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3<span class="token operator">==</span>s8<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>åªè¦å…¶ä¸­æœ‰ä¸€ä¸ªæ˜¯å˜é‡ï¼Œç»“æœå°±åœ¨å †ä¸­</strong>ã€‚å˜é‡æ‹¼æ¥çš„åŸç†æ˜¯StringBuilder </p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token string">"a"</span><span class="token punctuation">;</span><span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">;</span><span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token string">"ab"</span><span class="token punctuation">;</span><span class="token comment">/*å¦‚ä¸‹çš„s1 + s2æ“ä½œæ‰§è¡Œç»†èŠ‚ï¼šâ‘  StringBuilder s = new StringBuilder();â‘¡ s.append("a")â‘¢ s.append("b")â‘£ s.toString() ---->åº•å±‚å®é™…ä¸Šæ˜¯newäº†ä¸€ä¸ªStringï¼Œè¿”å›å›å» */</span><span class="token class-name">String</span> s4 <span class="token operator">=</span> s1 <span class="token operator">+</span> s2<span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3 <span class="token operator">==</span> s4<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬æ¥çœ‹å­—èŠ‚ç ï¼š</p><pre class="line-numbers language-class" data-language="class"><code class="language-class"> 0 ldc #2 &lt;a&gt;     &#x2F;&#x2F; å­—ç¬¦ä¸²å¸¸é‡a 2 astore_1   &#x2F;&#x2F; å­˜æ”¾åœ¨å±€éƒ¨å˜é‡è¡¨ç´¢å¼•ä¸º1çš„ä½ç½® 3 ldc #3 &lt;b&gt; 5 astore_2 6 ldc #4 &lt;ab&gt; 8 astore_3 9 new #5 &lt;java&#x2F;lang&#x2F;StringBuilder&gt;    &#x2F;&#x2F; è¿™é‡Œä½¿ç”¨äº†StringBuilder12 dup13 invokespecial #6 &lt;java&#x2F;lang&#x2F;StringBuilder.&lt;init&gt;&gt;16 aload_117 invokevirtual #7 &lt;java&#x2F;lang&#x2F;StringBuilder.append&gt;    &#x2F;&#x2F;è¿™é‡Œè°ƒç”¨äº†appendæ–¹æ³•æ‹¼æ¥ &quot;a&quot;20 aload_221 invokevirtual #7 &lt;java&#x2F;lang&#x2F;StringBuilder.append&gt;    &#x2F;&#x2F;è¿™é‡Œè°ƒç”¨äº†appendæ–¹æ³•æ‹¼æ¥ &quot;b&quot;24 invokevirtual #8 &lt;java&#x2F;lang&#x2F;StringBuilder.toString&gt;   &#x2F;&#x2F; è°ƒç”¨è‡ªå·±çš„toStringæ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªString27 astore 429 getstatic #9 &lt;java&#x2F;lang&#x2F;System.out&gt;32 aload_333 aload 435 if_acmpne 42 (+7)38 iconst_139 goto 43 (+4)42 iconst_043 invokevirtual #10 &lt;java&#x2F;io&#x2F;PrintStream.println&gt;46 return<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¡¥å……</strong></p><p><strong>åœ¨jdk5ä¹‹å‰</strong>ä½¿ç”¨çš„æ˜¯StringBufferï¼Œï¼Œ<strong>5ä¹‹åçš„ç‰ˆæœ¬</strong>ä½¿ç”¨çš„StringBuilder</p><p>BUT!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</p><p>å¦‚æœå‡ºç°ä»¥ä¸‹æƒ…å†µï¼Œå°±æ˜¯å¦ä¸€å›äº‹å„¿äº†</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">final</span>  <span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token string">"a"</span><span class="token punctuation">;</span><span class="token keyword">final</span>  <span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">;</span><span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token string">"ab"</span><span class="token punctuation">;</span><span class="token comment">/*ç”¨finalä¿®é¥° s1 s2è¿™æ—¶å€™å¯ä»¥è®¤ä¸ºæ˜¯ä¸¤ä¸ªå¸¸é‡å¼•ç”¨è¿›è¡Œç›¸åŠ  */</span><span class="token class-name">String</span> s4 <span class="token operator">=</span> s1 <span class="token operator">+</span> s2<span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3 <span class="token operator">==</span> s4<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºåŠ äº†<code>final</code>å…³é”®å­—ï¼Œæ‰€ä»¥s1ï¼Œs2éƒ½æ˜¯å­—ç¬¦ä¸²å¸¸é‡çš„å¼•ç”¨ï¼Œæ‰€ä»¥ä»–ä»¬çš„åœ°å€åº”è¯¥æ˜¯åŒä¸€ä¸ª</p></li></ol><h4 id="å’Œ-appendçš„æ•ˆç‡é—®é¢˜"><a href="#å’Œ-appendçš„æ•ˆç‡é—®é¢˜" class="headerlink" title="+ å’Œ appendçš„æ•ˆç‡é—®é¢˜"></a>+ å’Œ appendçš„æ•ˆç‡é—®é¢˜</h4><blockquote><p>appendçš„æ‰§è¡Œæ•ˆç‡è¦è¿œè¿œé«˜äº å­—ç¬¦ä¸²æ‹¼æ¥çš„æ•ˆç‡</p><p>å­—ç¬¦ä¸²æ‹¼æ¥åº•å±‚ï¼Œè¦å…ˆnewä¸€ä¸ªStringBuilderï¼Œå®Œäº†è°ƒç”¨appendæ–¹æ³•ï¼Œæœ€åå†è°ƒç”¨toStringæ–¹æ³•è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ã€‚</p></blockquote><p><strong>æé«˜</strong></p><p>æˆ‘ä»¬ä¸€èˆ¬åœ¨é¡¹ç›®ä¸­ï¼Œå¦‚æœé‡åˆ°å¤šæ¬¡å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œæˆ‘ä»¬ä¼šåˆ›å»ºStringBuilderï¼Œç”¨appendæ–¹æ³•æ¥ä»£æ›¿å­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œã€‚</p><p>å½“ç„¶<strong>è¿˜æœ‰ä¸€ç§æ›´å¥½çš„ä¼˜åŒ–</strong>ï¼šå› ä¸ºStringBuilderæ„é€ å™¨ä¹Ÿæ˜¯ç”¨é»˜è®¤é•¿åº¦16çš„æ•°ç»„æ„é€ çš„ï¼Œæ‰€ä»¥</p><ol><li><p>å¦‚æœæ‹¼æ¥çš„ç»“æœè°ƒç”¨internï¼ˆï¼‰æ–¹æ³•ï¼Œåˆ™<strong>ä¸»åŠ¨å°†å¸¸é‡æ± ä¸­è¿˜æ²¡æœ‰çš„å­—ç¬¦ä¸²å¯¹è±¡æ”¾å…¥æ± ä¸­ï¼Œå¹¶è¿”å›æ­¤å¯¹è±¡çš„åœ°å€</strong>ã€‚</p><blockquote><p>æˆ‘ä»¬å¯ä»¥æ¥åšä¸€ä¸ªéªŒè¯ï¼Œåœ¨ä¸Šä¸€ä¸ªä¾‹å­ä¸­ï¼Œç”±äºs6çš„ â€œjavaEEhadoopâ€ åœ¨ä¹‹å‰å°±å­˜åœ¨äº†å¸¸é‡æ± ä¸­ï¼Œæ‰€ä»¥<strong>åªæ˜¯æŠŠå¸¸é‡æ± ä¸­çš„å¯¹åº”å­—ç¬¦ä¸²åœ°å€è¿”å›äº†</strong></p></blockquote></li></ol><p>é—®é¢˜å‡ºç°:</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token string">"a"</span><span class="token punctuation">;</span><span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">;</span><span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token string">"ab"</span><span class="token punctuation">;</span><span class="token class-name">String</span> s4 <span class="token operator">=</span> s1<span class="token operator">+</span>s2<span class="token punctuation">;</span>sout <span class="token punctuation">(</span>s3 <span class="token operator">==</span> s4<span class="token punctuation">)</span>       <span class="token boolean">false</span>  å› ä¸ºå˜é‡ç›¸åŠ  æ˜¯åœ¨å †ä¸­<span class="token keyword">new</span>äº†ä¸€ä¸ªæ–°çš„        s3ä¸­æŒ‡å‘çš„æ˜¯å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„ <span class="token string">"ab"</span>    s4æ˜¯åœ¨å †ç©ºé—´ä¸­<span class="token keyword">new</span> çš„<span class="token class-name">String</span>å¯¹è±¡ï¼Œå­˜æ”¾çš„ <span class="token string">"ab"</span>ï¼Œä»–ä»¬ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œæ‰€ä»¥æ˜¯<span class="token boolean">false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="intern-çš„ä½¿ç”¨"><a href="#intern-çš„ä½¿ç”¨" class="headerlink" title="intern()çš„ä½¿ç”¨"></a>intern()çš„ä½¿ç”¨</h2><h4 id="å¼•å­ï¼šé¢è¯•é¢˜"><a href="#å¼•å­ï¼šé¢è¯•é¢˜" class="headerlink" title="å¼•å­ï¼šé¢è¯•é¢˜"></a>å¼•å­ï¼šé¢è¯•é¢˜</h4><blockquote><p><a href="https://www.bilibili.com/video/BV1PJ411n7xZ?p=126">https://www.bilibili.com/video/BV1PJ411n7xZ?p=126</a></p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> s<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s <span class="token operator">==</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">///?????????</span><span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s3<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> s4 <span class="token operator">=</span> <span class="token string">"11"</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3 <span class="token operator">==</span> s4<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">////??????????????</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><blockquote><p>internæ–¹æ³•ä¼šåˆ¤æ–­å½“å‰å­—ç¬¦ä¸²ï¼Œåœ¨å¸¸é‡æ± ä¸­æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœå­˜åœ¨å°±è¿”å›å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„åœ°å€ï¼Œå¦‚æœä¸å­˜åœ¨å°±ä¼šå°†å½“å‰å­—ç¬¦ä¸²æ”¾å…¥å¸¸é‡æ± ä¸­ï¼Œå¹¶è¿”å›è¿™ä¸ªåœ°å€ã€‚è¿™ä¸ªè¦å› ä¸ºç‰ˆæœ¬çš„ä¸åŒï¼Œä¼šæœ‰ä¸åŒçš„æƒ…å†µï¼Œå…·ä½“çœ‹ä¸‹é¢çš„é¢˜</p></blockquote><h4 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h4><blockquote><p>å¦‚ä½•ä¿è¯å˜é‡sæŒ‡å‘çš„æ˜¯å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„æ•°æ®å‘¢ï¼Ÿ</p><ul><li>String s = â€œhello worldâ€ // å®šä¹‰å­—é¢é‡æ–¹å¼</li><li>String s = new String(â€œxxxxâ€).intern();</li><li>String s = new StringBuilder(â€œxxxxxâ€).toString().intern();</li></ul></blockquote><h4 id="new-Stringåˆ°åº•åˆ›å»ºäº†å‡ ä¸ªå¯¹è±¡ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ"><a href="#new-Stringåˆ°åº•åˆ›å»ºäº†å‡ ä¸ªå¯¹è±¡ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ" class="headerlink" title="new Stringåˆ°åº•åˆ›å»ºäº†å‡ ä¸ªå¯¹è±¡ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ"></a>new Stringåˆ°åº•åˆ›å»ºäº†å‡ ä¸ªå¯¹è±¡ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</h4><blockquote><p>new String(â€œabâ€) ä¼šåˆ›å»ºå‡ ä¸ªå¯¹è±¡ï¼Ÿ  æŸ¥çœ‹å­—èŠ‚ç æŒ‡ä»¤ï¼</p></blockquote><pre class="line-numbers language-class" data-language="class"><code class="language-class"> 0 new #2 &lt;java&#x2F;lang&#x2F;String&gt;   &#x2F;&#x2F; new å¼€è¾Ÿäº†ä¸€å—ç©ºé—´å­˜æ”¾ä¸€ä¸ªab 3 dup 4 ldc #3 &lt;ab&gt;   &#x2F;&#x2F; è¿™é‡Œå¾€å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å­˜äº†ä¸€ä»½ 6 invokespecial #4 &lt;java&#x2F;lang&#x2F;String.&lt;init&gt;&gt; 9 astore_110 return<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>new String(â€œaâ€) + new String(â€œbâ€) ä¼šåˆ›å»ºå‡ ä¸ªå¯¹è±¡ï¼Ÿ</p><ul><li>new StringBuilder</li><li>new String(a)</li><li>å¸¸é‡æ± ä¸­çš„ a</li><li>new String(b)</li><li>å¸¸é‡æ± ä¸­çš„ b</li><li>toStringæ–¹æ³•åˆ›å»ºçš„Stringå¯¹è±¡ï¼šnew String(â€œabâ€)</li></ul><p><strong>å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ä¸å­˜åœ¨ab</strong>ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ </p></blockquote><pre class="line-numbers language-class" data-language="class"><code class="language-class"> 0 new #2 &lt;java&#x2F;lang&#x2F;StringBuilder&gt;   &#x2F;&#x2F; ä½¿ç”¨äº†æ‹¼æ¥æ“ä½œï¼Œåˆ›å»ºä¸€ä¸ªStringBuilderå¯¹è±¡ 3 dup 4 invokespecial #3 &lt;java&#x2F;lang&#x2F;StringBuilder.&lt;init&gt;&gt; 7 new #4 &lt;java&#x2F;lang&#x2F;String&gt;   &#x2F;&#x2F; new å¼€è¾Ÿç©ºé—´å­˜æ”¾a10 dup11 ldc #5 &lt;a&gt;   &#x2F;&#x2F; å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å†å­˜æ”¾ä¸€ä¸ªa13 invokespecial #6 &lt;java&#x2F;lang&#x2F;String.&lt;init&gt;&gt;16 invokevirtual #7 &lt;java&#x2F;lang&#x2F;StringBuilder.append&gt;   &#x2F;&#x2F;è°ƒç”¨appendæ–¹æ³•19 new #4 &lt;java&#x2F;lang&#x2F;String&gt;   &#x2F;&#x2F; new å¼€è¾Ÿç©ºé—´å­˜æ”¾b22 dup23 ldc #8 &lt;b&gt;  &#x2F;&#x2F; å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å­˜æ”¾ä¸€ä¸ªb25 invokespecial #6 &lt;java&#x2F;lang&#x2F;String.&lt;init&gt;&gt;28 invokevirtual #7 &lt;java&#x2F;lang&#x2F;StringBuilder.append&gt;  &#x2F;&#x2F; è°ƒç”¨appendæ–¹æ³•31 invokevirtual #9 &lt;java&#x2F;lang&#x2F;StringBuilder.toString&gt;    &#x2F;&#x2F;è°ƒç”¨toStringæ–¹æ³•34 astore_135 return<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæˆ‘ä»¬æ¥è¯´ä¸€ä¸‹æœ¬æ¨¡å—çš„å¼•å­ï¼Œé¢è¯•é¢˜ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> s<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// åœ¨è¿™ä¹‹å‰å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å·²ç»å­˜åœ¨1äº†</span><span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s <span class="token operator">==</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">///  jdk6  false     jdk7/8 false</span><span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s3<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/*jdk1.6  åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­åˆ›å»ºä¸€ä¸ª11å¯¹è±¡jdk7/8  åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å¼€è¾Ÿä¸€ä¸ªç©ºé—´ï¼Œè®°å½•å †ä¸­newçš„11çš„åœ°å€ï¼Œæ‰€ä»¥s3 == s4ï¼Œå› ä¸ºä»–ä»¬éƒ½æŒ‡å‘çš„åŒä¸€ä¸ªå¯¹è±¡*/</span><span class="token class-name">String</span> s4 <span class="token operator">=</span> <span class="token string">"11"</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3 <span class="token operator">==</span> s4<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">////      jdk6 false    jdk7/8 true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/10/20/0zbbfs.png" alt="0zbbfs.png"></p><p>è§£é‡Šï¼š</p><p>â€‹      new String(â€œ1â€)ï¼Œæ ¹æ®æˆ‘ä»¬ä¹‹å‰çš„çŸ¥è¯†ï¼Œå¯ä»¥çŸ¥é“ä»–åˆ›å»ºäº†ä¸¤ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªæ”¾åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ï¼Œä¸€ä¸ªåœ¨å †ä¸­ã€‚å½“å†æ¬¡è°ƒç”¨intern()æ–¹æ³•çš„æ—¶å€™ï¼Œç”±äºå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å·²ç»æœ‰äº† â€œ1â€è¿™ä¸ªå€¼ï¼Œè¿”å›å¸¸é‡æ± ä¸­çš„åœ°å€ï¼Œå´æ²¡æœ‰æ¥æ”¶å¯¹è±¡ï¼Œæ‰€ä»¥ç›¸å½“äºæ²¡æœ‰åšä»»ä½•æ“ä½œã€‚s2 = â€œ1â€ å°±ç›´æ¥å»å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æ‰¾ï¼Œå› ä¸ºä¹‹å‰å­˜åœ¨ï¼Œè¿”å›åŸæ¥çš„åœ°å€ã€‚</p><p>â€‹       new String(â€œ1â€) + new String(â€œ1â€) ï¼Œ æ ¹æ®æˆ‘ä»¬ä¹‹å‰çš„çŸ¥è¯†ï¼Œå¯ä»¥çŸ¥é“ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ä¼šå­˜æ”¾ â€œ1â€ï¼Œå †ç©ºé—´ä¸­ä¼šå­˜æ”¾æœ€åçš„ç»“æœ â€œ11â€ã€‚å½“è°ƒç”¨ s3.intern()æ–¹æ³•çš„æ—¶å€™ã€‚æœ‰ä»¥ä¸‹æƒ…å†µï¼š</p><ul><li>jdk6çš„æ—¶å€™ï¼Œjvmä¼šåœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­new ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œæ¥ä¿å­˜11  ï¼ŒåŒæ—¶å †ç©ºé—´ä¸­ä¹Ÿå­˜åœ¨ä¸€ä¸ª11,s3æŒ‡å‘çš„æ˜¯å †ç©ºé—´çš„é‚£ä¸ªnew å‡ºæ¥çš„ï¼Œs4åˆ›å»ºçš„æ—¶å€™ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å·²ç»å­˜åœ¨äº†ï¼Œæ‰€ä»¥æŠŠå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„ç»™äº†s4ï¼Œæ‰€ä»¥ä»–ä»¬ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œæ•…false</li><li>jdk7/8çš„æ—¶å€™ï¼Œjvmä¼šåœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å¼€è¾Ÿç©ºé—´ï¼Œ<strong>è¿™æ—¶å€™ä¸æ˜¯ä¿å­˜â€11â€äº†ï¼Œè€Œæ˜¯ä¿å­˜å †ç©ºé—´ä¸­newçš„â€11â€å¯¹è±¡çš„åœ°å€ã€‚</strong>æ‰€ä»¥ï¼Œs4åˆ›å»ºçš„æ—¶å€™ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­ç¡®å®å­˜åœ¨â€11â€è¿™ä¸ªä¸œè¥¿ï¼Œä½†æ˜¯ä»–å®é™…ä¸Šå­˜æ”¾çš„æ˜¯å †ç©ºé—´ä¸­çš„é‚£ä¸ªâ€11â€çš„åœ°å€ã€‚æ‰€ä»¥è¿™æ—¶å€™s4 å’Œ s3 å®é™…ä¸Šæ˜¯æŒ‡å‘åŒä¸€å—å†…å­˜åœ°å€ï¼Œå³å †ç©ºé—´ä¸­çš„â€11â€å¯¹è±¡ã€‚</li></ul><p><strong>é¢è¯•é¢˜æ‹“å±•ï¼š</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> s4 <span class="token operator">=</span> <span class="token string">"11"</span><span class="token punctuation">;</span>s3<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// æ­¤æ—¶å¸¸é‡æ± ä¸­å·²ç»æœ‰äº†11ï¼Œæ‰€ä»¥ç›¸å½“äºå•¥ä¹Ÿæ²¡å¹²</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s3 <span class="token operator">==</span> s4<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/10/20/BppKFP.png"></p><h2 id="String-Tableçš„åƒåœ¾å›æ”¶"><a href="#String-Tableçš„åƒåœ¾å›æ”¶" class="headerlink" title="String Tableçš„åƒåœ¾å›æ”¶"></a>String Tableçš„åƒåœ¾å›æ”¶</h2><h2 id="G1ä¸­çš„Stringå»é‡æ“ä½œ"><a href="#G1ä¸­çš„Stringå»é‡æ“ä½œ" class="headerlink" title="G1ä¸­çš„Stringå»é‡æ“ä½œ"></a>G1ä¸­çš„Stringå»é‡æ“ä½œ</h2><p><img src="https://s1.ax1x.com/2020/10/20/Bp5UQf.png"></p>]]></content>
      
      
      <categories>
          
          <category> jvm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JVM06</title>
      <link href="2020/10/16/jvm06/"/>
      <url>2020/10/16/jvm06/</url>
      
        <content type="html"><![CDATA[<h1 id="æ‰§è¡Œå¼•æ“"><a href="#æ‰§è¡Œå¼•æ“" class="headerlink" title="æ‰§è¡Œå¼•æ“"></a>æ‰§è¡Œå¼•æ“</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><blockquote><p>æ‰§è¡Œå¼•æ“æ˜¯javaè™šæ‹Ÿæœºæ ¸å¿ƒçš„ç»„æˆéƒ¨åˆ†ä¹‹ä¸€ã€‚</p><p><strong>è™šæ‹Ÿæœºçš„æ‰§è¡Œå¼•æ“æ˜¯ç”±è½¯ä»¶è‡ªè¡Œå®ç°çš„</strong>ï¼Œå¯ä»¥ä¸å—ç‰©ç†æ¡ä»¶åˆ¶çº¦ç¬¬æŒ‡å®šæŒ‡ä»¤é›†ä¸æ‰§è¡Œå¼•æ“çš„ç»“æ„ä½“ç³»ï¼Œ<strong>èƒ½å¤Ÿæ‰§è¡Œé‚£äº›ä¸è¢«ç¡¬ä»¶ç›´æ¥æ”¯æŒçš„æŒ‡ä»¤é›†æ ¼å¼</strong></p></blockquote><p><img src="https://s1.ax1x.com/2020/10/16/0bX21U.png"></p><p>JVMçš„ä¸»è¦ä»»åŠ¡æ˜¯ï¼š<strong>è£…è½½å­—èŠ‚ç åˆ°å…¶å†…éƒ¨</strong>ï¼Œä½†å­—èŠ‚ç å¹¶ä¸èƒ½å¤Ÿç›´æ¥è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸Šï¼Œå› ä¸ºå­—èŠ‚ç æŒ‡ä»¤å¹¶éç­‰ä»·äºæœ¬åœ°æœºå™¨æŒ‡ä»¤ï¼Œä»–å†…éƒ¨åŒ…å«çš„ä»…ä»…æ˜¯ä¸€äº›èƒ½å¤Ÿè¢«JVMæ‰€è¯†åˆ«çš„å­—èŠ‚ç æŒ‡ä»¤ã€ç¬¦å·è¡¨ï¼Œä»¥åŠå…¶ä»–è¾…åŠ©ä¿¡æ¯ã€‚</p><p><strong>è€Œæ‰§è¡Œå¼•æ“çš„ä»»åŠ¡æ˜¯ï¼š</strong>å°†å­—èŠ‚ç è§£é‡Š/ç¼–è¯‘ä¸ºå¯¹åº”å¹³å°ä¸Šçš„<strong>æœ¬åœ°æœºå™¨æŒ‡ä»¤</strong>ï¼Œç›¸å½“äºä¸€ä¸ªç¿»è¯‘å®˜ã€‚</p><p><img src="https://s1.ax1x.com/2020/10/17/0Lemuj.png" alt="æ‰§è¡Œå¼•æ“å……å½“çš„è§’è‰²"></p><ol><li>æ‰§è¡Œå¼•æ“æ‰§è¡Œä»€ä¹ˆæ ·çš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œ<strong>å®Œå…¨å–å†³äºpcå¯„å­˜å™¨</strong></li><li>æ¯å½“æ‰§è¡Œå®Œä¸€æ¡æŒ‡ä»¤åï¼Œpcå¯„å­˜å™¨å°±ä¼šæ›´æ–°ä¸‹ä¸€æ¡éœ€è¦è¢«æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€</li><li>æ‰§è¡Œå¼•æ“å¯èƒ½ä¼šé€šè¿‡<strong>å­˜å‚¨åœ¨å±€éƒ¨å˜é‡è¡¨ä¸­çš„å¯¹è±¡å¼•ç”¨</strong>ï¼Œå®šä½åˆ°javaå †ä¸­çš„å®ä¾‹ä¿¡æ¯ï¼Œå†é€šè¿‡<strong>å¯¹è±¡å¤´ä¸­çš„å…ƒæ•°æ®æŒ‡é’ˆ</strong>å®šä½åˆ°å¯¹è±¡çš„ç±»å‹ä¿¡æ¯</li></ol><blockquote><p>ä»å¤–è§‚ä¸Šæ¥çœ‹ï¼Œjavaè™šæ‹Ÿæœºæ‰§è¡Œå¼•æ“è¾“å…¥çš„æ˜¯å­—èŠ‚ç äºŒè¿›åˆ¶æµï¼Œè¾“å‡ºçš„æ˜¯æ‰§è¡Œç»“æœ</p></blockquote><h2 id="javaä»£ç ç¼–è¯‘å’Œæ‰§è¡Œè¿‡ç¨‹"><a href="#javaä»£ç ç¼–è¯‘å’Œæ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="javaä»£ç ç¼–è¯‘å’Œæ‰§è¡Œè¿‡ç¨‹"></a>javaä»£ç ç¼–è¯‘å’Œæ‰§è¡Œè¿‡ç¨‹</h2><blockquote><p>javaä»£ç ç¼–è¯‘åˆ†ä¸º<strong>å‰ç«¯ç¼–è¯‘</strong>å’Œ<strong>åç«¯ç¼–è¯‘</strong></p><p>å‰ç«¯ç¼–è¯‘æ˜¯ä¸å±äºjvmçš„ï¼Œæ˜¯æŠŠä¸€ä¸ªjavaæ–‡ä»¶è½¬æ¢ä¸ºå­—èŠ‚ç æ–‡ä»¶çš„è¿‡ç¨‹ï¼Œæ¥ä¸‹æ¥æ‰ä¼šè¢«ç±»åŠ è½½å™¨æ‰€åŠ è½½åˆ°jvmä¸­ã€‚</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/17/0LuDP0.png" alt="åç«¯ç¼–è¯‘"></p><h3 id="è§£é‡Šå™¨å’Œç¼–è¯‘å™¨"><a href="#è§£é‡Šå™¨å’Œç¼–è¯‘å™¨" class="headerlink" title="è§£é‡Šå™¨å’Œç¼–è¯‘å™¨"></a>è§£é‡Šå™¨å’Œç¼–è¯‘å™¨</h3><blockquote><p>è§£é‡Šå™¨ Interpreter</p></blockquote><p><strong>å½“Javaè™šæ‹Ÿæœºå¯åŠ¨æ—¶</strong>ï¼Œä¼šæ ¹æ®é¢„å®šä¹‰çš„è§„èŒƒ<strong>å¯¹å­—èŠ‚ç é‡‡ç”¨é€è¡Œè§£é‡Šçš„æ–¹å¼æ‰§è¡Œ</strong>ï¼Œå°†æ¯æ¡å­—èŠ‚ç æ–‡ä»¶ä¸­çš„å†…å®¹â€œç¿»è¯‘â€ä¸ºå¯¹åº”å¹³å°çš„æœ¬åœ°æœºå™¨æŒ‡ä»¤æ‰§è¡Œ</p><blockquote><p>ç¼–è¯‘å™¨ (just in time Compiler)</p></blockquote><p>è™šæ‹Ÿæœºå°†æºä»£ç ç›´æ¥ç¼–è¯‘æˆå’Œæœ¬åœ°æœºå™¨å¹³å°ç›¸å…³çš„æœºå™¨è¯­è¨€</p><p><strong>é—®é¢˜ï¼šä¸ºä»€ä¹ˆè¯´javaæ˜¯åŠç¼–è¯‘åŠè§£é‡Šæ€§è¯­è¨€ï¼Ÿ</strong></p><p>JVMåœ¨æ‰§è¡Œjavaä»£ç çš„æ—¶å€™ï¼Œé€šå¸¸éƒ½ä¼šæŠŠ<strong>è§£é‡Šæ‰§è¡Œå’Œç¼–è¯‘æ‰§è¡Œ</strong>ç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œæ‰€ä»¥æ˜¯ã€‚ã€‚ã€‚ã€‚</p><p><img src="https://s1.ax1x.com/2020/10/17/0L19ts.png" alt="ç¼–è¯‘è§£é‡Šæµç¨‹"></p><h2 id="è§£é‡Šå™¨"><a href="#è§£é‡Šå™¨" class="headerlink" title="è§£é‡Šå™¨"></a>è§£é‡Šå™¨</h2><blockquote><p>åŸºäºè§£é‡Šå™¨æ‰§è¡Œå·²ç»æˆä¸ºäº†<strong>ä½æ•ˆ</strong>çš„ä»£åè¯ï¼Œæ‰€ä»¥æ‰è¦æä¾›ä¸€ä¸ªç¼–è¯‘å™¨  </p></blockquote><h2 id="JITç¼–è¯‘å™¨"><a href="#JITç¼–è¯‘å™¨" class="headerlink" title="JITç¼–è¯‘å™¨"></a>JITç¼–è¯‘å™¨</h2><blockquote><p>å‡ºç°çš„ç›®çš„æ˜¯é¿å…å‡½æ•°è¢«è§£é‡Šæ‰§è¡Œï¼Œ<strong>è€Œæ˜¯å°†æ•´ä¸ªå‡½æ•°ä½“ç¼–è¯‘æˆæœºå™¨ç </strong>ï¼Œæ¯æ¬¡å‡½æ•°æ‰§è¡Œæ—¶ï¼Œåªæ‰§è¡Œç¼–è¯‘åçš„æœºå™¨ç å³å¯ã€‚<strong>å¤§å¹…åº¦æé«˜æ•ˆç‡</strong></p></blockquote><p><img src="https://s1.ax1x.com/2020/10/17/0LD7Nt.png"></p><p>å…·ä½“hotspoté€‰æ‹©å“ªç§ï¼Œå°±è¦çœ‹å®ƒè‡ªå·±å»åˆ¤æ–­äº†ã€‚</p><blockquote><p>å½“è™šæ‹Ÿæœºå¯åŠ¨çš„æ—¶å€™ï¼Œ<strong>è§£é‡Šå™¨é¦–å…ˆå‘æŒ¥ä½œç”¨</strong>ï¼Œè¿™æ ·å¯ä»¥çœå»ä¸å¿…è¦çš„ç¼–è¯‘æ—¶é—´ã€‚å¹¶ä¸”ï¼Œéšç€ç¨‹åºè¿ è¡Œæ—¶é—´çš„æ¨ç§»ï¼Œå³æ—¶ç¼–è¯‘å™¨é€æ¸å‘æŒ¥ä½œç”¨ï¼Œ<strong>æ ¹æ®çƒ­ç‚¹æ¢æµ‹åŠŸèƒ½</strong>ï¼Œ<strong>å°†æœ‰ä»·å€¼çš„å­—èŠ‚ç ç¼–è¯‘ä¸ºæœ¬åœ°æœºå™¨æŒ‡ä»¤</strong>ï¼Œä»è€Œæ¢å–æ›´é«˜çš„ç¨‹åºæ‰§è¡Œæ•ˆç‡ã€‚</p></blockquote><h3 id="çƒ­ç‚¹ä»£ç ç¡®å®šä½•æ—¶JIT"><a href="#çƒ­ç‚¹ä»£ç ç¡®å®šä½•æ—¶JIT" class="headerlink" title="çƒ­ç‚¹ä»£ç ç¡®å®šä½•æ—¶JIT"></a>çƒ­ç‚¹ä»£ç ç¡®å®šä½•æ—¶JIT</h3><blockquote><p>çƒ­ç‚¹ä»£ç è¦<strong>æ ¹æ®ä»£ç çš„è°ƒç”¨é¢‘ç‡æ¥å®š</strong>ã€‚  JITç¼–è¯‘å™¨ä¼šé’ˆå¯¹é‚£äº›çƒ­ç‚¹ä»£ç è¿›è¡Œ <strong>æ·±åº¦ä¼˜åŒ–</strong>ï¼Œå°†å…¶ç›´æ¥ç¼–è¯‘ä¸ºå¯¹åº”å¹³å°çš„æœ¬åœ°æœºå™¨æŒ‡ä»¤ï¼Œä»¥æ­¤æå‡javaç¨‹åºçš„æ‰§è¡Œæ€§èƒ½ã€‚</p></blockquote><ul><li><p>çƒ­ç‚¹ä»£ç ï¼š</p><p>ä¸€ä¸ªè¢«å¤šæ¬¡è°ƒç”¨çš„æ–¹æ³•ï¼Œæˆ–è€…ä¸€ä¸ªæ–¹æ³•ä½“å†…å¾ªç¯æ¬¡æ•°è¾ƒå¤šçš„å¾ªç¯ä½“ç­‰</p></li><li><p>çƒ­ç‚¹æ¢æµ‹æŠ€æœ¯ï¼š</p><blockquote><p>hotspotè™šæ‹Ÿæœºä¼šç»™æ¯ä¸€ä¸ªæ–¹æ³•å»ºç«‹2ä¸ªä¸åŒç±»å‹çš„è®¡æ•°å™¨ï¼š<strong>æ–¹æ³•è°ƒç”¨è®¡æ•°å™¨</strong> å’Œ <strong>å›è¾¹è®¡æ•°å™¨</strong></p><ul><li>æ–¹æ³•è°ƒç”¨è®¡æ•°å™¨ç”¨äº<strong>ç»Ÿè®¡æ–¹æ³•çš„è°ƒç”¨æ¬¡æ•°</strong></li><li>å›è¾¹è®¡æ•°å™¨åˆ™ç”¨äº<strong>ç»Ÿè®¡å¾ªç¯ä½“æ‰§è¡Œçš„å¾ªç¯æ¬¡æ•°</strong></li></ul></blockquote></li></ul><h4 id="æ–¹æ³•è°ƒç”¨è®¡æ•°å™¨"><a href="#æ–¹æ³•è°ƒç”¨è®¡æ•°å™¨" class="headerlink" title="æ–¹æ³•è°ƒç”¨è®¡æ•°å™¨"></a>æ–¹æ³•è°ƒç”¨è®¡æ•°å™¨</h4><blockquote><p>ç”¨äºç»Ÿè®¡æ–¹æ³•è¢«è°ƒç”¨çš„æ¬¡æ•°ï¼Œé»˜è®¤é˜ˆå€¼åœ¨Clientæ¨¡å¼ä¸‹æ˜¯1500æ¬¡ï¼Œåœ¨Serveræ¨¡å¼ä¸‹æ˜¯10000æ¬¡ã€‚è¶…è¿‡è¿™ä¸ªé˜ˆå€¼ï¼Œå°±ä¼šè§¦å‘JITç¼–è¯‘ã€‚</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/18/0XAcNV.png" alt="æµç¨‹"></p><p>å½“è°ƒç”¨javaæ–¹æ³•çš„æ—¶å€™ï¼Œä¼šé¦–å…ˆå»åˆ¤æ–­å®ƒæ˜¯å¦å·²ç»è¢«ç¼–è¯‘==ã€‹å¦‚æœè¢«ç¼–è¯‘ï¼Œå°±ç›´æ¥æ‰§è¡Œç¼–è¯‘åçš„æœºå™¨ç ã€‚æ²¡æœ‰ç¼–è¯‘ï¼Œä¼šè®©æ–¹æ³•è°ƒç”¨è®¡æ•°å™¨+1ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦è¶…è¿‡äº†çƒ­ç‚¹ä»£ç ç»Ÿè®¡çš„é˜ˆå€¼==ã€‹è¶…è¿‡äº†å°±æäº¤ç¼–è¯‘è¯·æ±‚ï¼Œç”¨JITç¼–è¯‘å™¨åŠ¨æ€ç¼–è¯‘ï¼Œ<strong>å¹¶æŠŠä»£ç ç¼“å­˜åˆ°æ–¹æ³•åŒºä¸­</strong>ï¼Œæ‰§è¡Œç¼–è¯‘åçš„æœºå™¨ç ã€‚å¦‚æœæ²¡æœ‰è¶…è¿‡é˜ˆå€¼ï¼Œå°±ä¼šè°ƒç”¨è§£é‡Šå™¨å»è§£é‡Šæ‰§è¡Œã€‚</p><p><strong>çƒ­åº¦è¡°å‡</strong></p><blockquote><ul><li>å½“<strong>è¶…è¿‡ä¸€å®šçš„æ—¶é—´é™åº¦</strong>ï¼Œå¦‚æœæ–¹æ³•çš„è°ƒç”¨æ¬¡æ•°ä»»ç„¶ä¸è¶³ä»¥è®©ä»–æäº¤ç»™å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘ï¼Œé‚£è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨è®¡æ•°å™¨å°±ä¼šè¢«<strong>å‡å°‘ä¸€åŠ</strong>ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºæ–¹æ³•è°ƒç”¨è®¡æ•°å™¨çƒ­åº¦çš„<strong>è¡°å‡</strong>ï¼Œè€Œè¿™æ®µæ—¶é—´å°±ç§°ä¸ºæ­¤æ–¹æ³•ç»Ÿè®¡çš„<strong>åŠè¡°å‘¨æœŸ</strong></li><li>-XX:-UseCounterDecay å…³é—­çƒ­åº¦è¡°å‡</li><li>ç”¨ -XX:CounterHalfLifeTime å‚æ•°è®¾ç½®åŠè¡°å‘¨æœŸçš„æ—¶é—´ï¼Œå•ä½s</li></ul></blockquote><h4 id="å›è¾¹è®¡æ•°å™¨"><a href="#å›è¾¹è®¡æ•°å™¨" class="headerlink" title="å›è¾¹è®¡æ•°å™¨"></a>å›è¾¹è®¡æ•°å™¨</h4><blockquote><p>ç»Ÿè®¡ä¸€ä¸ªæ–¹æ³•ä¸­ <strong>å¾ªç¯ä½“ä»£ç æ‰§è¡Œçš„æ¬¡æ•°</strong>ï¼Œåœ¨å­—èŠ‚ç ä¸­é‡åˆ°æ§åˆ¶æµå‘åè·³è½¬çš„æŒ‡ä»¤ç§°ä¸ºâ€œå›è¾¹â€ã€‚æ˜¾ç„¶ï¼Œå»ºç«‹æ±‡ç¼–è®¡æ•°å™¨ç»Ÿè®¡çš„ç›®çš„å°±æ˜¯ä¸ºäº†è§¦å‘OSRç¼–è¯‘</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> jvm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hashmapçš„å‰ä¸–ä»Šç”Ÿ</title>
      <link href="2020/10/12/hashmap-de-qian-shi-jin-sheng/"/>
      <url>2020/10/12/hashmap-de-qian-shi-jin-sheng/</url>
      
        <content type="html"><![CDATA[<h1 id="hashmapçš„nä¸ªé—®é¢˜"><a href="#hashmapçš„nä¸ªé—®é¢˜" class="headerlink" title="hashmapçš„nä¸ªé—®é¢˜"></a>hashmapçš„nä¸ªé—®é¢˜</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><h3 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1 æ¦‚è¿°"></a>1 æ¦‚è¿°</h3><ul><li><p>HashMapæ˜¯åŸºäºå“ˆå¸Œè¡¨å®ç°çš„,æ¯ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªkey-valueå¯¹,å…¶å†…éƒ¨é€šè¿‡å•é“¾è¡¨è§£å†³å†²çªé—®é¢˜,å®¹é‡ä¸è¶³(è¶…è¿‡äº†é˜€å€¼)æ—¶,åŒæ ·ä¼šè‡ªåŠ¨å¢é•¿.</p></li><li><p>HashMapæ˜¯éçº¿ç¨‹å®‰å…¨çš„,åªé€‚ç”¨äºå•çº¿ç¨‹ç¯å¢ƒ,å¤šçº¿ç¨‹ç¯å¢ƒå¯ä»¥é‡‡ç”¨å¹¶å‘åŒ…ä¸‹çš„concurrentHashMap</p></li><li><p>HashMap å®ç°äº†Serializableæ¥å£ï¼Œå› æ­¤å®ƒæ”¯æŒåºåˆ—åŒ–ï¼Œå®ç°äº†Cloneableæ¥å£ï¼Œèƒ½è¢«å…‹éš†</p></li><li><p>HashMapæ˜¯åŸºäºå“ˆå¸Œè¡¨çš„Mapæ¥å£çš„éåŒæ­¥å®ç°.æ­¤å®ç°æä¾›æ‰€æœ‰å¯é€‰çš„æ˜ å°„æ“ä½œ,å¹¶å…è®¸ä½¿ç”¨nullå€¼å’Œnullé”®.æ­¤ç±»ä¸ä¿è¯æ˜ å°„çš„é¡ºåº,ç‰¹åˆ«æ˜¯å®ƒä¸ä¿è¯è¯¥é¡ºåºæ’ä¹…ä¸å˜.</p></li><li><p>Java8ä¸­åˆå¯¹æ­¤ç±»åº•å±‚å®ç°è¿›è¡Œäº†ä¼˜åŒ–ï¼Œæ¯”å¦‚å¼•å…¥äº†çº¢é»‘æ ‘çš„ç»“æ„ä»¥è§£å†³å“ˆå¸Œç¢°æ’</p></li></ul><h2 id="å“ˆå¸Œè¡¨çš„ç”±æ¥"><a href="#å“ˆå¸Œè¡¨çš„ç”±æ¥" class="headerlink" title="å“ˆå¸Œè¡¨çš„ç”±æ¥"></a>å“ˆå¸Œè¡¨çš„ç”±æ¥</h2><blockquote><p>åœ¨ä»¥å¾€çš„æŸ¥è¯¢ä¸­ï¼Œå¤§éƒ¨åˆ†éƒ½ç”¨çš„æ˜¯æ•°ç»„ï¼ŒListç­‰æ¥è¿›è¡ŒæŸ¥è¯¢ã€‚è¿™æ ·æœ‰ä¸ªå¼Šç«¯ï¼Œå°±æ˜¯æŸ¥è¯¢ä¸€ä¸ªå€¼æ˜¯å¦å­˜åœ¨äºæ•°ç»„ä¸­ï¼Œæˆ‘ä»¬éœ€è¦éå†æ•°ç»„ï¼Œlistï¼Œè¿›è¡Œåˆ¤æ–­ï¼Œçœ‹çœ‹æ˜¯å¦å­˜åœ¨ã€‚</p></blockquote><p><strong>å“ˆå¸Œè¡¨</strong></p><p>å“ˆå¸Œè¡¨æ˜¯æ ¹æ®å…³é”®ç å€¼(Key value)è€Œç›´æ¥è¿›è¡Œè®¿é—®çš„<a href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/1450">æ•°æ®ç»“æ„</a>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒé€šè¿‡æŠŠå…³é”®ç å€¼æ˜ å°„åˆ°è¡¨ä¸­ä¸€ä¸ªä½ç½®æ¥è®¿é—®è®°å½•ï¼Œä»¥åŠ å¿«æŸ¥æ‰¾çš„é€Ÿåº¦ã€‚è¿™ä¸ªæ˜ å°„å‡½æ•°å«åš<a href="https://baike.baidu.com/item/%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B0/2366288">æ•£åˆ—å‡½æ•°</a>ï¼Œå­˜æ”¾è®°å½•çš„<a href="https://baike.baidu.com/item/%E6%95%B0%E7%BB%84/3794097">æ•°ç»„</a>å«åš<a href="https://baike.baidu.com/item/%E6%95%A3%E5%88%97%E8%A1%A8/10027933">æ•£åˆ—è¡¨</a>ã€‚</p><p><strong>å“ˆå¸Œå†²çª</strong></p><blockquote><p>å­˜æ”¾å…ƒç´ åˆ™é€šè¿‡æŠŠè¯¥æ•°å­—å¯¹æ•°ç»„é•¿åº¦å–ä½™ï¼Œæ‰€å¾—çš„å€¼ä½œä¸ºä¸‹è§’æ ‡å­˜å…¥å¯¹åº”ä½ç½®ä¸­ã€‚å½“ç„¶å¦‚æœå­˜æ”¾çš„ä½ç½®ä¸­æœ‰å…ƒç´ äº†ï¼Œé‚£ä¹ˆå°±æ˜¯å‘ç”Ÿäº†ç¢°æ’ï¼Œè¿™ä¹Ÿå«<strong>hashå†²çª</strong>ã€‚</p></blockquote><p><strong>å“ˆå¸Œå†²çªæ˜¯æ— æ³•é¿å…çš„</strong>ï¼Œæˆ‘ä»¬åªèƒ½å‡å°‘å†²çªå¸¦æ¥çš„æŸå¤±ï¼Œä¸€ä¸ªå¥½çš„hashå‡½æ•°éœ€è¦æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ol><li><p>å°½é‡ä½¿å…³é”®å­—å¯¹åº”çš„è®°å½•å‡åŒ€åˆ†é…åœ¨å“ˆå¸Œè¡¨é‡Œé¢ï¼ˆæ¯”å¦‚è¯´æŸå‚å•†å–30æ ‹æˆ¿å­ï¼Œå‡åŒ€åˆ’åˆ†ABC3ä¸ªåŒºåŸŸï¼Œå¦‚æœä½ åˆ’åˆ†AåŒºåŸŸ1ä¸ªæˆ¿å­ï¼ŒBåŒºåŸŸ1ä¸ªæˆ¿å­ï¼ŒCåŒºåŸŸ28ä¸ªæˆ¿å­ï¼Œæœ‰äººæ¥æŸ¥æ‰¾CåŒºåŸŸçš„æŸä¸ªæˆ¿å­æœ€åçš„æƒ…å†µå°±æ˜¯è¦æ‰¾28æ¬¡ï¼‰ã€‚</p></li><li><p>å…³é”®å­—æå°çš„å˜åŒ–å¯ä»¥å¼•èµ·å“ˆå¸Œå€¼æå¤§çš„å˜åŒ–ã€‚</p></li></ol><p><strong>å“ˆå¸Œå†²çªè§£å†³æ–¹æ³•</strong></p><blockquote><p>é“¾åœ°å€æ³•å¯ä»¥ï¼Œé“¾åœ°å€æ³•çš„åŸç†æ—¶å¦‚æœé‡åˆ°å†²çªï¼Œä»–å°±ä¼šåœ¨åŸåœ°å€æ–°å»ºä¸€ä¸ªç©ºé—´ï¼Œç„¶åä»¥é“¾è¡¨ç»“ç‚¹çš„å½¢å¼æ’å…¥åˆ°è¯¥ç©ºé—´ã€‚æˆ‘æ„Ÿè§‰ä¸šç•Œä¸Šç”¨çš„æœ€å¤šçš„å°±æ˜¯é“¾åœ°å€æ³•ã€‚ä¸‹é¢ä»ç™¾åº¦ä¸Šæˆªå–æ¥ä¸€å¼ å›¾ç‰‡ï¼Œå¯ä»¥å¾ˆæ¸…æ™°æ˜äº†ååº”ä¸‹é¢çš„ç»“æ„ã€‚æ¯”å¦‚è¯´æˆ‘æœ‰ä¸€å †æ•°æ®{1,12,26,337,353â€¦}ï¼Œè€Œæˆ‘çš„å“ˆå¸Œç®—æ³•æ˜¯H(key)=key mod 16ï¼Œç¬¬ä¸€ä¸ªæ•°æ®1çš„å“ˆå¸Œå€¼f(1)=1ï¼Œæ’å…¥åˆ°1ç»“ç‚¹çš„åé¢ï¼Œç¬¬äºŒä¸ªæ•°æ®12çš„å“ˆå¸Œå€¼f(12)=12ï¼Œæ’å…¥åˆ°12ç»“ç‚¹ï¼Œç¬¬ä¸‰ä¸ªæ•°æ®26çš„å“ˆå¸Œå€¼f(26)=10ï¼Œæ’å…¥åˆ°10ç»“ç‚¹åé¢ï¼Œç¬¬4ä¸ªæ•°æ®337ï¼Œè®¡ç®—å¾—åˆ°å“ˆå¸Œå€¼æ˜¯1ï¼Œé‡åˆ°å†²çªï¼Œä½†æ˜¯ä¾ç„¶åªéœ€è¦æ‰¾åˆ°è¯¥1ç»“ç‚¹çš„æœ€åé“¾ç»“ç‚¹æ’å…¥å³å¯ï¼ŒåŒç†353ã€‚</p></blockquote><p><img src="https://img-blog.csdn.net/20160603152626346?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="é“¾åœ°å€æ³•"></p><ul><li>O(1)çš„å¹³å‡æŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤æ—¶é—´</li><li>è‡´å‘½ç¼ºç‚¹æ˜¯<strong>å“ˆå¸Œå€¼çš„ç¢°æ’</strong>(collision)</li></ul><h2 id="hashmapå‰ä¸–"><a href="#hashmapå‰ä¸–" class="headerlink" title="hashmapå‰ä¸–"></a>hashmapå‰ä¸–</h2><h3 id="åº•å±‚æ•°æ®ç»“æ„"><a href="#åº•å±‚æ•°æ®ç»“æ„" class="headerlink" title="åº•å±‚æ•°æ®ç»“æ„"></a>åº•å±‚æ•°æ®ç»“æ„</h3><ul><li><strong>æ•°ç»„+é“¾è¡¨</strong></li></ul><blockquote><p>åœ¨java1.7ä¸­ï¼Œhashmapä½¿ç”¨æ•°ç»„+é“¾è¡¨æ¥ä½œä¸ºå­˜å‚¨ç»“æ„</p><p>æ•°ç»„å°±ç±»ä¼¼äºä¸€ä¸ªä¸ªæ¡¶å®¹å™¨ï¼Œé“¾è¡¨ç”¨æ¥è§£å†³hashå†²çªï¼Œå½“å‡ºç°å†²çªæ—¶ï¼Œå°±åœ¨è¯¥æ¡¶çš„ä½ç½®ä¸‹æ’å…¥æ–°çš„èŠ‚ç‚¹ã€‚</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// èŠ‚ç‚¹åŸŸå¯¹è±¡</span><span class="token keyword">class</span> <span class="token class-name">Entry</span><span class="token punctuation">&#123;</span>    key<span class="token punctuation">;</span>    value<span class="token punctuation">;</span>    hash<span class="token punctuation">;</span>    <span class="token class-name">Entry</span> next<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/7B8iaauAfclMROAyV9gMNAZtanwhQZmIrDPib4cGibVOYvg2ZbIG5Ag6a1gwj4mR6zLC8cwCAfRIX5L8r6BaNDv9g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="åº•å±‚åŸç†å›¾"></p><h3 id="å†…éƒ¨å±æ€§"><a href="#å†…éƒ¨å±æ€§" class="headerlink" title="å†…éƒ¨å±æ€§"></a>å†…éƒ¨å±æ€§</h3><blockquote><p>å†…éƒ¨å±æ€§æºç </p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//å†…éƒ¨æ•°ç»„çš„é»˜è®¤åˆå§‹å®¹é‡ï¼Œä½œä¸ºhashmapçš„åˆå§‹å®¹é‡ï¼Œæ˜¯2çš„4æ¬¡æ–¹ï¼Œ2çš„næ¬¡æ–¹çš„ä½œç”¨æ˜¯å‡å°‘hashå†²çª</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> DEFAULT_INITIAL_CAPACITY <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// aka 16</span>    <span class="token comment">//é»˜è®¤çš„æœ€å¤§å®¹é‡</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAXIMUM_CAPACITY <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">30</span><span class="token punctuation">;</span>    <span class="token comment">//é»˜è®¤è´Ÿè½½å› å­ï¼Œå½“å®¹å™¨ä½¿ç”¨ç‡è¾¾åˆ°è¿™ä¸ª75%çš„æ—¶å€™å°±æ‰©å®¹</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">float</span> DEFAULT_LOAD_FACTOR <span class="token operator">=</span> <span class="token number">0.75f</span><span class="token punctuation">;</span>    <span class="token comment">/**     *å½“æ•°ç»„è¡¨è¿˜æ²¡æ‰©å®¹çš„æ—¶å€™ï¼Œä¸€ä¸ªå…±äº«çš„ç©ºè¡¨å¯¹è±¡     */</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> EMPTY_TABLE <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token comment">//å†…éƒ¨æ•°ç»„è¡¨ï¼Œç”¨æ¥è£…entryï¼Œå¤§å°åªèƒ½æ˜¯2çš„næ¬¡æ–¹ã€‚</span>    <span class="token keyword">transient</span> <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> table <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> EMPTY_TABLE<span class="token punctuation">;</span>    <span class="token comment">//å­˜å‚¨çš„é”®å€¼å¯¹çš„ä¸ªæ•°</span>    <span class="token keyword">transient</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span>    <span class="token comment">/**     * æ‰©å®¹çš„ä¸´ç•Œç‚¹ï¼Œå¦‚æœå½“å‰å®¹é‡è¾¾åˆ°è¯¥å€¼ï¼Œåˆ™éœ€è¦æ‰©å®¹äº†ã€‚     * å¦‚æœå½“å‰æ•°ç»„å®¹é‡ä¸º0æ—¶ï¼ˆç©ºæ•°ç»„ï¼‰ï¼Œåˆ™è¯¥å€¼ä½œä¸ºåˆå§‹åŒ–å†…éƒ¨æ•°ç»„çš„åˆå§‹å®¹é‡     */</span>    <span class="token keyword">int</span> threshold<span class="token punctuation">;</span>    <span class="token comment">//ç”±æ„é€ å‡½æ•°ä¼ å…¥çš„æŒ‡å®šè´Ÿè½½å› å­</span>    <span class="token keyword">final</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">;</span>    <span class="token comment">//Hashçš„ä¿®æ”¹æ¬¡æ•°</span>    <span class="token keyword">transient</span> <span class="token keyword">int</span> modCount<span class="token punctuation">;</span>    <span class="token comment">//thresholdçš„æœ€å¤§å€¼</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> ALTERNATIVE_HASHING_THRESHOLD_DEFAULT <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>    <span class="token comment">//è®¡ç®—hashå€¼æ—¶å€™ç”¨ï¼Œåˆå§‹æ˜¯0</span>    <span class="token keyword">transient</span> <span class="token keyword">int</span> hashSeed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">//å«æœ‰æ‰€æœ‰entryèŠ‚ç‚¹çš„ä¸€ä¸ªseté›†åˆ</span>    <span class="token keyword">private</span> <span class="token keyword">transient</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span><span class="token punctuation">></span></span> entrySet <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">362498820763181265L</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ„é€ æ–¹æ³•"><a href="#æ„é€ æ–¹æ³•" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h3><ol><li>æ— å‚æ„é€ æ–¹æ³•</li></ol><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// æ­¤å¤„è°ƒç”¨äº†å«å®¹é‡å’Œè´Ÿè½½å› å­çš„æ„é€ æ–¹æ³•æ¥è¿›è¡Œåˆå§‹åŒ–æ“ä½œ</span><span class="token keyword">public</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">(</span>DEFAULT_INITIAL_CAPACITY<span class="token punctuation">,</span> DEFAULT_LOAD_FACTOR<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>å«å®¹é‡çš„æ„é€ æ–¹æ³•</li></ol><pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token keyword">public</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// è°ƒç”¨äº†å«å®¹é‡å’Œè´Ÿè½½å› å­çš„æ„é€ æ–¹æ³•æ¥è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œå…¶ä¸­å®¹é‡ä¸ºä¼ å…¥çš„å®¹é‡ï¼Œè´Ÿè½½å› å­ä¸ºé»˜è®¤è´Ÿè½½å› å­0.75</span>        <span class="token keyword">this</span><span class="token punctuation">(</span>initialCapacity<span class="token punctuation">,</span> DEFAULT_LOAD_FACTOR<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li>å«å®¹é‡å’Œè´Ÿè½½å› å­çš„æ„é€ æ–¹æ³•</li></ol><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">,</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// å¦‚æœä¼ å…¥çš„åˆå§‹åŒ–å®¹é‡å°äº0ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Illegal initial capacity: "</span> <span class="token operator">+</span>                                               initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å¦‚æœä¼ å…¥çš„å®¹é‡å¤§äºæœ€å¤§å®¹é‡ï¼Œå°±åˆå§‹åŒ–ä¸ºæœ€å¤§å®¹é‡</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">></span> MAXIMUM_CAPACITY<span class="token punctuation">)</span>            initialCapacity <span class="token operator">=</span> MAXIMUM_CAPACITY<span class="token punctuation">;</span>        <span class="token comment">// å¦‚æœè´Ÿè½½å› å­å°äº0ï¼Œæˆ–è€…æ˜¯éæ³•çš„æµ®ç‚¹æ•°ï¼ŒæŠ›å‡ºå¼‚å¸¸</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>loadFactor <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token class-name">Float</span><span class="token punctuation">.</span><span class="token function">isNaN</span><span class="token punctuation">(</span>loadFactor<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Illegal load factor: "</span> <span class="token operator">+</span>                                               loadFactor<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ ¹æ®ä¼ å…¥çš„è´Ÿè½½å› å­ç»™è´Ÿè½½å› å­èµ‹å€¼</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>loadFactor <span class="token operator">=</span> loadFactor<span class="token punctuation">;</span>       <span class="token comment">// int threshold</span>    <span class="token comment">// é˜ˆå€¼ï¼Œå®¹é‡Ã—è´Ÿè½½å› å­ã€‚ç›®å‰å¤§å°ä¸ºinitialCapacityï¼ˆè¿˜æœªæ‰©å®¹ï¼‰</span>    <span class="token comment">// è¶…è¿‡é˜ˆå€¼è¿›è¡Œæ‰©å®¹æ“ä½œ</span>        threshold <span class="token operator">=</span> initialCapacity<span class="token punctuation">;</span>        <span class="token comment">// æ­¤å¤„çš„init()æ–¹æ³•æ˜¯ä¸€ä¸ªç©ºæ–¹æ³•ï¼Œåœ¨å‘å“ˆå¸Œè¡¨æ·»åŠ å…ƒç´ ä¹‹å‰ï¼Œä¸ä¼šçœŸæ­£åœ°åˆ›å»ºå“ˆå¸Œè¡¨ï¼ˆä»¥å…å ç”¨è¿‡å¤šçš„å†…å­˜ï¼‰</span>        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ç©ºæ–¹æ³•</span><span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯è§ï¼Œæ— è®ºè°ƒç”¨å“ªç§æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–HashMapï¼Œæœ€ç»ˆè°ƒç”¨çš„éƒ½æ˜¯<strong>å«å®¹é‡å’Œè´Ÿè½½å› å­çš„æ„é€ æ–¹æ³•</strong>ï¼Œå¹¶ä¸”éƒ½<strong>æ²¡æœ‰çœŸæ­£çš„å¼€è¾Ÿå‡ºéœ€è¦çš„å†…å­˜ç©ºé—´</strong></p><h3 id="åˆå§‹åŒ–ã€æ·»åŠ ã€æ‰©å®¹"><a href="#åˆå§‹åŒ–ã€æ·»åŠ ã€æ‰©å®¹" class="headerlink" title="åˆå§‹åŒ–ã€æ·»åŠ ã€æ‰©å®¹"></a>åˆå§‹åŒ–ã€æ·»åŠ ã€æ‰©å®¹</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * put() */</span><span class="token keyword">public</span> <span class="token class-name">V</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// å¦‚æœè¡¨æ˜¯ç©ºçš„ï¼Œå°±é€šè¿‡inflateTable()æ–¹æ³•è¿›è¡Œæ‰©å®¹</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>table <span class="token operator">==</span> EMPTY_TABLE<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// ç­‰åˆ°çœŸæ­£å‘å“ˆå¸Œè¡¨ä¸­æ·»åŠ å…ƒç´ æ—¶ï¼Œæ‰å¼€è¾Ÿå†…å­˜ç©ºé—´ï¼ŒæŠŠåœ¨æ„é€ æ–¹æ³•ä¸­èµ‹å€¼çš„thresholdä¼ å…¥ï¼Œé»˜è®¤æ˜¯16ï¼ˆ1&lt;&lt;4ï¼‰</span>        <span class="token function">inflateTable</span><span class="token punctuation">(</span>threshold<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token function">putForNullKey</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®¡ç®—è¦æ’å…¥å…ƒç´ çš„å“ˆå¸Œå€¼</span>    <span class="token keyword">int</span> hash <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ ¹æ®å“ˆå¸Œå€¼æ¥åˆ¤æ–­æ’å…¥å…ƒç´ åº”è¯¥æ”¾åœ¨å“ªä¸ªæ¡¶ä¸­</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e <span class="token operator">=</span> table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Object</span> k<span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">V</span> oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>            e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>            e<span class="token punctuation">.</span><span class="token function">recordAccess</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    modCount<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token function">addEntry</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * åˆå§‹åŒ– */</span><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">inflateTable</span><span class="token punctuation">(</span><span class="token keyword">int</span> toSize<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// Find a power of 2 >= toSize</span>    <span class="token comment">// è®©å®¹é‡å‘ä¸Šèˆå…¥å˜ä¸º2çš„å¹‚ã€‚æ¯”å¦‚toSize = 10 å°±ä¼šå˜ä¸º 16ã€‚</span>        <span class="token keyword">int</span> capacity <span class="token operator">=</span> <span class="token function">roundUpToPowerOf2</span><span class="token punctuation">(</span>toSize<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// é˜ˆå€¼ï¼Œå‘ä¸Šå–æ•´åçš„å®¹é‡Ã—è´Ÿè½½å› å­ æˆ– æœ€å¤§å®¹é‡+1ï¼Œå–å…¶ä¸­çš„è¾ƒå°å€¼</span>    <span class="token comment">// è¯¥å˜é‡åœ¨ç¬¬ä¸€æ¬¡æ”¾å…¥æ“ä½œæ—¶ä¸ä¼šç”¨åˆ°</span>        threshold <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>capacity <span class="token operator">*</span> loadFactor<span class="token punctuation">,</span> MAXIMUM_CAPACITY <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ ¹æ®capacityåˆ›å»ºå“ˆå¸Œè¡¨</span>        table <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span>capacity<span class="token punctuation">]</span><span class="token punctuation">;</span>         <span class="token comment">// åˆ›å»ºäº†ä¸€ä¸ªå“ˆå¸Œç§å­ï¼Œé‡æ„Stringçš„hashç®—æ³•ï¼Œåœ¨åé¢çš„æ½œåœ¨å®‰å…¨æ¼æ´ä¼šè°ˆåˆ°</span>        <span class="token function">initHashSeedAsNeeded</span><span class="token punctuation">(</span>capacity<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * æŠŠç”¨æˆ·è¾“å…¥çš„ç­’å®¹é‡å¼ºåˆ¶å‘ä¸Šè½¬æˆ2å¹‚æ¬¡ */</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">roundUpToPowerOf2</span><span class="token punctuation">(</span><span class="token keyword">int</span> number<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// assert number >= 0 : "number must be non-negative";</span>        <span class="token comment">// å¦‚æœå®¹é‡å¤§äºæœ€å¤§å®¹é‡ï¼Œå°±è¿”å›æœ€å¤§å®¹é‡ã€‚</span>    <span class="token comment">// å¦åˆ™è°ƒç”¨Integer.highestOneBit()æ–¹æ³•è®©å…¶å‘ä¸Šèˆå…¥ä¸º2çš„å¹‚</span>    <span class="token comment">// numberä¸å¤§äº1é‚£å°±æ˜¯0æˆ–1ï¼Œæ‰€ä»¥è¿”å›2çš„0æ¬¡ï¼Œå°±æ˜¯1</span>    <span class="token comment">// highestOneBitçš„ä½œç”¨æ˜¯å– iè¿™ä¸ªæ•°çš„äºŒè¿›åˆ¶å½¢å¼æœ€å·¦è¾¹çš„æœ€é«˜ä¸€ä½ä¸”é«˜ä½åé¢å…¨éƒ¨è¡¥é›¶ï¼Œæœ€åè¿”å›intå‹çš„ç»“æœã€‚</span>        <span class="token keyword">return</span> number <span class="token operator">>=</span> MAXIMUM_CAPACITY                <span class="token operator">?</span> MAXIMUM_CAPACITY                <span class="token operator">:</span> <span class="token punctuation">(</span>number <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">highestOneBit</span><span class="token punctuation">(</span><span class="token punctuation">(</span>number <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="hashç®—æ³•"><a href="#hashç®—æ³•" class="headerlink" title="hashç®—æ³•"></a>hashç®—æ³•</h4><blockquote><p>HashMapä¸ºäº†æé«˜æ•ˆç‡ä½¿ç”¨ä½è¿ç®—ä»£æ›¿å“ˆå¸Œï¼Œè¿™åˆå¼•å…¥äº†å“ˆå¸Œåˆ†å¸ƒä¸å‡åŒ€çš„é—®é¢˜ï¼Œæ‰€ä»¥HashMapä¸ºè§£å†³è¿™é—®é¢˜ï¼Œåˆå¯¹hashç®—æ³•åšäº†ä¸€äº›æ”¹è¿›ï¼Œè¿›è¡Œäº†æ‰°åŠ¨è®¡ç®—ã€‚</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// é€šè¿‡ä¸€ç³»åˆ—ç§»ä½æ“ä½œä¸å¼‚æˆ–æ“ä½œè·å¾—å…ƒç´ çš„å“ˆå¸Œå€¼ã€‚ JDK 8 ä¸­å·²ä¸å†ä½¿ç”¨è¯¥æ–¹æ³•</span><span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token class-name">Object</span> k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> h <span class="token operator">=</span> hashSeed<span class="token punctuation">;</span>    <span class="token comment">// å¦‚æœå“ˆå¸Œç§å­å­˜åœ¨ï¼Œå¹¶ä¸”è¿›è¡Œå“ˆå¸Œçš„å…ƒç´ çš„Stringç±»å‹</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">!=</span> h <span class="token operator">&amp;&amp;</span> k <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// å°±è®©Stringä½¿ç”¨å¦ä¸€ç§hashç®—æ³•</span>            <span class="token keyword">return</span> <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Hashing</span><span class="token punctuation">.</span><span class="token function">stringHash32</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        h <span class="token operator">^=</span> k<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// This function ensures that hashCodes that differ only by</span>        <span class="token comment">// constant multiples at each bit position have a bounded</span>        <span class="token comment">// number of collisions (approximately 8 at default load factor).</span>        h <span class="token operator">^=</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> h <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="é—®é¢˜ï¼šä¸ºä»€ä¹ˆå“ˆå¸Œè¡¨å¤§å°ä¸€å®šæ˜¯2çš„å¹‚ï¼Ÿ"><a href="#é—®é¢˜ï¼šä¸ºä»€ä¹ˆå“ˆå¸Œè¡¨å¤§å°ä¸€å®šæ˜¯2çš„å¹‚ï¼Ÿ" class="headerlink" title="é—®é¢˜ï¼šä¸ºä»€ä¹ˆå“ˆå¸Œè¡¨å¤§å°ä¸€å®šæ˜¯2çš„å¹‚ï¼Ÿ"></a>é—®é¢˜ï¼šä¸ºä»€ä¹ˆå“ˆå¸Œè¡¨å¤§å°ä¸€å®šæ˜¯2çš„å¹‚ï¼Ÿ</h4><blockquote><p>å…¶å®é€šè¿‡æˆ‘ä»¬ä¸Šé¢çš„è®²è§£ï¼Œå·²ç»å¯ä»¥çœ‹å‡ºï¼Œå¼€å‘è€…å¤šæ¬¡è·Ÿæˆ‘ä»¬å¼ºè°ƒæ¡¶å¤§å°åº”è¯¥ä¸º2çš„å¹‚æ¬¡ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æ¥æƒ³ä¸€ä¸ªé—®é¢˜ï¼š2ã€4ã€6ã€8ã€16â€¦ä»–ä»¬çš„äºŒè¿›åˆ¶æ˜¯10ï¼Œ100ï¼Œ1000ï¼Œ10000ä»¥æ­¤ç±»æ¨ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œ<strong>å“ˆå¸Œè¡¨æœ€è‡´å‘½çš„å†²çªå°±æ˜¯hashç¢°æ’ï¼Œä¹Ÿå°±æ˜¯å¤šä¸ªå“ˆå¸Œå€¼ç›¸åŒçš„å…ƒç´ æ”¾åœ¨äº†åŒä¸€ä¸ªæ¡¶ä¸­</strong></p></blockquote><p>ä¹‹å‰æåˆ°è¿‡ï¼Œæˆ‘ä»¬ä¸ºäº†é¿å…å“ˆå¸Œç¢°æ’ï¼Œæˆ‘ä»¬å°±åº”è¯¥å°½å¯èƒ½çš„æŠŠå…ƒç´ åˆ†é…çš„å‡åŒ€ä¸€äº›ï¼Œè¿™æ ·å­ä¸ä¼šå‡ºç°æœ‰çš„æ¡¶é‡Œä¸€ä¸ªä¹Ÿæ²¡æœ‰ï¼Œæœ‰çš„æ¡¶é‡Œæœ‰20å¤šä¸ªæ•°çš„æƒ…å†µäº†ã€‚æˆ‘ä»¬æœ‰ä»¥ä¸‹å‡ ç§è§£å†³åŠæ³•ï¼š</p><blockquote><p>å–æ¨¡è¿ç®—</p></blockquote><p>å°±è·Ÿé’Ÿè¡¨ä¸€æ ·ï¼Œå¯¹12ï¼ˆè¿™æ˜¯é’Ÿè¡¨æ•°å­—çš„é•¿åº¦ï¼‰å–æ¨¡ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ° 0<del>11çš„èŒƒå›´çš„æ•°ã€‚åŒç†ï¼Œæˆ‘ä»¬æŠŠhashå€¼å¯¹æ¡¶çš„é•¿åº¦ï¼ˆcapacityï¼‰å–æ¨¡è¿ç®—ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å¾—åˆ°ï¼ˆ0</del>capacity-1ï¼‰çš„èŒƒå›´çš„æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å°½é‡åˆ†é…çš„å‡åŒ€ä¸€ç‚¹ã€‚<strong>ä½†æ˜¯è¿™æ ·å­çš„å¼Šç«¯æ˜¯ï¼Œ10è¿›åˆ¶çš„è¿ç®—æ•ˆç‡å…¶å®æ˜¯å¾ˆä½çš„ï¼Œè¿™æ ·å­ä¸€ç›´è¿ç®—ä¼šä½¿å¾—hashmapçš„æ•ˆç‡å˜ä½ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸æƒ³çœ‹åˆ°çš„ï¼Œäºæ˜¯æˆ‘ä»¬æœ‰äº†æ›´å¥½çš„åŠæ³•</strong></p><blockquote><p>äºŒè¿›åˆ¶ä¸</p><p><strong>ä½è¿ç®—ç›´æ¥å¯¹å†…å­˜æ•°æ®è¿›è¡Œæ“ä½œï¼Œä¸éœ€è¦è½¬æˆåè¿›åˆ¶ï¼Œå› æ­¤å¤„ç†é€Ÿåº¦éå¸¸å¿«ã€‚</strong></p></blockquote><p> æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹æºç :</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">indexFor</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// assert Integer.bitCount(length) == 1 : "length must be a non-zero power of 2";</span>        <span class="token comment">// å°†ä¼ å…¥çš„å“ˆå¸Œå€¼ä¸å…¶é•¿åº¦-1è¿›è¡ŒæŒ‰ä½ä¸æ“ä½œï¼Œå¹¶è¿”å›å…¶ç»“æœ</span>        <span class="token keyword">return</span> h <span class="token operator">&amp;</span> <span class="token punctuation">(</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬åˆšæ‰è¯´è¿‡ï¼Œ2ã€4ã€6ã€8ã€16â€¦ä»–ä»¬çš„äºŒè¿›åˆ¶æ˜¯10ï¼Œ100ï¼Œ1000ï¼Œ10000ï¼Œé‚£ä¹ˆä»–ä»¬çš„å‰ä¸€ä½åè¿›åˆ¶çš„äºŒè¿›åˆ¶å°±æ˜¯å…¨1çŠ¶æ€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹å»åšä¸è¿ç®—ï¼Œå…¶å®çœŸæ­£å†³å®šå€¼çš„æ˜¯hashå€¼çš„æœ€åå‡ ä½ã€‚è¿™æ ·ä¸€æ¥ï¼Œåªè¦æ•°ä¸åŒï¼Œé‚£ä¹ˆä»–ä»¬æŒ‰ä½ä¸ä¸‹æ¥çš„å€¼ä¹Ÿå°±ä¸åŒäº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç»™ä»–ä»¬åˆ†é…ä¸åŒçš„ç©ºé—´ï¼Œå› ä¸ºä½ç½®å®Œå…¨æ˜¯ç”±hashå€¼å†³å®šçš„äº†ã€‚</p><p><img src="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200912201909.png"></p><p><strong>é‚£ä¹ˆæˆ‘ä»¬å†æ¬¡æ€è€ƒï¼Œå¦‚æœä¸æ˜¯2çš„å¹‚æ¬¡ä¼šæ€ä¹ˆæ ·ï¼Ÿ</strong>ï¼Œå…¶å®ä¹Ÿç®€å•ï¼Œå¦‚æœä¸æ˜¯2çš„å¹‚æ¬¡ï¼Œæ¯”å¦‚xï¼Œé‚£ä¹ˆ(x-1)çš„äºŒè¿›åˆ¶å°±è‡³å°‘æœ‰ä¸€ä¸ªä¸æ˜¯1ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‰§è¡Œä¸è¿ç®—çš„æ—¶å€™ï¼Œå¿…ç„¶æœ‰è‡³å°‘ä¸€ä½ä¼šå—åˆ°0çš„å½±å“è€Œæ”¹å˜ï¼Œ<strong>è¿™åœ¨æŸäº›æç«¯çš„æ¡ä»¶ä¸‹ï¼Œå°±ä¼šå‡ºç°æˆ‘åªæœ‰ä¸€ä¸ªä½ç½®ä¸Šæœ‰å¾ˆå¤šå¾ˆå¤šçš„å…ƒç´ ï¼Œå…¶ä»–ä½ç½®ä¸Šéƒ½æ˜¯ç©ºçš„ã€‚è¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„</strong></p><p><font color="red"><b>ç»¼ä¸Šï¼Œå¼€å‘è€…æ‰ä¼šè§„å®šæˆ‘ä»¬çš„æ¡¶å¤§å°å¿…é¡»æ˜¯2çš„å¹‚ã€‚</b></font></p><p>æœ‰æ„æ€çš„æ˜¯ï¼Œå½“æˆ‘ä»¬ç”¨æˆ·è¾“å…¥ä¸€ä¸ªä¸æ˜¯2çš„å¹‚çš„æ•°ï¼Œä½œä¸ºæ¡¶å¤§å°ä¼ å…¥çš„æ—¶å€™ã€‚åœ¨ç¬¬ä¸€æ¬¡æ‰©å®¹çš„æ—¶å€™ä¼šè¢«å¼ºåˆ¶å‘ä¸Šè½¬æ¢æˆ2çš„å¹‚ï¼ˆè§æºç  <code>roundUpToPowerOf2 (int number)</code>ï¼‰</p><h4 id="æ·»åŠ å…ƒç´ çš„çœŸæ­£æ–¹æ³•addEntry"><a href="#æ·»åŠ å…ƒç´ çš„çœŸæ­£æ–¹æ³•addEntry" class="headerlink" title="æ·»åŠ å…ƒç´ çš„çœŸæ­£æ–¹æ³•addEntry()"></a>æ·»åŠ å…ƒç´ çš„çœŸæ­£æ–¹æ³•addEntry()</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * çœŸæ­£çš„æ·»åŠ å…ƒç´ çš„æ–¹æ³• */</span><span class="token keyword">void</span> <span class="token function">addEntry</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token keyword">int</span> bucketIndex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// å¦‚æœå“ˆå¸Œè¡¨ä¸­çš„å…ƒç´ ä¸ªæ•°è¶…è¿‡äº†é˜ˆå€¼ï¼Œå¹¶ä¸”è¯¥å…ƒç´ åº”è¯¥æ”¾å…¥çš„æ¡¶ä¸­å·²ç»æœ‰äº†å…ƒç´ </span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>size <span class="token operator">>=</span> threshold<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// è¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹å¤§å°ä¸ºåŸå¤§å°çš„2å€ï¼Œä»¥ä¿è¯æ‰©å®¹åå®¹é‡ä»ä¸º2çš„å¹‚</span>        <span class="token comment">// å¹¶å°†æ‰©å®¹å‰å“ˆå¸Œè¡¨ä¸­çš„å…ƒç´ å…¨éƒ¨é‡æ–°è®¡ç®—å“ˆå¸Œå€¼ï¼Œå¹¶æ”¾å…¥åˆ°æ‰©å®¹åçš„æ¡¶ä¸­</span>        <span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// é‡æ–°è®¡ç®—å“ˆå¸Œå€¼ï¼Œå› ä¸ºç»å†äº†æ‰©å®¹ï¼Œéœ€è¦é‡æ–°ç¡®å®šä¸€ä¸‹ä½ç½®</span>        hash <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> key<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>        bucketIndex <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> table<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// åˆ›å»ºèŠ‚ç‚¹ï¼Œé‡‡ç”¨å¤´æ’æ³•å°†å…¶æ”¾åœ¨å¯¹åº”çš„æ¡¶ä¸­ï¼Œè¿™é‡Œé‡‡ç”¨å¤´æ’æ³•å¯¼è‡´äº†ä¸€ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜ï¼Œä¹‹åè¯´</span>    <span class="token function">createEntry</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> bucketIndex<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * åˆ›å»ºèŠ‚ç‚¹ï¼Œç”¨å¤´æ’æ³•æ’å…¥åˆ°é“¾è¡¨ä¸­ */</span><span class="token keyword">void</span> <span class="token function">createEntry</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token keyword">int</span> bucketIndex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e <span class="token operator">=</span> table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token comment">// å°†æ–°èŠ‚ç‚¹æ”¾åœ¨æ¡¶çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼Œä¹Ÿå°±æ˜¯é‡‡ç”¨å¤´æ’æ³•è¿›è¡Œæ’å…¥</span>    <span class="token keyword">void</span> <span class="token function">createEntry</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token keyword">int</span> bucketIndex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e <span class="token operator">=</span> table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>        table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        size<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        table<span class="token punctuation">[</span>bucketIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>        size<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å½“æˆ‘ä»¬çœŸæ­£æ’å…¥å…ƒç´ çš„æ—¶å€™ï¼Œä¼šå…ˆå»åˆ¤æ–­æ˜¯å¦è¾¾åˆ°äº†æ‰©å®¹çš„æ ‡å‡†ï¼ˆ<strong>æ¡¶ä¸­å…ƒç´ çš„ä¸ªæ•°å¤§äºç­‰äºé˜ˆå€¼ï¼Œå¹¶ä¸”è¯¥å…ƒç´ åº”è¯¥æ”¾å…¥çš„æ¡¶ä¸­å·²ç»æœ‰äº†å…ƒç´ </strong>ï¼ˆ1.7ä»¥å‰çš„ä¸€ä¸ªæ¡ä»¶ï¼‰ï¼‰</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token keyword">int</span> newCapacity<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> oldTable <span class="token operator">=</span> table<span class="token punctuation">;</span>        <span class="token keyword">int</span> oldCapacity <span class="token operator">=</span> oldTable<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token comment">// å½“æ¡¶å®¹é‡æ»¡äº†ï¼Œå°±æŠŠé˜ˆå€¼è°ƒæ•´åˆ°intçš„æœ€å¤§å€¼ï¼Œå¹¶ç»“æŸæ‰©å®¹</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCapacity <span class="token operator">==</span> MAXIMUM_CAPACITY<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            threshold <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token comment">// æ‰©å®¹ä¸ºæ–°å®¹é‡</span>        <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span>newCapacity<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token comment">// é‡æ–°è®¡ç®—å…ƒç´ å“ˆå¸Œå€¼ï¼Œå†æ”¾å…¥åˆ°æ‰©å®¹åçš„å“ˆå¸Œè¡¨ä¸­</span>        <span class="token function">transfer</span><span class="token punctuation">(</span>newTable<span class="token punctuation">,</span> <span class="token function">initHashSeedAsNeeded</span><span class="token punctuation">(</span>newCapacity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        table <span class="token operator">=</span> newTable<span class="token punctuation">;</span>        <span class="token comment">//é‡æ–°è®¡ç®—é˜ˆå€¼</span>        threshold <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>newCapacity <span class="token operator">*</span> loadFactor<span class="token punctuation">,</span> MAXIMUM_CAPACITY <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>é—®ï¼šæ‰©å®¹åæ€ä¹ˆæŠŠæ•°æ®æ”¾å…¥å¯¹åº”çš„ä½ç½®ä¸­ï¼Ÿ</p></blockquote><p>rehash()å…¨éƒ¨æŒ‰ç…§åŸæ¥çš„æ–¹å¼è®¡ç®—ï¼Œä¹Ÿå°±æ˜¯ hashCode()â€“&gt;&gt;æ‰°åŠ¨å¤„ç†â€“&gt;&gt;ï¼ˆh&amp;(length-1)ï¼‰</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTable<span class="token punctuation">,</span> <span class="token keyword">boolean</span> rehash<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> newTable<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token comment">// éå†åŸæ¥å“ˆå¸Œè¡¨ä¸­çš„å…ƒç´ </span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e <span class="token operator">:</span> table<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// å¦‚æœæ¡¶ä¸­å…ƒç´ ä¸ä¸ºç©ºï¼Œå°±é‡æ–°è®¡ç®—èµ·å“ˆå¸Œå€¼ï¼Œç„¶åæ”¾å…¥åˆ°æ‰©å®¹åçš„å“ˆå¸Œè¡¨ä¸­</span>            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                <span class="token comment">// åˆ¤æ–­æ˜¯å¦è¿›è¡Œreshash</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>rehash<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token comment">// ç»™eèµ‹å€¼æ–°çš„hashå€¼</span>                    e<span class="token punctuation">.</span>hash <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token operator">==</span> e<span class="token punctuation">.</span>key <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token function">hash</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token comment">// æ ¹æ®æ–°çš„hashå€¼å’Œæ–°æ¡¶å®¹é‡è·å–æ–°çš„ä½ç½®</span>                <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// æŒ‡å‘å¤´æŒ‡é’ˆ i å°è„šè¡¨çš„é‚£ä¸ª</span>                e<span class="token punctuation">.</span>next <span class="token operator">=</span> newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                                <span class="token comment">// æ‰©å®¹è½¬ç§»æ—¶ä½¿ç”¨å¤´æ’æ³•ï¼Œè¿™é‡Œç®—æ˜¯æ›´æ¢å¤´èŠ‚ç‚¹</span>                newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>                <span class="token comment">// æ›´æ–°å¾ªç¯çš„æ¡ä»¶å§</span>                e <span class="token operator">=</span> next<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å­˜åœ¨çš„é—®é¢˜"><a href="#å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="å­˜åœ¨çš„é—®é¢˜"></a>å­˜åœ¨çš„é—®é¢˜</h3><h4 id="å®¹æ˜“å‘ç”Ÿæ­»é”"><a href="#å®¹æ˜“å‘ç”Ÿæ­»é”" class="headerlink" title="å®¹æ˜“å‘ç”Ÿæ­»é”"></a>å®¹æ˜“å‘ç”Ÿæ­»é”</h4><blockquote><p>å› ä¸ºHashMapæœ¬èº«æ˜¯<strong>çº¿ç¨‹ä¸å®‰å…¨</strong>çš„ï¼Œæ‰€ä»¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¯èƒ½ä¼šå‘ç”Ÿæ­»é”é—®é¢˜</p></blockquote><h4 id="æ½œåœ¨çš„å®‰å…¨æ¼æ´"><a href="#æ½œåœ¨çš„å®‰å…¨æ¼æ´" class="headerlink" title="æ½œåœ¨çš„å®‰å…¨æ¼æ´"></a>æ½œåœ¨çš„å®‰å…¨æ¼æ´</h4><blockquote><p>å“ˆå¸Œç¢°æ’å¯èƒ½ä¼š<strong>ä½¿å“ˆå¸Œè¡¨é€€åŒ–æˆé“¾è¡¨</strong>ï¼Œé“¾è¡¨æŸ¥è¯¢æ•ˆç‡ä½ä¸‹ï¼Œä¸€æ—¦é€€åŒ–çš„è¯ï¼Œå¯¼è‡´æˆ‘ä»¬ç¨‹åºæ•ˆç‡å˜ä½ã€‚</p><p>é»‘å®¢å¯ä»¥æ„é€ ä¸€å †è¿™æ ·çš„å­—ç¬¦ä¸²ï¼Œé€šè¿‡è®¿é—®æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼ŒæŠŠè¿™äº›å“ˆå¸Œå€¼ä¸€æ ·çš„å…ƒç´ æ”¾åœ¨ä¸€ä¸ªæ¡¶ä¸­ï¼Œé™ä½æˆ‘ä»¬çš„æ€§èƒ½ã€‚</p></blockquote><h2 id="hashmapä»Šç”Ÿ"><a href="#hashmapä»Šç”Ÿ" class="headerlink" title="hashmapä»Šç”Ÿ"></a>hashmapä»Šç”Ÿ</h2><blockquote><p>Java8ä¸­é€šè¿‡å¼•å…¥äº†çº¢é»‘æ ‘çš„ç»“æ„ä»¥é™ä½å“ˆå¸Œç¢°æ’</p><p>å³ï¼Œåº•å±‚ç»“æ„å˜æˆäº†  æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘</p></blockquote><p><img src="https://img2018.cnblogs.com/blog/1454456/201910/1454456-20191019110307139-568037783.png" alt="åº•å±‚å®ç°"></p><h3 id="çº¢é»‘æ ‘"><a href="#çº¢é»‘æ ‘" class="headerlink" title="çº¢é»‘æ ‘"></a>çº¢é»‘æ ‘</h3><blockquote><p>ä¸€ç§<strong>äºŒå‰æŸ¥æ‰¾æ ‘</strong>ï¼Œä½†åœ¨æ¯ä¸ªèŠ‚ç‚¹å¢åŠ ä¸€ä¸ªå­˜å‚¨ä½è¡¨ç¤ºèŠ‚ç‚¹çš„é¢œè‰²ï¼Œå¯ä»¥æ˜¯çº¢æˆ–é»‘ï¼ˆ<strong>éçº¢å³é»‘</strong>ï¼‰ã€‚é€šè¿‡å¯¹ä»»ä½•ä¸€æ¡ä»æ ¹åˆ°å¶å­çš„è·¯å¾„ä¸Šå„ä¸ªèŠ‚ç‚¹ç€è‰²çš„æ–¹å¼çš„é™åˆ¶ï¼Œçº¢é»‘æ ‘ç¡®ä¿<strong>æ²¡æœ‰ä¸€æ¡è·¯å¾„ä¼šæ¯”å…¶å®ƒè·¯å¾„é•¿å‡ºä¸¤å€</strong>ï¼Œå› æ­¤ï¼Œçº¢é»‘æ ‘æ˜¯ä¸€ç§<strong>å¼±å¹³è¡¡äºŒå‰æ ‘</strong>ï¼ˆç”±äºæ˜¯å¼±å¹³è¡¡ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œ<strong>åœ¨ç›¸åŒçš„èŠ‚ç‚¹æƒ…å†µä¸‹ï¼ŒAVLæ ‘çš„é«˜åº¦ä½äºçº¢é»‘æ ‘ï¼‰</strong>ï¼Œç›¸å¯¹äºè¦æ±‚ä¸¥æ ¼çš„AVLæ ‘æ¥è¯´ï¼Œå®ƒçš„æ—‹è½¬æ¬¡æ•°å°‘ï¼Œæ‰€ä»¥<strong>å¯¹äºæœç´¢ï¼Œæ’å…¥ï¼Œåˆ é™¤æ“ä½œè¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±ç”¨çº¢é»‘æ ‘</strong></p></blockquote><h4 id="æ€§è´¨"><a href="#æ€§è´¨" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h4><ul><li>æ¯ä¸ªèŠ‚ç‚¹éçº¢å³é»‘</li><li>æ ¹èŠ‚ç‚¹æ˜¯é»‘çš„</li><li>ä¸èƒ½æœ‰ä¸¤ä¸ªçº¢è‰²çš„èŠ‚ç‚¹è¿æ¥åœ¨ä¸€èµ·ï¼Œé»‘è‰²çš„å¯ä»¥</li><li>æ¯ä¸ªå¶èŠ‚ç‚¹éƒ½æ˜¯é»‘çš„</li><li>å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ˜¯çº¢çš„ï¼Œé‚£ä¹ˆä»–çš„ä¸¤ä¸ªå„¿å­éƒ½æ˜¯é»‘çš„</li><li>å¯¹äºä»»æ„èŠ‚ç‚¹è€Œè¨€ï¼Œå…¶åˆ°å¶å­èŠ‚ç‚¹æ•°NULLæŒ‡é’ˆçš„æ¯æ¡è·¯å¾„éƒ½åŒ…å«ç›¸åŒæ•°æ®çš„é»‘èŠ‚ç‚¹</li><li>æ¯æ¡è·¯å¾„éƒ½åŒ…å«ç›¸åŒçš„é»‘èŠ‚ç‚¹</li></ul><p><img src="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200913110321.png" alt="çº¢é»‘æ ‘"></p><blockquote><p>çº¢é»‘æ ‘å¯ä»¥å¼¥è¡¥äºŒå‰æœç´¢æ ‘çš„ç¼ºç‚¹ï¼ŒäºŒå‰æœç´¢æ ‘åœ¨æœ‰äº›æƒ…å†µä¸‹ä¼šå˜å¾—è·Ÿé“¾è¡¨ä¸€æ ·ï¼Œçº¿æ€§ç»“æ„ï¼Œå¯¼è‡´æŸ¥æ‰¾æ•ˆç‡ä¸ºO(n)</p><p>è€Œçº¢é»‘æ ‘çš„æŸ¥æ‰¾é€Ÿåº¦ä¸ºO(log n)ï¼Œè§£å†³é“¾è¡¨æŸ¥è¯¢æ·±åº¦çš„é—®é¢˜ã€‚</p><p>å½“ä¸€ä¸ªæ¡¶ä¸­çš„å…ƒç´ ç‰¹åˆ«å¤šçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±ç”¨çº¢é»‘æ ‘æ¥å®ç°ï¼Œè¿™ä¸ªé‡æˆ‘ä»¬å®šä¸ºæ¡¶ä¸­å…ƒç´ å¤§äº8ï¼Œå¹¶ä¸”å“ˆå¸Œè¡¨ä¸­çš„å®¹é‡å¤§äº64æ—¶ã€‚</p><p>ä½“ç°äº†<strong>ç©ºé—´æ¢æ—¶é—´</strong>çš„æ€æƒ³</p></blockquote><h3 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//é»˜è®¤çš„åˆå§‹å®¹é‡ï¼Œè·Ÿ1.7æ²¡å˜åŒ–</span>   <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> DEFAULT_INITIAL_CAPACITY <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>   <span class="token comment">//æœ€å¤§å®¹é‡(ä¼ å…¥å®¹é‡è¿‡å¤§å°†è¢«è¿™ä¸ªå€¼æ›¿æ¢)ï¼Œä¸1.7ç›¸åŒ</span>   <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAXIMUM_CAPACITY <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">30</span><span class="token punctuation">;</span>   <span class="token comment">// é»˜è®¤åŠ è½½å› å­ä¸º0.75(å½“è¡¨è¾¾åˆ°3/4æ»¡æ—¶,æ‰ä¼šå†æ•£åˆ—),è¿™ä¸ªå› å­åœ¨æ—¶é—´å’Œç©ºé—´ä»£ä»·ä¹‹é—´è¾¾åˆ°äº†å¹³è¡¡.æ›´é«˜çš„å› å­å¯ä»¥é™ä½è¡¨æ‰€éœ€çš„ç©ºé—´,ä½†æ˜¯ä¼šå¢åŠ æŸ¥æ‰¾ä»£ä»·,è€ŒæŸ¥æ‰¾æ˜¯æœ€é¢‘ç¹æ“ä½œ</span>   <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">float</span> DEFAULT_LOAD_FACTOR <span class="token operator">=</span> <span class="token number">0.75f</span><span class="token punctuation">;</span>   <span class="token comment">//æ¡¶çš„æ ‘åŒ–é˜ˆå€¼ï¼šå³ é“¾è¡¨è½¬æˆçº¢é»‘æ ‘çš„é˜ˆå€¼ï¼Œåœ¨å­˜å‚¨æ•°æ®æ—¶ï¼Œå½“é“¾è¡¨é•¿åº¦ >= 8æ—¶ï¼Œåˆ™å°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘</span>   <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> TREEIFY_THRESHOLD <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>  <span class="token comment">// æ¡¶çš„é“¾è¡¨è¿˜åŸé˜ˆå€¼ï¼šå³ çº¢é»‘æ ‘è½¬ä¸ºé“¾è¡¨çš„é˜ˆå€¼ï¼Œå½“åœ¨æ‰©å®¹ï¼ˆresizeï¼ˆï¼‰ï¼‰æ—¶ï¼ˆHashMapçš„æ•°æ®å­˜å‚¨ä½ç½®ä¼šé‡æ–°è®¡ç®—ï¼‰ï¼Œåœ¨é‡æ–°è®¡ç®—å­˜å‚¨ä½ç½®åï¼Œå½“åŸæœ‰çš„çº¢é»‘æ ‘å†…æ•°é‡ &lt;= 6æ—¶ï¼Œåˆ™å°† çº¢é»‘æ ‘è½¬æ¢æˆé“¾è¡¨</span>   <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> UNTREEIFY_THRESHOLD <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>  <span class="token comment">//æœ€å°æ ‘å½¢åŒ–å®¹é‡é˜ˆå€¼ï¼šå³ å½“å“ˆå¸Œè¡¨ä¸­çš„å®¹é‡ > è¯¥å€¼æ—¶ï¼Œæ‰å…è®¸è½¬æ¢æˆçº¢é»‘æ ‘</span>   <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MIN_TREEIFY_CAPACITY <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>   <span class="token comment">//ä¸ JDK 1.7 çš„å¯¹æ¯”ï¼ˆEntryç±»ï¼‰ï¼Œä»…ä»…åªæ˜¯æ¢äº†åå­—ï¼Œå¯ä»¥å‚è€ƒæ–‡ç« ä¸Šè¾¹</span>   <span class="token keyword">transient</span> <span class="token class-name">Node</span><span class="token punctuation">[</span><span class="token punctuation">]</span> table<span class="token punctuation">;</span>   <span class="token keyword">transient</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span>   <span class="token comment">// æ‰©å®¹çš„é˜ˆå€¼ï¼Œåˆå§‹ä¸º0ï¼Œè®¡ç®—å…¬å¼ä¸º åŠ è½½å› å­*å®¹é‡</span>   <span class="token keyword">int</span> threshold<span class="token punctuation">;</span>   <span class="token comment">// è´Ÿè½½å› å­å®é™…å¤§å°</span>   <span class="token keyword">final</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">;</span>   <span class="token comment">// HashMapè¢«æ”¹å˜çš„æ¬¡æ•° </span>   <span class="token keyword">transient</span> <span class="token keyword">int</span> modCount<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="é—®é¢˜ï¼šä¸ºä»€ä¹ˆè¦åœ¨å“ˆå¸Œè¡¨å®¹é‡å¤§äº8çš„æ—¶å€™è½¬æ¢æˆæ ‘ï¼Ÿ"><a href="#é—®é¢˜ï¼šä¸ºä»€ä¹ˆè¦åœ¨å“ˆå¸Œè¡¨å®¹é‡å¤§äº8çš„æ—¶å€™è½¬æ¢æˆæ ‘ï¼Ÿ" class="headerlink" title="é—®é¢˜ï¼šä¸ºä»€ä¹ˆè¦åœ¨å“ˆå¸Œè¡¨å®¹é‡å¤§äº8çš„æ—¶å€™è½¬æ¢æˆæ ‘ï¼Ÿ"></a>é—®é¢˜ï¼šä¸ºä»€ä¹ˆè¦åœ¨å“ˆå¸Œè¡¨å®¹é‡å¤§äº8çš„æ—¶å€™è½¬æ¢æˆæ ‘ï¼Ÿ</h4><blockquote><p>â€‹    å› ä¸ºçº¢é»‘æ•°çš„å¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸ºlog(n)ï¼Œé•¿åº¦ä¸º8çš„æ—¶å€™ï¼Œå¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸º3.å¦‚æœç»§ç»­ç”¨é“¾è¡¨çš„è¯ï¼Œå¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸º8/2=4ï¼Œè¿™æ ·å­å¯¹æ¯”ï¼Œæ˜æ˜¾å˜æˆçº¢é»‘æ ‘åæŸ¥æ‰¾çš„å¿«ã€‚</p><p>â€‹    é“¾è¡¨åœ¨6çš„æ—¶å€™ä¸è½¬æ¢æ˜¯å› ä¸ºï¼Œè¿™æ—¶å€™çš„å¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸º6/2=3ï¼Œä¸ç®—å¾ˆæ…¢ï¼Œè€Œä¸”è½¬æ¢æˆæ ‘æ‰€éœ€è¦çš„æ—¶é—´ä¹Ÿä¸çŸ­ã€‚</p><p>â€‹    <strong>è¿˜æœ‰é€‰æ‹©6å’Œ8çš„åŸå› </strong>ï¼Œ7ä½œä¸ºä¸­é—´å€¼å¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢é“¾è¡¨å’Œçº¢é»‘æ ‘é¢‘ç¹çš„è½¬æ¢ã€‚æ¯•ç«Ÿé¢‘ç¹çš„åœ¨æ ‘å’Œé“¾è¡¨ä¹‹é—´è½¬æ¢ï¼Œä¼šä¸¥é‡é™ä½æ•ˆç‡ã€‚</p></blockquote><h3 id="æ„é€ æ–¹æ³•-1"><a href="#æ„é€ æ–¹æ³•-1" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">    <span class="token keyword">public</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">,</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// è¿™é‡Œæ˜¯åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„å®¹é‡æ˜¯å¦åˆæ³•</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Illegal initial capacity: "</span> <span class="token operator">+</span>                                               initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// æ¡¶å®¹é‡è¶…è¿‡æœ€å¤§å®¹é‡æ—¶ï¼Œèµ‹å€¼ä¸ºæœ€å¤§çš„</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">></span> MAXIMUM_CAPACITY<span class="token punctuation">)</span>            initialCapacity <span class="token operator">=</span> MAXIMUM_CAPACITY<span class="token punctuation">;</span>    <span class="token comment">// åˆ¤æ–­åŠ è½½å› å­æ˜¯å¦åˆæ³•</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>loadFactor <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token class-name">Float</span><span class="token punctuation">.</span><span class="token function">isNaN</span><span class="token punctuation">(</span>loadFactor<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Illegal load factor: "</span> <span class="token operator">+</span>                                               loadFactor<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// èµ‹å€¼</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>loadFactor <span class="token operator">=</span> loadFactor<span class="token punctuation">;</span>    <span class="token comment">// è¿™é‡Œçš„tableSizeFor ç€é‡å¼ºè°ƒä»¥ä¸‹, é˜ˆå€¼ï¼Œåˆå§‹åŒ–æ—¶ä¸ºä¼ å…¥å®¹é‡å–å¹‚åçš„å€¼</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>threshold <span class="token operator">=</span> <span class="token function">tableSizeFor</span><span class="token punctuation">(</span>initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>tableSizeFor(åˆå§‹å®¹é‡)ï¼Œç”¨æ¥ä¿è¯å‡½æ•°è¿”å›å€¼æ˜¯å¤§äºç­‰äºç»™å®šå‚æ•°initialCapacityæœ€å°çš„2çš„å¹‚æ¬¡çš„æ•°å€¼ï¼Œ</p><p><font color = "red">a |= bÂ  Â ç­‰åŒäºÂ  a =Â  a | b</font></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Returns a power of two size for the given target capacity. */</span><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">tableSizeFor</span><span class="token punctuation">(</span><span class="token keyword">int</span> cap<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// é˜²æ­¢capæœ¬æ¥å°±æ˜¯2çš„å¹‚æ¬¡ï¼Œè¿™æ ·æœ€åä¼šæˆ   2 * cap</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> cap <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>    n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">1</span><span class="token punctuation">;</span>    n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">2</span><span class="token punctuation">;</span>    n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">4</span><span class="token punctuation">;</span>    n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">8</span><span class="token punctuation">;</span>    n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">16</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> MAXIMUM_CAPACITY<span class="token punctuation">)</span> <span class="token operator">?</span> MAXIMUM_CAPACITY <span class="token operator">:</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="é—®é¢˜ï¼šä¸ºä»€ä¹ˆcapè¦ä¿æŒä¸º2çš„å¹‚æ¬¡ï¼Ÿ"><a href="#é—®é¢˜ï¼šä¸ºä»€ä¹ˆcapè¦ä¿æŒä¸º2çš„å¹‚æ¬¡ï¼Ÿ" class="headerlink" title="é—®é¢˜ï¼šä¸ºä»€ä¹ˆcapè¦ä¿æŒä¸º2çš„å¹‚æ¬¡ï¼Ÿ"></a>é—®é¢˜ï¼šä¸ºä»€ä¹ˆcapè¦ä¿æŒä¸º2çš„å¹‚æ¬¡ï¼Ÿ</h4><p>åŸç†è·Ÿ1.7çš„ä¸€æ ·ï¼Œå‚è€ƒä¸Šé¢å³å¯</p><h3 id="TreeNodeé™æ€å†…éƒ¨ç±»"><a href="#TreeNodeé™æ€å†…éƒ¨ç±»" class="headerlink" title="TreeNodeé™æ€å†…éƒ¨ç±»"></a>TreeNodeé™æ€å†…éƒ¨ç±»</h3><blockquote><p>çº¢é»‘æ ‘ç»“æ„åŒ…å«å‰ã€åã€å·¦ã€å³èŠ‚ç‚¹ï¼Œä»¥åŠæ ‡å¿—æ˜¯å¦ä¸ºçº¢é»‘æ ‘çš„å­—æ®µ</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> <span class="token keyword">extends</span> <span class="token class-name">LinkedHashMap<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> parent<span class="token punctuation">;</span>  <span class="token comment">// red-black tree links</span>    <span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> left<span class="token punctuation">;</span>    <span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> right<span class="token punctuation">;</span>    <span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> prev<span class="token punctuation">;</span>      <span class="token comment">// ç”¨æ¥æ ‡è®°æ˜¯çº¢èŠ‚ç‚¹ è¿˜æ˜¯é»‘èŠ‚ç‚¹</span>     <span class="token keyword">boolean</span> red<span class="token punctuation">;</span>    <span class="token class-name">TreeNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> val<span class="token punctuation">,</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> next<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">,</span> next<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ä¸­é—´çœç•¥ä¸å†™</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="hashæ–¹æ³•"><a href="#hashæ–¹æ³•" class="headerlink" title="hashæ–¹æ³•"></a>hashæ–¹æ³•</h3><blockquote><p>jdk8ä¸­ä¼˜åŒ–äº†hashæ–¹æ³•ï¼Œ</p><p>è‡ªå·±çš„é«˜åŠåŒºå’Œä½åŠåŒºåšå¼‚æˆ–ï¼Œå°±æ˜¯ä¸ºäº†æ··åˆåŸå§‹hashCodeçš„é«˜ä½å’Œä½ä½ï¼Œä»¥æ­¤æ¥åŠ å¤§ä½ä½çš„éšæœºæ€§ï¼Œè€Œä¸”æ··åˆåçš„ä½ä½æºæ‚äº†é«˜ä½çš„éƒ¨åˆ†ç‰¹å¾ï¼Œè¿™æ ·é«˜ä½çš„ä¿¡æ¯ä¹Ÿè¢«å˜ç›¸ä¿ç•™ä¸‹æ¥ã€‚</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> h<span class="token punctuation">;</span>    <span class="token comment">// æŠŠè‡ªå·±çš„é«˜16ä½å³ç§»16ä½ï¼Œç”¨è‡ªå·±çš„ä½16ä½å’Œé«˜16ä½åšå¼‚æˆ–ï¼Œè¿™æ ·å¤§å¤§åŠ å¤§äº†ä½ä½çš„éšæœºæ€§</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/7B8iaauAfclMROAyV9gMNAZtanwhQZmIrveJ7uyMzqftKxLfqBw8bKiadibUVTe3KdVyfEvwYJNHJvmzZ7ibdmhsAw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p><p>å³ä½ç§»16ä½ï¼Œæ­£å¥½æ˜¯32ä½ä¸€åŠï¼Œè‡ªå·±çš„é«˜åŠåŒºå’Œä½åŠåŒºåšå¼‚æˆ–ï¼Œå°±æ˜¯ä¸ºäº†æ··åˆåŸå§‹hashCodeçš„é«˜ä½å’Œä½ä½ï¼Œä»¥æ­¤æ¥åŠ å¤§ä½ä½çš„éšæœºæ€§<br>è€Œä¸”æ··åˆåçš„ä½ä½æºæ‚äº†é«˜ä½çš„éƒ¨åˆ†ç‰¹å¾ï¼Œè¿™æ ·é«˜ä½çš„ä¿¡æ¯ä¹Ÿè¢«å˜ç›¸ä¿ç•™ä¸‹æ¥ã€‚</p><p>indexçš„è¿ç®—è§„åˆ™æ˜¯<br><code>e.hash &amp; (newCap - 1)</code><br>newCapæ˜¯2çš„å¹‚,æ‰€ä»¥newCap - 1çš„é«˜ä½å…¨0</p><p><strong>è‹¥e.hashå€¼åªç”¨è‡ªèº«çš„hashcode,indexåªä¼šå’Œe.hashçš„ä½ä½åš&amp;æ“ä½œ.è¿™æ ·ä¸€æ¥,indexçš„å€¼å°±åªæœ‰ä½ä½å‚ä¸è¿ç®—,é«˜ä½æ¯«æ— å­˜åœ¨æ„Ÿ,ä»è€Œä¼šå¸¦æ¥å“ˆå¸Œå†²çªçš„é£é™©</strong>æ‰€ä»¥åœ¨è®¡ç®—keyçš„hashCodeæ—¶,ç”¨å…¶è‡ªèº«hashCodeä¸å…¶ä½16ä½åšå¼‚æˆ–æ“ä½œï¼Œè¿™ä¹Ÿå°±<strong>è®©é«˜ä½å‚ä¸åˆ°indexçš„è®¡ç®—ä¸­</strong>æ¥äº†,å³<strong>é™ä½äº†å“ˆå¸Œå†²çªçš„é£é™©åˆä¸ä¼šå¸¦æ¥å¤ªå¤§çš„æ€§èƒ½é—®é¢˜</strong></p><h3 id="putæ–¹æ³•"><a href="#putæ–¹æ³•" class="headerlink" title="putæ–¹æ³•"></a>putæ–¹æ³•</h3><blockquote><p>ç”±äº1.8å¼•å…¥äº†çº¢é»‘æ ‘ç»“æ„ï¼Œå¹¶ä¸”ä¸ºäº†è§£å†³ä»¥å‰é—ç•™çš„é—®é¢˜ï¼Œ</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">V</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// è°ƒç”¨putValçš„æ–¹æ³•</span>    <span class="token keyword">return</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/** * Implements Map.put and related methods. * * @param hash hash for key * @param key the key * @param value the value to put * @param onlyIfAbsent if true, don't change existing value * @param evict if false, the table is in creation mode. * @return previous value, or null if none */</span><span class="token keyword">final</span> <span class="token class-name">V</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token keyword">boolean</span> onlyIfAbsent<span class="token punctuation">,</span>               <span class="token keyword">boolean</span> evict<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span>     <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> p<span class="token punctuation">;</span>     <span class="token keyword">int</span> n<span class="token punctuation">,</span> i<span class="token punctuation">;</span> <span class="token comment">// nä¿å­˜æ¡¶çš„ä¸ªæ•°ï¼Œiä¿å­˜äº†åº”è¯¥æ”¾åœ¨å“ªä¸ªæ¡¶ä¸­</span>    <span class="token comment">// é¦–å…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦åˆå§‹åŒ–</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        n <span class="token operator">=</span> <span class="token punctuation">(</span>tab <span class="token operator">=</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token comment">// è¿™é‡Œçš„ (n - 1) &amp; hash ç›¸å½“äº Java 7 ä¸­çš„indexFor()æ–¹æ³•ï¼Œç”¨äºç¡®å®šå…ƒç´ åº”è¯¥æ”¾åœ¨å“ªä¸ªæ¡¶ä¸­</span>   <span class="token comment">// (n - 1) &amp; hash æœ‰ä»¥ä¸‹ä¸¤ä¸ªå¥½å¤„ï¼š1ã€æ”¾å…¥çš„ä½ç½®ä¸ä¼šå¤§äºæ¡¶çš„ä¸ªæ•° 2ã€ç”¨åˆ°äº†hashå€¼ï¼Œç¡®å®šå…¶åº”æ”¾çš„å¯¹åº”çš„ä½ç½®</span>    <span class="token comment">// è¿™é‡Œæ˜¯åˆ¤æ–­æŒ‡å®šä½ç½®ä¸Šæ˜¯ä¸æ˜¯ç©ºçš„ï¼Œå¦‚æœæ˜¯ç©ºçš„ç›´æ¥åˆ›å»ºèŠ‚ç‚¹æ”¾å…¥ï¼Œå¦‚æœä¸æ˜¯ï¼Œæ‰§è¡Œelse</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">=</span> tab<span class="token punctuation">[</span>i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>        tab<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e<span class="token punctuation">;</span>         <span class="token class-name">K</span> k<span class="token punctuation">;</span>ey        <span class="token comment">//  èŠ‚ç‚¹çš„hashç›¸åŒï¼Œå¹¶ä¸”ï¼Œkeyç›¸åŒæˆ–è€… keyä¸ä¸ºç©ºå¹¶ä¸”keyåœ¨å€¼ä¸Šè¦ç­‰äºkï¼›æ­¤æ—¶è¯´æ˜è¯¥å…ƒç´ å·²ç»å­˜åœ¨hashè¡¨ä¸­ï¼Œç›´æ¥è¦†ç›–</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>            <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            e <span class="token operator">=</span> p<span class="token punctuation">;</span>        <span class="token comment">// å¦åˆ™å¦‚æœæ˜¯çº¢é»‘æ ‘çš„ç»“æ„ï¼Œå°±ç”¨çº¢é»‘æ ‘çš„æ–¹æ³•æ’å…¥å®ƒ</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>            e <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">)</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">putTreeVal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> tab<span class="token punctuation">,</span> hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// å¦åˆ™ç”¨é“¾è¡¨çš„å½¢å¼å»æ’å…¥</span>                       <span class="token comment">// è¿™é‡Œè¿™ä¸ªå¾ªç¯æ˜¯ä¸ºäº†è®¡æ•°ï¼Œçœ‹çœ‹æ˜¯å¦è¾¾åˆ°äº†é˜ˆå€¼</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> binCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token operator">++</span>binCount<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// å°¾æ’æ³•æ’å…¥</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    p<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// è¿™é‡Œæ˜¯åˆ¤æ–­æ¡¶ä¸­çš„å…ƒç´ å¤§äºäº†é˜ˆå€¼ï¼Œå°±å»è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥è½¬æˆçº¢é»‘æ ‘ï¼Œï¼ˆä¸ä¸€å®šèƒ½æˆåŠŸï¼Œå› ä¸ºè¿˜æœ‰ä¸€ä¸ªæ¡ä»¶64ï¼‰</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>binCount <span class="token operator">>=</span> TREEIFY_THRESHOLD <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// -1 for 1st</span>                        <span class="token function">treeifyBin</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> hash<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token comment">// å¦‚æœé‡åˆ°äº†ç›¸åŒçš„å…ƒç´ ï¼Œè·³å‡ºå¾ªç¯</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>                    <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token comment">// ç§»åŠ¨æŒ‡é’ˆï¼Œæ–¹ä¾¿ç»§ç»­å–p.next</span>                p <span class="token operator">=</span> e<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// existing mapping for key</span>            <span class="token class-name">V</span> oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>            <span class="token comment">// æ ¹æ®è§„åˆ™é€‰æ‹©æ˜¯å¦è¦†ç›–value</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>onlyIfAbsent <span class="token operator">||</span> oldValue <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>                e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>            <span class="token function">afterNodeAccess</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token operator">++</span>modCount<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>size <span class="token operator">></span> threshold<span class="token punctuation">)</span>        <span class="token comment">// sizeå¤§äºé˜ˆå€¼ï¼ˆå®¹é‡*åŠ è½½å› å­ï¼‰</span>        <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">afterNodeInsertion</span><span class="token punctuation">(</span>evict<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/7B8iaauAfclMROAyV9gMNAZtanwhQZmIrqlUJic8Psu92oicku0sUNkI2JBmuvndVamTowntyicpjpdobGgjuSD6ibQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/7B8iaauAfclMROAyV9gMNAZtanwhQZmIrBE8HGibIYffm5ENuPAwiakchicduU1c7Wp5RMNPVejDuJdhqB4cUpfaicw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/7B8iaauAfclMROAyV9gMNAZtanwhQZmIrumcxcAXyY3k1S4fxg3Cyw8lZZg9ylnMxKFN88ByWC1r0ocCo8hS1Mg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p><h3 id="æ‰©å®¹-resizeï¼ˆï¼‰"><a href="#æ‰©å®¹-resizeï¼ˆï¼‰" class="headerlink" title="æ‰©å®¹ resizeï¼ˆï¼‰"></a>æ‰©å®¹ resizeï¼ˆï¼‰</h3><blockquote><p>jdk1.8çš„æ‰©å®¹æ–¹æ³•å’Œåˆå§‹åŒ–æ–¹æ³•åˆä¸ºä¸€ä½“äº†</p></blockquote><p><img src="https://mmbiz.qpic.cn/mmbiz_png/7B8iaauAfclMROAyV9gMNAZtanwhQZmIrumogH8GNxBmfddxJCIkxsAhZznYNiaarWeMXibkX8XB5frXqrHxkFUcQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1"></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * Initializes or doubles table size.  If null, allocates in * accord with initial capacity target held in field threshold. * Otherwise, because we are using power-of-two expansion, the * elements from each bin must either stay at same index, or move * with a power of two offset in the new table. *  1.8çš„åˆå§‹åŒ–å’Œæ‰©å®¹æ”¾åˆ°äº†ä¸€å— * @return the table */</span><span class="token keyword">final</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// ç”¨æ¥ä¿å­˜æ—§è¡¨</span>    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> oldTab <span class="token operator">=</span> table<span class="token punctuation">;</span>    <span class="token comment">// å­˜å‚¨æ¡¶å®¹é‡</span>    <span class="token keyword">int</span> oldCap <span class="token operator">=</span> <span class="token punctuation">(</span>oldTab <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> oldTab<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token comment">// ä¿å­˜æ—§é˜ˆå€¼</span>    <span class="token keyword">int</span> oldThr <span class="token operator">=</span> threshold<span class="token punctuation">;</span>    <span class="token comment">// åˆå§‹åŒ–æ–°æ¡¶å®¹é‡ï¼Œé˜ˆå€¼ä¸º0</span>    <span class="token keyword">int</span> newCap<span class="token punctuation">,</span> newThr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment">// è¿™é‡Œè¯´æ˜æ˜¯æ‰©å®¹</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// åˆ¤æ–­æ—§ç­’å®¹é‡æ˜¯å¦å¤§äºç­‰äºæœ€å¤§æ¡¶å®¹é‡</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">>=</span> MAXIMUM_CAPACITY<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// èµ‹å€¼ä¸ºæœ€å¤§æ¡¶å®¹é‡</span>            threshold <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>            <span class="token keyword">return</span> oldTab<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// å¦åˆ™å¦‚æœ æ–°ç­’å®¹é‡ä¸º2å€çš„æ—§å®¹é‡ï¼Œå¹¶ä¸”è¦å°äºæœ€å¤§æ¡¶å®¹é‡ï¼Œï¼Œå¹¶ä¸”ï¼Œæ—§å®¹é‡è¦å¤§äºç­‰äºé»˜è®¤åˆå§‹å®¹é‡16</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>newCap <span class="token operator">=</span> oldCap <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token generics"><span class="token punctuation">&lt;</span> MAXIMUM_CAPACITY <span class="token operator">&amp;</span><span class="token operator">&amp;</span>                 oldCap <span class="token punctuation">></span></span><span class="token operator">=</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">)</span>            newThr <span class="token operator">=</span> oldThr <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// æ›´æ–°æ–°é˜ˆå€¼ï¼Œè¿™æ˜¯æ•°å­¦çŸ¥è¯†</span>    <span class="token punctuation">&#125;</span>   <span class="token comment">// è°ƒç”¨äº†å«å‚æ„é€ æ–¹æ³•çš„æ‰©å®¹</span>    <span class="token comment">// åŸå®¹é‡å°äºç­‰äº0ï¼Œä½†æ˜¯é˜ˆå€¼å¤§äº0ï¼Œé‚£ä¹ˆæ–°å®¹é‡å°±ä½åŸæ¥çš„é˜ˆå€¼ï¼ˆé˜ˆå€¼åœ¨è°ƒç”¨æ„é€ å‡½æ•°æ—¶å°±ä¼šç¡®å®šï¼Œä½†å®¹é‡ä¸ä¼š)</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldThr <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// initial capacity was placed in threshold</span>        newCap <span class="token operator">=</span> oldThr<span class="token punctuation">;</span>        <span class="token comment">// è¿™é‡Œæ˜¯é»˜è®¤åˆå§‹åŒ–</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>               <span class="token comment">// zero initial threshold signifies using defaults</span>        newCap <span class="token operator">=</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">;</span>        newThr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>DEFAULT_LOAD_FACTOR <span class="token operator">*</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span>newThr <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// </span>        <span class="token keyword">float</span> ft <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>newCap <span class="token operator">*</span> loadFactor<span class="token punctuation">;</span>        <span class="token comment">// è¿™é‡Œé‡æ–°è®¡ç®—æ–°çš„é˜ˆå€¼</span>        newThr <span class="token operator">=</span> <span class="token punctuation">(</span>newCap <span class="token operator">&lt;</span> MAXIMUM_CAPACITY <span class="token operator">&amp;&amp;</span> ft <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>MAXIMUM_CAPACITY <span class="token operator">?</span>                  <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>ft <span class="token operator">:</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// èµ‹å€¼ç»™é˜ˆå€¼threshold</span>    threshold <span class="token operator">=</span> newThr<span class="token punctuation">;</span>    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"rawtypes"</span><span class="token punctuation">,</span><span class="token string">"unchecked"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token comment">// åˆ›å»ºæ–°çš„è¡¨ï¼Œå°†æ—§è¡¨ä¸­çš„å…ƒç´ è¿›è¡Œé‡æ–°æ”¾å…¥</span>    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTab <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>newCap<span class="token punctuation">]</span><span class="token punctuation">;</span>    table <span class="token operator">=</span> newTab<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldTab <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token comment">// oldTab å¤åˆ¶åˆ° newTab</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> oldCap<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>next <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>                    <span class="token comment">// é“¾è¡¨åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç›´æ¥èµ‹å€¼ï¼Œè¿™é‡Œè¦é‡æ–°è®¡ç®—hashï¼Œä½ç½®æ˜¯åœ¨åŸä½ç½®æˆ–è€…åŸä½ç½®+æ—§å®¹é‡</span>                    newTab<span class="token punctuation">[</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> <span class="token punctuation">(</span>newCap <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>                    <span class="token comment">// å¦‚æœèŠ‚ç‚¹æ˜¯çº¢é»‘æ ‘çš„æƒ…å†µï¼Œè°ƒç”¨çº¢é»‘æ ‘çš„æ’å…¥æ–¹å¼</span>                    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">)</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> newTab<span class="token punctuation">,</span> j<span class="token punctuation">,</span> oldCap<span class="token punctuation">)</span><span class="token punctuation">;</span>                                <span class="token comment">// å¦åˆ™è°ƒç”¨é“¾è¡¨çš„æ’å…¥æ“ä½œï¼Œå°¾æ’æ³•</span>                <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">// preserve order</span>                    <span class="token comment">// lo å’Œ hi åˆ†åˆ«ä¸ºä¸¤ä¸ªé“¾è¡¨ï¼Œä¿å­˜äº†åŸæ¥ä¸€ä¸ªæ¡¶ä¸­å…ƒç´ è¢«æ‹†åˆ†åçš„ä¸¤ä¸ªé“¾è¡¨</span>                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> loHead <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> loTail <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> hiHead <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> hiTail <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> next<span class="token punctuation">;</span>                    <span class="token keyword">do</span> <span class="token punctuation">&#123;</span>                        next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> oldCap<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                            <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>                                loHead <span class="token operator">=</span> e<span class="token punctuation">;</span>                            <span class="token keyword">else</span>                                loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>                            loTail <span class="token operator">=</span> e<span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span>                        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                            <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>                                hiHead <span class="token operator">=</span> e<span class="token punctuation">;</span>                            <span class="token keyword">else</span>                                hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>                            hiTail <span class="token operator">=</span> e<span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                        newTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> loHead<span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>                        newTab<span class="token punctuation">[</span>j <span class="token operator">+</span> oldCap<span class="token punctuation">]</span> <span class="token operator">=</span> hiHead<span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> newTab<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä¸¾ä¸ªä¾‹å­ï¼Œå›¾è§£ä¸€ä¸‹æ‰©å®¹æ“ä½œ</strong></p><blockquote><p>å‡è®¾hashè¡¨ä¸­çš„æ¡¶ä¸ªæ•°ä¸º4ï¼Œå…¶ä¸­4ï¼Œ8ï¼Œ12ï¼Œ0ï¼Œéƒ½è¢«æ”¾åœ¨äº†ä¸‹æ ‡ä¸º0çš„æ¡¶ä¸­ã€‚è¦è¿›è¡Œæ‰©å®¹æ“ä½œï¼Œå°†å…ƒç´ hashå€¼ä¸æ—§å®¹é‡ï¼ˆoldCapï¼‰è¿›è¡Œä¸æ“ä½œï¼Œå¦‚æœä¸º0ï¼Œæ”¾åœ¨loHeadæ•°ç»„ä¸­ï¼Œå¦åˆ™æ”¾åœ¨loTailæ•°ç»„ä¸­ã€‚</p></blockquote><p><img src="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200913155253.png"></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">do</span> <span class="token punctuation">&#123;</span>    next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token comment">// å½“å‰å…ƒç´ çš„hashå€¼å’Œå®¹é‡è¿›è¡ŒæŒ‰ä½ä¸ï¼Œå†³å®šè¢«åˆ†é…åˆ°å“ªä¸ªé“¾è¡¨ä¸­</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> oldCap<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>            loHead <span class="token operator">=</span> e<span class="token punctuation">;</span>        <span class="token keyword">else</span>            loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>        loTail <span class="token operator">=</span> e<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>            hiHead <span class="token operator">=</span> e<span class="token punctuation">;</span>        <span class="token keyword">else</span>            hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>        hiTail <span class="token operator">=</span> e<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ç»è¿‡ä¸€ç³»åˆ—è®¡ç®—ï¼Œç§»åŠ¨ï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰çš„å…ƒç´ éƒ½åˆ†å¼€äº†ã€‚</p></blockquote><p><img src="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200913155514.png"></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// é€šè¿‡å¤´æŒ‡é’ˆç›´æ¥å°†é“¾è¡¨æ”¾å…¥æ¡¶ä¸­</span><span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    newTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> loHead<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    newTab<span class="token punctuation">[</span>j <span class="token operator">+</span> oldCap<span class="token punctuation">]</span> <span class="token operator">=</span> hiHead<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200913155710.png"></p><p><strong>æ€»ç»“</strong></p><ul><li>å…ˆå°†åŸæ¡¶ä¸­çš„å…ƒç´ çš„<strong>hashå€¼ä¸æ—§å®¹é‡è¿›è¡ŒæŒ‰ä½ä¸</strong>æ“ä½œ<ul><li>å¦‚æœç»“æœä¸º0ï¼Œå°±æ”¾å…¥loé“¾è¡¨ä¸­</li><li>å¦‚æœç»“æœä¸ä¸º0ï¼Œå°±æ”¾å…¥hié“¾è¡¨ä¸­</li></ul></li><li>loé“¾è¡¨ä¸­çš„å…ƒç´ ç»§ç»­æ”¾åœ¨æ–°çš„å“ˆå¸Œè¡¨ä¸­åŸæ¥çš„ä½ç½®</li><li>hié“¾è¡¨ä¸­çš„å…ƒç´ æ”¾åœ¨æ–°çš„å“ˆå¸Œè¡¨ä¸­ï¼Œæ‰©å®¹åç›¸å¯¹äºåŸæ¥çš„ä½ç½®ä¸Š(j+oldCap)<ul><li><strong>ä¸¤ä¸ªæ¡¶ä¹‹é—´çš„é—´éš”æ•°å°±ä¸ºå¢åŠ åŸæ¥å“ˆå¸Œè¡¨çš„å®¹é‡</strong></li></ul></li></ul><p><strong>å¥½å¤„</strong></p><ul><li>ç›¸è¾ƒäº1.7çš„å¤´æ’æ³•ï¼Œå°¾æ’æ³•é¡ºåºæ’å…¥ï¼Œå‡å°‘äº†å‘ç”Ÿæ­»é”çš„æ¦‚ç‡</li><li>ä½¿å¾—å…ƒç´ å˜å¾—ç›¸å¯¹å‡åŒ€åœ°å­˜åœ¨hashè¡¨ä¸­</li></ul><h3 id="ç§»é™¤remove"><a href="#ç§»é™¤remove" class="headerlink" title="ç§»é™¤remove()"></a>ç§»é™¤remove()</h3><blockquote><p>removeçš„ä¸¤ä¸ªé‡è½½æ–¹æ³•ï¼Œæœ€ç»ˆéƒ½èµ°çš„removeNodeå®ç°çš„</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">V</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e<span class="token punctuation">;</span>    <span class="token comment">// è°ƒç”¨removeNode()æ–¹æ³•ï¼Œè¿”å›å…¶è¿”å›çš„ç»“æœ</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>e <span class="token operator">=</span> <span class="token function">removeNode</span><span class="token punctuation">(</span><span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span>        <span class="token keyword">null</span> <span class="token operator">:</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/*** çœŸæ­£å®ç°çš„ç§»é™¤å…ƒç´ */</span><span class="token keyword">final</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> <span class="token function">removeNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">Object</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">,</span>                               <span class="token keyword">boolean</span> matchValue<span class="token punctuation">,</span> <span class="token keyword">boolean</span> movable<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> p<span class="token punctuation">;</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> index<span class="token punctuation">;</span>        <span class="token comment">// æ¡¶ä¸­æœ‰å…ƒç´ , pä¿å­˜äº†æ¡¶ä¸­çš„é¦–ä¸ªå…ƒç´ </span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span>            <span class="token punctuation">(</span>p <span class="token operator">=</span> tab<span class="token punctuation">[</span>index <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> node <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> e<span class="token punctuation">;</span> <span class="token class-name">K</span> k<span class="token punctuation">;</span> <span class="token class-name">V</span> v<span class="token punctuation">;</span>                        <span class="token comment">// æ‰¾åˆ°å¯¹åº”çš„å…ƒç´ ï¼Œä¿å­˜åœ¨nodeä¸­</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>                <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                node <span class="token operator">=</span> p<span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>                    <span class="token comment">// å¦‚æœæ˜¯çº¢é»‘æ ‘ç±»å‹ï¼Œè°ƒç”¨è·å–æ ‘èŠ‚ç‚¹çš„æ–¹æ³•ï¼Œè·å–è¿™ä¸ªèŠ‚ç‚¹</span>                    node <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">)</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTreeNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                    <span class="token comment">// éå†é“¾è¡¨ï¼Œæ‰¾åˆ°è¦åˆ é™¤çš„å…ƒç´ </span>                    <span class="token keyword">do</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>                            <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span>                             <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                            node <span class="token operator">=</span> e<span class="token punctuation">;</span>                            <span class="token keyword">break</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span>                        p <span class="token operator">=</span> e<span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>                        <span class="token comment">// è¯¥å…ƒç´ ä¸ä¸ºç©ºï¼Œè¯´æ˜å·²ç»æ‰¾åˆ°äº†ï¼Œä¸æ˜¯ä¸ªç©ºå€¼</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span>matchValue <span class="token operator">||</span> <span class="token punctuation">(</span>v <span class="token operator">=</span> node<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token operator">==</span> value <span class="token operator">||</span>                                 <span class="token punctuation">(</span>value <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> value<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// å¦‚æœæ˜¯æ ‘èŠ‚ç‚¹ï¼Œå°±è°ƒç”¨çº¢é»‘æ ‘çš„åˆ é™¤æ–¹æ³•</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>                    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">)</span>node<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeTreeNode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> tab<span class="token punctuation">,</span> movable<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ¡¶çš„ç´¢å¼•å°±ä¿å­˜å…¶ä¸‹ä¸€ä¸ªå…ƒç´ </span>                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">==</span> p<span class="token punctuation">)</span>                    tab<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                                <span class="token comment">// å¦åˆ™å°±ä¸åœ¨æŒ‡å‘è¿™ä¸ªå…ƒç´ </span>                <span class="token keyword">else</span>                    p<span class="token punctuation">.</span>next <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>                                <span class="token operator">++</span>modCount<span class="token punctuation">;</span>                <span class="token operator">--</span>size<span class="token punctuation">;</span>                <span class="token function">afterNodeRemoval</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è¿™æ˜¯ä¸ªç©ºæ–¹æ³•ï¼Œå¯ä»¥é‡å†™ä»–ï¼Œæ»¡è¶³æˆ‘ä»¬çš„ä¸šåŠ¡éœ€è¦</span>                <span class="token keyword">return</span> node<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> hashmap </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hashmap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JVM04</title>
      <link href="2020/10/11/jvm04/"/>
      <url>2020/10/11/jvm04/</url>
      
        <content type="html"><![CDATA[<h1 id="æ–¹æ³•åŒº"><a href="#æ–¹æ³•åŒº" class="headerlink" title="æ–¹æ³•åŒº"></a>æ–¹æ³•åŒº</h1><h2 id="æ ˆï¼Œå †ï¼Œæ–¹æ³•åŒºçš„äº¤äº’å…³ç³»"><a href="#æ ˆï¼Œå †ï¼Œæ–¹æ³•åŒºçš„äº¤äº’å…³ç³»" class="headerlink" title="æ ˆï¼Œå †ï¼Œæ–¹æ³•åŒºçš„äº¤äº’å…³ç³»"></a>æ ˆï¼Œå †ï¼Œæ–¹æ³•åŒºçš„äº¤äº’å…³ç³»</h2><p><img src="https://s1.ax1x.com/2020/10/11/0gnfC8.png" alt="ä»çº¿ç¨‹å…±äº«çš„è§’åº¦çœ‹"></p><blockquote><p>referenceæ˜¯å¼•ç”¨</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/11/0gnL5V.png" alt="å®ä¾‹"></p><h2 id="æ–¹æ³•åŒºçš„ç†è§£"><a href="#æ–¹æ³•åŒºçš„ç†è§£" class="headerlink" title="æ–¹æ³•åŒºçš„ç†è§£"></a>æ–¹æ³•åŒºçš„ç†è§£</h2><blockquote><p>å°½ç®¡æ‰€æœ‰çš„æ–¹æ³•åŒºåœ¨é€»è¾‘ä¸Šæ˜¯å±äºå †çš„ä¸€éƒ¨åˆ†ï¼Œä½†ä¸€äº›ç®€å•çš„å®ç°å¯èƒ½ä¸ä¼šé€‰æ‹©åŒºè¿›è¡Œåƒåœ¾æ”¶é›†æˆ–è€…è¿›è¡Œå‹ç¼©ã€‚ä½†å¯¹äºHotSpotè™šæ‹Ÿæœºè€Œè¨€ï¼Œæ–¹æ³•åŒºè¿˜æœ‰ä¸€ä¸ªåˆ«åå«åš Non-Heapï¼ˆéå †ï¼‰ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†å’Œå †åˆ†å¼€ã€‚<strong>æ–¹æ³•åŒºå¯ä»¥çœ‹ä½œä¸€å—ç‹¬ç«‹äºjavaå †çš„å†…å­˜ç©ºé—´</strong></p></blockquote><ul><li>æ–¹æ³•åŒºä¸javaå †ä¸€æ ·ï¼Œ<strong>æ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸ</strong></li><li>æ–¹æ³•åŒº<strong>åœ¨jvmå¯åŠ¨çš„æ—¶å€™è¢«åˆ›å»º</strong>ï¼Œå¹¶ä¸”ä»–çš„<strong>å®é™…ç‰©ç†å†…å­˜ç©ºé—´</strong>ä¸­å’Œjavaå †åŒºä¸€æ ·éƒ½å¯ä»¥æ˜¯<strong>ä¸è¿ç»­çš„</strong></li><li>æ–¹æ³•åŒºçš„å¤§å°ï¼Œè·Ÿå †ç©ºé—´ä¸€æ ·ï¼Œå¯ä»¥é€‰æ‹©<strong>å›ºå®šå¤§å°æˆ–è€…å¯æ‹“å±•</strong></li><li>æ–¹æ³•åŒºçš„å¤§å°å†³å®šäº†ç³»ç»Ÿå¯ä»¥ä¿å­˜å¤šå°‘ä¸ªç±»ï¼Œå¦‚æœç³»ç»Ÿå®šä¹‰äº†å¤ªå¤šçš„ç±»ï¼Œå¯¼è‡´æ–¹æ³•åŒºæº¢å‡ºï¼ŒjvmåŒæ ·ä¼šæŠ›å‡ºOOM</li><li>å…³é—­JVMå°±ä¼šé‡Šæ”¾è¿™ä¸ªåŒºåŸŸçš„å†…å­˜</li></ul><blockquote><p>Hotspotè™šæ‹Ÿæœºä¸­æ–¹æ³•åŒºçš„æ¼”è¿›</p></blockquote><ul><li>åœ¨jdk7åŠä»¥å‰ï¼Œä¹ æƒ¯ä¸ŠæŠŠæ–¹æ³•åŒºç§°ä¸ºæ°¸ä¹…ä»£ã€‚jdk8å¼€å§‹ï¼Œä½¿ç”¨å…ƒç©ºé—´å–ä»£äº†æ°¸ä¹…ä»£</li><li>æœ¬è´¨ä¸Šæ–¹æ³•åŒºå’Œæ°¸ä¹…ä»£å¹¶ä¸ç­‰ä»·ï¼Œä»…ä»…æ˜¯å †hotspotè€Œè¨€çš„ã€‚å¯¹äºå¦‚ä½•å®ç°æ–¹æ³•åŒºï¼Œä¸åšç»Ÿä¸€è¦æ±‚ã€‚</li></ul><h2 id="è®¾ç½®æ–¹æ³•åŒºå¤§å°ä¸OOM"><a href="#è®¾ç½®æ–¹æ³•åŒºå¤§å°ä¸OOM" class="headerlink" title="è®¾ç½®æ–¹æ³•åŒºå¤§å°ä¸OOM"></a>è®¾ç½®æ–¹æ³•åŒºå¤§å°ä¸OOM</h2><blockquote><p>jdk7ä»¥å‰</p></blockquote><ul><li>-XX:PermSizeè®¾ç½®æ°¸ä¹…ä»£åˆå§‹åˆ†é…ç©ºé—´ã€‚é»˜è®¤å€¼æ˜¯20.75m</li><li>-XX:MaxPermSizeè®¾ç½®æ°¸ä¹…ä»£æœ€å¤§å¯åˆ†é…ç©ºé—´ã€‚32ä½æœºå™¨é»˜è®¤æ˜¯64mï¼Œ64ä½æœºå™¨é»˜è®¤æ˜¯82m</li><li>å½“JVMåŠ è½½çš„ç±»ä¿¡æ¯è¶…è¿‡äº†è¿™ä¸ªå€¼ï¼Œå°±ä¼šæŠ¥OOM</li></ul><blockquote><p>jdk8ä¹‹å</p></blockquote><ul><li>-XX:MetaspaceSizeè®¾ç½®å…ƒç©ºé—´åˆå§‹åˆ†é…ç©ºé—´</li><li>-XX:MaxMetaspaceSizeè®¾ç½®å…ƒç©ºé—´æœ€å¤§å¯åˆ†é…ç©ºé—´</li></ul><p><img src="https://s1.ax1x.com/2020/10/11/0gtoKx.png" alt="1.8ä¹‹å"></p><blockquote><p>å¦‚ä½•è§£å†³OOM</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/11/0gUA0K.png" alt="å†…å­˜æº¢å‡ºå’Œå†…å­˜æ³„æ¼"></p><h2 id="æ–¹æ³•åŒºçš„å†…éƒ¨ç»“æ„"><a href="#æ–¹æ³•åŒºçš„å†…éƒ¨ç»“æ„" class="headerlink" title="æ–¹æ³•åŒºçš„å†…éƒ¨ç»“æ„"></a>æ–¹æ³•åŒºçš„å†…éƒ¨ç»“æ„</h2><p><img src="https://s1.ax1x.com/2020/10/11/0grjJK.png" alt="ç®€å›¾"></p><blockquote><p>ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ä¹¦ä¸­å¯¹æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰å­˜å‚¨å†…å®¹æè¿°å¦‚ä¸‹ï¼š</p><p>å®ƒç”¨äºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„<strong>ç±»å‹ä¿¡æ¯</strong>ã€<strong>å¸¸é‡</strong>ã€<strong>é™æ€å˜é‡</strong>ã€<strong>å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç¼“å­˜</strong>ç­‰ç­‰</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/11/0gy9pT.png" alt="ç»å…¸è€Œè§„èŒƒçš„ç‰ˆæœ¬"></p><h3 id="ç±»å‹ä¿¡æ¯"><a href="#ç±»å‹ä¿¡æ¯" class="headerlink" title="ç±»å‹ä¿¡æ¯"></a>ç±»å‹ä¿¡æ¯</h3><blockquote><p>å¯¹äºæ¯ä¸ªåŠ è½½çš„ç±»å‹ï¼ˆclassã€interfaceã€enumã€annotationï¼‰ï¼ŒJVMå¿…é¡»åœ¨æ–¹æ³•åŒºä¸­å­˜å‚¨ä»¥ä¸‹ç±»å‹ä¿¡æ¯ï¼š</p><ol><li>è¿™ä¸ªç±»å‹çš„å®Œæ•´æœ‰æ•ˆåç§°ï¼ˆåŒ…å.ç±»åï¼‰</li><li>è¿™ä¸ªç±»å‹ç›´æ¥çˆ¶ç±»çš„å®Œæ•´æœ‰æ•ˆåï¼ˆå¯¹äºinterfaceæˆ–æ˜¯java.lang.Objectï¼Œéƒ½æ²¡æœ‰çˆ¶ç±»ï¼‰</li><li>è¿™ä¸ªç±»å‹çš„ä¿®é¥°ç¬¦ï¼ˆpublicï¼Œabstractï¼Œfinalçš„æŸä¸ªå­é›†ï¼‰</li><li>è¿™ä¸ªç±»å‹ç›´æ¥æ¥å£çš„ä¸€ä¸ªæœ‰åºåˆ—è¡¨</li></ol></blockquote><h3 id="åŸŸä¿¡æ¯"><a href="#åŸŸä¿¡æ¯" class="headerlink" title="åŸŸä¿¡æ¯"></a>åŸŸä¿¡æ¯</h3><blockquote><ul><li>JVMå¿…é¡»åœ¨æ–¹æ³•åŒºä¸­ä¿å­˜ç±»å‹çš„æ‰€æœ‰åŸŸçš„ç›¸å…³ä¿¡æ¯ä»¥åŠåŸŸçš„å£°æ˜é¡ºåº</li><li>åŸŸçš„ç›¸å…³ä¿¡æ¯åŒ…æ‹¬ï¼šåç§°ã€ç±»å‹ã€ä¿®é¥°ç¬¦</li></ul></blockquote><h3 id="æ–¹æ³•ä¿¡æ¯"><a href="#æ–¹æ³•ä¿¡æ¯" class="headerlink" title="æ–¹æ³•ä¿¡æ¯"></a>æ–¹æ³•ä¿¡æ¯</h3><blockquote><ul><li>æ–¹æ³•åç§°</li><li>æ–¹æ³•è¿”å›ç±»å‹</li><li>æ–¹æ³•å‚æ•°çš„æ•°é‡å’Œç±»å‹ï¼ˆæŒ‰é¡ºåºï¼‰</li><li>æ–¹æ³•çš„ä¿®é¥°ç¬¦</li><li>æ–¹æ³•çš„å­—èŠ‚ç ã€æ“ä½œæ•°æ ˆã€å±€éƒ¨å˜é‡è¡¨ä»¥åŠå¤§å°ï¼ˆabstractå’Œnativeé™¤å¤–ï¼‰</li><li>å¼‚å¸¸è¡¨ï¼ˆabstractå’Œnativeæ–¹æ³•é™¤å¤–ï¼‰<ul><li>æ¯ä¸ªå¼‚å¸¸å¤„ç†çš„å¼€å§‹ä½ç½®ï¼Œç»“æŸä½ç½®ï¼Œä»£ç å¤„ç†åœ¨ç¨‹åºè®¡æ•°å™¨ä¸­çš„åç§»åœ°å€ï¼Œè¢«æ•è·çš„å¼‚å¸¸ç±»çš„å¸¸é‡æ± ç´¢å¼•</li></ul></li></ul></blockquote><h3 id="non-finalçš„ç±»å˜é‡"><a href="#non-finalçš„ç±»å˜é‡" class="headerlink" title="non-finalçš„ç±»å˜é‡"></a>non-finalçš„ç±»å˜é‡</h3><ul><li>é™æ€å˜é‡å’Œç±»å…³è”åœ¨ä¸€èµ·ï¼Œéšç€ç±»çš„åŠ è½½è€ŒåŠ è½½ï¼Œä»–ä»¬æˆä¸ºç±»æ•°æ®åœ¨é€»è¾‘ä¸Šçš„ä¸€éƒ¨åˆ†</li><li>ç±»å˜é‡è¢«ç±»çš„æ‰€æœ‰å®ä¾‹å…±äº«ï¼Œ<strong>å³ä½¿æ²¡æœ‰ç±»å®ä¾‹æ—¶ä¹Ÿå¯ä»¥è®¿é—®å®ƒ</strong></li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Order</span> order <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token comment">//</span>        <span class="token comment">// è¿™é‡Œä¸ä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸</span>        <span class="token comment">// å› ä¸ºç±»å˜é‡å³ä½¿æ²¡æœ‰ç±»å®ä¾‹ä¹Ÿèƒ½è®¿é—®ä»–</span>        <span class="token comment">//</span>        order<span class="token punctuation">.</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">Order</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> number <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¡¥å……è¯´æ˜ï¼šå…¨å±€å¸¸é‡ï¼šstatic final</p></blockquote><p>è¢«å£°æ˜ä¸ºfinalçš„ç±»å˜é‡çš„å¤„ç†æ–¹æ³•åˆ™ä¸åŒï¼Œæ¯ä¸ªå…¨å±€å¸¸é‡åœ¨ç¼–è¯‘çš„æ—¶å€™å°±è¢«åˆ†é…äº†ã€‚</p><p><img src="https://s1.ax1x.com/2020/10/11/0gRH10.png" alt="å…¨å±€å¸¸é‡"></p><h3 id="è¿è¡Œæ—¶å¸¸é‡æ± "><a href="#è¿è¡Œæ—¶å¸¸é‡æ± " class="headerlink" title="è¿è¡Œæ—¶å¸¸é‡æ± "></a><strong>è¿è¡Œæ—¶å¸¸é‡æ± </strong></h3><blockquote><p>è¿è¡Œæ—¶å¸¸é‡æ±  vs å¸¸é‡æ± </p></blockquote><ul><li>æ–¹æ³•åŒºï¼Œå†…éƒ¨åŒ…å«äº†è¿è¡Œæ—¶å¸¸é‡æ± </li><li>å­—èŠ‚ç æ–‡ä»¶ï¼Œå†…éƒ¨åŒ…å«äº†å¸¸é‡æ± </li><li>è¦å¼„æ¸…æ¥šæ–¹æ³•åŒºï¼Œéœ€è¦ç†è§£æ¸…æ¥šClassFileï¼Œå› ä¸ºåŠ è½½ç±»çš„ä¿¡æ¯éƒ½æ”¾åœ¨æ–¹æ³•åŒº</li><li>è¦å¼„æ¸…æ¥šæ–¹æ³•åŒºçš„è¿è¡Œæ—¶å¸¸é‡æ± ï¼Œéœ€è¦ç†è§£æ¸…æ¥šClassFileä¸­çš„å¸¸é‡æ± </li></ul><h4 id="å¸¸é‡æ± "><a href="#å¸¸é‡æ± " class="headerlink" title="å¸¸é‡æ± "></a>å¸¸é‡æ± </h4><p><img src="https://s1.ax1x.com/2020/10/11/0gWxr8.png" alt="0gWxr8.png"></p><p>ä¸€ä¸ªæœ‰æ•ˆçš„å­—èŠ‚ç æ–‡ä»¶ä¸­é™¤äº†åŒ…å«ç±»çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå­—æ®µï¼Œæ–¹æ³•ä»¥åŠæ¥å£ç­‰ï¼Œè¿˜éœ€è¦åŒ…å«ä¸€é¡¹ä¿¡æ¯å°±æ˜¯å¸¸é‡æ± è¡¨ï¼ŒåŒ…æ‹¬å„ç§å­—é¢é‡å’Œå¯¹ç±»å‹ã€åŸŸå’Œæ–¹æ³•çš„ç¬¦å·å¼•ç”¨</p><h4 id="è¿è¡Œæ—¶å¸¸é‡æ± -1"><a href="#è¿è¡Œæ—¶å¸¸é‡æ± -1" class="headerlink" title="è¿è¡Œæ—¶å¸¸é‡æ± "></a>è¿è¡Œæ—¶å¸¸é‡æ± </h4><blockquote><p>ç”¨äºå­˜æ”¾ç¼–è¯‘å™¨ç”Ÿæˆçš„å„ç§å­—é¢é‡ä¸ç¬¦å·å¼•ç”¨ï¼Œ<strong>è¿™éƒ¨åˆ†å†…å®¹å°†åœ¨ç±»åŠ è½½åå­˜æ”¾åˆ°æ–¹æ³•åŒºçš„è¿è¡Œæ—¶å¸¸é‡æ± ä¸­</strong></p><ul><li>è¿è¡Œæ—¶å¸¸é‡æ± ï¼Œåœ¨åŠ è½½ç±»å’Œæ¥å£åˆ°è™šæ‹Ÿæœºåï¼Œå°±ä¼šåˆ›å»ºå¯¹åº”çš„è¿è¡Œæ—¶å¸¸é‡æ± </li><li>jvmä¸ºæ¯ä¸ªå·²åŠ è½½çš„ç±»å‹ï¼ˆç±»æˆ–æ¥å£ï¼‰éƒ½ç»´æŠ¤ä¸€ä¸ªå¸¸é‡æ± ã€‚æ± ä¸­çš„æ•°æ®é¡¹åƒæ•°ç»„é¡¹ä¸€æ ·ï¼Œæ˜¯é€šè¿‡ç´¢å¼•è®¿é—®çš„ã€‚</li><li>è¿è¡Œæ—¶å¸¸é‡æ± ä¸­åŒ…å«å¤šç§ä¸åŒçš„å¸¸é‡ï¼ŒåŒ…æ‹¬ç¼–è¯‘å™¨å°±å·²ç»æ˜ç¡®çš„æ•°å€¼å­—é¢é‡ï¼Œä¹ŸåŒ…æ‹¬åˆ°è¿è¡ŒæœŸè§£æåæ‰è·å¾—çš„æ–¹æ³•æˆ–è€…å­—æ®µå¼•ç”¨ã€‚æ­¤æ—¶ä¸å†æ˜¯å¸¸é‡æ± ä¸­çš„ç¬¦å·åœ°å€äº†ï¼Œè¿™é‡Œæ¢ä¸ºçœŸå®åœ°å€ã€‚<ul><li>è¿è¡Œæ—¶å¸¸é‡æ± ï¼Œç›¸å¯¹äºClassæ–‡ä»¶å¸¸é‡æ± çš„å¦ä¸€ä¸ªé‡è¦ç‰¹å¾æ˜¯ï¼šå…·å¤‡åŠ¨æ€æ€§</li></ul></li><li>è¿è¡Œæ—¶å¸¸é‡æ± ç±»ä¼¼äºä¼ ç»Ÿç¼–ç¨‹è¯­è¨€ä¸­çš„ç¬¦å·è¡¨ï¼Œä½†æ˜¯å®ƒæ‰€åŒ…å«çš„æ•°æ®å´æ¯”ç¬¦å·è¡¨è¿˜è¦ä¸°å¯Œä¸€äº›ã€‚</li><li>å½“åˆ›å»ºçš„ç±»æˆ–æ¥å£çš„è¿è¡Œæ—¶å¸¸é‡æ± æ—¶ï¼Œå¦‚æœæ„é€ è¿è¡Œæ—¶å¸¸é‡æ± æ‰€éœ€çš„å†…å­˜ç©ºé—´è¶…è¿‡äº†æ–¹æ³•åŒºæ‰€èƒ½æä¾›çš„æœ€å¤§å€¼ï¼Œåˆ™JVMä¼šæŠ›OOM</li></ul></blockquote><h2 id="æ–¹æ³•åŒºçš„æ¼”è¿›"><a href="#æ–¹æ³•åŒºçš„æ¼”è¿›" class="headerlink" title="æ–¹æ³•åŒºçš„æ¼”è¿›"></a>æ–¹æ³•åŒºçš„æ¼”è¿›</h2><ol><li><p>åªæœ‰<strong>HotSpot</strong>æ‰æœ‰æ°¸ä¹…ä»£</p></li><li><p>HotSpotæ–¹æ³•åŒºçš„å˜åŒ–ï¼š</p><table><thead><tr><th align="center">jdkç‰ˆæœ¬</th><th align="center">å˜åŒ–</th></tr></thead><tbody><tr><td align="center">jdk1.6åŠä»¥å‰</td><td align="center">æœ‰æ°¸ä¹…ä»£ï¼Œé™æ€å˜é‡æ”¾åœ¨æ°¸ä¹…ä»£ä¸Š</td></tr><tr><td align="center">jdk1.7</td><td align="center">æœ‰æ°¸ä¹…ä»£ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œé™æ€å˜é‡ç§»é™¤ï¼Œä¿å­˜åœ¨å †ä¸­</td></tr><tr><td align="center">jdk1.8åŠä»¥å</td><td align="center">æ— æ°¸ä¹…ä»£ï¼Œç±»å‹ä¿¡æ¯ï¼Œå­—æ®µï¼Œæ–¹æ³•ï¼Œå¸¸é‡ä¿å­˜åœ¨æœ¬åœ°å†…å­˜çš„å…ƒç©ºé—´ã€‚<strong>ä½†å­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œé™æ€å˜é‡ä»åœ¨å †ä¸­</strong></td></tr></tbody></table><p><img src="https://s1.ax1x.com/2020/10/14/05M00K.png" alt="1.6"></p></li></ol><p>   <img src="https://s1.ax1x.com/2020/10/14/05Mh0f.png" alt="1.7"></p><p><img src="https://s1.ax1x.com/2020/10/14/05MHpj.png" alt="1.8"></p><blockquote><p>é—®é¢˜ï¼š<strong>ä¸ºä»€ä¹ˆæ°¸ä¹…ä»£è¦è¢«æ›¿æ¢æˆå…ƒç©ºé—´ï¼Ÿ</strong></p></blockquote><ol><li>é¦–å…ˆï¼Œæ–¹æ³•åŒºçš„å¤§å°æ˜¯éš¾ä»¥ç¡®å®šä¸‹æ¥çš„ï¼Œå¦‚æœæˆ‘ä»¬ä¸€å¼€å§‹è®¾å®šäº†æ–¹æ³•åŒºçš„å¤§å°ï¼Œé‚£ä¹ˆæ˜¯ä¼šå®¹æ˜“å‡ºç°full gcçš„ï¼Œæˆ‘ä»¬çŸ¥é“full gcæ˜¯ååˆ†è€—è´¹æ—¶é—´çš„ï¼Œè€Œä¸”ï¼Œå¦‚æœfull gcç»“æŸåï¼Œè¿˜æ˜¯æ”¾ä¸ä¸‹ï¼Œå°±ä¼šå‡ºç°OOMã€‚</li><li>å…¶æ¬¡ï¼Œæ”¾åœ¨æœ¬åœ°å†…å­˜ï¼Œå®ƒåªå—æœ¬åœ°å†…å­˜é™åˆ¶ï¼Œå¤§å¤§é™ä½äº†gcçš„é¢‘ç‡ã€‚</li></ol><blockquote><p>é—®é¢˜ï¼š<strong>å…ƒç©ºé—´æ˜¯å¦‚ä½•GCçš„</strong></p></blockquote><p><strong>MetaspaceSize</strong>æ˜¯ metaspaceGCå‘ç”Ÿçš„åˆå§‹é˜ˆå€¼ï¼Œä¹Ÿæ˜¯æœ€å°é˜ˆå€¼ï¼Œé»˜è®¤20.8Må·¦å³ï¼Œä¸ä¹‹å¯¹æ¯”çš„ä¸»è¦æ˜¯æŒ‡Klass Metaspaceä¸NoKlass Metaspaceä¸¤å—committedçš„å†…å­˜å’Œã€‚</p><ul><li>è§¦å‘metaspaceGCçš„é˜ˆå€¼æ˜¯ä¸æ–­å˜åŒ–çš„ï¼šå½“å…ƒç©ºé—´è§¦å‘gcçš„æ—¶å€™ï¼Œä¼šå›æ”¶ä¸€äº›åƒåœ¾ï¼Œå¦‚æœå›æ”¶äº†å¤§é‡çš„åƒåœ¾ï¼Œè¿™ä¸ªé˜ˆå€¼å°±ä¼šç›¸åº”çš„é™ä½ä¸€ç‚¹ï¼Œå¦‚æœåªå›æ”¶äº†å°‘é‡çš„åƒåœ¾ï¼Œé‚£ä¹ˆè¿™ä¸ªé˜ˆå€¼ä¼šé€‚å½“çš„å¢åŠ ä¸€ç‚¹ã€‚ç›®çš„å°±æ˜¯ä¸ºäº†é™ä½gcé¢‘ç‡</li></ul><p><strong>é™æ€å˜é‡çš„å­˜æ”¾ä½ç½®</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StaticObjTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;</span>        <span class="token comment">// é™æ€å†…éƒ¨ç±»å¯¹è±¡</span>        <span class="token keyword">static</span> <span class="token class-name">ObjectHolder</span> staticObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// å†…éƒ¨ç±»å¯¹è±¡</span>        <span class="token class-name">ObjectHolder</span> instanceObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">// åœ¨æ–¹æ³•ä¸­çš„å†…éƒ¨ç±»å¯¹è±¡</span>            <span class="token class-name">ObjectHolder</span> localObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectHolder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"done"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ObjectHolder</span><span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Test</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StaticObjTest<span class="token punctuation">.</span>Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        t<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/10/14/05olkR.png" alt="05olkR.png"></p><blockquote><p>æµ‹è¯•å‘ç°ï¼Œä¸‰ä¸ªå¯¹è±¡çš„æ•°æ®åœ¨å†…å­˜ä¸­çš„åœ°å€éƒ½è½åœ¨EdenåŒºèŒƒå›´å†…ï¼Œæ‰€ä»¥ç»“è®ºï¼šåªè¦æ˜¯å¯¹è±¡å®ä¾‹ï¼Œå¿…ç„¶ä¼šåœ¨javaå †ä¸­åˆ†é…</p></blockquote><h2 id="æ–¹æ³•åŒºçš„åƒåœ¾ç»†èŠ‚"><a href="#æ–¹æ³•åŒºçš„åƒåœ¾ç»†èŠ‚" class="headerlink" title="æ–¹æ³•åŒºçš„åƒåœ¾ç»†èŠ‚"></a>æ–¹æ³•åŒºçš„åƒåœ¾ç»†èŠ‚</h2><blockquote><p><strong>æ–¹æ³•åŒºçš„åƒåœ¾æ”¶é›†ä¸»è¦å›æ”¶ä¸¤éƒ¨åˆ†å†…å®¹ï¼šå¸¸é‡æ± ä¸­åºŸå¼ƒçš„å¸¸é‡å’Œä¸å†ä½¿ç”¨çš„ç±»å‹</strong></p></blockquote><h2 id="æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶"><a href="#æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶" class="headerlink" title="æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶"></a>æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶</h2><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><img src="https://s1.ax1x.com/2020/10/14/05jAhQ.png" alt="è¿è¡Œæ—¶æ•°æ®åŒº"></p><h2 id="é¢è¯•é¢˜"><a href="#é¢è¯•é¢˜" class="headerlink" title="é¢è¯•é¢˜"></a>é¢è¯•é¢˜</h2><h3 id="ç™¾åº¦"><a href="#ç™¾åº¦" class="headerlink" title="ç™¾åº¦"></a>ç™¾åº¦</h3><blockquote><p>ä¸‰é¢ï¼šè¯´ä¸€ä¸‹JVMå†…å­˜æ¨¡å‹å§ï¼Œæœ‰å“ªäº›åŒºï¼Ÿåˆ†åˆ«å¹²ä»€ä¹ˆçš„ï¼Ÿ</p></blockquote><h3 id="èš‚èšé‡‘æœ"><a href="#èš‚èšé‡‘æœ" class="headerlink" title="èš‚èšé‡‘æœ"></a>èš‚èšé‡‘æœ</h3><blockquote><ul><li>java8çš„å†…å­˜åˆ†ä»£æ”¹è¿›</li><li>jvmå†…å­˜åˆ†ä¸ºå“ªå‡ ä¸ªåŒºï¼Ÿæ¯ä¸ªåŒºçš„ä½œç”¨æ˜¯ä»€ä¹ˆ</li><li>ä¸€é¢ï¼šJVMå†…å­˜åˆ†å¸ƒ/å†…å­˜ç»“æ„ï¼Ÿæ ˆå’Œå †çš„åŒºåˆ«ï¼Ÿå †çš„ç»“æ„ï¼Ÿä¸ºä»€ä¹ˆä¸¤ä¸ªsurvivoråŒºï¼Ÿ</li><li>äºŒé¢ï¼šEdenå’ŒSurviorçš„æ¯”ä¾‹åˆ†é…</li></ul></blockquote><h3 id="å°ç±³"><a href="#å°ç±³" class="headerlink" title="å°ç±³"></a>å°ç±³</h3><blockquote><p>JVMå†…å­˜åˆ†åŒºï¼Œä¸ºä»€ä¹ˆè¦æœ‰æ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Ÿ</p></blockquote><h3 id="å­—èŠ‚è·³åŠ¨"><a href="#å­—èŠ‚è·³åŠ¨" class="headerlink" title="å­—èŠ‚è·³åŠ¨"></a>å­—èŠ‚è·³åŠ¨</h3><blockquote><p>äºŒé¢ï¼šJVMçš„å†…å­˜åˆ†åŒºï¼Ÿ</p><p>äºŒé¢ï¼šè®²è®²JVMè¿è¡Œæ—¶æ•°æ®åº“åŒº</p><p>ä»€ä¹ˆæ—¶å€™å¯¹è±¡ä¼šè¿›å…¥è€å¹´ä»£ï¼Ÿ</p></blockquote><h3 id="äº¬ä¸œ"><a href="#äº¬ä¸œ" class="headerlink" title="äº¬ä¸œ"></a>äº¬ä¸œ</h3><blockquote><p>JVMçš„å†…å­˜ç»“æ„ï¼ŒEdenå’ŒSurvivoræ¯”ä¾‹</p><p>JVMå†…å­˜ä¸ºä»€ä¹ˆè¦åˆ†æˆæ–°ç”Ÿä»£ï¼Œè€å¹´ä»£ï¼ŒæŒä¹…ä»£ã€‚æ–°ç”Ÿä»£ä¸­ä¸ºä»€ä¹ˆè¦åˆ†ä¸ºEdenå’ŒSurvivor</p></blockquote><h3 id="å¤©çŒ«"><a href="#å¤©çŒ«" class="headerlink" title="å¤©çŒ«"></a>å¤©çŒ«</h3><blockquote><p>JVMå†…å­˜æ¨¡å‹ä»¥åŠåˆ†åŒºï¼Œéœ€è¦è¯¦ç»†åˆ°æ¯ä¸ªåˆ†åŒºæ”¾ä»€ä¹ˆ</p><p>JVMçš„å†…å­˜æ¨¡å‹ï¼Œjava8åšäº†ä»€ä¹ˆä¿®æ”¹</p></blockquote><h3 id="æ‹¼å¤•å¤•"><a href="#æ‹¼å¤•å¤•" class="headerlink" title="æ‹¼å¤•å¤•"></a>æ‹¼å¤•å¤•</h3><blockquote><p>JVMå†…å­˜åˆ†å“ªå‡ ä¸ªåŒºï¼Œæ¯ä¸ªåŒºçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><h3 id="ç¾å›¢"><a href="#ç¾å›¢" class="headerlink" title="ç¾å›¢"></a>ç¾å›¢</h3><blockquote><p>javaå†…å­˜åˆ†é…</p><p>jvmçš„æ°¸ä¹…ä»£ä¸­ä¼šå‘ç”Ÿåƒåœ¾å›æ”¶å—ï¼Ÿ</p><p>jvmå†…å­˜åˆ†åŒºï¼Œä¸ºä»€ä¹ˆè¦æœ‰æ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Ÿ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> jvm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JVM04</title>
      <link href="2020/10/11/jvm05/"/>
      <url>2020/10/11/jvm05/</url>
      
        <content type="html"><![CDATA[<h1 id="å¯¹è±¡çš„å®ä¾‹åŒ–å†…å­˜å¸ƒå±€ä¸è®¿é—®å®šä½"><a href="#å¯¹è±¡çš„å®ä¾‹åŒ–å†…å­˜å¸ƒå±€ä¸è®¿é—®å®šä½" class="headerlink" title="å¯¹è±¡çš„å®ä¾‹åŒ–å†…å­˜å¸ƒå±€ä¸è®¿é—®å®šä½"></a>å¯¹è±¡çš„å®ä¾‹åŒ–å†…å­˜å¸ƒå±€ä¸è®¿é—®å®šä½</h1><h2 id="å¯¹è±¡çš„å®ä¾‹åŒ–"><a href="#å¯¹è±¡çš„å®ä¾‹åŒ–" class="headerlink" title="å¯¹è±¡çš„å®ä¾‹åŒ–"></a>å¯¹è±¡çš„å®ä¾‹åŒ–</h2><p><strong>å¼•å­</strong></p><blockquote><p>ç¾å›¢ï¼š</p><ul><li>å¯¹è±¡åœ¨JVMä¸­æ˜¯æ€ä¹ˆå­˜å‚¨çš„ï¼Ÿ</li><li>å¯¹è±¡å¤´ä¿¡æ¯é‡Œé¢æœ‰å“ªäº›ä¸œè¥¿ï¼Ÿ</li></ul><p>èš‚èšé‡‘æœï¼š</p><ul><li>javaå¯¹è±¡å¤´é‡Œé¢æœ‰ä»€ä¹ˆï¼Ÿ</li></ul></blockquote><h3 id="å¯¹è±¡åˆ›å»ºçš„æ–¹å¼"><a href="#å¯¹è±¡åˆ›å»ºçš„æ–¹å¼" class="headerlink" title="å¯¹è±¡åˆ›å»ºçš„æ–¹å¼"></a>å¯¹è±¡åˆ›å»ºçš„æ–¹å¼</h3><p><img src="https://s1.ax1x.com/2020/10/14/0IsZTO.png" alt="å¯¹è±¡çš„åˆ›å»ºæ–¹å¼"></p><p><strong>ä¸ºå¯¹è±¡åˆ†é…å†…å­˜</strong>ï¼š</p><p><img src="https://s1.ax1x.com/2020/10/14/0I23o6.png" alt="åˆ›å»ºå¯¹è±¡çš„æ­¥éª¤"></p><ul><li>åŠ è½½ç±»å…ƒä¿¡æ¯</li><li>ä¸ºå¯¹è±¡åˆ†é…å†…å­˜</li><li>å¤„ç†å¹¶å‘é—®é¢˜</li><li>å±æ€§çš„é»˜è®¤åˆå§‹åŒ–ï¼ˆé›¶å€¼åˆå§‹åŒ–ï¼‰</li><li>è®¾ç½®å¤´ä¿¡æ¯</li><li>å±æ€§çš„æ˜¾ç¤ºåˆå§‹åŒ–ï¼Œä»£ç å—åˆå§‹åŒ–ï¼Œæ„é€ å™¨åˆå§‹åŒ–</li></ul><h2 id="å¯¹è±¡çš„å†…å­˜å¸ƒå±€"><a href="#å¯¹è±¡çš„å†…å­˜å¸ƒå±€" class="headerlink" title="å¯¹è±¡çš„å†…å­˜å¸ƒå±€"></a>å¯¹è±¡çš„å†…å­˜å¸ƒå±€</h2><h3 id="å¯¹è±¡å¤´"><a href="#å¯¹è±¡å¤´" class="headerlink" title="å¯¹è±¡å¤´"></a>å¯¹è±¡å¤´</h3><blockquote><p><strong>è¿è¡Œæ—¶å…ƒæ•°æ®</strong></p></blockquote><ul><li>å“ˆå¸Œå€¼ï¼ˆHashCodeï¼‰</li><li>GCåˆ†ä»£å¹´é¾„ï¼ˆå¹´é¾„è®¡æ•°å™¨ï¼‰</li><li>é”çŠ¶æ€æ ‡å¿—</li><li>çº¿ç¨‹æ± æœ‰çš„é”</li><li>åå‘çº¿ç¨‹id</li><li>åå‘æ—¶é—´æˆ³</li></ul><blockquote><p><strong>ç±»å‹æŒ‡é’ˆ</strong>ï¼ˆå¹¶ä¸æ˜¯æ‰€æœ‰çš„å¯¹è±¡éƒ½æœ‰ï¼‰</p></blockquote><p>æŒ‡å‘ç±»å…ƒæ•°æ®InstanceKlassï¼Œç¡®å®šè¯¥å¯¹è±¡æ‰€å±çš„ç±»å‹</p><blockquote><p>å¦‚æœæ˜¯<strong>æ•°ç»„</strong>ï¼Œè¿˜è¦<strong>è®°å½•æ•°ç»„çš„é•¿åº¦</strong></p></blockquote><h3 id="å®ä¾‹æ•°æ®"><a href="#å®ä¾‹æ•°æ®" class="headerlink" title="å®ä¾‹æ•°æ®"></a>å®ä¾‹æ•°æ®</h3><blockquote><p>ä»–æ˜¯å¯¹è±¡çœŸæ­£å­˜å‚¨çš„æœ‰æ•ˆä¿¡æ¯ï¼ŒåŒ…æ‹¬ç¨‹åºä»£ç ä¸­å®šä¹‰çš„å„ç§ç±»å‹çš„å­—æ®µï¼ˆåŒ…æ‹¬ä»çˆ¶ç±»ç»§æ‰¿ä¸‹æ¥çš„å’Œæœ¬èº«æ‹¥æœ‰çš„å­—æ®µï¼‰</p></blockquote><p><strong>è§„åˆ™</strong></p><ul><li>ç›¸åŒå®½åº¦çš„å­—æ®µæ€»æ˜¯è¢«åˆ†é…åœ¨ä¸€èµ·</li><li>çˆ¶ç±»ä¸­å®šä¹‰çš„å˜é‡ä¼šå‡ºç°åœ¨å­ç±»ä¹‹å‰</li><li>å¦‚æœCompactFiledså‚æ•°ä¸ºtrueï¼ˆé»˜è®¤trueï¼‰ï¼šå­ç±»çš„çª„å˜é‡å¯èƒ½æ’å…¥åˆ°çˆ¶ç±»å˜é‡çš„ç©ºéš™</li></ul><h3 id="å¯¹é½å¡«å……"><a href="#å¯¹é½å¡«å……" class="headerlink" title="å¯¹é½å¡«å……"></a>å¯¹é½å¡«å……</h3><blockquote><p>ä¸æ˜¯å¿…é¡»çš„ï¼Œä»…ä»…èµ·åˆ°å ä½ç¬¦çš„ä½œç”¨</p></blockquote><h3 id="å†…å­˜å¸ƒå±€"><a href="#å†…å­˜å¸ƒå±€" class="headerlink" title="å†…å­˜å¸ƒå±€"></a>å†…å­˜å¸ƒå±€</h3><p>æ¡ˆä¾‹ä»£ç ï¼š</p><p><img src="https://s1.ax1x.com/2020/10/15/0oHn0O.png" alt="0oHn0O.png"></p><p>åˆ†æï¼š</p><p><img src="https://s1.ax1x.com/2020/10/15/0oIpin.png" alt="0oIpin.png"></p><h2 id="å¯¹è±¡çš„è®¿é—®å®šä½"><a href="#å¯¹è±¡çš„è®¿é—®å®šä½" class="headerlink" title="å¯¹è±¡çš„è®¿é—®å®šä½"></a>å¯¹è±¡çš„è®¿é—®å®šä½</h2><blockquote><p>JVMæ˜¯å¦‚ä½•é€šè¿‡æ ˆå¸§ä¸­çš„å¯¹è±¡å¼•ç”¨è®¿é—®åˆ°å…¶å†…éƒ¨çš„å¯¹è±¡å®ä¾‹çš„ï¼Ÿ</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/15/0ob854.png"></p><p>æ ˆå¸§ä¸Šé€šè¿‡referenceè®¿é—®å †åŒºåˆ›å»ºçš„é‚£ä¸ªå¯¹è±¡</p><h4 id="å¯¹è±¡è®¿é—®æ–¹å¼"><a href="#å¯¹è±¡è®¿é—®æ–¹å¼" class="headerlink" title="å¯¹è±¡è®¿é—®æ–¹å¼"></a>å¯¹è±¡è®¿é—®æ–¹å¼</h4><blockquote><p>å¥æŸ„è®¿é—®</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/15/0obIIg.png" alt="å›¾ç¤º"></p><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>referenceä¸­å­˜å‚¨ç¨³å®šçš„å¥æŸ„åœ°å€ï¼Œå¯¹è±¡åœ¨å †ç©ºé—´ä¸­è¢«ç§»åŠ¨æ—¶<strong>åªä¼šæ”¹å˜å¥æŸ„ä¸­å®ä¾‹æ•°æ®æŒ‡é’ˆ</strong>ï¼Œreferenceæœ¬èº«ä¸éœ€è¦æ”¹å˜ã€‚</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>éœ€è¦åœ¨å †å†…å­˜ä¸­å¼€è¾Ÿä¸€å—ç©ºé—´æ¥è®°å½•å¥æŸ„ï¼Œæµªè´¹ç©ºé—´ï¼Œè¿˜é€Ÿåº¦æ…¢</li></ul><blockquote><p>ç›´æ¥æŒ‡é’ˆï¼ˆHotspoté‡‡ç”¨çš„å°±æ˜¯è¿™ç§ï¼‰</p></blockquote><p><a href="https://imgchr.com/i/0oqksx"><img src="https://s1.ax1x.com/2020/10/15/0oqksx.png" alt="å›¾ç¤º"></a></p><h2 id="ç›´æ¥å†…å­˜"><a href="#ç›´æ¥å†…å­˜" class="headerlink" title="ç›´æ¥å†…å­˜"></a>ç›´æ¥å†…å­˜</h2><blockquote><p>ç›´æ¥å†…å­˜æ˜¯javaå †å¤–çš„ã€ç›´æ¥å‘ç³»ç»Ÿç”³è¯·çš„å†…å­˜åŒºé—´</p><ul><li>æ¥æºäº<strong>NIO</strong>ï¼Œé€šè¿‡å­˜åœ¨å †ä¸­çš„<code>DirectByteBuffer</code>æ“ä½œnativeå†…å­˜</li></ul></blockquote><p>é€šè¿‡ByteBufferçš„allocateDirect()å¯ä»¥ç›´æ¥ç”³è¯·æœ¬åœ°å†…å­˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡System.gc()å›æ”¶æœ¬åœ°å†…å­˜</p><p><img src="https://s1.ax1x.com/2020/10/15/0TAOZF.png" alt="0TAOZF.png"></p><blockquote><ul><li>é€šå¸¸ï¼Œ<strong>NIO</strong>è®¿é—®ç›´æ¥å†…å­˜çš„é€Ÿåº¦ä¼šä¼˜äºjavaå †ã€‚è¯»å†™æ€§èƒ½é«˜<ul><li>å‡ºäºæ€§èƒ½çš„è€ƒè™‘ï¼Œè¯»å†™é¢‘ç¹çš„åœºåˆå¯èƒ½ä¼šè€ƒè™‘ä½¿ç”¨ç›´æ¥å†…å­˜</li><li>javaçš„<strong>nioåº“å…è®¸javaç¨‹åºç›´æ¥ä½¿ç”¨å†…å­˜ï¼Œç”¨äºæ•°æ®ç¼“å†²åŒº</strong></li></ul></li></ul></blockquote><p><img src="https://s1.ax1x.com/2020/10/15/0TZyx1.png" alt="0TZyx1.png"></p><blockquote><p>ç›´æ¥å†…å­˜æ¦‚è¿°:</p></blockquote><ul><li>å¯èƒ½å¯¼è‡´OOMå¼‚å¸¸<ul><li>ç”±äºç›´æ¥å†…å­˜åœ¨javaå †å¤–ï¼Œå› æ­¤ä»–çš„å¤§å°ä¸ä¼šå—-XmxæŒ‡å®šçš„æœ€å¤§å †å¤§å°ï¼Œä½†æ˜¯ç³»ç»Ÿå†…å­˜æ˜¯æœ‰é™çš„ï¼Œjavaå †å’Œç›´æ¥å†…å­˜çš„æ€»å’Œä¾ç„¶å—é™äºæ“ä½œç³»ç»Ÿèƒ½ç»™å‡ºçš„æœ€å¤§å†…å­˜ã€‚</li></ul></li><li>ç¼ºç‚¹ï¼š<ul><li>å›æ”¶æˆæœ¬é«˜</li><li>ä¸å—JVMåƒåœ¾å›æ”¶ç®¡ç†</li></ul></li><li><strong>ç›´æ¥å†…å­˜å¯ä»¥é€šè¿‡ MaxDirectMemorySize æ¥è®¾ç½®</strong></li><li>å¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤ä¸å †çš„æœ€å¤§å€¼-Xmxå‚æ•°å€¼ä¸€è‡´</li></ul><p><img src="https://s1.ax1x.com/2020/10/16/0HpO3V.png" alt="ç›´æ¥å†…å­˜æº¢å‡ºä¾‹å­"></p><blockquote><p>java process memory = java heap + native memory</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> jvm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JVM03</title>
      <link href="2020/10/09/jvm03/"/>
      <url>2020/10/09/jvm03/</url>
      
        <content type="html"><![CDATA[<h1 id="å †"><a href="#å †" class="headerlink" title="å †"></a>å †</h1><blockquote><p>çº¿ç¨‹å…±äº«å †ç©ºé—´å’Œæ–¹æ³•åŒº</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/09/0rsWgs.png" alt="å †"></p><h2 id="å †çš„æ ¸å¿ƒæ¦‚è¿°"><a href="#å †çš„æ ¸å¿ƒæ¦‚è¿°" class="headerlink" title="å †çš„æ ¸å¿ƒæ¦‚è¿°"></a>å †çš„æ ¸å¿ƒæ¦‚è¿°</h2><blockquote><p>ä¸€ä¸ªJVMå®ä¾‹åªå­˜åœ¨ä¸€ä¸ªå †å†…å­˜ï¼Œå †ä¹Ÿæ˜¯javaå†…å­˜ç®¡ç†çš„æ ¸å¿ƒåŒºåŸŸ</p><ul><li>javaå †åŒºåœ¨<strong>jvmå¯åŠ¨çš„æ—¶å€™åˆ›å»º</strong>ï¼Œå…¶<strong>ç©ºé—´å¤§å°ä¹Ÿå°±ç¡®å®šäº†</strong>ï¼ˆå¯ä»¥è¢«è°ƒèŠ‚ï¼‰ã€‚æ˜¯JVMç®¡ç†çš„æœ€å¤§ä¸€å—å†…å­˜ç©ºé—´</li><li>å †å¯ä»¥<strong>å¤„äºç‰©ç†ä¸Šä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ï¼Œä½†åœ¨é€»è¾‘ä¸Šæ˜¯è¿ç»­çš„</strong></li><li>æ‰€æœ‰çº¿ç¨‹å…±äº«å †ï¼Œåœ¨è¿™é‡Œè¿˜å¯ä»¥åˆ’åˆ†çº¿ç¨‹ç§æœ‰çš„ç¼“å†²åŒº(TLAB)</li></ul></blockquote><ul><li><p>æ•°ç»„å’Œå¯¹è±¡å¯èƒ½æ°¸è¿œä¸ä¼šå­˜å‚¨åœ¨æ ˆä¸Šï¼Œå› ä¸ºæ ˆå¸§ä¸­ä¿å­˜å¼•ç”¨ï¼Œè¿™ä¸ªå¼•ç”¨æŒ‡å‘å¯¹è±¡æˆ–è€…æ•°ç»„åœ¨æ ˆä¸­çš„ä½ç½®</p></li><li><p>åœ¨æ–¹æ³•ç»“æŸåï¼Œå †ä¸­çš„å¯¹è±¡ä¸ä¼šé©¬ä¸Šè¢«ç§»é™¤ï¼Œä»…ä»…åœ¨åƒåœ¾æ”¶é›†çš„æ—¶å€™æ‰ä¼šè¢«ç§»é™¤</p></li><li><p>å †æ˜¯GCæ‰§è¡Œåƒåœ¾å›æ”¶çš„é‡ç‚¹åŒºåŸŸ</p></li></ul><h2 id="è®¾ç½®å †å†…å­˜å¤§å°ä¸OOM"><a href="#è®¾ç½®å †å†…å­˜å¤§å°ä¸OOM" class="headerlink" title="è®¾ç½®å †å†…å­˜å¤§å°ä¸OOM"></a>è®¾ç½®å †å†…å­˜å¤§å°ä¸OOM</h2><h3 id="å†…å­˜ç»†åˆ†"><a href="#å†…å­˜ç»†åˆ†" class="headerlink" title="å†…å­˜ç»†åˆ†"></a>å†…å­˜ç»†åˆ†</h3><blockquote><p>ç°ä»£åƒåœ¾æ”¶é›†å™¨å¤§éƒ¨åˆ†éƒ½åŸºäºåˆ†ä»£æ”¶é›†ç†è®ºè®¾è®¡ï¼Œå †ç©ºé—´ç»†åˆ†ä¸ºï¼š</p><p><strong>java7ä»¥åŠä¹‹å‰</strong>åˆ†ä¸º <strong>æ–°ç”ŸåŒº+å…»è€åŒº+æ°¸ä¹…åŒº</strong></p><p><strong>java8åŠä»¥å</strong>åˆ†ä¸º <strong>æ–°ç”ŸåŒº</strong>+<strong>å…»è€åŒº</strong>+<strong>å…ƒç©ºé—´</strong></p></blockquote><p><img src="https://s1.ax1x.com/2020/10/09/0rRPc4.png" alt="åˆ†ä»£ç†è®º"></p><blockquote><p><strong>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æˆ‘ä»¬é€šå¸¸å°†åˆå§‹åŒ–å †å†…å­˜å’Œæœ€å¤§çš„å †å†…å­˜è®¾ç½®æˆç›¸åŒçš„å€¼</strong>ï¼Œé˜²æ­¢ä¸æ–­çš„æ‰©å®¹ï¼ŒGCï¼Œå¯¼è‡´ç”¨æˆ·çº¿ç¨‹é˜»å¡ã€‚</p></blockquote><ul><li>-Xms å †çš„åˆå§‹åŒ–å†…å­˜</li><li>-Xmx å †çš„æœ€å¤§å†…å­˜</li></ul><h3 id="OOMä¸¾ä¾‹"><a href="#OOMä¸¾ä¾‹" class="headerlink" title="OOMä¸¾ä¾‹"></a>OOMä¸¾ä¾‹</h3><p><img src="https://s1.ax1x.com/2020/10/10/0ykSts.png" alt="0ykSts.png"></p><p><img src="https://s1.ax1x.com/2020/10/10/0yF8Fs.png" alt="ç›‘æ§"></p><h2 id="å¹´è½»ä»£ä¸è€å¹´ä»£"><a href="#å¹´è½»ä»£ä¸è€å¹´ä»£" class="headerlink" title="å¹´è½»ä»£ä¸è€å¹´ä»£"></a>å¹´è½»ä»£ä¸è€å¹´ä»£</h2><blockquote><p>javaå †ç©ºé—´åˆ†ä¸º  <strong>å¹´è½»ä»£</strong>ï¼Œ<strong>è€å¹´ä»£</strong></p><p>å¹´è½»ä»£å¯ä»¥åˆ’åˆ†ä¸º **ä¼Šç”¸å›­åŒº(Edenç©ºé—´)**ï¼Œå¹¸å­˜è€…0åŒºï¼Œå¹¸å­˜è€…1åŒºï¼ˆæœ‰æ—¶ä¹Ÿå«åšfromåŒºï¼ŒtoåŒºï¼‰</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/10/0ykhvV.png" alt="åˆ†åŒº"></p><blockquote><p>é…ç½®æ–°ç”Ÿä»£ä¸è€å¹´ä»£çš„ç»“æ„æ¯”</p></blockquote><ul><li>é»˜è®¤ -XX:NewRatio = 2 è¡¨ç¤ºæ–°ç”Ÿä»£å 1ï¼Œè€å¹´ä»£å 2ï¼Œæ–°ç”Ÿä»£å æ•´ä¸ªå †çš„1/3</li><li>å¯ä»¥ä¿®æ”¹ -XX:NewRatio = 4 è¡¨ç¤ºæ–°ç”Ÿä»£å 1ï¼Œè€å¹´ä»£å 4ï¼Œæ–°ç”Ÿä»£å æ•´ä¸ªå †çš„1/5</li></ul><blockquote><p>æ–°ç”Ÿä»£ä¸­å„ä¸ªéƒ¨åˆ†çš„æ¯”ä¾‹</p></blockquote><p>ä¼Šç”¸å›­åŒºï¼šå¹¸å­˜è€…0åŒºï¼šå¹¸å­˜è€…1åŒºçš„æ¯”ä¾‹é»˜è®¤ä¸ºï¼š8ï¼š1ï¼š1</p><p><strong>è®¾ç½®æ–°ç”Ÿä»£ä¸­ä¼Šç”¸å›­åŒºå’Œå¹¸å­˜è€…åŒºçš„æ¯”ä¾‹</strong></p><ul><li><code>-XX:SurvivorRatio = 8 </code>å¯ä»¥æ˜¾ç¤ºçš„è®¾ç½®æ¯”ä¾‹ä¸º8ï¼š1ï¼š1</li></ul><blockquote><ul><li><p><strong>å‡ ä¹æ‰€æœ‰çš„</strong>javaå¯¹è±¡éƒ½æ˜¯åœ¨ä¼Šç”¸å›­åŒºè¢«newå‡ºæ¥çš„</p></li><li><p>ç»å¤§éƒ¨åˆ†çš„javaå¯¹è±¡çš„é”€æ¯éƒ½åœ¨æ–°ç”Ÿä»£è¿›è¡Œäº†</p><ul><li>æœ‰ä¸“é—¨ç ”ç©¶è¡¨æ˜ 80%çš„å¯¹è±¡éƒ½æ˜¯æ´»ä¸ä¹…çš„</li></ul></li><li><p>å¯ä»¥ä½¿ç”¨å‚æ•° <code>-Xmn</code>è®¾ç½®æ–°ç”Ÿä»£æœ€å¤§å†…å­˜å¤§å°ï¼ˆä¸€èˆ¬é»˜è®¤ï¼‰</p></li></ul></blockquote><h2 id="å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹"><a href="#å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹" class="headerlink" title="å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹"></a>å›¾è§£å¯¹è±¡åˆ†é…è¿‡ç¨‹</h2><blockquote><ol><li>new çš„å¯¹è±¡å…ˆæ”¾åœ¨ä¼Šç”¸å›­åŒºï¼Œæ­¤åŒºæœ‰å¤§å°é™åˆ¶</li><li>å½“ä¼Šç”¸å›­åŒºçš„ç©ºé—´å¡«æ»¡æ—¶ï¼Œç¨‹åºåˆè¦åˆ›å»ºå¯¹è±¡ï¼Œjvmçš„åƒåœ¾å›æ”¶å™¨å°†å¯¹ä¼Šç”¸å›­åŒºè¿›è¡ŒGCï¼Œå°†ä¼Šç”¸å›­åŒºä¸­<strong>ä¸å†è¢«å…¶ä»–å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œé”€æ¯</strong>ã€‚å¹¶æŠŠä¼Šç”¸å›­åŒºå¹¸å­˜ä¸‹æ¥çš„æ”¾åˆ°toåŒºï¼ŒfromåŒºå¹¸å­˜ä¸‹æ¥çš„ä¹Ÿæ”¾å…¥toåŒºï¼Œå¦‚æœæ”¾ä¸ä¸‹å°±ç”³è¯·è€å¹´ä»£ç©ºé—´ã€‚å¦‚æœè¿˜æ”¾ä¸ä¸‹å°±OOM</li><li>å¦‚æœæ‰§è¡Œå®ŒMinor  GCåæ–°å¯¹è±¡èƒ½å¤Ÿåœ¨ä¼Šç”¸å›­åŒºæ”¾å¾—ä¸‹å°±åˆ†é…ç©ºé—´ã€‚å¦‚æœæ‰§è¡ŒMinor GCä¹‹åä¼Šç”¸å›­åŒºè¿˜æ”¾ä¸ä¸‹ï¼Œå°±ç”³è¯·è€å¹´ä»£ç©ºé—´ã€‚</li><li>å¦‚æœè€å¹´ä»£èƒ½æ”¾å¾—ä¸‹å°±æ”¾å…¥è€å¹´ä»£ï¼Œå¹¶åˆ†é…å†…å­˜ã€‚å¦‚æœæ”¾ä¸ä¸‹å°±ä¼šè¿›è¡Œä¸€æ¬¡Full GCã€‚å¹¶å†æ¬¡åˆ¤æ–­è€å¹´ä»£èƒ½å¦æ”¾çš„ä¸‹ï¼Œå¦‚æœæ”¾å¾—ä¸‹å°±åˆ†é…ç©ºé—´ï¼Œå¦‚æœè¿˜æ”¾ä¸ä¸‹å°±OOM</li></ol></blockquote><p><img src="https://s1.ax1x.com/2020/10/10/0y3l0s.png" alt="å¯¹è±¡åˆ†é…çš„æµç¨‹"></p><p><img src="https://s1.ax1x.com/2020/10/10/0yYM80.png" alt="0yYM80.png"></p><blockquote><p>æ€»ç»“</p></blockquote><ul><li>é’ˆå¯¹å¹¸å­˜è€…s0,s1åŒºï¼Œå¤åˆ¶ä¹‹åæœ‰äº¤æ¢ï¼Œè°ç©ºè°æ˜¯to</li><li>å…³äºåƒåœ¾å›æ”¶ï¼šæ–°ç”Ÿä»£ä¸­é¢‘ç¹å‘ç”Ÿï¼Œå¾ˆå°‘åœ¨è€å¹´ä»£å‘ç”Ÿï¼Œå‡ ä¹ä¸åœ¨å…ƒç©ºé—´/æ°¸ä¹…ä»£å‘ç”Ÿ</li></ul><h2 id="Minor-GC-Major-GC-Full-GC"><a href="#Minor-GC-Major-GC-Full-GC" class="headerlink" title="Minor GC Major GC Full GC"></a>Minor GC Major GC Full GC</h2><blockquote><p>HotSpot VMä¸­çš„gcåˆ†ä¸ºä¸¤å¤§ç§ç±»å‹ï¼šéƒ¨åˆ†æ”¶é›†ï¼ˆPartial GCï¼‰ï¼Œæ•´å †æ”¶é›†ï¼ˆFull GCï¼‰</p></blockquote><ul><li><p>éƒ¨åˆ†æ”¶é›†ï¼šä¸æ˜¯å®Œæ•´çš„æ”¶é›†æ•´ä¸ªjavaå †</p><ul><li>æ–°ç”Ÿä»£æ”¶é›†ï¼ˆMinor GC/ Young GCï¼‰</li><li>è€å¹´ä»£æ”¶é›†ï¼ˆMajor GC/ Old GCï¼‰<ul><li><strong>ç›®å‰åªæœ‰CMS GCä¼šæœ‰å•ç‹¬æ”¶é›†è€å¹´ä»£çš„è¡Œä¸º</strong></li></ul></li><li>æ··åˆæ”¶é›†ï¼ˆMixed GCï¼‰ï¼šæ”¶é›†æ•´ä¸ªæ–°ç”Ÿä»£ä»¥åŠéƒ¨åˆ†è€å¹´ä»£çš„åƒåœ¾æ”¶é›†<ul><li>ç›®å‰åªæœ‰G1 GCä¼šæœ‰è¿™ç§è¡Œä¸º</li></ul></li></ul></li><li><p>æ•´å †æ”¶é›†ï¼šæ”¶é›†æ•´ä¸ªjavaå †å’Œæ–¹æ³•åŒºçš„åƒåœ¾æ”¶é›†</p></li></ul><blockquote><p>æ–°ç”Ÿä»£GCè§¦å‘æœºåˆ¶ï¼š</p></blockquote><ul><li>å½“ä¼Šç”¸å›­åŒºç©ºé—´ä¸è¶³ä»¥åˆ†é…çš„æ—¶å€™ä¼šè§¦å‘</li><li>å¹¸å­˜è€…åŒºä¸ä¼šè§¦å‘GCï¼Œä»–åªæ˜¯è¢«åŠ¨çš„è§¦å‘äº†GC</li><li>Minor GCä¼šå¼•å‘STWï¼Œæš‚åœå…¶ä»–ç”¨æˆ·çš„çº¿ç¨‹ï¼Œç­‰åƒåœ¾å›æ”¶ç»“æŸï¼Œç”¨æˆ·çº¿ç¨‹æ‰æ¢å¤è¿è¡Œ</li></ul><blockquote><p>è€å¹´ä»£GCè§¦å‘æœºåˆ¶</p></blockquote><ul><li>å‡ºç°äº†Major GCï¼Œç»å¸¸ä¼šä¼´éšè‡³å°‘ä¸€æ¬¡çš„Minor GCï¼ˆéç»å¯¹ï¼Œåœ¨Parallel Scavengeæ”¶é›†å™¨ä¸­æ”¶é›†ç­–ç•¥é‡Œæœ‰ç›´æ¥è¿›è¡ŒMajor GCçš„ç­–ç•¥é€‰æ‹©ï¼‰</li><li>Major GCçš„é€Ÿåº¦ä¸€èˆ¬ä¼šæ¯”Minor GCæ…¢10å€ä»¥ä¸Šï¼ŒSTWçš„æ—¶é—´æ›´é•¿</li><li>å¦‚æœMajor GCåå†…å­˜è¿˜ä¸è¶³ï¼Œå°±OOM</li></ul><blockquote><p>Full GCè§¦å‘æœºåˆ¶</p><p><strong>full gcåœ¨å¼€å‘æˆ–è€…è°ƒä¼˜ä¸­å°½é‡è¦é¿å…ï¼Œè¿™æ ·æš‚æ—¶æ—¶é—´ä¼šçŸ­ä¸€äº›</strong></p></blockquote><ul><li>è°ƒç”¨System.gc()æ—¶å€™ï¼Œç³»ç»Ÿå»ºè®®æ‰§è¡ŒFull GC ä½†æ˜¯ä¸å¿…ç„¶æ‰§è¡Œ</li><li>è€å¹´ä»£ç©ºé—´ä¸è¶³</li><li>æ–¹æ³•åŒºç©ºé—´ä¸è¶³</li><li>é€šè¿‡Minor GCåè¿›å…¥è€å¹´ä»£çš„å¹³å‡å¤§å°å¤§äºè€å¹´ä»£çš„å¯ç”¨å†…å­˜</li><li>ç”±ä¼Šç”¸å›­åŒºï¼ŒfromåŒºå‘toåŒºå¤åˆ¶æ—¶ï¼Œå¯¹è±¡å¤§å°å¤§äºtoåŒºå¯ç”¨å†…å­˜ï¼Œåˆ™æŠŠè¯¥å¯¹è±¡è½¬å…¥è€å¹´ä»£ï¼Œå¹¶ä¸”è€å¹´ä»£çš„å¯ç”¨å†…å­˜å°äºè¯¥å¯¹è±¡çš„å¤§å°</li></ul><h2 id="å †ç©ºé—´åˆ†ä»£æ€æƒ³"><a href="#å †ç©ºé—´åˆ†ä»£æ€æƒ³" class="headerlink" title="å †ç©ºé—´åˆ†ä»£æ€æƒ³"></a>å †ç©ºé—´åˆ†ä»£æ€æƒ³</h2><blockquote><p>åˆ†ä»£çš„å”¯ä¸€ç†ç”±å°±æ˜¯ä¼˜åŒ–GCæ€§èƒ½ã€‚</p></blockquote><p>å¦‚æœæ²¡æœ‰åˆ†ä»£ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„å¯¹è±¡éƒ½åœ¨ä¸€å—ï¼Œè¿™æ ·gcçš„æ—¶å€™éœ€è¦å¯¹å †çš„æ‰€æœ‰åŒºåŸŸè¿›è¡Œæ‰«æï¼Œåœ¨è¿›è¡Œæ“ä½œï¼Œå¾ˆæ²¡æœ‰æ•ˆç‡ã€‚</p><h2 id="å†…å­˜åˆ†é…ç­–ç•¥"><a href="#å†…å­˜åˆ†é…ç­–ç•¥" class="headerlink" title="å†…å­˜åˆ†é…ç­–ç•¥"></a>å†…å­˜åˆ†é…ç­–ç•¥</h2><blockquote><p>é’ˆå¯¹ä¸åŒå¹´é¾„æ®µçš„å¯¹è±¡åˆ†é…åŸåˆ™ï¼š</p></blockquote><ul><li>ä¼˜å…ˆåˆ†é…åˆ°Eden</li><li>å¤§å¯¹è±¡ç›´æ¥åˆ†é…åˆ°è€å¹´ä»£<ul><li>å°½é‡é¿å…ç¨‹åºä¸­å‡ºç°è¿‡å¤šçš„å¤§å¯¹è±¡</li></ul></li><li>é•¿æœŸå­˜æ´»çš„åˆ†é…åˆ°è€å¹´ä»£</li><li>åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤æ–­<ul><li>å¦‚æœ<strong>å¹¸å­˜è€…åŒºä¸­ç›¸åŒå¹´é¾„çš„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äºå¹¸å­˜è€…ç©ºé—´çš„ä¸€åŠ</strong>ï¼Œå¹´é¾„å¤§äºæˆ–è€…ç­‰äºè¯¥å¹´é¾„å¯¹è±¡çš„å¯ä»¥ç›´æ¥æ™‹å‡åˆ°è€å¹´ä»£ï¼Œæ— éœ€ç­‰åˆ°MaxTenuringThresholdä¸­è¦æ±‚çš„å¹´é¾„</li></ul></li><li>ç©ºé—´åˆ†é…æ‹…ä¿ï¼š<code>-XX:HandlePromotionFailure</code></li></ul><h2 id="ä¸ºå¯¹è±¡åˆ†é…å†…å­˜-TLABï¼ˆThread-Local-Allocation-Bufferï¼‰"><a href="#ä¸ºå¯¹è±¡åˆ†é…å†…å­˜-TLABï¼ˆThread-Local-Allocation-Bufferï¼‰" class="headerlink" title="ä¸ºå¯¹è±¡åˆ†é…å†…å­˜:TLABï¼ˆThread Local Allocation Bufferï¼‰"></a>ä¸ºå¯¹è±¡åˆ†é…å†…å­˜:TLABï¼ˆThread Local Allocation Bufferï¼‰</h2><blockquote><p>ä¸ºä»€ä¹ˆè¦ç”¨TLABï¼Ÿ</p></blockquote><ul><li>å †åŒºæ˜¯çº¿ç¨‹å…±äº«çš„ï¼Œä»»ä½•çº¿ç¨‹éƒ½èƒ½è®¿é—®å †åŒºä¸­çš„å…±äº«æ•°æ®</li><li>ç”±äºå¯¹è±¡å®ä¾‹çš„åˆ›å»ºåœ¨JVMä¸­éå¸¸é¢‘ç¹ï¼Œå› æ­¤åœ¨<strong>å¹¶å‘ç¯å¢ƒä¸‹ä»å †åŒºä¸­åˆ’åˆ†å†…å­˜ç©ºé—´æ˜¯çº¿ç¨‹ä¸å®‰å…¨</strong>çš„</li><li>ä¸ºé¿å…å¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€åœ°å€ï¼Œéœ€è¦ä½¿ç”¨<strong>åŠ é”</strong>ç­‰æœºåˆ¶ï¼Œè¿›è€Œ<strong>å½±å“åˆ†é…é€Ÿåº¦</strong></li></ul><blockquote><p>ä»€ä¹ˆæ˜¯TLABï¼Ÿ</p></blockquote><ul><li>ä»å†…å­˜æ¨¡å‹è€Œä¸æ˜¯åƒåœ¾æ”¶é›†çš„è§’åº¦ï¼Œå¯¹EdenåŒºåŸŸç»§ç»­è¿›è¡Œåˆ’åˆ†ï¼ŒJVMä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…äº†ä¸€ä¸ªç§æœ‰ç¼“å­˜åŒºåŸŸï¼Œä»–åŒ…å«åœ¨EdenåŒºåŸŸä¸­</li><li>å¤šçº¿ç¨‹åŒæ—¶åˆ†é…å†…å­˜çš„æ—¶å€™ï¼Œä½¿ç”¨TLABå¯ä»¥é¿å…ä¸€ç³»åˆ—éçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼ŒåŒæ—¶è¿˜èƒ½æå‡å†…å­˜åˆ†é…çš„ååé‡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†è¿™ç§å†…å­˜åˆ†é…æ–¹å¼ç§°ä¸º <strong>å¿«é€Ÿåˆ†é…ç­–ç•¥</strong></li><li>æ‰€æœ‰çš„openjdkè¡ç”Ÿå‡ºæ¥çš„jvméƒ½æä¾›äº†TLABè®¾è®¡</li></ul><p><strong>è¡¥å……è¯´æ˜</strong></p><p><img src="https://s1.ax1x.com/2020/10/10/0yO2uR.png" alt="TLABè¡¥å……è¯´æ˜"></p><p><strong>å¯¹è±¡åˆ†é…è¿‡ç¨‹ï¼šTLAB</strong></p><p><img src="https://s1.ax1x.com/2020/10/10/0yXSPS.png" alt="0yXSPS.png"></p><h2 id="å°ç»“å †ç©ºé—´çš„å‚æ•°è®¾ç½®"><a href="#å°ç»“å †ç©ºé—´çš„å‚æ•°è®¾ç½®" class="headerlink" title="å°ç»“å †ç©ºé—´çš„å‚æ•°è®¾ç½®"></a>å°ç»“å †ç©ºé—´çš„å‚æ•°è®¾ç½®</h2><blockquote><p>å°ç»“å¸¸ç”¨å‚æ•° ğŸ‘‰ <a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/java.html">å®˜æ–¹è¯´æ˜</a></p></blockquote><ul><li>-XX:+PrintFlagsInitial  æŸ¥çœ‹æ‰€æœ‰çš„å‚æ•°çš„é»˜è®¤åˆå§‹å€¼</li><li>-XX:+PrintFlagsFinal  æŸ¥çœ‹æ‰€æœ‰çš„å‚æ•°çš„æœ€ç»ˆå€¼</li><li>-Xms  åˆå§‹åŒ–å †ç©ºé—´å†…å­˜ï¼ˆé»˜è®¤ç‰©ç†å†…å­˜çš„1/64ï¼‰</li><li>-Xmx  æœ€å¤§å †ç©ºé—´å†…å­˜ï¼ˆé»˜è®¤ç‰©ç†å†…å­˜çš„1/4ï¼‰</li><li>-Xmn  è®¾ç½®æ–°ç”Ÿä»£çš„å¤§å°ï¼ˆåˆå§‹å€¼ä»¥åŠæœ€å¤§å€¼ï¼‰</li><li>-XX:NewRatio  é…ç½®æ–°ç”Ÿä»£å’Œè€å¹´ä»£åœ¨å †ç»“æ„çš„å æ¯”</li><li>-XX:SurvivorRatio  é…ç½®æ–°ç”Ÿä»£ä¸­ä¼Šç”¸å›­åŒºå’Œå¹¸å­˜è€…åŒºç©ºé—´çš„å æ¯”</li><li>-XX:MaxTenuringThreshold  è®¾ç½®æ–°ç”Ÿä»£åƒåœ¾çš„æœ€å¤§å¹´é¾„</li><li>-XX:+PrintGCDetails  è¾“å‡ºè¯¦ç»†çš„GCå¤„ç†æ—¥å¿—</li><li>-XX:HandlePromotionFailure  æ˜¯å¦è®¾ç½®ç©ºé—´åˆ†é…æ‹…ä¿</li><li>æ‰“å°GCçš„ç®€è¦ä¿¡æ¯  -XX:+PrintGC  æˆ–è€…  -verbose:gc</li></ul><h2 id="å †æ˜¯åˆ†é…ç©ºé—´çš„å”¯ä¸€é€‰æ‹©å—ï¼Ÿï¼Ÿ"><a href="#å †æ˜¯åˆ†é…ç©ºé—´çš„å”¯ä¸€é€‰æ‹©å—ï¼Ÿï¼Ÿ" class="headerlink" title="å †æ˜¯åˆ†é…ç©ºé—´çš„å”¯ä¸€é€‰æ‹©å—ï¼Ÿï¼Ÿ"></a>å †æ˜¯åˆ†é…ç©ºé—´çš„å”¯ä¸€é€‰æ‹©å—ï¼Ÿï¼Ÿ</h2><blockquote><p>åœ¨javaè™šæ‹Ÿæœºä¸­ï¼Œå¯¹è±¡æ˜¯åœ¨javaå †ä¸­åˆ†é…å†…å­˜çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªæ™®éçš„å¸¸è¯†ã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œ<strong>å¦‚æœç»è¿‡é€ƒé€¸åˆ†æåå‘ç°ï¼Œä¸€ä¸ªå¯¹è±¡å¹¶æ²¡æœ‰é€ƒé€¸å‡ºæ–¹æ³•çš„è¯ï¼Œé‚£ä¹ˆå°±å¯èƒ½è¢«ä¼˜åŒ–æˆæ ˆä¸Šåˆ†é…</strong>ã€‚è¿™æ ·å°±æ— éœ€åœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œä¹Ÿæ— é¡»è¿›è¡Œåƒåœ¾å›æ”¶ã€‚è¿™æ˜¯æœ€å¸¸è§çš„ä¸€ç§å †å¤–å­˜å‚¨æŠ€æœ¯ã€‚</p></blockquote><p>æ­¤å¤–ï¼ŒåŸºäºOpenJDKçš„TaoBaoVMï¼Œå…¶ä¸­åˆ›æ–°çš„GCIHæŠ€æœ¯å®ç°off-heapï¼Œå°†ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿çš„Javaå¯¹è±¡ä»heapä¸­ç§»è‡³heapå¤–ï¼Œå¹¶ä¸”GCä¸èƒ½ç®¡ç†GCIHå†…éƒ¨çš„å¯¹è±¡ï¼Œä»¥æ­¤æ¥é™ä½GCçš„å›æ”¶é¢‘ç‡å’Œæå‡GCçš„å›æ”¶æ•ˆç‡ã€‚</p><h3 id="é€ƒé€¸åˆ†ææ¦‚è¿°"><a href="#é€ƒé€¸åˆ†ææ¦‚è¿°" class="headerlink" title="é€ƒé€¸åˆ†ææ¦‚è¿°"></a>é€ƒé€¸åˆ†ææ¦‚è¿°</h3><blockquote><p><strong>å¦‚æœå°†å †ä¸Šçš„å¯¹è±¡åˆ†é…åˆ°æ ˆï¼Œéœ€è¦ä½¿ç”¨é€ƒé€¸åˆ†ææ‰‹æ®µ</strong></p><ul><li>è¿™æ˜¯ä¸€ç§å¯ä»¥æœ‰æ•ˆå‡å°‘javaç¨‹åºä¸­åŒæ­¥è´Ÿè½½å’Œå†…å­˜å †åˆ†é…å‹åŠ›çš„è·¨å‡½æ•°å…¨å±€æ•°æ®æµåˆ†æç®—æ³•ã€‚</li><li>é€šè¿‡é€ƒé€¸åˆ†æï¼Œjava Hotspotç¼–è¯‘å™¨èƒ½å¤Ÿåˆ†æå‡º<strong>ä¸€ä¸ªæ–°çš„å¯¹è±¡å¼•ç”¨çš„ä½¿ç”¨èŒƒå›´</strong>ï¼Œä»è€Œå†³å®šæ˜¯å¦è¦å°†è¿™ä¸ªå¯¹è±¡åˆ†é…åˆ°å †ä¸Š</li><li>é€ƒé€¸åˆ†æçš„åŸºæœ¬è¡Œä¸ºå°±æ˜¯åˆ†æå¯¹è±¡åŠ¨æ€ä½œç”¨åŸŸï¼š<ul><li>å½“ä¸€ä¸ªå¯¹è±¡åœ¨æ–¹æ³•ä¸­è¢«å®šä¹‰åï¼Œ<strong>å¯¹è±¡åªåœ¨æ–¹æ³•å†…éƒ¨ä½¿ç”¨</strong>ï¼Œåˆ™è®¤ä¸º<strong>æ²¡æœ‰å‘ç”Ÿé€ƒé€¸</strong>ã€‚</li><li>å½“ä¸€ä¸ªå¯¹è±¡åœ¨æ–¹æ³•ä¸­è¢«å®šä¹‰åï¼Œ<strong>å®ƒè¢«å¤–éƒ¨æ–¹æ³•æ‰€å¼•ç”¨</strong>ï¼Œåˆ™è®¤ä¸º<strong>å‘ç”Ÿé€ƒé€¸</strong>ã€‚ä¾‹å¦‚ä½œä¸ºè°ƒç”¨å‚æ•°ï¼Œä¼ é€’åˆ°å…¶ä»–åœ°æ–¹ã€‚</li></ul></li></ul></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">my_method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">V</span> v <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">V</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// use v</span>    <span class="token comment">// ....</span>    v <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸Šå°±æ²¡æœ‰å‘ç”Ÿé€ƒé€¸å¯¹è±¡ï¼Œåˆ™å¯ä»¥åˆ†é…åˆ°æ ˆä¸Šï¼Œéšç€æ–¹æ³•æ‰§è¡Œçš„ç»“æŸï¼Œæ ˆç©ºé—´è¢«ç§»é™¤ ã€‚</p><p><img src="https://s1.ax1x.com/2020/10/11/0ccJC6.png" alt="0ccJC6.png"></p><blockquote><p>å¦‚ä½•å¿«é€Ÿåˆ¤æ–­æ˜¯å¦å‘ç”Ÿäº†é€ƒé€¸åˆ†æï¼Ÿåˆ›å»ºçš„å¯¹è±¡æ˜¯å¦æœ‰å¯èƒ½åœ¨å¤–éƒ¨è¢«è°ƒç”¨</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">A</span> a <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token class-name">A</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> a<span class="token operator">==</span><span class="token keyword">null</span><span class="token operator">?</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> a<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä¼šå‘ç”Ÿé€ƒé€¸</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">A</span> a <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸Šä¾‹å­testä¼šå‘ç”Ÿé€ƒé€¸ï¼Œå¼•ç”¨äº†æˆå‘˜å˜é‡çš„å€¼ã€‚</p><h3 id="ä»£ç ä¼˜åŒ–"><a href="#ä»£ç ä¼˜åŒ–" class="headerlink" title="ä»£ç ä¼˜åŒ–"></a>ä»£ç ä¼˜åŒ–</h3><blockquote><p>ä½¿ç”¨é€ƒé€¸åˆ†æï¼Œç¼–è¯‘å™¨ä¼šå †ä»£ç åšå¦‚ä¸‹ä¼˜åŒ–</p></blockquote><ul><li><p><strong>æ ˆä¸Šåˆ†é…</strong>ï¼Œå°†å †åˆ†é…è½¬åŒ–ä¸ºæ ˆåˆ†é…ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡åœ¨å­ç¨‹åºä¸­è¢«åˆ†é…ï¼Œè¦ä½¿æŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆæ°¸è¿œä¸ä¼šé€ƒé€¸ï¼Œå¯¹è±¡å¯èƒ½æ˜¯<strong>æ ˆåˆ†é…çš„å€™é€‰</strong>ï¼Œè€Œä¸æ˜¯å †åˆ†é…ã€‚</p><blockquote><p>å¦‚æœæ²¡æœ‰å‘ç”Ÿé€ƒé€¸çš„è¯ï¼Œå¯¹è±¡å­˜åœ¨è¢«åˆ†é…åˆ°æ ˆå¸§ä¸Šçš„å¯èƒ½ï¼ˆä¹Ÿå¯ä»¥ä¸åˆ†é…åˆ°æ ˆä¸Šåˆ†é…åˆ°å †ä¸Šï¼‰</p></blockquote></li><li><p><strong>åŒæ­¥çœç•¥</strong>ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡è¢«å‘ç°åªèƒ½ä»ä¸€ä¸ªçº¿ç¨‹è®¿é—®åˆ°ï¼Œ<strong>é‚£ä¹ˆå¯¹äºè¿™ä¸ªå¯¹è±¡çš„æ“ä½œå¯ä»¥è€ƒè™‘ä¸åŒæ­¥</strong></p><blockquote><p>çº¿ç¨‹åŒæ­¥çš„ä»£ä»·æ˜¯ <strong>é™ä½å¹¶å‘æ€§å’Œæ€§èƒ½</strong></p><p>åœ¨åŠ¨æ€ç¼–è¯‘åŒæ­¥å—çš„æ—¶å€™ï¼ŒJITç¼–è¯‘å™¨å¯ä»¥å€ŸåŠ©é€ƒé€¸åˆ†ææ¥åˆ¤æ–­åŒæ­¥å—æ‰€ä½¿ç”¨çš„é”å¯¹è±¡æ˜¯å¦èƒ½å¤Ÿè¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®è€Œæ²¡æœ‰è¢«å‘å¸ƒåˆ°å…¶ä»–çº¿ç¨‹ã€‚å¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆJITç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿™ä¸ªåŒæ­¥å—çš„æ—¶å€™å°±ä¼šå–æ¶ˆå¯¹è¿™éƒ¨åˆ†ä»£ç çš„åŒæ­¥ã€‚<strong>å¤§å¤§æé«˜å¹¶å‘æ€§å’Œæ€§èƒ½</strong>ï¼Œè¿™ç§æ“ä½œå«åš<strong>åŒæ­¥çœç•¥</strong>ï¼Œæˆ–è€…å«<strong>é”æ¶ˆé™¤</strong></p></blockquote></li><li><p><strong>åˆ†ç¦»å¯¹è±¡æˆ–æ ‡é‡æ›¿æ¢</strong>ï¼Œæœ‰çš„å¯¹è±¡å¯èƒ½<strong>ä¸éœ€è¦ä½œä¸ºä¸€ä¸ªè¿ç»­çš„å†…å­˜ç»“æ„å­˜åœ¨ä¹Ÿå¯ä»¥è¢«è®¿é—®åˆ°</strong>ï¼Œé‚£ä¹ˆ<strong>å¯¹è±¡çš„éƒ¨åˆ†ï¼ˆæˆ–è€…å…¨éƒ¨ï¼‰</strong>å¯ä»¥ä¸å­˜å‚¨åœ¨å†…å­˜ï¼Œè€Œæ˜¯<strong>å­˜å‚¨åœ¨cpuå¯„å­˜å™¨</strong>ä¸­</p><blockquote><p><strong>æ ‡é‡</strong>æ˜¯æŒ‡ä¸€ä¸ªæ— æ³•å†åˆ†è§£æˆæ›´å°çš„æ•°æ®çš„æ•°æ®ï¼Œjavaä¸­çš„åŸå§‹æ•°æ®ç±»å‹å°±æ˜¯æ ‡é‡ã€‚ç›¸å¯¹çš„ï¼Œé‚£äº›å¯ä»¥åˆ†è§£çš„æ•°æ®å«åš<strong>èšåˆé‡</strong>ï¼Œjavaä¸­çš„å¯¹è±¡å°±æ˜¯èšåˆé‡ï¼Œå› ä¸ºä»–å¯ä»¥åˆ†è§£æˆå…¶ä»–èšåˆé‡å’Œæ ‡é‡</p><p>åœ¨JITé˜¶æ®µï¼Œå¦‚æœç»è¿‡é€ƒé€¸åˆ†æï¼Œå‘ç°ä¸€ä¸ªå¯¹è±¡ä¸ä¼šè¢«å¤–ç•Œè®¿é—®çš„è¯ï¼Œé‚£ä¹ˆç»è¿‡JITä¼˜åŒ–ï¼Œå°±ä¼šæŠŠè¿™ä¸ªå¯¹è±¡æ‹†è§£æˆè‹¥å¹²ä¸ªå…¶ä¸­åŒ…å«çš„è‹¥å¹²ä¸ªæˆå‘˜å˜é‡æ¥ä»£æ›¿ã€‚è¿™ä¸ªè¿‡ç¨‹å«åš<strong>æ ‡é‡æ›¿æ¢</strong></p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/***ä¾‹å­*/</span><span class="token keyword">class</span> <span class="token class-name">Point2</span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token keyword">int</span> x<span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token keyword">int</span> y<span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token class-name">Point2</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token comment">/**è¿™é‡Œçš„ pointæ²¡æœ‰å‘ç”Ÿé€ƒé€¸ï¼Œä»–ä¼šè¢«æ›¿æ¢æˆ int x = 1, int y = 2æ¥ä»£æ›¿*/</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">Point2</span> point <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">// ä¸Šä¸€ä¸ªæ–¹æ³•è¢«æ›¿æ¢æˆäº†ä»¥ä¸‹æ–¹æ³•ï¼Œè¿™å°±æ˜¯æ ‡é‡æ›¿æ¢</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> x<span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token function">sout</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">sout</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TestBiaoLiang</span> testBiaoLiang <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestBiaoLiang</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        testBiaoLiang<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ ‡é‡æ›¿æ¢å¤§å¤§å‡å°‘äº†å †å†…å­˜çš„å ç”¨ï¼Œå› ä¸ºä¸€æ—¦ä¸éœ€è¦åˆ›å»ºå¯¹è±¡äº†ï¼Œé‚£ä¹ˆå°±ä¸å†éœ€è¦åˆ†é…å †å†…å­˜äº†ã€‚</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> jvm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JVM02</title>
      <link href="2020/09/25/jvm02/"/>
      <url>2020/09/25/jvm02/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿è¡Œæ—¶æ•°æ®åŒº"><a href="#è¿è¡Œæ—¶æ•°æ®åŒº" class="headerlink" title="è¿è¡Œæ—¶æ•°æ®åŒº"></a>è¿è¡Œæ—¶æ•°æ®åŒº</h1><blockquote><p><strong>çº¢è‰²åŒºåŸŸæ˜¯ä¸€ä¸ªè¿›ç¨‹ä¸€ä»½</strong>ï¼Œ<strong>å…±äº«çš„</strong>ï¼š</p><ul><li>å †</li><li>å †å¤–å†…å­˜(æ–¹æ³•åŒº)ï¼ˆæ°¸ä¹…ä»£ï¼Œå…ƒç©ºé—´ï¼Œä»£ç ç¼“å­˜ï¼‰</li></ul><p><strong>ç°è‰²åŒºåŸŸæ˜¯ä¸€ä¸ªçº¿ç¨‹ä¸€ä»½</strong>ï¼Œ<strong>ç§æœ‰çš„</strong></p><ul><li>ç¨‹åºè®¡æ•°å™¨</li><li>æ ˆ</li><li>æœ¬åœ°æ ˆ</li></ul></blockquote><p><img src="https://s1.ax1x.com/2020/10/09/0rBTED.png" alt="è¿è¡Œæ—¶æ•°æ®åŒº"></p><h2 id="çº¿ç¨‹"><a href="#çº¿ç¨‹" class="headerlink" title="çº¿ç¨‹"></a>çº¿ç¨‹</h2><blockquote><p>çº¿ç¨‹æ˜¯ä¸€ä¸ªç¨‹åºé‡Œçš„è¿è¡Œå•å…ƒï¼ŒJVMå…è®¸ä¸€ä¸ªåº”ç”¨æœ‰å¤šä¸ªçº¿ç¨‹å¹¶è¡Œçš„æ‰§è¡Œ</p><ul><li>hotspotè™šæ‹Ÿæœºä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¸æ“ä½œç³»ç»Ÿçš„æœ¬åœ°çº¿ç¨‹ç›´æ¥æ˜ å°„ï¼Œå½“javaçº¿ç¨‹å‡†å¤‡å¥½ä»¥åï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„æœ¬åœ°çº¿ç¨‹ã€‚javaçº¿ç¨‹ç»ˆæ­¢ä»¥åï¼Œæœ¬åœ°çº¿ç¨‹ä¹Ÿä¼šå›æ”¶ã€‚</li><li>æ“ä½œç³»ç»Ÿè´Ÿè´£æŠŠçº¿ç¨‹è°ƒåº¦åˆ°å¯ç”¨çš„cpuä¸Šï¼Œå»è°ƒç”¨javaçº¿ç¨‹ä¸­çš„run()æ–¹æ³•</li><li>å½“æœ€åä¸€ä¸ªæ™®é€šçº¿ç¨‹ç»“æŸçš„æ—¶å€™ï¼ˆmainæ–¹æ³•ï¼‰è™šæ‹Ÿæœºä¹Ÿä¼šè¢«å…³é—­</li></ul></blockquote><h2 id="ç¨‹åºè®¡æ•°å™¨-PCå¯„å­˜å™¨"><a href="#ç¨‹åºè®¡æ•°å™¨-PCå¯„å­˜å™¨" class="headerlink" title="ç¨‹åºè®¡æ•°å™¨(PCå¯„å­˜å™¨)"></a>ç¨‹åºè®¡æ•°å™¨(PCå¯„å­˜å™¨)</h2><h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><blockquote><p>ä¸æ˜¯cpuå¯„å­˜å™¨ï¼Œæ˜¯jvmä¸­å¯¹ç‰©ç†pcå¯„å­˜å™¨çš„ä¸€ç§æŠ½è±¡ã€‚</p><p>pcå¯„å­˜å™¨ç”¨æ¥å­˜å‚¨æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œä¹Ÿå³å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤ä»£ç ã€‚ç”±æ‰§è¡Œå¼•æ“è¯»å–ä¸‹ä¸€æ¡æŒ‡ä»¤</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/09/0rBOgI.png" alt="PCå¯„å­˜å™¨"></p><blockquote><p>ä»–æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¿æŒä¸€è‡´ã€‚</p><p>ä»»ä½•æ—¶é—´ä¸€ä¸ªçº¿ç¨‹éƒ½åªæœ‰ä¸€ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯æ‰€è°“ çš„<strong>å½“å‰æ–¹æ³•</strong>ã€‚ç¨‹åºè®¡æ•°å™¨ä¼šå­˜å‚¨å½“å‰çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„javaæ–¹æ³•çš„jvmæŒ‡ä»¤åœ°å€ã€‚æˆ–è€…å¦‚æœæ˜¯åœ¨æ‰§è¡Œnativeæ–¹æ³•ï¼Œåˆ™æ˜¯æœªæŒ‡å®šå€¼(undefined)</p></blockquote><p><strong>ç¨‹åºè®¡æ•°å™¨æ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨javaè™šæ‹Ÿæœºä¸­æ²¡æœ‰è§„å®šä»»ä½•OutOfMemoryErroræƒ…å†µçš„åŒºåŸŸ</strong></p><h3 id="ä¸¾ä¾‹è¯´æ˜"><a href="#ä¸¾ä¾‹è¯´æ˜" class="headerlink" title="ä¸¾ä¾‹è¯´æ˜"></a>ä¸¾ä¾‹è¯´æ˜</h3><p><img src="/home/zhy/.config/Typora/typora-user-images/image-20200925180521546.png" alt="image-20200925180521546"></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> k <span class="token operator">=</span> i<span class="token operator">+</span>j<span class="token punctuation">;</span>    <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h3><blockquote><p>ä½¿ç”¨PCå¯„å­˜å™¨å­˜å‚¨å­—èŠ‚ç æŒ‡ä»¤åœ°å€æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</p></blockquote><p>cpuéœ€è¦ä¸åœçš„åˆ‡æ¢å„ä¸ªçº¿ç¨‹ï¼Œè¿™æ—¶å€™åˆ‡æ¢å›æ¥åï¼Œå°±å¾—çŸ¥é“æ¥ç€ä»å“ªé‡Œå¼€å§‹ç»§ç»­æ‰§è¡Œã€‚</p><blockquote><p>ä¸ºä»€ä¹ˆä½¿ç”¨pcå¯„å­˜å™¨è®°å½•å½“å‰çº¿ç¨‹éƒ½æ‰§è¡Œåœ°å€å‘¢ï¼Ÿ</p></blockquote><p>JVMçš„å­—èŠ‚ç è§£é‡Šå™¨å°±éœ€è¦é€šè¿‡æ”¹å˜PCå¯„å­˜å™¨çš„å€¼æ¥æ˜ç¡®ä¸‹ä¸€æ¡åº”è¯¥æ‰§è¡Œä»€ä¹ˆæ ·çš„å­—èŠ‚ç æŒ‡ä»¤</p><h2 id="è™šæ‹Ÿæœºæ ˆ"><a href="#è™šæ‹Ÿæœºæ ˆ" class="headerlink" title="è™šæ‹Ÿæœºæ ˆ"></a>è™šæ‹Ÿæœºæ ˆ</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><blockquote><p>è™šæ‹Ÿæœºæ ˆè·¨å¹³å°å®¹æ˜“ï¼Œæ€§èƒ½è¦æ¯”å¯„å­˜å™¨çš„ä½ã€‚</p><ul><li><strong>æ¯ä¸ªçº¿ç¨‹åœ¨åˆ›å»ºçš„æ—¶å€™éƒ½ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºæ ˆ</strong>ï¼Œå…¶å†…éƒ¨ä¿å­˜ä¸€ä¸ªä¸ªçš„æ ˆå¸§ï¼Œå¯¹åº”ç€ä¸€æ¬¡æ¬¡çš„javaæ–¹æ³•è°ƒç”¨</li><li><strong>æ˜¯çº¿ç¨‹ç§æœ‰çš„</strong></li><li>ç”Ÿå‘½å‘¨æœŸå’Œçº¿ç¨‹ä¸€è‡´</li><li>ä¸»ç®¡javaç¨‹åºçš„è¿è¡Œï¼Œä¿å­˜æ–¹æ³•çš„å±€éƒ¨å˜é‡ï¼ˆ8ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå¯¹è±¡çš„å¼•ç”¨åœ°å€ï¼‰ï¼Œéƒ¨åˆ†ç»“æœï¼Œå¹¶å‚ä¸æ–¹æ³•çš„è°ƒç”¨å’Œè¿”å›</li></ul></blockquote><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>ä¸å­˜åœ¨åƒåœ¾å›æ”¶é—®é¢˜</li><li>æ¯ä¸ªæ–¹æ³•çš„æ‰§è¡Œéƒ½ä¼´éšç€å‹æ ˆ</li><li>æ‰§è¡Œç»“æŸåä¼šæœ‰å‡ºæ ˆå·¥ä½œ</li></ul><p><strong>æ ˆä¸­å‡ºç°çš„å¼‚å¸¸</strong></p><blockquote><p>javaè™šæ‹Ÿæœºè§„èŒƒ<strong>javaæ ˆçš„å¤§å°æ˜¯åŠ¨æ€çš„æˆ–è€…å›ºå®šä¸å˜çš„</strong></p><ul><li><strong>é‡‡ç”¨å›ºå®šå¤§å°çš„è™šæ‹Ÿæœºæ ˆ</strong>ï¼Œåœ¨çº¿ç¨‹åˆ›å»ºçš„æ—¶å€™ï¼Œè¦è€ƒè™‘è‡ªå·±çš„å±€éƒ¨å˜é‡è¡¨ä»€ä¹ˆçš„æ˜¯å¦è¶…è¿‡äº†javaè™šæ‹Ÿæœºæ ˆå…è®¸çš„æœ€å¤§å®¹é‡ï¼Œæ­¤æ—¶ä¼šæŠ›å‡ºä¸€ä¸ªStackOverflowError</li><li><strong>é‡‡ç”¨åŠ¨æ€æ‰©å±•çš„è™šæ‹Ÿæœºæ ˆ</strong>ï¼Œåœ¨å°è¯•æ‰©å±•çš„æ—¶å€™æ²¡åŠæ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ï¼Œæˆ–è€…åœ¨åˆ›å»ºçš„æ—¶å€™å°±æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜å»åˆ›å»ºè™šæ‹Ÿæœºæ ˆï¼Œé‚£ä¹ˆä¼šæŠ›å‡ºä¸€ä¸ªOutOfMemoryError</li></ul></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StackErrorTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">main</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸Šä»£ç ä¼šæŠ›å‡ºå¼‚å¸¸ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Exception</span> in thread <span class="token string">"main"</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>StackOverflowError</span>at <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>study<span class="token punctuation">.</span></span>StackErrorTest</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">StackErrorTest</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">)</span>    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><font color="red">æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>-XssÂ å…·ä½“å†…å­˜</code>æ¥æ§åˆ¶æ ˆå†…å­˜çš„å¤§å°</font></p><h3 id="æ ˆçš„å­˜å‚¨å•ä½"><a href="#æ ˆçš„å­˜å‚¨å•ä½" class="headerlink" title="æ ˆçš„å­˜å‚¨å•ä½"></a>æ ˆçš„å­˜å‚¨å•ä½</h3><blockquote><p>æ ˆé‡Œçš„æ•°æ®éƒ½æ˜¯ä»¥æ ˆå¸§(Stack Frame)çš„æ ¼å¼å­˜åœ¨çš„ã€‚</p><p>åœ¨çº¿ç¨‹ä¸Šæ­£åœ¨æ‰§è¡Œçš„æ¯ä¸ªæ–¹æ³•éƒ½å„è‡ªå¯¹åº”ä¸€ä¸ªæ ˆå¸§</p><p>æ ˆå¸§æ˜¯ä¸€ä¸ªå†…å­˜åŒºå—ï¼Œæ•°æ®é›†</p></blockquote><p><img src="https://s1.ax1x.com/2020/10/09/0BLxYj.png" alt="å½“å‰æ ˆå¸§"></p><ul><li><p>ä¸åŒçš„çº¿ç¨‹ä¹‹é—´æ‰€åŒ…å«çš„æ ˆå¸§æ˜¯ä¸èƒ½ç›¸äº’è°ƒç”¨çš„</p></li><li><p>å¦‚æœå½“å‰æ–¹æ³•è°ƒç”¨äº†å…¶ä»–æ–¹æ³•ï¼Œæ–¹æ³•è¿”å›çš„æ—¶å€™ä¼šæŠŠç»“æœç»™å‰ä¸€ä¸ªæ ˆå¸§ï¼Œè‡ªå·±è¢«å¼¹å‡ºæ ˆ</p></li><li><p>æ— è®ºæ˜¯æ­£å¸¸çš„returnè¿”å›ï¼Œè¿˜æ˜¯æŠ›å‡ºå¼‚å¸¸ç»“æŸï¼ˆæ²¡æœ‰å¤„ç†æ‰ï¼‰ï¼Œéƒ½ä¼šå¯¼è‡´æ ˆå¸§è¢«å¼¹å‡º</p><blockquote><p>å¦‚å›¾ä¸­æ‰€ç¤ºï¼Œå½“æ–¹æ³•4å‡ºç°å¼‚å¸¸ï¼Œè‡ªèº«æ²¡æœ‰å¤„ç†ï¼Œæ ˆå°±ä¼šå¼¹å‡ºæ–¹æ³•4,æŠŠå¼‚å¸¸è¿”å›ç»™æ–¹æ³•3ï¼Œçœ‹çœ‹æ–¹æ³•3æ˜¯å¦å¤„ç†ï¼Œå¦‚æœè¿˜æ²¡æœ‰å¤„ç†ï¼Œåˆ™æ ˆå¼¹å‡ºæ–¹æ³•3å¹¶ç»§ç»­è¿”å›ï¼Œç›´åˆ°æœ€åæ–¹æ³•1ã€‚å¦‚æœæ–¹æ³•1æ²¡æœ‰å¤„ç†ï¼Œé‚£ä¹ˆè™šæ‹Ÿæœºå°±ä¼šæŒ‚æ‰ã€‚</p></blockquote></li></ul><h3 id="æ ˆæ¡¢çš„å†…éƒ¨ç»“æ„"><a href="#æ ˆæ¡¢çš„å†…éƒ¨ç»“æ„" class="headerlink" title="æ ˆæ¡¢çš„å†…éƒ¨ç»“æ„"></a>æ ˆæ¡¢çš„å†…éƒ¨ç»“æ„</h3><blockquote><ul><li><strong>å±€éƒ¨å˜é‡è¡¨</strong></li><li><strong>æ“ä½œæ•°æ ˆ</strong></li><li>åŠ¨æ€é“¾æ¥ï¼ˆ<strong>æˆ–æŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± çš„æ–¹æ³•å¼•ç”¨</strong>ï¼‰</li><li>æ–¹æ³•è¿”å›åœ°å€ï¼ˆ<strong>æˆ–æ–¹æ³•æ­£å¸¸é€€å‡ºæˆ–è€…å¼‚å¸¸é€€å‡ºçš„å®šä¹‰</strong>ï¼‰</li><li>ä¸€äº›é™„åŠ ä¿¡æ¯</li></ul></blockquote><p><img src="https://s1.ax1x.com/2020/09/25/0ClVv6.png" alt="0ClVv6.png"></p><h4 id="å±€éƒ¨å˜é‡è¡¨"><a href="#å±€éƒ¨å˜é‡è¡¨" class="headerlink" title="å±€éƒ¨å˜é‡è¡¨"></a>å±€éƒ¨å˜é‡è¡¨</h4><blockquote><p>è¢«ç§°ä¸ºå±€éƒ¨å˜é‡æ•°ç»„æˆ–è€…æœ¬åœ°å˜é‡è¡¨</p><p><font color="red">å®šä¹‰ä¸ºä¸€ä¸ªæ•°å­—æ•°ç»„ï¼Œä¸»è¦ç”¨äºå­˜å‚¨æ–¹æ³•å‚æ•°å’Œè‡ªå®šä¹‰åœ¨æ–¹æ³•ä½“å†…çš„å±€éƒ¨å˜é‡</font>,è¿™äº›æ•°æ®ç±»å‹åŒ…æ‹¬å„ç±»åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå¯¹è±¡å¼•ç”¨ï¼Œä»¥åŠreturnAddressç±»å‹</p><ul><li>å»ºç«‹åœ¨çº¿ç¨‹çš„æ ˆä¸Šï¼Œæ˜¯çº¿ç¨‹ç§æœ‰æ•°æ®ï¼Œ<font color="red">ä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜</font></li><li><font color="red">å±€éƒ¨å˜é‡è¡¨æ‰€éœ€çš„å®¹é‡å¤§å°äº‹åœ¨ç¼–è¯‘çš„æ—¶å€™å°±ç¡®å®šä¸‹æ¥çš„</font>ï¼Œå¹¶ä¸”ä¿å­˜åœ¨æ–¹æ³•çš„Codeå±æ€§çš„maximun local variablesæ•°æ®é¡¹ä¸­ã€‚è¿è¡ŒæœŸé—´ä¸ä¼šæ”¹å˜å±€éƒ¨å˜é‡è¡¨çš„å¤§å°</li><li>å±€éƒ¨å˜é‡è¡¨çš„å˜é‡åªåœ¨å½“å‰æ–¹æ³•è°ƒç”¨ä¸­æœ‰æ•ˆï¼Œè°ƒç”¨ç»“æŸåï¼Œéšç€æ–¹æ³•æ ˆå¸§çš„é”€æ¯ï¼Œå±€éƒ¨å˜é‡è¡¨ä¹Ÿä¼šéšä¹‹é”€æ¯</li></ul></blockquote><p><strong>slot</strong></p><blockquote><p>slot æ˜¯å±€éƒ¨å˜é‡è¡¨ä¸­æœ€åŸºæœ¬çš„å­˜å‚¨å•å…ƒ</p><p>åœ¨å±€éƒ¨å˜é‡è¡¨ä¸­å­˜æ”¾ç¼–è¯‘æœŸå¯çŸ¥é“å„ç§æ•°æ®ç±»å‹ï¼Œå¼•ç”¨ç±»å‹(reference)ï¼ŒreturnAddressç±»å‹çš„å˜é‡</p><p>32ä½ä»¥å†…çš„ç±»å‹åªå ç”¨ä¸€ä¸ªslotï¼Œ64ä½çš„ç«™ä¿©</p></blockquote><p><strong>ä¸€ä¸ªé—®é¢˜ï¼š</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test123</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// è¿™é‡Œçš„thisä¼šå¯¼è‡´ç¼–è¯‘å¤±è´¥ï¼Œå› ä¸ºé™æ€æ–¹æ³•æ²¡æœ‰thiså­˜åœ¨å±€éƒ¨å˜é‡è¡¨ä¸­</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ç›¸åçš„ï¼Œåœ¨æˆ‘ä»¬çš„å®ä¾‹åˆ›å»ºçš„æ–¹æ³•ï¼Œæˆ–è€…æ„é€ æ–¹æ³•ä¸­ï¼Œthisä¼šå­˜æ”¾åœ¨indexä¸º0çš„slotä¸­</span><span class="token keyword">public</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">sout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token comment">//æ˜¯å¯ä»¥çš„</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>slot</strong>é‡å¤åˆ©ç”¨é—®é¢˜</p><p><font color = "red">æ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨ä¸­çš„slotæ˜¯å¯ä»¥é‡ç”¨çš„ï¼Œ</font>å¦‚æœä¸€ä¸ªå±€éƒ¨å˜é‡è¿‡äº†ä»–çš„ä½œç”¨åŸŸï¼Œåœ¨å…¶åå£°æ˜çš„å±€éƒ¨å˜é‡å°±å¯èƒ½ä¼šä½¿ç”¨ä»–çš„æ§½ä½ï¼Œä»è€Œ<strong>èŠ‚çœç©ºé—´</strong></p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**å› ä¸ºbçš„ç”Ÿå‘½åŸŸå°±åœ¨&#123;&#125;ä¸­ï¼Œå‡ºäº†&#123;&#125;ä»–å°±è¢«é”€æ¯äº†ã€‚ä½†æ˜¯åœ¨ä¹‹å‰è™šæ‹Ÿæœºæ ˆå·²ç»ä¸ºä»–å¼€è¾Ÿäº†ç©ºé—´ï¼Œé”€æ¯åè®©cä½¿ç”¨ä»–çš„ä½ç½®*/</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        b <span class="token operator">=</span> a <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">int</span> c <span class="token operator">=</span> a <span class="token operator">+</span> a<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æ“ä½œæ•°æ ˆ"><a href="#æ“ä½œæ•°æ ˆ" class="headerlink" title="æ“ä½œæ•°æ ˆ"></a>æ“ä½œæ•°æ ˆ</h4><blockquote><p>ç‰¹ç‚¹ï¼šåè¿›å…ˆå‡º</p><p>åœ¨æ–¹æ³•æ‰§è¡Œçš„è¿‡ç¨‹å½“ä¸­ï¼Œæ ¹æ®<strong>å­—èŠ‚ç æŒ‡ä»¤</strong>ï¼Œå¾€æ ˆä¸­å†™å…¥æ•°æ®æˆ–è€…æå–æ•°æ®ï¼Œï¼ˆå…¥æ ˆ/å‡ºæ ˆï¼‰</p><pre><code>- æ¯”å¦‚æ‰§è¡Œå¤åˆ¶ï¼Œäº¤æ¢ï¼Œæ±‚å’Œç­‰æ“ä½œ</code></pre><p>å¦‚æœè¢«è°ƒç”¨çš„æ–¹æ³•å¸¦æœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼ä¼šè¢«å‹å…¥å½“å‰æ ˆå¸§çš„æ“ä½œæ•°æ ˆä¸­ï¼Œå¹¶æ›´æ–°pcå¯„å­˜å™¨ä¸­ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚</p><ul><li>è™šæ‹Ÿæœºåœ¨æ“ä½œæ•°æ ˆä¸­å­˜å‚¨æ•°æ®çš„æ–¹å¼å’Œåœ¨å±€éƒ¨å˜é‡åŒºä¸­æ˜¯ä¸€æ ·çš„ï¼šå¦‚intã€longã€floatã€doubleã€referenceå’ŒreturnTypeçš„å­˜å‚¨ã€‚å¯¹äºbyteã€shortä»¥åŠcharç±»å‹çš„å€¼åœ¨å‹å…¥åˆ°æ“ä½œæ•°æ ˆä¹‹å‰ï¼Œä¹Ÿä¼šè¢«è½¬æ¢ä¸ºintã€‚</li></ul></blockquote><p><strong>è™šæ‹ŸæœºæŠŠæ“ä½œæ•°æ ˆä½œä¸ºå®ƒçš„å·¥ä½œåŒºâ€”â€”å¤§å¤šæ•°æŒ‡ä»¤éƒ½è¦ä»è¿™é‡Œå¼¹å‡ºæ•°æ®ï¼Œæ‰§è¡Œè¿ç®—ï¼Œç„¶åæŠŠç»“æœå‹å›æ“ä½œæ•°æ ˆã€‚</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java">begin  iload_0    <span class="token comment">// push the int in local variable 0 onto the stack  </span>iload_1    <span class="token comment">// push the int in local variable 1 onto the stack  </span>iadd       <span class="token comment">// pop two ints, add them, push result  </span>istore_2   <span class="token comment">// pop int, store into local variable 2  </span>end  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>åœ¨ä¸Šè¾¹çš„ä¾‹å­ä¸­ï¼Œiload_0å’Œiload_1æŠŠå±€éƒ¨å˜é‡è¡¨ä¸­ç´¢å¼•ä¸º0å’Œ1çš„æ•´æ•°å‹å…¥æ“ä½œæ•°æ ˆ</p><p>è°ƒç”¨iaddæŒ‡ä»¤æŠŠä¸¤ä¸ªæ•°ä»æ“ä½œæ•°æ ˆä¸­å¼¹å‡ºå¹¶ç›¸åŠ ï¼Œ<strong>æŠŠç»“æœå‹å…¥æ“ä½œæ•°æ ˆ</strong></p><p>istore_2ä»æ“ä½œæ•°æ ˆä¸­å¼¹å‡ºç»“æœï¼ŒæŠŠå®ƒå­˜å‚¨åˆ°å±€éƒ¨å˜é‡è¡¨ä¸­ç´¢å¼•ä¸º2çš„ä½ç½®ã€‚</p></blockquote><p><img src="http://dl.iteye.com/upload/picture/pic/116487/4032d1b9-43c5-3dc6-95c8-38b9fbb149b0.jpg" alt="æ¼”ç¤ºå›¾"></p><h5 id="æ ˆé¡¶ç¼“å­˜æŠ€æœ¯"><a href="#æ ˆé¡¶ç¼“å­˜æŠ€æœ¯" class="headerlink" title="æ ˆé¡¶ç¼“å­˜æŠ€æœ¯"></a>æ ˆé¡¶ç¼“å­˜æŠ€æœ¯</h5><blockquote><p>åŸºäºæ ˆå¼æ¶æ„çš„è™šæ‹Ÿæœºä½¿ç”¨çš„é›¶åœ°å€æŒ‡ä»¤æ›´åŠ ç´§å‡‘ï¼Œä½†æ˜¯å®Œæˆä¸€ä¸ªæ“ä½œéœ€è¦ä¸åœçš„å…¥æ ˆå‡ºæ ˆï¼Œï¼Œç»å¸¸å¯¹å†…å­˜è¿›è¡Œè¯»å†™ï¼Œæ•ˆç‡ä¼šè¢«é™ä½ã€‚</p><p>æ‰€ä»¥å¼€å‘è€…<strong>å°†æ ˆé¡¶å…ƒç´ å…¨éƒ¨ç¼“å­˜åœ¨ç‰©ç†cpuå¯„å­˜å™¨ä¸­ï¼Œä»¥æ­¤é™ä½å¯¹å†…å­˜çš„è¯»å†™æ¬¡æ•°ï¼Œæå‡æ‰§è¡Œå¼•æ“çš„æ‰§è¡Œæ•ˆç‡</strong></p></blockquote><h4 id="åŠ¨æ€é“¾æ¥"><a href="#åŠ¨æ€é“¾æ¥" class="headerlink" title="åŠ¨æ€é“¾æ¥"></a>åŠ¨æ€é“¾æ¥</h4><blockquote><p><strong>åœ¨æŸäº›ä¹¦ä¸Š åŠ¨æ€é“¾æ¥ï¼Œæ–¹æ³•è¿”å›åœ°å€ï¼Œé™„åŠ ä¿¡æ¯ä¼šè¢«ç§°ä¸º</strong><font color = "red"><strong>å¸§æ•°æ®åŒº</strong></font></p></blockquote><ul><li>åŠ¨æ€é“¾æ¥ä¸»è¦å°±æ˜¯<strong>æŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± çš„æ–¹æ³•å¼•ç”¨</strong></li><li>æ¯ä¸€ä¸ªæ ˆå¸§å†…å­˜éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± ä¸­è¯¥æ ˆå¸§æ‰€å±æ–¹æ³•çš„å¼•ç”¨ï¼ŒåŒ…å«è¿™ä¸ªå¼•ç”¨çš„ç›®çš„å°±æ˜¯ä¸ºäº†æ”¯æŒå½“å‰æ–¹æ³•çš„ä»£ç èƒ½å¤Ÿå®ç°åŠ¨æ€é“¾æ¥(Dynamic Linking)ã€‚æ¯”å¦‚invokedynamic æŒ‡ä»¤</li><li>åœ¨Javaæºæ–‡ä»¶è¢«ç¼–è¯‘åˆ°å­—èŠ‚ç æ–‡ä»¶ä¸­æ—¶ï¼Œæ‰€æœ‰çš„å˜é‡å’Œæ–¹æ³•å¼•ç”¨éƒ½<strong>ä½œä¸ºç¬¦å·å¼•ç”¨ä¿å­˜åœ¨classæ–‡ä»¶çš„å¸¸é‡æ± é‡Œ</strong>ã€‚æ¯”å¦‚ï¼Œæè¿°ä¸€ä¸ªæ–¹æ³•è°ƒç”¨å…¶ä»–æ–¹æ³•æ—¶ï¼Œå°±æ˜¯é€šè¿‡å¸¸é‡æ± ä¸­æŒ‡å‘æ–¹æ³•çš„ç¬¦å·å¼•ç”¨æ¥è¡¨ç¤ºçš„ï¼Œé‚£ä¹ˆ<strong>åŠ¨æ€é“¾æ¥çš„ä½œç”¨å°±æ˜¯ä¸ºäº†å°†è¿™äº›ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºè°ƒç”¨æ–¹æ³•çš„ç›´æ¥å¼•ç”¨</strong></li></ul><p><img src="https://s1.ax1x.com/2020/10/09/0rDVK0.png" alt="0rDVK0.png"></p><h4 id="æ–¹æ³•çš„è°ƒç”¨ï¼šè§£æä¸åˆ†æ´¾"><a href="#æ–¹æ³•çš„è°ƒç”¨ï¼šè§£æä¸åˆ†æ´¾" class="headerlink" title="æ–¹æ³•çš„è°ƒç”¨ï¼šè§£æä¸åˆ†æ´¾"></a>æ–¹æ³•çš„è°ƒç”¨ï¼šè§£æä¸åˆ†æ´¾</h4><blockquote><p><strong>å°†ç¬¦å·å¼•ç”¨è½¬æ¢æˆè°ƒç”¨æ–¹æ³•çš„ç›´æ¥å¼•ç”¨</strong></p><p>å¦‚æœ<strong>è½¬æ¢çš„è¿‡ç¨‹æ˜¯åœ¨ç¼–è¯‘æœŸé—´ç¡®å®šä¸‹æ¥</strong>ï¼Œå¹¶ä¸”è¿è¡ŒæœŸé—´ä¿æŒä¸å˜ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯<strong>é™æ€é“¾æ¥</strong></p><p>å¦‚æœ<strong>è¢«è°ƒç”¨çš„æ–¹æ³•åœ¨ç¼–è¯‘æœŸæ— æ³•è¢«ç¡®å®šä¸‹æ¥</strong>ï¼Œé‚£ä¹ˆåªèƒ½åœ¨ç¨‹åºè¿è¡ŒæœŸé—´è¿›è¡Œè½¬æ¢ï¼Œè¢«ç§°ä¸º<strong>åŠ¨æ€é“¾æ¥</strong></p></blockquote><p><strong>å¯¹äºæ–¹æ³•æ¥è¯´</strong>ï¼š</p><p>æ¥å£çš„æ–¹æ³•è°ƒç”¨åœ¨ç¼–è¯‘æœŸé—´æ˜¯ä¸ç¡®å®šçš„ï¼Œæ‰€ä»¥æ˜¯<strong>æ™šæœŸç»‘å®š</strong></p><p>è€Œæ–¹æ³•ä¸­å¦‚æœè°ƒç”¨äº†æ„é€ å™¨ï¼Œæ˜¯å¯ä»¥åœ¨ç¼–è¯‘æœŸé—´ç¡®å®šçš„ï¼Œæ˜¯<strong>æ—©æœŸç»‘å®š</strong></p><p><strong>è™šæ–¹æ³•å’Œéè™šæ–¹æ³•</strong>ï¼š</p><ul><li>é™æ€æ–¹æ³•ï¼Œç§æœ‰æ–¹æ³•ï¼Œfinalæ–¹æ³•ï¼Œæ„é€ å™¨ï¼Œçˆ¶ç±»æ–¹æ³•éƒ½æ˜¯éè™šæ–¹æ³•</li><li>æ–¹æ³•åœ¨ç¼–è¯‘å™¨å°±ç¡®å®šäº†å…·ä½“çš„è°ƒç”¨ï¼Œå¹¶ä¸”åœ¨è¿è¡Œæ—¶ä¸å¯å˜ï¼Œå°±æ˜¯éè™šæ–¹æ³•</li></ul><blockquote><p>JVMæä¾›äº†å¦‚ä¸‹æ–¹æ³•è°ƒç”¨æŒ‡ä»¤ï¼š</p></blockquote><ol><li>invokestatic è°ƒç”¨é™æ€æ–¹æ³•</li><li>invokespecial è°ƒç”¨ç§æœ‰å®ä¾‹æ–¹æ³•ã€æ„é€ å™¨ï¼Œä»¥åŠä½¿ç”¨superå…³é”®å­—è°ƒç”¨çˆ¶ç±»çš„å®ä¾‹æ–¹æ³•æˆ–æ„é€ å™¨ï¼Œå’Œæ‰€æœ‰å®ç°æ¥å£çš„é»˜è®¤æ–¹æ³•ã€‚</li><li>invokevirtual è°ƒç”¨è™šæ–¹æ³•å³éç§æœ‰çš„å®ä¾‹æ–¹æ³•ã€‚</li><li>invokeinterface è°ƒç”¨æ¥å£æ–¹æ³•ï¼Œåœ¨è¿è¡Œæ—¶å†ç¡®å®šä¸€ä¸ªå®ç°æ­¤æ¥å£çš„å¯¹è±¡ã€‚</li><li>invokedynamic è°ƒç”¨åŠ¨æ€æ–¹æ³•ï¼Œåœ¨è¿è¡Œæ—¶åŠ¨æ€è§£æå‡ºè°ƒç”¨ç‚¹é™å®šç¬¦æ‰€å¼•ç”¨çš„æ–¹æ³•ä¹‹åï¼Œè°ƒç”¨è¯¥æ–¹æ³•ã€‚</li></ol><p><strong>æ–¹æ³•é‡å†™çš„æœ¬è´¨</strong></p><p><img src="/home/zhy/.config/Typora/typora-user-images/image-20200927113251358.png" alt="image-20200927113251358"></p><p><strong>è™šæ–¹æ³•è¡¨</strong></p><blockquote><p>åœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ä¸­ï¼Œä¼šå¾ˆé¢‘ç¹çš„ä½¿ç”¨åˆ°åŠ¨æ€åˆ†æ´¾ï¼Œå¦‚æœåœ¨æ¯æ¬¡åŠ¨æ€åˆ†æ´¾çš„è¿‡ç¨‹ä¸­éƒ½è¦é‡æ–°åœ¨ç±»çš„æ–¹æ³•å…ƒæ•°æ®ä¸­æœç´¢åˆé€‚çš„ç›®æ ‡çš„è¯å°±ä¼šå½±å“åˆ°æ‰§è¡Œæ•ˆç‡ã€‚</p><p><strong>ä¸ºäº†æé«˜æ€§èƒ½</strong>ï¼Œjvmåœ¨ç±»çš„æ–¹æ³•åŒºå»ºç«‹ä¸€ä¸ªè™šæ–¹æ³•è¡¨ã€‚ä½¿ç”¨ç´¢å¼•æ¥ä»£æ›¿æŸ¥æ‰¾ã€‚</p><p>æ¯ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªè™šæ–¹æ³•è¡¨ï¼Œç”¨æ¥å­˜æ”¾å„ä¸ªæ–¹æ³•çš„å®é™…å…¥å£</p></blockquote><p><strong>è™šæ–¹æ³•è¡¨åœ¨ä»€ä¹ˆæ—¶å€™ä¼šè¢«åˆ›å»º</strong>ï¼Ÿï¼Ÿ</p><blockquote><p>è™šæ–¹æ³•è¡¨ä¼šåœ¨ç±»åŠ è½½åˆ°é“¾æ¥é˜¶æ®µè¢«åˆ›å»ºå¹¶å¼€å§‹åˆå§‹åŒ–ï¼Œç±»çš„å˜é‡åˆå§‹å€¼å‡†å¤‡å®Œæˆåï¼ŒJVMä¼šæŠŠè¯¥ç±»çš„æ–¹æ³•è¡¨ä¹Ÿåˆå§‹åŒ–å®Œæ¯•ã€‚</p></blockquote><h4 id="æ–¹æ³•è¿”å›åœ°å€"><a href="#æ–¹æ³•è¿”å›åœ°å€" class="headerlink" title="æ–¹æ³•è¿”å›åœ°å€"></a>æ–¹æ³•è¿”å›åœ°å€</h4><blockquote><p>è¿™ä¸€å—åŒºåŸŸæ˜¯ç”¨æ¥å­˜å‚¨pcå¯„å­˜å™¨ä¸­çš„å€¼ï¼Œç›®çš„æ˜¯ä¸ºäº†ç»™æ‰§è¡Œå¼•æ“è®©ä»–ç»§ç»­åšæ“ä½œ</p><p>ä¸€ä¸ªæ–¹æ³•å¦‚æœæ˜¯æ­£å¸¸æ‰§è¡Œå®Œæˆæ—¶<strong>pcå¯„å­˜å™¨çš„å€¼ä½œä¸ºè¿”å›åœ°å€ï¼Œå³è°ƒç”¨è¯¥æ–¹æ³•çš„æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€</strong>ã€‚å¦‚æœæ˜¯é€šè¿‡å¼‚å¸¸é€€å‡ºçš„ï¼Œ<strong>è¿”å›åœ°å€è¦é€šè¿‡å¼‚å¸¸è¡¨æ¥ç¡®å®šï¼Œæ ˆå¸§ä¸­ä¸€èˆ¬ä¸ä¼šä¿å­˜æ­¤ä¿¡æ¯</strong></p></blockquote><p>æµç¨‹ï¼š</p><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201008204215341.png" alt="image-20201008204215341"></p><p><strong>å­—èŠ‚ç æŒ‡ä»¤ï¼š</strong></p><p><img src="/home/zhy/.config/Typora/typora-user-images/image-20200927115358502.png" alt="image-20200927115358502"></p><h4 id="ä¸€äº›é™„åŠ ä¿¡æ¯"><a href="#ä¸€äº›é™„åŠ ä¿¡æ¯" class="headerlink" title="ä¸€äº›é™„åŠ ä¿¡æ¯"></a>ä¸€äº›é™„åŠ ä¿¡æ¯</h4><blockquote><p>æ— </p></blockquote><h4 id="ç›¸å…³é¢è¯•é—®é¢˜"><a href="#ç›¸å…³é¢è¯•é—®é¢˜" class="headerlink" title="ç›¸å…³é¢è¯•é—®é¢˜"></a>ç›¸å…³é¢è¯•é—®é¢˜</h4><blockquote><p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¸¸é‡æ± ï¼Ÿ</p></blockquote><ul><li>å¸¸é‡æ± çš„ä½œç”¨å°±æ˜¯ä¸ºäº†æä¾›ä¸€äº›ç¬¦å·å’Œå¸¸é‡ï¼Œä¾¿äºæŒ‡ä»¤çš„è¯†åˆ«ã€‚</li></ul><blockquote><p>ä¸¾ä¾‹æ ˆæº¢å‡ºçš„æƒ…å†µ(StackOverflowError)</p></blockquote><ul><li>é€šè¿‡-Xssè®¾ç½®æ ˆçš„å¤§å°</li><li>OOM</li></ul><blockquote><p>åˆ†é…çš„æ ˆå†…å­˜è¶Šå¤§è¶Šå¥½ï¼Ÿ</p></blockquote><ul><li>å†…å­˜ç©ºé—´æœ‰é™</li><li>ä¸èƒ½é¿å…æ ˆæº¢å‡ºçš„æƒ…å†µå‘ç”Ÿ</li></ul><blockquote><p>åƒåœ¾å›æ”¶æ¶‰åŠåˆ°ä»€ä¹ˆ</p></blockquote><ul><li>æ–¹æ³•åŒº</li><li>å †</li></ul><h2 id="æœ¬åœ°æ–¹æ³•æ ˆ"><a href="#æœ¬åœ°æ–¹æ³•æ ˆ" class="headerlink" title="æœ¬åœ°æ–¹æ³•æ ˆ"></a>æœ¬åœ°æ–¹æ³•æ ˆ</h2><blockquote><p>native methodå°±æ˜¯javaè°ƒç”¨éjavaä»£ç çš„æ¥å£</p><p>æœ¬åœ°æ¥å£çš„åˆè¡·å°±æ˜¯èåˆä¸åŒçš„ç¼–ç¨‹è¯­è¨€ä¸ºjavaæ‰€ç”¨</p></blockquote><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201008210718117.png" alt="image-20201008210718117"></p><blockquote><p>æœ¬åœ°æ–¹æ³•æ ˆæ˜¯ç”¨äºç®¡ç†æœ¬åœ°æ–¹æ³•çš„è°ƒç”¨</p><ul><li>æœ¬åœ°æ–¹æ³•æ˜¯çº¿ç¨‹ç§æœ‰çš„</li><li>å…è®¸è¢«å®ç°æˆå›ºå®šæˆ–è€…æ˜¯å¯åŠ¨æ€æ‰©å±•çš„å†…å­˜å¤§å°<ul><li>å¦‚æœçº¿ç¨‹è¯·æ±‚åˆ†é…çš„æ ˆå®¹é‡è¶…è¿‡æœ¬åœ°æ–¹æ³•æ ˆå…è®¸çš„æœ€å¤§å®¹é‡æŠ¥é”™æ ˆæº¢å‡º</li><li>å¦‚æœæœ¬åœ°æ–¹æ³•æ ˆå¯ä»¥åŠ¨æ€æ‰©å±•ï¼Œåœ¨å°è¯•æ‰©å±•çš„æ—¶å€™æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜å°±ä¼šå†…å­˜æº¢å‡º</li></ul></li><li>æœ¬åœ°æ–¹æ³•æ˜¯cå®ç°çš„</li><li>åœ¨æœ¬åœ°æ–¹æ³•æ ˆä¸­ç™»è®°nativeæ–¹æ³•ï¼Œåœ¨æ‰§è¡Œå¼•æ“æ‰§è¡Œæ—¶å€™åŠ è½½æœ¬åœ°æ–¹æ³•åº“</li></ul></blockquote><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201008213600601.png" alt="image-20201008213600601"></p><blockquote><ul><li>å½“æŸä¸ªçº¿ç¨‹è°ƒç”¨ä¸€ä¸ªæœ¬åœ°æ–¹æ³•æ—¶ï¼Œä»–ä¼šè¿›å…¥ä¸€ä¸ªå…¨æ–°çš„å¹¶ä¸”ä¸å—è™šæ‹Ÿæœºé™åˆ¶çš„ä¸–ç•Œ<ul><li>æœ¬åœ°æ–¹æ³•å¯ä»¥é€šè¿‡æœ¬åœ°æ–¹æ³•æ¥å£æ¥è®¿é—®è™šæ‹Ÿæœºå†…éƒ¨çš„è¿è¡Œæ—¶æ•°æ®åŒº</li><li>ç”šè‡³å¯ä»¥ç›´æ¥ä½¿ç”¨æœ¬åœ°å¤„ç†å™¨ä¸­çš„å¯„å­˜å™¨</li><li>ç›´æ¥ä»æœ¬åœ°çš„å †ä¸­åˆ†é…ä»»æ„æ•°é‡çš„å†…å­˜</li></ul></li><li>å¹¶ä¸æ˜¯æ‰€æœ‰çš„JVMéƒ½æ”¯æŒæœ¬åœ°æ–¹æ³•ï¼Œå› ä¸ºJavaè™šæ‹Ÿæœºè§„èŒƒæ²¡æœ‰æ˜ç¡®è¦æ±‚æœ¬åœ°æ–¹æ³•ç«™çš„ä½¿ç”¨è¯­è¨€ï¼Œå…·ä½“å®ç°æ–¹å¼ï¼Œæ•°æ®ç»“æ„ã€‚</li><li>åœ¨ Hotspotè™šæ‹Ÿæœºä¸­ï¼Œç›´æ¥å°†æœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹ŸæœºåˆäºŒä¸ºä¸€</li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> -jvm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java8æ–°ç‰¹æ€§</title>
      <link href="2020/09/21/java8-xin-te-xing/"/>
      <url>2020/09/21/java8-xin-te-xing/</url>
      
        <content type="html"><![CDATA[<h1 id="java8æ–°ç‰¹æ€§"><a href="#java8æ–°ç‰¹æ€§" class="headerlink" title="java8æ–°ç‰¹æ€§"></a>java8æ–°ç‰¹æ€§</h1><h2 id="ç”Ÿæ€"><a href="#ç”Ÿæ€" class="headerlink" title="ç”Ÿæ€"></a>ç”Ÿæ€</h2><ul><li>Lambda è¡¨è¾¾å¼</li><li>å‡½æ•°å¼æ¥å£</li><li>æ–¹æ³•å¼•ç”¨ã€æ„é€ å™¨å¼•ç”¨</li><li>Stream API</li><li>æ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•/é™æ€æ–¹æ³•</li><li>æ–°æ—¶é—´æ—¥æœŸAPI</li><li>å…¶ä»–æ–°ç‰¹æ€§</li></ul><h2 id="æ–°ç‰¹æ€§"><a href="#æ–°ç‰¹æ€§" class="headerlink" title="æ–°ç‰¹æ€§"></a>æ–°ç‰¹æ€§</h2><ul><li>é€Ÿåº¦æ›´å¿«</li><li>ä»£ç æ›´å°‘</li><li>å¼ºå¤§çš„Stream API</li><li>ä¾¿äºå¹¶è¡Œ</li><li>æœ€å¤§åŒ–å‡å°‘ç©ºæŒ‡é’ˆå¼‚å¸¸Optional</li><li>Hashmapåº•å±‚çš„å˜åŒ–</li><li>â€¦â€¦.</li></ul><h2 id="Lambdaè¡¨è¾¾å¼"><a href="#Lambdaè¡¨è¾¾å¼" class="headerlink" title="Lambdaè¡¨è¾¾å¼"></a>Lambdaè¡¨è¾¾å¼</h2><blockquote><p>Java 8çš„ä¸€ä¸ªå¤§äº®ç‚¹æ˜¯å¼•å…¥Lambdaè¡¨è¾¾å¼ï¼Œä½¿ç”¨å®ƒè®¾è®¡çš„ä»£ç ä¼šæ›´åŠ ç®€æ´ã€‚å½“å¼€å‘è€…åœ¨ç¼–å†™Lambdaè¡¨è¾¾å¼æ—¶ï¼Œä¹Ÿä¼šéšä¹‹è¢«ç¼–è¯‘æˆä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚ä½¿ç”¨Lambdaè¡¨è¾¾å¼ä¸ä»…è®©ä»£ç å˜çš„ç®€å•ã€è€Œä¸”å¯è¯»ã€æœ€é‡è¦çš„æ˜¯ä»£ç é‡ä¹Ÿéšä¹‹å‡å°‘å¾ˆå¤šã€‚</p></blockquote><p><strong>æ¼”å˜è¿‡ç¨‹</strong></p><blockquote><p>åƒåœ¾ä»£ç  â€“&gt; ç­–ç•¥æ¨¡å¼ â€“&gt; åŒ¿åå†…éƒ¨ç±» â€“&gt; Lambdaè¡¨è¾¾å¼</p></blockquote><p><strong>ä¸¾ä¾‹</strong></p><ul><li><p>åŒ¿åå†…éƒ¨ç±»</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> comparator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> o1<span class="token punctuation">,</span> <span class="token class-name">Integer</span> o2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token number">01</span><span class="token punctuation">,</span><span class="token number">02</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><ul><li><p>Lambdaè¡¨è¾¾å¼</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> comparator <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><p><strong>æ ¼å¼</strong></p><ul><li><p>æ— å‚æ•°æ— è¿”å›å€¼</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test02</span> <span class="token punctuation">&#123;</span><span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//jdk 1.7ä»¥å‰ å¿…é¡»finalä¿®é¥°</span>        <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//åŒ¿åå†…éƒ¨ç±»</span>        <span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">//åœ¨å±€éƒ¨ç±»ä¸­å¼•ç”¨åŒçº§å±€éƒ¨å˜é‡</span>                <span class="token comment">//åªè¯»</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Hello World"</span> <span class="token operator">+</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//è¯­æ³•ç³–</span>     <span class="token class-name">Runnable</span> runnable <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Hello Lambda"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><ul><li><p>æœ‰ä¸€ä¸ªå‚æ•°æ— è¿”å›å€¼</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> consumer <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>    consumer<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">"æˆ‘è§‰å¾—è¿˜è¡Œï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><ul><li><p>æœ‰ä¸¤ä¸ªä»¥ä¸Šçš„å‚æ•°ï¼Œæœ‰è¿”å›å€¼</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test04</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> comparator <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¯”è¾ƒæ¥å£"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><ul><li><p>æœ‰ä¸¤ä¸ªä»¥ä¸Šçš„å‚æ•°ï¼Œæœ‰è¿”å›å€¼ï¼Œå¹¶ä¸” Lambda ä½“ä¸­åªæœ‰1æ¡è¯­å¥ ï¼ˆå¤§æ‹¬å· ä¸ return éƒ½å¯ä»¥çœç•¥ä¸å†™ï¼‰</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test04</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> comparator <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p><strong>å‡½æ•°å¼æ¥å£</strong></p><blockquote><p>å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œåªèƒ½å­˜æ”¾ä¸€ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”è¦æ·»åŠ æ³¨è§£ @FunctionalInterface</p></blockquote><p><strong>å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥ä¸ä½¿ç”¨æ³›å‹</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@FunctionalInterface</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">MyFun</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>    <span class="token class-name">T</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token class-name">T</span> t<span class="token punctuation">,</span> <span class="token class-name">T</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æµ‹è¯•</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">MyFun</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> myFun <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">-></span> x<span class="token operator">+</span>y<span class="token punctuation">;</span><span class="token class-name">MyFun</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> myFun2 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">-></span> x<span class="token operator">-</span>y<span class="token punctuation">;</span><span class="token class-name">MyFun</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> myFun3 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">-></span> x<span class="token operator">+</span>y<span class="token punctuation">;</span><span class="token class-name">MyFun</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Double</span><span class="token punctuation">></span></span> myFun4 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">-></span> x<span class="token operator">*</span>y<span class="token punctuation">;</span><span class="token class-name">Integer</span> count <span class="token operator">=</span> myFun<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Integer</span> count2 <span class="token operator">=</span> myFun2<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> count3 <span class="token operator">=</span> myFun3<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Double</span> count4 <span class="token operator">=</span> myFun4<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1.1</span><span class="token punctuation">,</span><span class="token number">2.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*ç»“æœæ˜¯ï¼š    3    -1    12    2.3100000000000005*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å¯ä»¥å‘ç°ï¼Œå‡½æ•°å¼æ¥å£è®©æˆ‘ä»¬åœ¨å®ç°ä¸šåŠ¡çš„æ—¶å€™æœ‰äº†å¾ˆé«˜çš„è‡ªç”±åº¦ï¼Œä»£ç ä¹¦å†™ä¹Ÿæ›´åŠ çš„ç´§å‡‘ï¼Œç®€ä¾¿ï¼Œå‡å°‘äº†ä»£ç é‡</p></blockquote><h2 id="å‡½æ•°å¼ç¼–ç¨‹"><a href="#å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹"></a>å‡½æ•°å¼ç¼–ç¨‹</h2><p><strong>Javaå†…ç½®å››å¤§æ ¸å¿ƒå‡½æ•°å¼æ¥å£ï¼š</strong></p><table><thead><tr><th align="center"><strong>å‡½æ•°å¼æ¥å£</strong></th><th align="center"><strong>å‚æ•°ç±»å‹</strong></th><th align="center">è¿”å›ç±»å‹</th><th align="center"><strong>ç”¨é€”</strong></th></tr></thead><tbody><tr><td align="center">Consumer<br/>æ¶ˆè´¹å‹æ¥å£</td><td align="center">T</td><td align="center">void</td><td align="center">å¯¹ç±»å‹ä¸ºTçš„å¯¹è±¡åº”ç”¨æ“ä½œï¼švoid accept(T t)</td></tr><tr><td align="center">Supplier<br/>æä¾›å‹æ¥å£</td><td align="center">æ— </td><td align="center">T</td><td align="center">è¿”å›ç±»å‹ä¸ºTçš„å¯¹è±¡ï¼šT get()</td></tr><tr><td align="center">Function&lt;T, R&gt;<br/>å‡½æ•°å‹æ¥å£</td><td align="center">T</td><td align="center">R</td><td align="center">ç¡®å®šç±»å‹ä¸ºTçš„å¯¹è±¡æ˜¯å¦æ»¡è¶³æŸçº¦æŸï¼Œå¹¶è¿”å›booleanå€¼ï¼šboolean test(T t)</td></tr><tr><td align="center">Predicate<br/>æ–­è¨€å‹æ¥å£</td><td align="center">T</td><td align="center">boolean</td><td align="center">ç¡®å®šç±»å‹ä¸ºTçš„å¯¹è±¡æ˜¯å¦æ»¡è¶³æŸçº¦æŸï¼Œå¹¶è¿”å›booleanå€¼ï¼šboolean test(T t)</td></tr></tbody></table><p><strong>æ¶ˆè´¹å‹æ¥å£</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@org.junit.Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test06</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> consumer <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-></span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>    consumer<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æä¾›å‹æ¥å£</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@org.junit.Test</span><span class="token keyword">public</span>  <span class="token keyword">void</span> <span class="token function">test07</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span><span class="token punctuation">></span></span> supplier <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> list<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> supplier<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å‡½æ•°å‹æ¥å£</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@org.junit.Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test08</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> function <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-></span> x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> apply <span class="token operator">=</span> function<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>apply<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ–­è¨€å‹æ¥å£</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@org.junit.Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test09</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> predicate <span class="token operator">=</span> x<span class="token operator">-></span> <span class="token string">"predicate"</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>predicate<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å…¶ä»–çš„æ¥å£</strong></p><p><img src="/home/zhy/.config/Typora/typora-user-images/image-20200922093418137.png" alt="å­æ¥å£"></p><h2 id="æ–¹æ³•å¼•ç”¨"><a href="#æ–¹æ³•å¼•ç”¨" class="headerlink" title="æ–¹æ³•å¼•ç”¨"></a>æ–¹æ³•å¼•ç”¨</h2><blockquote><p>å¦‚æœLambdaä½“ä¸­çš„å†…å®¹æœ‰æ–¹æ³•å·²ç»å®ç°äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨(æ˜¯Lambdaçš„å¦ä¸€ç§è¡¨è¾¾å½¢å¼)</p></blockquote><p><strong>è¯­æ³•æ ¼å¼</strong></p><ul><li><p>å¯¹è±¡::å®ä¾‹æ–¹æ³•å</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@org.junit.Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> consumer <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">-></span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/*    ä¸¤è€…éƒ½æ²¡æœ‰è¿”å›å€¼ï¼Œå‚æ•°åˆ—è¡¨ä¹Ÿä¸€æ ·    å¯¹è±¡::å®ä¾‹æ–¹æ³•å     */</span>    <span class="token class-name">Cons</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> consumer2 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@org.junit.Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Users</span> users <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Users</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/*    getPassword()çš„è¿”å›ç±»å‹æ˜¯String    å‡½æ•°å¼æ¥å£ä¸­æŠ½è±¡æ–¹æ³•çš„è¿”å›å€¼ä¹Ÿæ˜¯String    äºŒè€…éƒ½æ²¡æœ‰å‚æ•°    å¯ä»¥ç®€åŒ–lambdaè¡¨è¾¾å¼    */</span>    <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> supplier <span class="token operator">=</span> users<span class="token operator">::</span><span class="token function">getPassword</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>supplier<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><ul><li><p>ç±»::é™æ€æ–¹æ³•å</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@org.junit.Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// ç±»:: é™æ€æ–¹æ³•</span>    <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> comparator <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">-></span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> comparator1 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">compare</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>comparator1<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><ul><li><p>ç±»::å®ä¾‹æ–¹æ³•å</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java">  <span class="token annotation punctuation">@org.junit.Test</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token comment">// ç±»:: å®ä¾‹æ–¹æ³•å</span>      <span class="token class-name">BiPredicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">></span></span> predicate <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">-></span>x<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è¿™ä¸€ä¸ªè·Ÿä¸Šè¾¹çš„ ç±»::é™æ€æ–¹æ³•åå·®ä¸å¤š</span>      <span class="token class-name">BiPredicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">></span></span> predicate2 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token operator">::</span><span class="token function">equals</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><blockquote><p>å§‹ç»ˆè¦<strong>æ³¨æ„</strong>çš„æ˜¯ï¼š</p><ul><li><p>Lambdaä½“é»„æ€»è°ƒç”¨æ–¹æ³•çš„å‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ï¼Œä¸å‡½æ•°å¼æ¥å£ä¸­æŠ½è±¡æ–¹æ³•å’Œè¿”å›å€¼ç±»å‹ä¿æŒä¸€è‡´</p></li><li><p>å¦‚æœLambdaå‚æ•°åˆ—è¡¨ä¸­çš„ç¬¬ä¸€å‚æ•°æ˜¯å®ä¾‹æ–¹æ³•çš„è°ƒç”¨ç€ï¼Œè€Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å®ä¾‹æ–¹æ³•çš„å‚æ•°ï¼Œå¯ä»¥ç”¨<code>ClassName::method</code>è¡¨ç¤º</p></li></ul></blockquote><h2 id="æ„é€ å™¨å¼•ç”¨"><a href="#æ„é€ å™¨å¼•ç”¨" class="headerlink" title="æ„é€ å™¨å¼•ç”¨"></a>æ„é€ å™¨å¼•ç”¨</h2><p><strong>æ ¼å¼</strong></p><ul><li>ClassName::new</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/*ç®€å•æ¡ˆä¾‹ï¼Œå¼•ç”¨æ— å‚æ„é€ å™¨*/</span><span class="token annotation punctuation">@org.junit.Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// className::new</span>    <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Users</span><span class="token punctuation">></span></span> supplier <span class="token operator">=</span> <span class="token class-name">Users</span><span class="token operator">::</span><span class="token keyword">new</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>supplier<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>æ³¨æ„</strong></p><ul><li>éœ€è¦è°ƒç”¨çš„æ„é€ å™¨çš„å‚æ•°åˆ—è¡¨è¦ä¸å‡½æ•°å¼æ¥å£ä¸­æŠ½è±¡çš„å‚æ•°åˆ—è¡¨ä¿æŒä¸€è‡´</li></ul></blockquote><p><strong>æ•°ç»„çš„å¼•ç”¨</strong></p><pre class="line-numbers language-none"><code class="language-none">@org.junit.Testpublic void test6()&#123;    Function&lt;Integer,String[]&gt; fun &#x3D; (x)-&gt;new String[x];    &#x2F;*å¯ä»¥å˜ä¸º*&#x2F;    Function&lt;Integer,String[]&gt; fun2 &#x3D; String[]::new;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å¼ºå¤§çš„Stream-API"><a href="#å¼ºå¤§çš„Stream-API" class="headerlink" title="å¼ºå¤§çš„Stream API"></a>å¼ºå¤§çš„Stream API</h2><blockquote><p>æµæ˜¯æ•°æ®æ¸ é“ï¼Œç”¨äºæ“ä½œæ•°æ®æºï¼Œæ•°ç»„ï¼Œé›†åˆç­‰ç”Ÿäº§çš„å…ƒç´     åºåˆ—</p><ul><li>Stream è‡ªå·±ä¸ä¼šå­˜å‚¨å…ƒç´ </li><li>Stream ä¸å›æ”¹å˜æºå¯¹è±¡ï¼Œä»–ä»¬ä¼šè¿”å›ä¸€ä¸ªæŒæœ‰ç»“æœçš„æ–°çš„Stream</li><li>Stream æ“ä½œæ˜¯å»¶è¿Ÿæ‰§è¡Œçš„ã€‚è¿™æ„å‘³ç€ä»–ä»¬ä¼šç­‰åˆ°éœ€è¦ç»“æœçš„æ—¶å€™æ‰æ‰§è¡Œ</li></ul></blockquote><p><strong>æ­¥éª¤</strong></p><ul><li>åˆ›å»ºStream</li><li>ä¸­é—´æ“ä½œ</li><li>ç»ˆæ­¢æ“ä½œ</li></ul><h3 id="åˆ›å»ºStream"><a href="#åˆ›å»ºStream" class="headerlink" title="åˆ›å»ºStream"></a>åˆ›å»ºStream</h3><blockquote><p>åˆ›å»ºStreamçš„æ–¹æ³•æœ‰å¤šç§</p></blockquote><ul><li><p>Connectionæ¥å£ä¸‹æä¾›çš„æ–¹æ³•stream()æˆ–è€…parallelStream()ï¼ˆå¹¶è¡Œæµï¼‰</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// é€šè¿‡Connectionæä¾›çš„steam()æˆ–è€…parallelStream()</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> stream <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>é€šè¿‡Arraysä¸­çš„é™æ€æ–¹æ³•è·å–</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Users</span><span class="token punctuation">[</span><span class="token punctuation">]</span> users <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Users</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Users</span><span class="token punctuation">></span></span> stream1 <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ul><ul><li><p>Streamç±»çš„é™æ€æ–¹æ³•of()è·å–</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> integerStream <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><ul><li><p>åˆ›å»ºæ— é™æµ</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> iterate <span class="token operator">=</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">-></span> x <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="ä¸­é—´æ“ä½œ"><a href="#ä¸­é—´æ“ä½œ" class="headerlink" title="ä¸­é—´æ“ä½œ"></a>ä¸­é—´æ“ä½œ</h3></li></ul><blockquote><p>Streamçš„ä¸­é—´æ“ä½œå’Œç»ˆç«¯æ“ä½œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p></blockquote><p><img src="https://img-blog.csdn.net/20180609175507605?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI4NDEwMjgz/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="Streamçš„æ“ä½œ"></p><h3 id="åˆ‡ç‰‡å’Œç­›é€‰"><a href="#åˆ‡ç‰‡å’Œç­›é€‰" class="headerlink" title="åˆ‡ç‰‡å’Œç­›é€‰"></a>åˆ‡ç‰‡å’Œç­›é€‰</h3><blockquote><ul><li>filter æ¥æ”¶Lambda,ä»æµä¸­æ’é™¤æŸäº›å…ƒç´ </li><li>limit æˆªæ–­æµï¼Œä½¿å…ƒç´ ä¸è¶…è¿‡ç»™å®šæ•°é‡</li><li>skip(n) è·³è¿‡å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæ‰”æ‰äº†å‰nä¸ªå…ƒç´ çš„æµï¼Œå¦‚æœä¸è¶³nä¸ªåˆ™è¿”å›ä¸€ä¸ªç©ºæµ</li><li>distinct ç­›é€‰ï¼Œé€šè¿‡æµæ‰€äº§ç”Ÿå…ƒç´ çš„hashCode()å’Œequals()å»é™¤é‡å¤å…ƒç´ </li></ul></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token annotation punctuation">@Test</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Users</span><span class="token punctuation">></span></span> stream <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">/*     * ä¸­é—´æ“ä½œ:ä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œ     * ç»ˆæ­¢æ“ä½œ:ä¸€æ¬¡æ€§æ‰§è¡Œå…¨éƒ¨å†…å®¹ï¼Œå³"æƒ°æ€§æ±‚å€¼"     filter(Predicate&lt;? super T> predicate)æ»¡è¶³predicateçš„æ¡ä»¶çš„ä¼šè¢«ä¿ç•™     * */</span>     stream<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">-></span>e<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token annotation punctuation">@Test</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Users</span><span class="token punctuation">></span></span> stream <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">/*     limit(n) è¡¨ç¤ºå–å‰nä¸ª     */</span>     stream<span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>             <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token annotation punctuation">@Test</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token comment">/*     skip(n) è¡¨ç¤ºè·³è¿‡å‰nä¸ªï¼Œé…åˆlimitå¯ä»¥æœ‰å¥‡æ•ˆ     */</span>     <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Users</span><span class="token punctuation">></span></span> stream <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     stream<span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>             <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token annotation punctuation">@Test</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Users</span><span class="token punctuation">></span></span> stream <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">/*     å»é‡æ“ä½œéœ€è¦æ¯”è¾ƒäºŒè€…çš„hashCode()å’Œequals()ï¼Œéœ€è¦é‡å†™è¿™ä¸¤ä¸ªæ–¹æ³•     */</span>     stream<span class="token punctuation">.</span><span class="token function">distinct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>             <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ˜ å°„"><a href="#æ˜ å°„" class="headerlink" title="æ˜ å°„"></a>æ˜ å°„</h3><blockquote><ul><li>mapï¼šæ¥æ”¶ Lambda ï¼Œå°†å…ƒç´ è½¬æ¢ä¸ºå…¶ä»–å½¢å¼æˆ–æå–ä¿¡æ¯ï¼›æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œå¹¶å°†å…¶æ˜ å°„æˆä¸€ä¸ªæ–°çš„å…ƒç´ </li><li>flatMapï¼šæ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå°†æµä¸­æ¯ä¸€ä¸ªå€¼éƒ½æ¢æˆå¦ä¸€ä¸ªæµï¼Œç„¶åæŠŠæ‰€æœ‰æµé‡æ–°è¿æ¥æˆä¸€ä¸ªæµ(ç±»ä¼¼äºcollectionä¸­çš„addAll(Collection coll)æ–¹æ³•)</li></ul></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">"111"</span><span class="token punctuation">,</span> <span class="token string">"bbb"</span><span class="token punctuation">,</span> <span class="token string">"ccc"</span><span class="token punctuation">,</span> <span class="token string">"awdaw"</span><span class="token punctuation">,</span> <span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/*    * map æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œå¹¶å°†å…¶æ˜ å°„æˆä¸€ä¸ªæ–°çš„å…ƒç´     * */</span>    list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>str<span class="token operator">-></span>str<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"============================="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>users <span class="token operator">-></span> users<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"qweq"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">distinct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"============================="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/*    *  flatMap æŠŠæ‰€æœ‰æµé‡æ–°è¿æ¥æˆä¸€ä¸ªæµï¼Œå³ç›¸åŒç±»å‹çš„æµè¿›è¡Œåˆå¹¶    * */</span>    list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token class-name">TestStream</span><span class="token operator">::</span><span class="token function">getStream</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h3><blockquote><ul><li>sorted() è‡ªç„¶æ’åº</li><li>sorted(Comparator c) å®šåˆ¶æ’åº</li></ul></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test11</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">"111"</span><span class="token punctuation">,</span> <span class="token string">"bbb"</span><span class="token punctuation">,</span> <span class="token string">"ccc"</span><span class="token punctuation">,</span> <span class="token string">"awdaw"</span><span class="token punctuation">,</span> <span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/*è‡ªç„¶æ’åº*/</span>    <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> stream <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    stream<span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/*å®šåˆ¶æ’åº*/</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">-></span> x<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>y<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç»ˆæ­¢æ“ä½œ"><a href="#ç»ˆæ­¢æ“ä½œ" class="headerlink" title="ç»ˆæ­¢æ“ä½œ"></a>ç»ˆæ­¢æ“ä½œ</h2><h3 id="æŸ¥æ‰¾ä¸åŒ¹é…"><a href="#æŸ¥æ‰¾ä¸åŒ¹é…" class="headerlink" title="æŸ¥æ‰¾ä¸åŒ¹é…"></a>æŸ¥æ‰¾ä¸åŒ¹é…</h3><blockquote><ul><li>allMatchï¼šæ£€æŸ¥æ˜¯å¦åŒ¹é…æ‰€æœ‰å…ƒç´ </li><li>anyMatchï¼šæ£€æŸ¥æ˜¯å¦è‡³å°‘åŒ¹é…ä¸€ä¸ªå…ƒç´ </li><li>noneMatchï¼šæ£€æŸ¥æ˜¯å¦æ²¡æœ‰åŒ¹é…æ‰€æœ‰å…ƒç´ </li><li>findFirstï¼šè¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ </li><li>findAnyï¼šè¿”å›å½“å‰æµä¸­çš„ä»»æ„å…ƒç´ </li><li>countï¼šè¿”å›æµä¸­å…ƒç´ çš„æ€»ä¸ªæ•°</li><li>maxï¼šè¿”å›æµä¸­æœ€å¤§å€¼</li><li>minï¼šè¿”å›æµä¸­æœ€å°å€¼</li></ul></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Status</span> <span class="token punctuation">&#123;</span>    FREE<span class="token punctuation">,</span> BUSY<span class="token punctuation">,</span> VOCATION<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Status</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token class-name">Status</span><span class="token punctuation">.</span>FREE<span class="token punctuation">,</span> <span class="token class-name">Status</span><span class="token punctuation">.</span>BUSY<span class="token punctuation">,</span> <span class="token class-name">Status</span><span class="token punctuation">.</span>VOCATION<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span> flag1 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">allMatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Status</span><span class="token punctuation">.</span>BUSY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span> flag2 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">anyMatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Status</span><span class="token punctuation">.</span>BUSY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span> flag3 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">noneMatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Status</span><span class="token punctuation">.</span>BUSY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>flag3<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸</span>    <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Status</span><span class="token punctuation">></span></span> op1 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// å¦‚æœOptionalä¸ºç©º æ‰¾ä¸€ä¸ªæ›¿ä»£çš„å¯¹è±¡</span>    <span class="token class-name">Status</span> s1 <span class="token operator">=</span> op1<span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token class-name">Status</span><span class="token punctuation">.</span>BUSY<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// éšä¾¿è·å–ä¸€ä¸ª</span>    <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Status</span><span class="token punctuation">></span></span> op2 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">findAny</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>op2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">long</span> count <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å½’çº¦ä¸æ”¶é›†"><a href="#å½’çº¦ä¸æ”¶é›†" class="headerlink" title="å½’çº¦ä¸æ”¶é›†"></a>å½’çº¦ä¸æ”¶é›†</h3><blockquote><ul><li>å½’çº¦ï¼šreduce(T identity, BinaryOperator) / reduce(BinaryOperator) å¯ä»¥å°†æµä¸­çš„æ•°æ®åå¤ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå€¼</li><li>æ”¶é›†ï¼šcollect å°†æµè½¬æ¢æˆå…¶ä»–å½¢å¼ï¼›æ¥æ”¶ä¸€ä¸ª Collector æ¥å£çš„å®ç°ï¼Œç”¨äºç»™æµä¸­å…ƒç´ åšæ±‡æ€»çš„æ–¹æ³•</li></ul></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> -java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>leetcodeåˆ·é¢˜</title>
      <link href="2020/09/21/leetcode-shua-ti/"/>
      <url>2020/09/21/leetcode-shua-ti/</url>
      
        <content type="html"><![CDATA[<h1 id="Leetcodeé¢˜ç›®"><a href="#Leetcodeé¢˜ç›®" class="headerlink" title="Leetcodeé¢˜ç›®"></a>Leetcodeé¢˜ç›®</h1><h2 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h2><h3 id="æ•°ç»„ä¸­é‡å¤çš„æ•°å­—"><a href="#æ•°ç»„ä¸­é‡å¤çš„æ•°å­—" class="headerlink" title="æ•°ç»„ä¸­é‡å¤çš„æ•°å­—"></a>æ•°ç»„ä¸­é‡å¤çš„æ•°å­—</h3><blockquote><p>æ‰¾å‡ºæ•°ç»„ä¸­é‡å¤çš„æ•°å­—ã€‚</p><p>åœ¨ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„ nums é‡Œçš„æ‰€æœ‰æ•°å­—éƒ½åœ¨ 0ï½n-1 çš„èŒƒå›´å†…ã€‚æ•°ç»„ä¸­æŸäº›æ•°å­—æ˜¯é‡å¤çš„ï¼Œä½†ä¸çŸ¥é“æœ‰å‡ ä¸ªæ•°å­—é‡å¤äº†ï¼Œä¹Ÿä¸çŸ¥é“æ¯ä¸ªæ•°å­—é‡å¤äº†å‡ æ¬¡ã€‚è¯·æ‰¾å‡ºæ•°ç»„ä¸­ä»»æ„ä¸€ä¸ªé‡å¤çš„æ•°å­—ã€‚</p></blockquote><pre class="line-numbers language-none"><code class="language-none">è¾“å…¥ï¼š[2, 3, 1, 0, 2, 5, 3]è¾“å‡ºï¼š2 æˆ– 3 é™åˆ¶ï¼š2 &lt;&#x3D; n &lt;&#x3D; 100000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/shu-zu-zhong-zhong-fu-de-shu-zi-lcof">https://leetcode-cn.com/problems/shu-zu-zhong-zhong-fu-de-shu-zi-lcof</a></p></blockquote><p><strong>è§£é¢˜æ€è·¯</strong></p><p>â€‹        é¢˜ç›®ä¸­æœ‰ä¸ªå¾ˆæœ‰æ„æ€çš„åœ°æ–¹å°±æ˜¯ <strong>æ•°ç»„é•¿åº¦è·Ÿæ•°å­—çš„èŒƒå›´å¤§å°ä¸€æ ·</strong>ï¼Œè¿™æ ·å°±æœ‰äº†å¾ˆå¤šçš„è§£é¢˜æ–¹æ³•ã€‚</p><h4 id="å­—å…¸æ³•"><a href="#å­—å…¸æ³•" class="headerlink" title="å­—å…¸æ³•"></a>å­—å…¸æ³•</h4><blockquote><p>åˆ›å»ºä¸€ä¸ªseté›†åˆï¼Œå¾ªç¯éå†æ•°ç»„ï¼ŒæŠŠitemæ”¾å…¥setä¸­ï¼Œå¦‚æœä¸èƒ½æˆåŠŸæ”¾å…¥ï¼Œåˆ™è¿”å›è¯¥å€¼</p><p>æ—¶é—´å¤æ‚åº¦ O(n)</p><p>ç©ºé—´å¤æ‚åº¦ O(n)</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">findRepeatNumber</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> num <span class="token operator">:</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// æ²¡æœ‰æ·»åŠ æˆåŠŸ</span>            <span class="token keyword">return</span> num<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="åŸåœ°ç½®æ¢æ³•"><a href="#åŸåœ°ç½®æ¢æ³•" class="headerlink" title="åŸåœ°ç½®æ¢æ³•"></a>åŸåœ°ç½®æ¢æ³•</h4><blockquote><p>åœ¨æ­¤é¢˜ä¸­ï¼Œå¦‚æœæ²¡æœ‰é‡å¤å…ƒç´ ï¼Œé‚£ä¹ˆä»–ä»¬æ­£å¸¸æ’åºåï¼Œæ•°å­—iå°±åº”è¯¥åœ¨iä¸‹æ ‡çš„ä½ç½®ã€‚æ‰€ä»¥æˆ‘ä»¬éå†æ•°ç»„ï¼Œé‡åˆ°çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½è·Ÿä»¥ä»–ä¸ºä¸‹æ ‡çš„æ•°å€¼ç›¸æ¯”è¾ƒã€‚å¦‚æœç›¸ç­‰åˆ™é‡å¤è¿”å›ï¼Œä¸æƒ³ç­‰åˆ™ç½®æ¢</p><p>æ—¶é—´å¤æ‚åº¦O(n)</p><p>ç©ºé—´å¤æ‚åº¦O(1)</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">findRepeatNumber</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// åœ¨æ²¡æœ‰å½’ä½çš„æƒ…å†µä¸‹</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">// åˆ¤æ–­è¯¥æ•°ä¸ ä»¥ä»–ä¸ºä¸‹æ ‡çš„æ•°æ˜¯å¦ç›¸ç­‰</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// è¯æ˜é‡å¤ï¼Œè¿”å›è¯¥æ•°</span>                <span class="token keyword">return</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">// ä¸é‡å¤å°±ç½®æ¢</span>            <span class="token keyword">int</span> tmp <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>tmp<span class="token punctuation">]</span><span class="token punctuation">;</span>            nums<span class="token punctuation">[</span>tmp<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JVM</title>
      <link href="2020/09/18/jvm/"/>
      <url>2020/09/18/jvm/</url>
      
        <content type="html"><![CDATA[<h1 id="JVMå†…å­˜å’Œåƒåœ¾å›æ”¶ç¯‡"><a href="#JVMå†…å­˜å’Œåƒåœ¾å›æ”¶ç¯‡" class="headerlink" title="JVMå†…å­˜å’Œåƒåœ¾å›æ”¶ç¯‡"></a>JVMå†…å­˜å’Œåƒåœ¾å›æ”¶ç¯‡</h1><blockquote><p>JVMå†…å­˜å’Œåƒåœ¾å›æ”¶ç¯‡<br>å­—èŠ‚ç ä¸ç±»çš„åŠ è½½ç¯‡<br>æ€§èƒ½ç›‘æ§ä¸è°ƒä¼˜ç¯‡</p></blockquote><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p><img src="https://s1.ax1x.com/2020/09/23/wxKNSe.png" alt="ä¸€æ¬¡ç¼–è¯‘åˆ°å¤„è¿è¡Œ"></p><p><strong>ä»»ä½•è¯­è¨€ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶éµå®ˆjavaè™šæ‹Ÿæœºè§„èŒƒï¼Œéƒ½å¯ä»¥è¿è¡Œåœ¨javaè™šæ‹Ÿæœºä¸Š</strong></p><p><img src="https://s1.ax1x.com/2020/09/23/wxKuQJ.png" alt="ä»»ä½•è¯­è¨€éƒ½å¯ä»¥è¿è¡Œåœ¨jvmä¸Š"></p><p>å¤šè¯­è¨€æ··åˆå¼€å‘ä¸å†æ˜¯ä¸å¯èƒ½çš„äº‹æƒ…ã€‚</p><blockquote><p>javaè™šæ‹Ÿæœºå°±æ˜¯äºŒè¿›åˆ¶å­—èŠ‚ç çš„è¿è¡Œç¯å¢ƒï¼Œè´Ÿè´£è£…åœ¨å­—èŠ‚ç åˆ°å…¶å†…éƒ¨ï¼Œè§£é‡Šç¼–è¯‘ä¸ºå¯¹åº”å¹³å°çš„æœºå™¨æŒ‡ä»¤æ‰§è¡Œã€‚</p></blockquote><p><img src="https://s1.ax1x.com/2020/09/23/wxKAoV.png" alt="jdk-jre-jvm"></p><h3 id="JVMçš„æ•´ä½“ç»“æ„"><a href="#JVMçš„æ•´ä½“ç»“æ„" class="headerlink" title="JVMçš„æ•´ä½“ç»“æ„"></a>JVMçš„æ•´ä½“ç»“æ„</h3><p><img src="https://s1.ax1x.com/2020/09/23/wxuoxH.png" alt="JVMç®€å›¾"></p><h3 id="JVMçš„æ¶æ„æ¨¡å‹"><a href="#JVMçš„æ¶æ„æ¨¡å‹" class="headerlink" title="JVMçš„æ¶æ„æ¨¡å‹"></a>JVMçš„æ¶æ„æ¨¡å‹</h3><p><img src="https://s1.ax1x.com/2020/09/23/wxu1PS.png" alt="æ¶æ„æ¨¡å‹"></p><p><strong>æ€»ç»“</strong></p><ul><li>è·¨å¹³å°æ€§çš„è®¾è®¡</li><li>æŒ‡ä»¤é›†å°</li><li>æŒ‡ä»¤å¤š</li><li>æ‰§è¡Œæ€§èƒ½æ¯”å¯„å­˜å™¨å·®</li></ul><h3 id="JVMçš„ç”Ÿå‘½å‘¨æœŸ"><a href="#JVMçš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="JVMçš„ç”Ÿå‘½å‘¨æœŸ"></a>JVMçš„ç”Ÿå‘½å‘¨æœŸ</h3><p><strong>è™šæ‹Ÿæœºçš„å¯åŠ¨</strong></p><p>javaè™šæ‹Ÿæœºçš„å¯åŠ¨æ—¶é€šè¿‡<strong>å¼•å¯¼ç±»åŠ è½½å™¨</strong>(bootstrap class loader)åˆ›å»ºä¸€ä¸ªåˆå§‹ç±»(initial class)æ¥å®Œæˆçš„ï¼Œè¿™ä¸ªç±»æ˜¯ç”±è™šæ‹Ÿæœºçš„å…·ä½“å®ç°æŒ‡å®šçš„ã€‚</p><p><strong>è™šæ‹Ÿæœºçš„è¿è¡Œ</strong></p><ul><li>ä¸€ä¸ªè¿è¡Œä¸­çš„javaè™šæ‹Ÿæœºæœ‰ä¸€ä¸ªä»»åŠ¡å°±æ˜¯æ‰§è¡Œjavaç¨‹åº</li><li>ç¨‹åºå¼€å§‹æ‰§è¡Œæ—¶ä»–æ‰è¿è¡Œï¼Œç¨‹åºç»“æŸçš„æ—¶å€™ä»–å°±åœæ­¢</li><li>==æ‰§è¡Œä¸€ä¸ªæ‰€è°“çš„javaç¨‹åºçš„æ—¶å€™ï¼ŒçœŸæ­£åœ¨æ‰§è¡Œçš„æ˜¯JAVAè™šæ‹Ÿæœºçš„è¿›ç¨‹==</li></ul><p><strong>è™šæ‹Ÿæœºçš„é€€å‡º</strong></p><ul><li>ç¨‹åºæ­£å¸¸æ‰§è¡Œç»“æŸ</li><li>é‡åˆ°å¼‚å¸¸æˆ–é”™è¯¯ç»ˆæ­¢</li><li>æ“ä½œç³»ç»Ÿå‡ºç°é”™è¯¯å¯¼è‡´javaè™šæ‹Ÿæœºè¿›ç¨‹ç»ˆæ­¢</li><li>æŸçº¿ç¨‹è°ƒç”¨runtimeç±»æˆ–systemç±»çš„exitæ–¹æ³•é€€å‡ºï¼Œæˆ–runtimeç±»ä¸­çš„haltæ–¹æ³•</li><li>JNIè§„èŒƒæè¿°äº†ç”¨JNI Invocation APIæ¥åŠ è½½æˆ–å¸è½½Javaè™šæ‹Ÿæœºçš„æ—¶å€™ï¼Œjvmé€€å‡º</li></ul><h2 id="ç±»åŠ è½½å­ç³»ç»Ÿ-ClassLoader"><a href="#ç±»åŠ è½½å­ç³»ç»Ÿ-ClassLoader" class="headerlink" title="ç±»åŠ è½½å­ç³»ç»Ÿ(ClassLoader)"></a>ç±»åŠ è½½å­ç³»ç»Ÿ(ClassLoader)</h2><blockquote><p><strong>æ•´ä½“ä½œç”¨</strong></p><ul><li><p>è´Ÿè´£ä»æ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œä¸­åŠ è½½classæ–‡ä»¶ï¼Œclassæ–‡ä»¶åœ¨æ–‡ä»¶å¼€å¤´æœ‰ç‰¹å®šçš„æ–‡ä»¶æ ‡è¯†</p></li><li><p>ClassLoaderåªè´Ÿè´£classæ–‡ä»¶çš„åŠ è½½ï¼Œè‡³äºå®ƒæ˜¯å¦å¯ä»¥è¿è¡Œï¼Œåˆ™ç”±Execution Engineå†³å®š</p></li><li><p>åŠ è½½çš„ç±»ä¿¡æ¯å­˜æ”¾äºä¸€å—ç§°ä¸º==æ–¹æ³•åŒº==çš„å†…å­˜ç©ºé—´ã€‚é™¤äº†ç±»çš„ä¿¡æ¯å¤–ï¼Œæ–¹æ³•åŒºä¸­è¿˜ä¼šå­˜æ”¾è¿è¡Œæ—¶å¸¸é‡æ± ä¿¡æ¯ï¼Œå¯èƒ½è¿˜åŒ…æ‹¬å­—ç¬¦ä¸²å­—é¢é‡å’Œæ•°å­—å¸¸é‡(è¿™éƒ¨åˆ†å¸¸é‡ä¿¡æ¯æ˜¯Classæ–‡ä»¶ä¸­å¸¸é‡æ± éƒ¨åˆ†çš„å†…å­˜æ˜ å°„)</p></li></ul></blockquote><p><img src="https://s1.ax1x.com/2020/09/23/wxueKA.png" alt="ç±»åŠ è½½å­ç³»ç»Ÿ"></p><ul><li><p>classæ–‡ä»¶æ”¾åœ¨æœ¬åœ°çš„ç¡¬ç›˜ä¸Šï¼Œå½“æ‰§è¡Œçš„æ—¶å€™æ˜¯è¦åŠ è½½åˆ°JVMä¸­ï¼Œæ ¹æ®è¿™ä¸ªæ–‡ä»¶å®ä¾‹åŒ–å‡ºnä¸ªä¸€æ¨¡ä¸€æ ·çš„å®ä¾‹ã€‚</p></li><li><p>classæ–‡ä»¶åŠ è½½åˆ°JVMä¸­ï¼Œè¢«ç§°ä¸ºDNAå…ƒæ•°æ®æ¨¡æ¿ï¼Œæ”¾åœ¨æ–¹æ³•åŒº</p></li><li><p>åœ¨.classæ–‡ä»¶-&gt;JVM-&gt;æœ€ç»ˆç§°ä¸ºå…ƒæ•°æ®æ¨¡æ¿ï¼Œæ­¤è¿‡ç¨‹å°±è¦ä¸€ä¸ªè¿è¾“å·¥å…·(ç±»è£…è½½å™¨ ClassLoader)æ‰®æ¼”ä¸€ä¸ªå¿«é€’å‘˜çš„è§’è‰²</p></li></ul><p><img src="https://s1.ax1x.com/2020/09/23/wxuA8e.png" alt="wxuA8e.png"></p><h3 id="ç±»çš„åŠ è½½è¿‡ç¨‹"><a href="#ç±»çš„åŠ è½½è¿‡ç¨‹" class="headerlink" title="ç±»çš„åŠ è½½è¿‡ç¨‹"></a>ç±»çš„åŠ è½½è¿‡ç¨‹</h3><p><strong>åŠ è½½é˜¶æ®µ</strong></p><blockquote><ul><li>é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåè·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶æ–‡ä»¶æµ</li><li>å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ï¼ˆ<strong>ç±»ä¿¡æ¯æ”¾åœ¨æ–¹æ³•åŒºä¸­</strong>ï¼‰</li><li>==åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡==ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„è®¿é—®å…¥å£ï¼ˆ<strong>åå°„</strong>æ”¾åœ¨å †ä¸­ï¼‰</li></ul></blockquote><p><strong>é“¾æ¥é˜¶æ®µ</strong></p><ul><li><p>éªŒè¯</p><blockquote><ul><li>ç›®çš„åœ¨äºç¡®ä¿classæ–‡ä»¶è¢‹å­—èŠ‚æµä¸­åŒ…å«çš„ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºè¦æ±‚ï¼Œä¿è¯è¢«åŠ è½½ç±»çš„æ­£ç¡®æ€§</li><li>æ–‡ä»¶æ ¼å¼éªŒè¯ï¼Œå…ƒæ•°æ®éªŒè¯ï¼Œå­—èŠ‚ç éªŒè¯ï¼Œç¬¦å·å¼•ç”¨éªŒè¯</li></ul></blockquote></li><li><p>å‡†å¤‡</p><blockquote><ul><li>ä¸ºç±»å˜é‡åˆ†é…å†…å­˜å¹¶ä¸”è®¾ç½®è¯¥ç±»å˜é‡çš„é»˜è®¤åˆå§‹å€¼ï¼Œå³é›¶å€¼<ul><li><code>private static int a = 1</code>åœ¨å‡†å¤‡é˜¶æ®µä¼šè¢«å…ˆè®¾ä¸º<code>a=0</code>ï¼Œåœ¨<code>initial</code>é˜¶æ®µæ‰ä¼šèµ‹å€¼</li></ul></li><li><strong>è¿™é‡Œä¸å«ç”¨finalä¿®é¥°çš„static,å› ä¸ºfinalåœ¨ç¼–è¯‘çš„æ—¶å€™å°±åˆ†é…äº†ï¼Œå‡†å¤‡é˜¶æ®µä¼šæ˜¾å¼åˆå§‹åŒ–</strong>ï¼ˆ<strong>è¿™æ—¶å€™æ˜¯å¸¸é‡äº†</strong>ï¼‰</li><li><strong>è¿™é‡Œä¸ä¼šä¸ºå®ä¾‹å˜é‡åˆ†é…åˆå§‹åŒ–</strong>ï¼ˆè¿˜æœªåˆ›å»ºå¯¹è±¡ï¼‰ï¼Œç±»å˜é‡ä¼šåˆ†é…åœ¨æ–¹æ³•åŒºä¸­ï¼Œè€Œå®ä¾‹å˜é‡æ˜¯ä¼šéšç€å¯¹è±¡ä¸€èµ·åˆ†é…åˆ°javaå †ä¸­</li></ul></blockquote></li><li><p>è§£æ</p><blockquote><ul><li>å°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹</li><li>äº‹å®ä¸Šï¼Œè§£ææ“ä½œä¼šåœ¨JVMæ‰§è¡Œå®Œåˆå§‹åŒ–åå†æ¬¡æ‰§è¡Œ</li><li>ç¬¦å·å¼•ç”¨å°±æ˜¯ä¸€ç»„ç¬¦å·æ¥æè¿°å¼•ç”¨çš„ç›®æ ‡ã€‚ç›´æ¥å¼•ç”¨å°±æ˜¯ç›´æ¥æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆï¼Œç›¸å¯¹åç§»é‡æˆ–ä¸€ä¸ªé—´æ¥å®šä½åˆ°ç›®æ ‡çš„å¥æŸ„</li><li>è§£æä¸»è¦é’ˆå¯¹ï¼šç±»æˆ–æ¥å£ï¼Œå­—æ®µï¼Œç±»æ–¹æ³•ï¼Œæ¥å£æ–¹æ³•ï¼Œæ–¹æ³•ç±»å‹ç­‰ç­‰ï¼Œå¯¹åº”å¸¸é‡æ± ä¸­çš„CONSTANT_Class_infoã€CONSTANT_Fieldref_infoã€CONSTANT_Methodref_info ç­‰ç­‰</li></ul></blockquote></li></ul><p><strong>åˆå§‹åŒ–</strong></p><blockquote><ul><li>åˆå§‹åŒ–å°±æ˜¯æ‰§è¡Œ<strong>ç±»æ„é€ å™¨æ–¹æ³•<Clinit>()**çš„è¿‡ç¨‹ï¼Œ<Clinit>()ä¸éœ€è¦å®šä¹‰ï¼Œä»–ä¸æ˜¯ç±»çš„æ„é€ å™¨ï¼Œjavacç¼–è¯‘å™¨è‡ªåŠ¨å¸®ä½ å¼„å¥½äº†ã€‚</strong>æ„é€ å™¨æ–¹æ³•ä¸­æŒ‡ä»¤æŒ‰ç…§è¯­å¥åœ¨æºæ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºæ‰§è¡Œ**ã€‚JVMä¼šä¿è¯å­ç±»çš„<Clinit>()æ‰§è¡Œå‰ï¼Œçˆ¶ç±»çš„<Clinit>()æ–¹æ³•å·²ç»æ‰§è¡Œå®Œæ¯•ã€‚</li><li><strong>ç±»æ„é€ å™¨æ˜¯å¯¹é™æ€å˜é‡ï¼Œé™æ€ä»£ç å—è¿›è¡Œåˆå§‹åŒ–</strong></li></ul></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">X</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">static</span> <span class="token class-name">Log</span> log <span class="token operator">=</span> <span class="token class-name">LogFactory</span><span class="token punctuation">.</span><span class="token function">getLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &lt;clinit></span>   <span class="token keyword">private</span> <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>   <span class="token comment">// &lt;init></span>   <span class="token class-name">X</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token comment">// &lt;init></span>   <span class="token punctuation">&#125;</span>   <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>      <span class="token comment">// &lt;clinit></span>   <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹        ç±»ä¸­çš„ç±»å˜é‡å’Œé™æ€ä»£ç å—ä¸­çš„è¯­å¥ä¼šè¢«ç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ï¼Œæ”¶é›†çš„é¡ºåºæ˜¯ç”±è¯­å¥åœ¨æºæ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºå†³å®šçš„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œï¼Œnumå˜é‡å’Œnumberå˜é‡åœ¨prepareé˜¶æ®µçš„æ—¶å€™è¢«èµ‹å€¼ä¸º0ï¼Œåˆ°initialé˜¶æ®µä¼šæŒ‰ç…§é¡ºåºï¼Œå…ˆå°†numèµ‹å€¼ä¸º1,å†æ‰§è¡Œstaticä»£ç å—ä¸­çš„<code>num=2</code>èµ‹å€¼ä¸º2ã€‚</p><p>â€‹        è€Œå¯¹äºnumberæ¥è¯´ï¼Œè™½ç„¶ä»–å®šä¹‰è¯­å¥æ˜¯åœ¨é™æ€ä»£ç å—ä¸‹è¾¹ï¼Œé™æ€ä»£ç å—ä¸­å¯¹ä»–è¿›è¡Œäº†èµ‹å€¼ï¼Œä½†æ˜¯ä»–è¢«åˆ›å»ºåˆ†é…å†…å­˜æ˜¯åœ¨prepareé˜¶æ®µï¼Œæ‰€ä»¥æŒ‰ç…§é¡ºåºä¼šå…ˆæŠŠä»–èµ‹å€¼ä¸º<code>20</code>,å†èµ‹å€¼ä¸º<code>10</code>ã€‚</p><p>â€‹        ä½†æ˜¯å¦‚æœåœ¨é™æ€ä»£ç å—ä¸­æå‰è®¿é—®numberçš„è¯ä¼šæŠ¥é”™ï¼Œ<strong>éæ³•çš„å‰å‘å¼•ç”¨</strong>ã€‚å¯èƒ½æ˜¯åœ¨JVMæ‰§è¡Œå®Œåˆå§‹åŒ–åè¿˜ä¼šå†æ¬¡è§£æï¼ŒæŠŠä»–çš„ç¬¦å·å¼•ç”¨æ”¹ä¸ºç›´æ¥å¼•ç”¨ï¼Ÿï¼Ÿï¼Ÿâ€”-è¿™ä¸€ç‚¹æ˜¯ä¸ªäººçŒœæµ‹</p><p><img src="https://s1.ax1x.com/2020/09/23/wxuPUK.png" alt="wxuPUK.png"></p><p><img src="https://s1.ax1x.com/2020/09/23/wxuSD1.png" alt="wxuSD1.png"></p><p>æ€»ç»“ï¼š</p><p><img src="https://s1.ax1x.com/2020/09/23/wxnvv9.png" alt="wxnvv9.png"></p><h3 id="ç±»åŠ è½½å™¨åˆ†ç±»"><a href="#ç±»åŠ è½½å™¨åˆ†ç±»" class="headerlink" title="ç±»åŠ è½½å™¨åˆ†ç±»"></a>ç±»åŠ è½½å™¨åˆ†ç±»</h3><blockquote><p>jvmæ”¯æŒä¸¤ç§ç±»å‹çš„åŠ è½½å™¨</p><ul><li>å¼•å¯¼ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰</li><li>è‡ªå®šä¹‰åŠ è½½å™¨ï¼ˆUser-Defined ClassLoaderï¼‰<ul><li>æ‹“å±•ç±»åŠ è½½å™¨</li><li>ç³»ç»Ÿç±»åŠ è½½å™¨</li></ul></li></ul><p>åªè¦æ˜¯æ´¾ç”ŸäºæŠ½è±¡ç±»ClassLoaderçš„åŠ è½½å™¨ï¼Œå°±æ˜¯è‡ªå®šä¹‰åŠ è½½å™¨</p></blockquote><p><img src="https://s1.ax1x.com/2020/09/23/wxnbNT.png" alt="wxnbNT.png"></p><pre class="line-numbers language-java" data-language="java"><code class="language-java">        <span class="token comment">// è·å–ç³»ç»Ÿç±»åŠ è½½å™¨</span>        <span class="token class-name">ClassLoader</span> systemClassLoader <span class="token operator">=</span> <span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"classLoader = "</span> <span class="token operator">+</span> systemClassLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// è·å–ä¸Šå±‚æ‹“å±•ç±»åŠ è½½å™¨</span>        <span class="token class-name">ClassLoader</span> extClassLoader <span class="token operator">=</span> systemClassLoader<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"extClassLoader = "</span> <span class="token operator">+</span> extClassLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è·å–å…¶ä¸Šå±‚ï¼šè·å–ä¸åˆ°å¼•å¯¼ç±»åŠ è½½å™¨</span>        <span class="token class-name">ClassLoader</span> bootStrapClassLoader <span class="token operator">=</span> extClassLoader<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"bootStrapClassLoader = "</span> <span class="token operator">+</span> bootStrapClassLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è·å–å½“å‰çš„ç±»åŠ è½½å™¨</span>        <span class="token class-name">ClassLoader</span> classLoader <span class="token operator">=</span> <span class="token class-name">ClassLoaderTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"classLoader = "</span> <span class="token operator">+</span> classLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è·å–ä¸åˆ°å¼•å¯¼ç±»åŠ è½½å™¨ï¼Œjavaçš„æ ¸å¿ƒç±»åº“æ˜¯ç”¨å¼•å¯¼ç±»åŠ è½½å™¨åŠ è½½çš„</span>        <span class="token class-name">ClassLoader</span> classLoader1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"classLoader1 = "</span> <span class="token operator">+</span> classLoader1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*å‡ºäºå®‰å…¨è€ƒè™‘ï¼ŒBootstrapå¯åŠ¨ç±»åŠ è½½å™¨åªåŠ è½½åŒ…åä¸º javaã€javaxã€sunç­‰å¼€å¤´çš„ç±»*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å¯åŠ¨ç±»åŠ è½½å™¨"><a href="#å¯åŠ¨ç±»åŠ è½½å™¨" class="headerlink" title="å¯åŠ¨ç±»åŠ è½½å™¨"></a>å¯åŠ¨ç±»åŠ è½½å™¨</h3><blockquote><p>ä¹Ÿæ˜¯å¼•å¯¼ç±»åŠ è½½å™¨ï¼ŒbootStrap ClassLoader æ˜¯ç”¨c++å†™çš„ï¼Œæ‰€ä»¥çœ‹ä¸åˆ°æºç ã€‚</p><p>å®ƒè´Ÿè´£å°† <JAVA_HOME>/libç›®å½•ã€ -Xbootclasspathé€‰é¡¹æŒ‡å®šçš„ç›®å½•æˆ–ç³»ç»Ÿå±æ€§sun.boot.class.pathæŒ‡å®šçš„ç›®å½•ä¸‹çš„æ ¸å¿ƒç±»åº“åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ </p><p>å‡ºäºå®‰å…¨è€ƒè™‘ï¼ŒBootstrapå¯åŠ¨ç±»åŠ è½½å™¨åªåŠ è½½åŒ…åä¸º javaã€javaxã€sunç­‰å¼€å¤´çš„ç±»</p></blockquote><h3 id="æ‹“å±•ç±»åŠ è½½å™¨"><a href="#æ‹“å±•ç±»åŠ è½½å™¨" class="headerlink" title="æ‹“å±•ç±»åŠ è½½å™¨"></a>æ‹“å±•ç±»åŠ è½½å™¨</h3><blockquote><p>sun.misc.Launcher$ExtClassLoaderå®ç°</p><p>æ´¾ç”ŸäºClassLoader</p><p>çˆ¶ç±»åŠ è½½å™¨ä¸ºå¯åŠ¨ç±»åŠ è½½å™¨</p><p>ä»java.ext.dirsç³»ç»Ÿå±æ€§æ‰€æŒ‡å®šçš„ç›®å½•ä¸­åŠ è½½ç±»åº“ï¼Œæˆ–ä»jdkçš„å®‰è£…ç›®å½•çš„jre/lib/extå­ç›®å½•ä¸‹åŠ è½½ç±»åº“ã€‚å¦‚æœç”¨æˆ·åˆ›å»ºçš„jaræ”¾åœ¨æ­¤ç›®å½•ä¸‹ï¼Œä¹Ÿä¼šè‡ªåŠ¨ç”±æ‹“å±•ç´¯åŠ è½½å™¨åŠ è½½</p></blockquote><h3 id="åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨"><a href="#åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨" class="headerlink" title="åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨"></a>åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨</h3><blockquote><p>ä¹Ÿå«ç³»ç»Ÿç±»åŠ è½½å™¨,ApplicationClassLoader</p><p>æ´¾ç”ŸäºClassLoaderç±»</p><p>çˆ¶ç±»æ˜¯æ‹“å±•ç±»åŠ è½½å™¨</p><p>è´Ÿè´£åŠ è½½ç¯å¢ƒå˜é‡classpathæˆ–ç³»ç»Ÿå±æ€§java.class.pathæŒ‡å®šè·¯å¾„ä¸‹å•ç±»åº“ï¼Œè¯¥ç±»åŠ è½½æ˜¯<strong>ç¨‹åºä¸­é»˜è®¤çš„ç´¯åŠ è½½å™¨</strong></p><p>é€šè¿‡ClassLoader#getSystemClassLoaderæ–¹æ³•å¯ä»¥è·å–åˆ°è¯¥ç±»åŠ è½½å™¨</p></blockquote><h3 id="ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨"><a href="#ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨" class="headerlink" title="ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨"></a>ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨</h3><blockquote><ul><li>ä¸ºä½•è¦ä½¿ç”¨ï¼Ÿ<ul><li>éš”ç¦»åŠ è½½ç±»</li><li>ä¿®æ”¹ç±»åŠ è½½æ–¹å¼</li><li>æ‹“å±•åŠ è½½æº</li><li>é˜²æ­¢æºç æ³„æ¼(è¿è¡Œæ—¶è§£å¯†)</li></ul></li></ul></blockquote><p>è·å–åŠ è½½ç±»å†…å®¹</p><p><img src="/home/zhy/.config/Typora/typora-user-images/image-20200924092057934.png" alt="image-20200924092057934"></p><h2 id="åŒäº²å§”æ´¾æœºåˆ¶ï¼ï¼ˆé‡ç‚¹ï¼‰"><a href="#åŒäº²å§”æ´¾æœºåˆ¶ï¼ï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="åŒäº²å§”æ´¾æœºåˆ¶ï¼ï¼ˆé‡ç‚¹ï¼‰"></a>åŒäº²å§”æ´¾æœºåˆ¶ï¼ï¼ˆé‡ç‚¹ï¼‰</h2><blockquote><p>javaè™šæ‹Ÿæœºå¯¹classæ–‡ä»¶é‡‡ç”¨çš„æ˜¯æŒ‰éœ€åŠ è½½çš„æ–¹å¼ï¼Œè€ŒåŠ è½½æŸä¸ªç±»çš„classæ–‡ä»¶æ—¶ï¼Œjavaè™šæ‹Ÿæœºé‡‡ç”¨çš„æ˜¯<strong>åŒäº²å§”æ´¾æ¨¡å¼</strong>ï¼Œå³æŠŠè¯·æ±‚äº¤ç”±çˆ¶ç±»å¤„ç†ï¼Œä»–æ˜¯ä¸€ç§ä»»åŠ¡å§”æ´¾æ¨¡å¼</p></blockquote><p>å¼•å…¥ï¼šæˆ‘ä»¬è‡ªå·±æ„é€ ä¸€ä¸ªStringç±»</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/*åœ¨é¡¹ç›®srcä¸‹åˆ›å»ºjava.lang.String*/</span><span class="token keyword">package</span> <span class="token namespace">java<span class="token punctuation">.</span>lang</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">String</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æµ‹è¯•åŒäº²å§”æ´¾æœºåˆ¶ï¼Œè‡ªåˆ¶Stringç±»"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç±»æ¥è°ƒç”¨æ–°åˆ›å»ºçš„Stringç±»ï¼Œæµ‹è¯•èƒ½å¦æŠŠé™æ€ä»£ç å—ä¸­çš„å€¼è¾“å‡º</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>study</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// åœ¨è¿™é‡Œnewæˆ‘ä»¬åˆ›å»ºçš„ç±»</span>        <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æµ‹è¯•ç±»"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œç»“æœï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>java<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">8.0_191</span><span class="token operator">/</span>bin<span class="token operator">/</span>java <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>æµ‹è¯•ç±»<span class="token class-name">Process</span> finished <span class="token keyword">with</span> <span class="token namespace">exit</span> code <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œç¨‹åºæ²¡æœ‰èµ°æˆ‘ä»¬è‡ªåˆ¶çš„Stringç±»ï¼Œï¼Œå…¶ä¸­å°±æ˜¯è¿ç”¨äº†<strong>åŒäº²å§”æ´¾æœºåˆ¶</strong></p></blockquote><h3 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h3><ol><li>å¦‚æœä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½è¯·æ±‚ï¼Œå®ƒå¹¶ä¸ä¼šè‡ªå·±å…ˆå»åŠ è½½ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™çˆ¶ç±»çš„åŠ è½½å™¨å»æ‰§è¡Œ</li><li>å¦‚æœçˆ¶ç±»åŠ è½½å™¨è¿˜å­˜åœ¨å…¶çˆ¶ç±»åŠ è½½å™¨ï¼Œè¿›ä¸€æ­¥å‘ä¸Šå§”æ‰˜ï¼Œä¾æ¬¡é€’å½’ï¼Œè¯·æ±‚æœ€ç»ˆå°†è¾¾åˆ°é¡¶å±‚çš„Bootstrap ClassLoaderå¯åŠ¨ç±»åŠ è½½å™¨</li><li>å¦‚æœçˆ¶ç±»åŠ è½½å™¨å¯ä»¥å®Œæˆç±»åŠ è½½ä»»åŠ¡ï¼Œå°±è¿”å›æˆåŠŸï¼Œå€˜è‹¥çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®Œæˆæ­¤åŠ è½½ä»»åŠ¡ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½</li></ol><p><img src="/home/zhy/.config/Typora/typora-user-images/image-20200924094613781.png" alt="åŒäº²å§”æ´¾æœºåˆ¶"></p><p><strong>å½“æˆ‘ä»¬åœ¨è‡ªå®šä¹‰çš„Stringä¸­ç¼–å†™mainæ–¹æ³•çš„æ—¶å€™</strong>ï¼Œå› ä¸ºåŒäº²å§”æ´¾æœºåˆ¶ï¼Œä¼šåŠ è½½Javaä¸­çš„Stringï¼Œä½†æ˜¯ä»–é‡Œè¾¹æ²¡æœ‰mainæ–¹æ³•ï¼Œå°±ä¼šæŠ¥é”™</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">String</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æµ‹è¯•åŒäº²å§”æ´¾æœºåˆ¶ï¼Œè‡ªåˆ¶Stringç±»"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/*    é”™è¯¯: åœ¨ç±» java.lang.String ä¸­æ‰¾ä¸åˆ° main æ–¹æ³•, è¯·å°† main æ–¹æ³•å®šä¹‰ä¸º:  public static void main(String[] args)å¦åˆ™ JavaFX åº”ç”¨ç¨‹åºç±»å¿…é¡»æ‰©å±•javafx.application.Application    */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token number">12312</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸‰æ–¹jaråŒ…çš„åŠ è½½ä¼šç”±ç³»ç»Ÿç±»åŠ è½½å™¨å»åŠ è½½ï¼Œåœ¨å›¾ä¸­æ˜¯ç”±çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨(ContextClassLoader)åŠ è½½çš„</p><p>å¯ä»¥çœ‹è¿™ç¯‡åšå®¢â€“&gt;<a href="https://blog.csdn.net/yangcheng33/article/details/52631940">https://blog.csdn.net/yangcheng33/article/details/52631940</a></p><p><img src="/home/zhy/.config/Typora/typora-user-images/image-20200924102029562.png" alt="ç¬¬ä¸‰æ–¹jaråŒ…çš„åŠ è½½"></p><blockquote><p>åŒäº²å§”æ´¾æœºåˆ¶çš„<strong>ä¼˜åŠ¿</strong></p><ul><li><strong>é¿å…ç±»é‡å¤åŠ è½½</strong></li><li><strong>ä¿æŠ¤ç¨‹åºå®‰å…¨ï¼Œé˜²æ­¢æ ¸å¿ƒApiè¢«ç¯¡æ”¹</strong><ul><li>è‡ªåˆ¶java.lang.Stringç±»</li></ul></li></ul></blockquote><p><strong>æ²™ç®±å®‰å…¨æœºåˆ¶</strong></p><blockquote><p>è‡ªå®šä¹‰Stringç±»åœ¨åŠ è½½çš„æ—¶å€™ä¼šè®©å¼•å¯¼ç±»åŠ è½½å™¨å»åŠ è½½jdkä¸‹çš„Stringç±»ï¼Œè¿™æ ·ç”±äºæ²¡æœ‰mainæ–¹æ³•ï¼Œä¼šæŠ¥é”™<code>åœ¨ç±» java.lang.String ä¸­æ‰¾ä¸åˆ° main æ–¹æ³•, è¯·å°† main æ–¹æ³•å®šä¹‰ä¸º:public static void main(String[] args)</code>ã€‚è¿™æ ·å¯ä»¥ä¿è¯å¯¹javaæ ¸å¿ƒæºä»£ç çš„ä¿æŠ¤ï¼Œè¿™å°±æ˜¯<strong>æ²™ç®±å®‰å…¨æœºåˆ¶</strong></p></blockquote><h3 id="ç±»çš„ä¸»åŠ¨ä½¿ç”¨å’Œè¢«åŠ¨ä½¿ç”¨"><a href="#ç±»çš„ä¸»åŠ¨ä½¿ç”¨å’Œè¢«åŠ¨ä½¿ç”¨" class="headerlink" title="ç±»çš„ä¸»åŠ¨ä½¿ç”¨å’Œè¢«åŠ¨ä½¿ç”¨"></a>ç±»çš„ä¸»åŠ¨ä½¿ç”¨å’Œè¢«åŠ¨ä½¿ç”¨</h3><blockquote><p>ä¸»åŠ¨ä½¿ç”¨</p></blockquote><p><img src="/home/zhy/.config/Typora/typora-user-images/image-20200924110708399.png" alt="image-20200924110708399"></p><blockquote><p>é™¤äº†ä¸Šè¿°çš„7ç§ï¼Œéƒ½æ˜¯<strong>è¢«åŠ¨ä½¿ç”¨</strong>ï¼Œéƒ½ä¸ä¼š<strong>å¯¼è‡´ç±»çš„åˆå§‹åŒ–</strong></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> jvm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ActiveMQ</title>
      <link href="2020/09/17/activemq/"/>
      <url>2020/09/17/activemq/</url>
      
        <content type="html"><![CDATA[<h1 id="ActiveMQå…¥é—¨"><a href="#ActiveMQå…¥é—¨" class="headerlink" title="ActiveMQå…¥é—¨"></a>ActiveMQå…¥é—¨</h1><h2 id="æ¶ˆæ¯"><a href="#æ¶ˆæ¯" class="headerlink" title="æ¶ˆæ¯"></a>æ¶ˆæ¯</h2><blockquote><p>â€œæ¶ˆæ¯â€æ˜¯åœ¨ä¸¤å°è®¡ç®—æœºé—´ä¼ é€çš„æ•°æ®å•ä½ã€‚æ¶ˆæ¯å¯ä»¥éå¸¸ç®€å•,ä¾‹å¦‚åªåŒ…å«æ–‡æœ¬å­—ç¬¦ä¸²;<br>ä¹Ÿå¯ä»¥æ›´å¤æ‚,å¯èƒ½åŒ…å«åµŒå…¥å¯¹è±¡ã€‚</p></blockquote><h2 id="æ¶ˆæ¯é˜Ÿåˆ—"><a href="#æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—"></a>æ¶ˆæ¯é˜Ÿåˆ—</h2><blockquote><p>æ¶ˆæ¯é˜Ÿåˆ—æ˜¯åœ¨æ¶ˆæ¯çš„ç©¿å¾è¿‡ç¨‹ä¸­ä¿å­˜æ¶ˆæ¯çš„å®¹å™¨</p></blockquote><h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><p><strong>ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼šå¼‚æ­¥å¤„ç†ï¼ï¼</strong><br><strong>ä¸»è¦ç›®çš„æ˜¯ï¼šå‡å°‘è¯·æ±‚å“åº”æ—¶é—´å’Œè§£è€¦åˆ</strong></p><blockquote><p>å¼‚æ­¥å¤„ç†ï¼š<br>  å°†ä¸»è¦æ˜¯å‡å°‘è¯·æ±‚æ—¶é—´ï¼Œå¹¶ä¸”ä¸éœ€è¦åŒæ­¥å“åº”çš„æ“ä½œä½œä¸ºæ¶ˆæ¯æ”¾å…¥æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œ<br>è§£è€¦åˆï¼š<br>  å°†æ¶ˆæ¯æ”¾å…¥æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç”¨è§„å®šçš„æ¶ˆæ¯æ ¼å¼ï¼Œæ¶ˆæ¯å‘é€æ–¹å’Œæ¥æ”¶æ–¹ä¸éœ€è¦å½¼æ­¤çš„è¿›è¡Œè”ç³»ï¼Œå³æ˜¯è§£è€¦åˆ  </p></blockquote><p><img src="https://s1.ax1x.com/2020/09/17/wWVgWq.png" alt="ç¤ºæ„å›¾"></p><h3 id="å¼‚æ­¥å¤„ç†"><a href="#å¼‚æ­¥å¤„ç†" class="headerlink" title="å¼‚æ­¥å¤„ç†"></a>å¼‚æ­¥å¤„ç†</h3><p><strong>ç”¨æˆ·æ³¨å†Œï¼š</strong></p><ul><li><p>æ³¨å†Œå¤„ç†ä»¥åŠå†™å…¥æ•°æ®åº“ï¼ˆä¸€èˆ¬æˆ‘ä»¬å†™åˆ°è¿™ä¸€æ­¥ï¼‰</p></li><li><p>å‘é€æ³¨å†ŒæˆåŠŸçš„æ‰‹æœºçŸ­ä¿¡</p></li><li><p>å‘é€æ³¨å†ŒæˆåŠŸçš„é‚®ä»¶ä¿¡æ¯</p></li></ul><pre><code>&gt; åœ¨ä»¥å‰æˆ‘ä»¬æ˜¯ç›´æ¥è®©ä¸€ä¸ªçº¿ç¨‹å»åšæ³¨å†ŒåŠŸèƒ½ï¼Œæ³¨å†Œ--&gt;åå°æ¥å—--&gt;è°ƒç”¨å‘ä¿¡æ¯çš„æ–¹æ³•ï¼Œä¸æ˜¯å¼‚æ­¥çš„æ“ä½œï¼Œç‰¹åˆ«è€—è´¹è¯·æ±‚çš„æ—¶é—´&gt;&gt; ç°åœ¨æˆ‘ä»¬ç”¨ä¸¤ä¸ªçº¿ç¨‹å»æ“ä½œï¼Œä¸€ä¸ªçº¿ç¨‹å»å‘æ¶ˆæ¯ä¸­é—´ä»¶ä¸­å‘æ¶ˆæ¯ï¼Œè®©é‚®ä»¶å‘é€æˆ–è€…çŸ­ä¿¡å‘é€çš„æœåŠ¡å»æ¶ˆæ¯ä¸­é—´ä»¶ä¸­å–æ¶ˆæ¯ï¼Œç„¶åå–åˆ°æ¶ˆæ¯å†åšå¯¹åº”çš„ä¸šåŠ¡æ“ä½œã€‚</code></pre><h3 id="åº”ç”¨è§£è€¦"><a href="#åº”ç”¨è§£è€¦" class="headerlink" title="åº”ç”¨è§£è€¦"></a>åº”ç”¨è§£è€¦</h3><p><strong>è®¢å•å¤„ç†ï¼š</strong></p><ul><li><p>åœ¨è´­ç‰©è½¦ä¸­ç‚¹å‡»ç»“ç®—</p></li><li><p>å®Œæˆæ”¯ä»˜</p></li><li><p>åˆ›å»ºè®¢å•</p></li><li><p>è°ƒç”¨åº“å­˜ç³»ç»Ÿ</p></li></ul><blockquote><p>åœ¨è¿™ä¸ªåœºæ™¯ä¸‹å°±èƒ½å¾ˆå¥½çš„ä½“ç°ï¼š<br>å¦‚æœæ²¡æœ‰æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œæ‰€æœ‰çš„æ“ä½œï¼Œåœ¨åˆ›å»ºè®¢å•ä¹‹åï¼Œéœ€è¦ç­‰å¾…åº“å­˜ç³»ç»Ÿä¸­åšäº†å‘è´§å¤„ç†ï¼ˆä¸€èˆ¬è¿™ä¸ªæ“ä½œæ˜¯æœ‰ä¸€å®šçš„æ—¶é—´çš„ï¼‰é‚£ä¹ˆç”¨æˆ·ç½‘è´­åå°±éœ€è¦åœ¨å½“å‰é¡µé¢ç­‰å¾…å¥½å‡ ä¸ªå°æ—¶æ‰èƒ½è·‘å®Œæ•´ä¸ªæµç¨‹ã€‚ååˆ†çš„ä¸å‹å¥½ã€‚</p><p>ç”¨æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œæˆ‘ä»¬åˆ›å»ºè®¢å•åå‘æ¶ˆæ¯ä¸­é—´ä»¶ä¸­å‘é€è®¢å•çš„ä¿¡æ¯ï¼Œåº“å­˜ç³»ç»Ÿè‡ªå·±å»æ¶ˆæ¯ä¸­é—´ä»¶ä¸Šè·å–ï¼Œç„¶ååšå‘è´§çš„å¤„ç†ï¼Œæ›´æ–°åº“å­˜ï¼Œè¿™æ ·å­èƒ½å¤Ÿä½“ç°å‡ºå¼‚æ­¥å¤„ç†çš„æ–¹å¼ï¼Œä¹Ÿèƒ½å¤ŸæŠŠè®¢å•ä¸šåŠ¡å’Œåº“å­˜ç³»ç»Ÿçš„ä¸šåŠ¡å®Œå…¨è§£è€¦ï¼Œè€Œä¸”é€Ÿåº¦è¿˜æ˜¯å¾ˆå¿«ã€‚</p></blockquote><h3 id="æµé‡å‰Šå³°"><a href="#æµé‡å‰Šå³°" class="headerlink" title="æµé‡å‰Šå³°"></a>æµé‡å‰Šå³°</h3><p><strong>ç§’æ€æµç¨‹</strong></p><ul><li>ç”¨æˆ·ç‚¹å‡»ç§’æ€</li><li>å‘é€è¯·æ±‚åˆ°ç§’æ€åº”ç”¨</li><li>åœ¨è¯·æ±‚ç§’æ€åº”ç”¨ä¹‹å‰å°†è¯·æ±‚æ”¾å…¥åˆ°æ¶ˆæ¯é˜Ÿåˆ—</li><li>ç§’æ€åº”ç”¨ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­è·å–è¯·æ±‚å¹¶å¤„ç†</li></ul><blockquote><p>æ¯”å¦‚,ç³»ç»Ÿä¸¾è¡Œç§’æ€æ´»åŠ¨,çƒ­é—¨å•†å“ã€‚æµé‡èœ‚æ‹¥è€Œè‡³ 100 ä»¶å•†å“,10 ä¸‡äººæŒ¤è¿›æ¥æ€ä¹ˆåŠ?10 ä¸‡ç§’æ€çš„æ“ä½œ,æ”¾å…¥æ¶ˆæ¯é˜Ÿåˆ—ã€‚ç§’æ€åº”ç”¨å¤„ç†æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„ 10 ä¸‡ä¸ªè¯·æ±‚ä¸­çš„å‰ 100ä¸ª,å…¶ä»–çš„æ‰“å›,é€šçŸ¥å¤±è´¥ã€‚æµé‡å³°å€¼æ§åˆ¶åœ¨æ¶ˆæ¯é˜Ÿåˆ—å¤„,ç§’æ€åº”ç”¨ä¸ä¼šç¬é—´è¢«æ€¼æ­».</p></blockquote><h2 id="JMSæ¨¡å‹"><a href="#JMSæ¨¡å‹" class="headerlink" title="JMSæ¨¡å‹"></a>JMSæ¨¡å‹</h2><blockquote><p>JMS(Java Messaging Service)æ˜¯ Java å¹³å°ä¸Šæœ‰å…³é¢å‘æ¶ˆæ¯ä¸­é—´ä»¶çš„æŠ€æœ¯è§„èŒƒ,å®ƒä¾¿äºæ¶ˆæ¯ç³»ç»Ÿä¸­çš„ Java åº”ç”¨ç¨‹åºè¿›è¡Œæ¶ˆæ¯äº¤æ¢,å¹¶ä¸”é€šè¿‡æä¾›æ ‡å‡†çš„äº§ç”Ÿã€å‘é€ã€æ¥æ”¶æ¶ˆæ¯çš„æ¥å£,ç®€åŒ–ä¼ä¸šåº”ç”¨çš„å¼€å‘ã€‚</p></blockquote><p><strong>ç‚¹å¯¹ç‚¹æ¨¡å‹</strong></p><p>ç”Ÿäº§è€…å‘é€ä¸€æ¡æ¶ˆæ¯åˆ° queue,åªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…èƒ½æ”¶åˆ°ã€‚</p><p><img src="https://s1.ax1x.com/2020/09/17/wWvL0P.png" alt="ç‚¹å¯¹ç‚¹"></p><p><strong>å‘å¸ƒè®¢é˜…æ¨¡å‹(Publish/Subscribe)</strong></p><p>å‘å¸ƒè€…å‘é€åˆ° topic çš„æ¶ˆæ¯,åªæœ‰è®¢é˜…äº† topic çš„è®¢é˜…è€…æ‰ä¼šæ”¶åˆ°æ¶ˆæ¯ã€‚</p><p><img src="https://s1.ax1x.com/2020/09/17/wWxsN8.png" alt="å‘å¸ƒè®¢é˜…"></p><h2 id="å®‰è£…ActiveMQ"><a href="#å®‰è£…ActiveMQ" class="headerlink" title="å®‰è£…ActiveMQ"></a>å®‰è£…ActiveMQ</h2><p>ActiveMQ å®˜ç½‘: <a href="http://activemq.apache.org/">http://activemq.apache.org</a></p><blockquote><p>ActiveMQ5.10.x ä»¥ä¸Šç‰ˆæœ¬å¿…é¡»ä½¿ç”¨ JDK1.8 æ‰èƒ½æ­£å¸¸ä½¿ç”¨ã€‚<br>ActiveMQ5.9.x åŠä»¥ä¸‹ç‰ˆæœ¬ä½¿ç”¨ JDK1.7 å³å¯æ­£å¸¸ä½¿ç”¨ã€‚</p></blockquote><p>ä¸Šä¼ åˆ°linuxç³»ç»Ÿä¸­åï¼Œè¿è¡Œ<code>tar -zxf apache-activemq-5.9.0-bin.tar.gz</code>æŠŠå‹ç¼©åŒ…è§£å‹</p><p>å¦‚æœæƒé™ä¸å¤Ÿéœ€è¦æ‰‹åŠ¨æˆäºˆæƒé™<code>sudo chmod 755 xxxxx</code></p><p>è¿›å…¥<code>bin</code>ç›®å½•ä¸­è¿è¡Œ<code>./activemq start</code>å³å¯è¿è¡Œ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å¯åŠ¨</span>./activemq start<span class="token comment"># é‡å¯</span>./activemq restart<span class="token comment"># åœæ­¢</span>./activemq restart<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä¿®æ”¹è®¿é—®ç«¯å£</strong></p><blockquote><p>ä¿®æ”¹ ActiveMQ é…ç½®æ–‡ä»¶: <code>è½¯ä»¶æ ¹ç›®å½•/conf/jetty.xml</code></p><p>æ­£å¸¸æƒ…å†µä¸‹æ˜¯</p><pre><code>&lt;bean id=&quot;jettyPort&quot; class=&quot;org.apache.activemq.web.WebConsolePort&quot; init-method=&quot;start&quot;&gt;         &lt;!-- the default port number for the web console --&gt;    &lt;property name=&quot;port&quot; value=&quot;8161&quot;/&gt;&lt;/bean&gt;</code></pre></blockquote><p><strong>ä¿®æ”¹æœåŠ¡ç«¯å£</strong></p><blockquote><p>é…ç½®æ–‡ä»¶ <code>activemq.xml</code><br>é…ç½®æ–‡ä»¶ä¸­,é…ç½®çš„æ˜¯ ActiveMQ çš„æ ¸å¿ƒé…ç½®ä¿¡æ¯. æ˜¯æä¾›æœåŠ¡æ—¶ä½¿ç”¨çš„é…ç½®. å¯ä»¥ä¿®æ”¹<br>å¯åŠ¨çš„è®¿é—®ç«¯å£. å³ java ç¼–ç¨‹ä¸­è®¿é—® ActiveMQ çš„è®¿é—®ç«¯å£.<br>é»˜è®¤ç«¯å£ä¸º 61616.<br>ä½¿ç”¨åè®®æ˜¯: tcp åè®®.<br>ä¿®æ”¹ç«¯å£å, ä¿å­˜å¹¶é‡å¯ ActiveMQ æœåŠ¡å³å¯.</p></blockquote><p><strong>ä¿®æ”¹ç”¨æˆ·åå¯†ç </strong></p><blockquote><p>ä¿®æ”¹ <code>conf/users.properties</code> é…ç½®æ–‡ä»¶.å†…å®¹ä¸º: ç”¨æˆ·å=å¯†ç <br>ä¿å­˜å¹¶é‡å¯ ActiveMQ æœåŠ¡å³å¯.</p></blockquote><p><strong>ç›®å½•ä»‹ç»</strong></p><blockquote><ul><li>bin å­˜æ”¾çš„æ˜¯è„šæœ¬æ–‡ä»¶</li><li>conf å­˜æ”¾çš„æ˜¯åŸºæœ¬é…ç½®æ–‡ä»¶</li><li>data å­˜æ”¾çš„æ˜¯æ—¥å¿—æ–‡ä»¶</li><li>docs å­˜æ”¾çš„æ˜¯è¯´æ˜æ–‡æ¡£</li><li>examples å­˜æ”¾çš„æ˜¯ç®€å•çš„å®ä¾‹</li><li>lib å­˜æ”¾çš„æ˜¯ activemq æ‰€éœ€ jar åŒ…</li><li>webapps ç”¨äºå­˜æ”¾é¡¹ç›®çš„ç›®å½• </li></ul></blockquote><h2 id="æœ¯è¯­"><a href="#æœ¯è¯­" class="headerlink" title="æœ¯è¯­"></a>æœ¯è¯­</h2><ul><li><p>Destination</p><blockquote><p>ç›®çš„åœ°ï¼ŒJMS Providerè´Ÿè´£ç»´æŠ¤ï¼Œç”¨äºå¯¹Messageè¿›è¡Œç®¡ç†çš„å¯¹è±¡ã€‚MessageProduceréœ€è¦æŒ‡å®šDestinationæ‰èƒ½å‘é€æ¶ˆæ¯ï¼ŒMessageReceiveréœ€è¦æŒ‡å®šDestinationæ‰èƒ½æ¥æ”¶æ¶ˆæ¯</p></blockquote></li><li><p>Producer/Provider</p><blockquote><p>æ¶ˆæ¯ç”Ÿäº§è€…</p></blockquote></li><li><p>Consumer/Receiver</p><blockquote><p>æ¶ˆæ¯è·å–è€…ï¼Œä»ç›®çš„åœ°ä¸­ã€å¤„ç†|ç›‘å¬|è®¢é˜…ã€‘message</p></blockquote></li><li><p>Message</p><blockquote><p>æ¶ˆæ¯å°è£…ä¸€æ¬¡é€šä¿¡çš„å†…å®¹</p></blockquote></li></ul><h2 id="å¸¸ç”¨API"><a href="#å¸¸ç”¨API" class="headerlink" title="å¸¸ç”¨API"></a>å¸¸ç”¨API</h2><ol><li><p>ConnectionFactory</p><p> é“¾æ¥å·¥å‚, ç”¨äºåˆ›å»ºé“¾æ¥çš„å·¥å‚ç±»å‹.</p></li><li><p>Connection</p><p> ç”±é“¾æ¥å·¥å‚åˆ›å»ºï¼Œç”¨äºè®¿é—®ActiveMQé“¾æ¥çš„ç±»å‹</p></li><li><p>Session</p><p> ä¼šè¯ï¼Œä¸€æ¬¡æŒä¹…æœ‰æ•ˆæœ‰çŠ¶æ€çš„è®¿é—®ï¼Œç”±é“¾æ¥åˆ›å»º</p></li><li><p>Destination &amp; Queue</p><p> ç›®çš„åœ°ï¼Œç”¨äºæè¿°æœ¬æ¬¡è®¿é—®ActiveMQçš„æ¶ˆæ¯è®¿é—®ç›®çš„åœ°ï¼Œå³ActiveMQæœåŠ¡ä¸­çš„å…·ä½“é˜Ÿåˆ—ï¼Œç”±ä¼šè¯åˆ›å»º</p></li><li><p>MessageProducer</p><p> æ¶ˆæ¯ç”Ÿäº§è€…ï¼Œåœ¨ä¸€æ¬¡æœ‰æ•ˆçš„ä¼šè¯ä¸­ç”¨äºå‘é€æ¶ˆæ¯ç»™ActiveMQ</p></li><li><p>MessageConsumer</p><p> æ¶ˆæ¯æ¶ˆè´¹è€…ã€è®¢é˜…è€…ï¼Œå¤„ç†è€…ã€‘ï¼Œåœ¨ä¸€æ¬¡æœ‰æ•ˆçš„ä¼šè¯ä¸­ï¼Œç”¨äºä»ActiveMQæœåŠ¡ä¸­è·å–æ¶ˆæ¯çš„å·¥å…·ï¼Œç”±ä¼šè¯åˆ›å»º</p></li><li><p>Message</p><p> æ¶ˆæ¯ï¼Œé€šè¿‡æ¶ˆæ¯ç”Ÿäº§è€…å‘MQæœåŠ¡å‘é€æ¶ˆæ¯æ—¶ä½¿ç”¨çš„æ•°æ®è½½ä½“å¯¹è±¡æˆ–è€…æ¶ˆæ¯æ¶ˆè´¹è€…ä»MQæœåŠ¡ä¸­è·å–æ¶ˆæ¯æ—¶ä½¿ç”¨çš„æ•°æ®è½½ä½“å¯¹è±¡ï¼Œæ—¶æ‰€æœ‰æ¶ˆæ¯å…·ä½“ç±»å‹çš„é¡¶çº§æ¥å£ï¼Œå¯ä»¥é€šè¿‡ä¼šè¯åˆ›å»ºæˆ–è€…é€šè¿‡ä¼šè¯ä»MQæœåŠ¡ä¸­è·å– </p></li></ol><h2 id="äº”ç§æ¶ˆæ¯ä½“æ ¼å¼"><a href="#äº”ç§æ¶ˆæ¯ä½“æ ¼å¼" class="headerlink" title="äº”ç§æ¶ˆæ¯ä½“æ ¼å¼"></a>äº”ç§æ¶ˆæ¯ä½“æ ¼å¼</h2><ul><li><p>TextMessage</p><blockquote><p>æ™®é€šå­—ç¬¦ä¸²æ¶ˆæ¯ï¼ŒåŒ…å«ä¸€ä¸ªstring</p></blockquote></li><li><p>MapMessage</p><blockquote><p>ä¸€ä¸ªMapç±»å‹çš„æ¶ˆæ¯ï¼Œkeyæ˜¯Stringç±»å‹ï¼Œè€Œå€¼ä¸ºJavaçš„åŸºæœ¬ç±»å‹</p></blockquote></li><li><p>BytesMessage</p><blockquote><p>äºŒè¿›åˆ¶æ•°ç»„æ¶ˆæ¯ï¼ŒåŒ…å«ä¸€ä¸ªbyte[]</p></blockquote></li><li><p>StreamMessage</p><blockquote><p>javaæ•°æ®æµæ¶ˆæ¯ï¼Œç”¨æ ‡å‡†æµæ“ä½œæ¥é¡ºåºçš„å¡«å……å’Œè¯»å–</p></blockquote></li><li><p>ObjectMessage</p><blockquote><p>å¯¹è±¡æ¶ˆæ¯ï¼ŒåŒ…å«ä¸€ä¸ªå¯åºåˆ—åŒ–çš„javaå¯¹è±¡</p></blockquote></li></ul><p><strong>æ¶ˆæ¯å±æ€§</strong><br>ä»–ä»¬æ˜¯ä»¥å±æ€§åå’Œå±æ€§å€¼å¯¹çš„å½¢å¼æŒ‡å®šçš„ã€‚å¯ä»¥ å°†å±æ€§æ˜¯ä¸º æ¶ˆæ¯å¤´å¾—æ‰©å±•ï¼Œå±æ€§æŒ‡å®šä¸€äº›æ¶ˆæ¯å¤´æ²¡æœ‰åŒ… æ‹¬çš„é™„åŠ ä¿¡æ¯ï¼Œæ¯”å¦‚å¯ä»¥åœ¨å±æ€§é‡ŒæŒ‡å®šæ¶ˆæ¯é€‰æ‹©å™¨ã€‚</p><p>æ¶ˆæ¯çš„å±æ€§å°±åƒå¯ä»¥åˆ†é…ç»™ä¸€æ¡æ¶ˆæ¯çš„é™„åŠ æ¶ˆæ¯å¤´ä¸€æ ·ã€‚ä»–ä»¬å…è®¸å¼€å‘è€…æ·»åŠ æœ‰å…³æ¶ˆæ¯çš„ä¸é€æ˜é™„åŠ ä¿¡æ¯ã€‚</p><p>å®ƒä»¬è¿˜ç”¨äºæš´éœ²æ¶ˆæ¯é€‰æ‹©å™¨åœ¨æ¶ˆæ¯è¿‡æ»¤æ—¶ä½¿ç”¨çš„æ•°æ®ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">TextMessage</span> message <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createTextMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>message<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>message<span class="token punctuation">.</span><span class="token function">setStringProperty</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span><span class="token string">"kuangshen"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è‡ªå®šä¹‰å±æ€§</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="ç®€å•æ¡ˆä¾‹"><a href="#ç®€å•æ¡ˆä¾‹" class="headerlink" title="ç®€å•æ¡ˆä¾‹"></a>ç®€å•æ¡ˆä¾‹</h2><blockquote><ul><li>åˆ›å»ºproduceræ¨¡å—<ul><li>æµ‹è¯•å‘é€æ–‡æœ¬æ¶ˆæ¯</li><li>æµ‹è¯•å‘é€æ¶ˆæ¯å¯¹è±¡<ul><li>å®ç°Serializableæ¥å£ï¼Œåºåˆ—åŒ–</li></ul></li></ul></li><li>åˆ›å»ºconsumeræ¨¡å—<ul><li>æµ‹è¯•æ¥æ”¶æ–‡æœ¬æ¶ˆæ¯</li><li>æµ‹è¯•æ¥æ”¶æ¶ˆæ¯å¯¹è±¡</li></ul></li></ul></blockquote><p><strong>æ¶ˆæ¯å‘é€æ¨¡å—</strong></p><ol><li>å¼•å…¥ActiveMQçš„mavenåæ ‡</li></ol><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- ActiveMQæ‰€ä¾èµ–çš„jaråŒ… --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.activemq<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>activemq-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>5.9.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li><p>æµ‹è¯•å‘é€æ–‡æœ¬ä¿¡æ¯åŠŸèƒ½</p> <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**    * ç”Ÿäº§æ¶ˆæ¯    */</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendHelloWorldActiveMQ</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token comment">// å®šä¹‰é“¾æ¥å·¥å‚</span>       <span class="token class-name">ConnectionFactory</span> connectionFactory <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>       <span class="token comment">// é“¾æ¥å¯¹è±¡</span>       <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>       <span class="token comment">// ä¼šè¯å¯¹è±¡</span>       <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>       <span class="token comment">// ç›®çš„åœ°</span>       <span class="token class-name">Destination</span> destination <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>       <span class="token comment">// æ¶ˆæ¯çš„å‘é€è€…</span>       <span class="token class-name">MessageProducer</span> messageProducer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>       <span class="token comment">// å®šä¹‰æ¶ˆæ¯</span>       <span class="token class-name">Message</span> message <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>           <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>           <span class="token comment">/**            * userName:è®¿é—®ActiveMQæœåŠ¡çš„ç”¨æˆ·åï¼Œé»˜è®¤admin,å¯ä»¥åœ¨jetty-ream.propertiesä¸­ä¿®æ”¹            * password:è®¿é—®ActiveMQæœåŠ¡çš„ç”¨æˆ·åï¼Œé»˜è®¤admin,å¯ä»¥åœ¨jetty-ream.propertiesä¸­ä¿®æ”¹            * brokerURL: è®¿é—®ActiveMQæœåŠ¡çš„è·¯å¾„åœ°å€ï¼Œè·¯å¾„ç»“æ„ä¸ºåè®®åï¼š//ä¸»æœºåœ°å€ï¼šç«¯å£å·            */</span>           connectionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveMQConnectionFactory</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">,</span><span class="token string">"admin"</span><span class="token punctuation">,</span><span class="token string">"failover:(tcp://localhost:61616)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           connection <span class="token operator">=</span> connectionFactory<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">//å¯åŠ¨é“¾æ¥</span>           connection<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">/**            * transacted æ˜¯å¦ä½¿ç”¨äº‹åŠ¡ï¼Œæ¶ˆæ¯åŸå­åŒ–ï¼Œé…åˆäº‹åŠ¡æäº¤æ¥è¿›è¡Œ æ‰¹é‡å’Œå‘é€å’Œæ¯ä¸ªå‘é€            *      true  ä¼šä¸€ä¸ªæ¶ˆæ¯ç¡®è®¤æœºåˆ¶            *      false            * acknowledgeMode            *      static final int AUTO_ACKNOWLEDGE = 1; è‡ªåŠ¨æ¶ˆæ¯ç¡®è®¤            *            *      static final int CLIENT_ACKNOWLEDGE = 2; å®¢æˆ·ç«¯ç¡®è®¤            *            *      static final int DUPS_OK_ACKNOWLEDGE = 3; æœ‰å‰¯æœ¬çš„å®¢æˆ·ç«¯ç¡®è®¤æ¶ˆæ¯æœºåˆ¶            *            *      static final int SESSION_TRANSACTED = 0; sessionå·²å¤„ç†çš„            */</span>           session <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createSession</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token class-name">Session</span><span class="token punctuation">.</span>AUTO_ACKNOWLEDGE<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// åˆ›å»ºç›®çš„åœ°ï¼Œå³é˜Ÿåˆ—</span>           destination <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQueue</span><span class="token punctuation">(</span><span class="token string">"helloworld-distination"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// åˆ›å»ºæ¶ˆæ¯ç”Ÿäº§è€… éœ€è¦æä¾›ç›®çš„åœ°</span>           messageProducer <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createProducer</span><span class="token punctuation">(</span>destination<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// åˆ›å»ºæ¶ˆæ¯å¯¹è±¡</span>           message <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createTextMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment">//å‘é€æ¶ˆæ¯</span>           messageProducer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>           <span class="token comment">// å›æ”¶æ¶ˆæ¯å‘é€è€…</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>messageProducer<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                   messageProducer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JMSException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>session<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                   session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JMSException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>connection<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                   connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JMSException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><ol start="3"><li><p>æµ‹è¯•å‘é€å¯¹è±¡ä¿¡æ¯åŠŸèƒ½</p><blockquote><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªuserç±»ï¼Œå¹¶ä¸”è¦<strong>å®ç°åºåˆ—åŒ–æ¥å£</strong></p><p>å…¶æ¬¡å®ç°ä»£ç :</p></blockquote> <pre class="line-numbers language-java" data-language="java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testConsumer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>         connectionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveMQConnectionFactory</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span><span class="token string">"user"</span><span class="token punctuation">,</span><span class="token string">"failover:(tcp://localhost:61616)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             connection <span class="token operator">=</span> connectionFactory<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             connection<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             session <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createSession</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token class-name">Session</span><span class="token punctuation">.</span>AUTO_ACKNOWLEDGE<span class="token punctuation">)</span><span class="token punctuation">;</span>             destination <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQueue</span><span class="token punctuation">(</span><span class="token string">"my-user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             messageConsumer <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createConsumer</span><span class="token punctuation">(</span>destination<span class="token punctuation">)</span><span class="token punctuation">;</span>             message <span class="token operator">=</span> messageConsumer<span class="token punctuation">.</span><span class="token function">receive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">/**         å¤„ç†æ¶ˆæ¯ç±»å‹ï¼Œè½¬æˆObjectMessage         è°ƒç”¨getObject()åï¼Œå†å¼ºè½¬ä¸ºå¯¹åº”çš„ç±»å‹         */</span>         <span class="token class-name">ObjectMessage</span> objectMessage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ObjectMessage</span><span class="token punctuation">)</span>message<span class="token punctuation">;</span>         <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span>objectMessage<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>         <span class="token comment">// å›æ”¶æ¶ˆæ¯å‘é€è€…</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>messageConsumer<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                 messageConsumer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JMSException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>session<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                 session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JMSException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>connection<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                 connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JMSException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><p><strong>æ¶ˆæ¯æ¥æ”¶æ¨¡å—</strong></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!-- ActiveMQæ‰€ä¾èµ–çš„jaråŒ… --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.activemq<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>activemq-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>5.9.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- log4jæ—¥å¿— --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>æµ‹è¯•æ¥å—æ–‡æœ¬</p><blockquote><p>è¦æœ‰å¯¹åº”çš„å¯¹è±¡ç±»ï¼Œå¹¶ä¸”å®ç°äº†åºåˆ—åŒ–</p></blockquote></li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testConsumer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>         connectionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveMQConnectionFactory</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span><span class="token string">"user"</span><span class="token punctuation">,</span><span class="token string">"failover:(tcp://localhost:61616)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         connection <span class="token operator">=</span> connectionFactory<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         connection<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         session <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createSession</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token class-name">Session</span><span class="token punctuation">.</span>AUTO_ACKNOWLEDGE<span class="token punctuation">)</span><span class="token punctuation">;</span>         destination <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQueue</span><span class="token punctuation">(</span><span class="token string">"helloworld-distination"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         messageConsumer <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createConsumer</span><span class="token punctuation">(</span>destination<span class="token punctuation">)</span><span class="token punctuation">;</span>         message <span class="token operator">=</span> messageConsumer<span class="token punctuation">.</span><span class="token function">receive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// å¤„ç†æ¶ˆæ¯</span>         <span class="token class-name">String</span> msg <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TextMessage</span><span class="token punctuation">)</span>message<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>         <span class="token comment">// å›æ”¶æ¶ˆæ¯å‘é€è€…</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>messageConsumer<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                 messageConsumer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JMSException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>session<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                 session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JMSException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>connection<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                 connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JMSException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                 e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æµ‹è¯•æ¥æ”¶å¯¹è±¡</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testConsumer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>           connectionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveMQConnectionFactory</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span><span class="token string">"user"</span><span class="token punctuation">,</span><span class="token string">"failover:(tcp://localhost:61616)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           connection <span class="token operator">=</span> connectionFactory<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           connection<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           session <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createSession</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token class-name">Session</span><span class="token punctuation">.</span>AUTO_ACKNOWLEDGE<span class="token punctuation">)</span><span class="token punctuation">;</span>           destination <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQueue</span><span class="token punctuation">(</span><span class="token string">"my-user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           messageConsumer <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createConsumer</span><span class="token punctuation">(</span>destination<span class="token punctuation">)</span><span class="token punctuation">;</span>           message <span class="token operator">=</span> messageConsumer<span class="token punctuation">.</span><span class="token function">receive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// å¤„ç†æ¶ˆæ¯</span>           <span class="token class-name">ObjectMessage</span> objectMessage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ObjectMessage</span><span class="token punctuation">)</span>message<span class="token punctuation">;</span>           <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span>objectMessage<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>           <span class="token comment">// å›æ”¶æ¶ˆæ¯å‘é€è€…</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>messageConsumer<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                   messageConsumer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JMSException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>session<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                   session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JMSException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span>connection<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                   connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JMSException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ¶ˆè´¹è€…çš„3å¤§é—®é¢˜"><a href="#æ¶ˆè´¹è€…çš„3å¤§é—®é¢˜" class="headerlink" title="æ¶ˆè´¹è€…çš„3å¤§é—®é¢˜"></a>æ¶ˆè´¹è€…çš„3å¤§é—®é¢˜</h3><ul><li>å…ˆç”Ÿäº§æ¶ˆæ¯ï¼Œåªå¯åŠ¨1å·æ¶ˆè´¹è€…ï¼Œ1å·æ¶ˆè´¹è€…å¯ä»¥æ¶ˆè´¹å—ï¼Ÿ</li><li>å…ˆç”Ÿäº§æ¶ˆæ¯ï¼Œå…ˆå¯åŠ¨1å·æ¶ˆè´¹è€…ï¼Œå†å¯åŠ¨2å·æ¶ˆè´¹è€…ã€‚2å·æ¶ˆè´¹è€…å¯ä»¥æ¶ˆè´¹å—ï¼Ÿ</li><li>å…ˆå¯åŠ¨ä¸¤ä¸ªæ¶ˆè´¹è€…ï¼Œå†ç”Ÿäº§6ä¸ªæ¶ˆæ¯ï¼Œè¯·é—®ï¼Œæ¶ˆè´¹æƒ…å†µå¦‚ä½•ï¼Ÿ</li></ul><h3 id="å®ç°é˜Ÿåˆ—æœåŠ¡ç›‘å¬å¤„ç†"><a href="#å®ç°é˜Ÿåˆ—æœåŠ¡ç›‘å¬å¤„ç†" class="headerlink" title="å®ç°é˜Ÿåˆ—æœåŠ¡ç›‘å¬å¤„ç†"></a>å®ç°é˜Ÿåˆ—æœåŠ¡ç›‘å¬å¤„ç†</h3><blockquote><p>åœ¨æ¶ˆè´¹è€…çš„é‚£ä¸€ç«¯å®ç°é˜Ÿåˆ—ç›‘å¬ï¼Œå¦‚æœé˜Ÿåˆ—ä¸­å­˜åœ¨äº†æ¶ˆæ¯ï¼Œå°±ä¼šè°ƒç”¨æ¶ˆè´¹è€…é‚£ä¸€ç«¯çš„æ–¹æ³•ã€‚</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**åœ¨æ¶ˆè´¹è€…è·å–æ¶ˆæ¯çš„æ—¶å€™æ³¨å†Œç›‘å¬å³å¯*/</span>messageConsumer<span class="token punctuation">.</span><span class="token function">setMessageListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">MessageListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// å¤„ç†æ¶ˆæ¯,å¯¹åº”çš„ä¸šåŠ¡</span>        <span class="token class-name">String</span> msg <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            msg <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TextMessage</span><span class="token punctuation">)</span>message<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JMSException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Topicæ¨¡å‹"><a href="#Topicæ¨¡å‹" class="headerlink" title="Topicæ¨¡å‹"></a>Topicæ¨¡å‹</h2><blockquote><p>publish / Subscribe å¤„ç†æ¨¡å¼(Topic)</p><p>æ¶ˆæ¯ç”Ÿäº§è€…(å‘å¸ƒ)æŠŠæ¶ˆæ¯å‘å¸ƒåˆ°topicä¸­ï¼ŒåŒæ—¶æœ‰å¤šä¸ªæ¶ˆæ¯æ¶ˆè´¹è€…(è®¢é˜…)æ”¹æ¶ˆæ¯.</p><ul><li><p>å’Œ<strong>ç‚¹å¯¹ç‚¹</strong>æ–¹å¼ä¸åŒï¼Œå‘å¸ƒåˆ°topicçš„æ¶ˆæ¯ä¼šè¢«<strong>æ‰€æœ‰è®¢é˜…è€…æ¶ˆè´¹</strong></p></li><li><p>å½“ç”Ÿäº§è€…å‘å¸ƒæ¶ˆæ¯ï¼Œä¸ç®¡æœ‰æ²¡æœ‰æ¶ˆè´¹è€…ï¼Œéƒ½ä¸ä¼šä¿å­˜æ¶ˆæ¯</p></li><li><p>ä¸€å®šæ˜¯å…ˆæœ‰æ¶ˆæ¯çš„æ¶ˆè´¹è€…ï¼Œåæœ‰æ¶ˆæ¯çš„ç”Ÿäº§è€…</p></li></ul></blockquote><p><img src="/home/zhy/.config/Typora/typora-user-images/image-20200920182932590.png" alt="å‘å¸ƒè®¢é˜…æ¨¡å¼"></p><p>ä»£ç å®ç°</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**åœ¨sessionåˆ›å»ºé˜Ÿåˆ—çš„æ—¶å€™è¦é€‰æ‹©åˆ›å»ºtopic*/</span>destination <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createTopic</span><span class="token punctuation">(</span><span class="token string">"test-topic"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><table><thead><tr><th>æ¯”è¾ƒé¡¹ç›®</th><th>Topicæ¨¡å¼é˜Ÿåˆ—</th><th>Queueæ¨¡å¼é˜Ÿåˆ—</th></tr></thead><tbody><tr><td><strong>å·¥ä½œæ¨¡å¼</strong></td><td>â€œè®¢é˜…-å‘å¸ƒâ€æ¨¡å¼ï¼Œå¦‚æœå½“å‰æ²¡æœ‰è®¢é˜…è€…ï¼Œæ¶ˆæ¯å°†ä¼šè¢«ä¸¢å¼ƒï¼Œå¦‚æœæœ‰å¤šä¸ªè®¢é˜…è€…ï¼Œé‚£ä¹ˆè¿™äº›è®¢é˜…è€…éƒ½ä¼šæ”¶åˆ°æ¶ˆæ¯ã€‚</td><td>è´Ÿè½½å‡è¡¡ æ¨¡å¼ï¼Œå¦‚æœå½“å‰æ²¡æœ‰æ¶ˆè´¹è€…ï¼Œæ¶ˆæ¯ä¹Ÿä¸ä¼šä¸¢å¼ƒï¼Œå¦‚æœæœ‰å¤šä¸ªæ¶ˆè´¹è€…ï¼Œé‚£ä¹ˆä¸€æ¡æ¶ˆæ¯ä¹Ÿåªä¼šå‘é€ç»™å…¶ä¸­ä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œå¹¶ä¸”è¦æ±‚æ¶ˆè´¹è€…ackä¿¡æ¯ã€‚</td></tr><tr><td><strong>æœ‰æ— çŠ¶æ€</strong></td><td>æ— çŠ¶æ€</td><td>Queue æ•°æ®é»˜è®¤ä¼šåœ¨ mq æœåŠ¡å™¨ä¸Šä»¥æ–‡ä»¶å½¢å¼ä¿å­˜ï¼Œæ¯”å¦‚ Active MQ ä¸€èˆ¬ä¿å­˜åœ¨$AMQ_HOME\data\kr-store\dataä¸‹é¢ï¼Œä¹Ÿå¯ä»¥é…ç½®æˆDBå­˜å‚¨ã€‚</td></tr><tr><td><strong>ä¼ é€’å®Œæ•´æ€§</strong></td><td>å¦‚æœæ²¡æœ‰è®¢é˜…è€…ï¼Œæ¶ˆæ¯ä¼šè¢«ä¸¢å¼ƒ</td><td>æ¶ˆæ¯ä¸ä¼šè¢«ä¸¢å¼ƒ</td></tr><tr><td><strong>å¤„ç†æ•ˆç‡</strong></td><td>ç”±äºæ¶ˆæ¯è¦æŒ‰ç…§è®¢é˜…è€…çš„æ•°é‡è¿›è¡Œå¤åˆ¶ï¼Œæ‰€ä»¥å¤„ç†æ€§èƒ½ä¼šéšç€è®¢é˜…è€…çš„å¢åŠ è€Œæ˜æ˜¾é™ä½ï¼Œå¹¶ä¸”è¿˜è¦ç»“åˆä¸åŒæ¶ˆæ¯åè®®è‡ªèº«çš„æ€§èƒ½å·®å¼‚</td><td>ç”±äºä¸€æ¡æ¶ˆæ¯åªå‘é€ç»™ä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œæ‰€ä»¥å°±ç®—æ¶ˆè´¹è€…å†å¤šï¼Œæ€§èƒ½ä¹Ÿä¸ä¼šæœ‰æ˜æ˜¾é™ä½ã€‚å½“ç„¶ä¸åŒæ¶ˆæ¯åè®®çš„å…·ä½“æ€§èƒ½ä¹Ÿæ˜¯æœ‰å·®å¼‚çš„</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> æ¶ˆæ¯ä¸­é—´ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ActiveMQ </tag>
            
            <tag> æ¶ˆæ¯ä¸­é—´ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerå®¹å™¨åŒ–æŠ€æœ¯</title>
      <link href="2020/08/26/docker-rong-qi-hua-ji-zhu/"/>
      <url>2020/08/26/docker-rong-qi-hua-ji-zhu/</url>
      
        <content type="html"><![CDATA[<h1 id="Docker-å­¦ä¹ "><a href="#Docker-å­¦ä¹ " class="headerlink" title="Docker å­¦ä¹ "></a>Docker å­¦ä¹ </h1><blockquote><p>Docker å®˜ç½‘ï¼š<a href="http://www.docker.com/">http://www.docker.com</a><br>Docker ä¸­æ–‡ç½‘ç«™ï¼š<a href="https://www.docker-cn.com/">https://www.docker-cn.com</a><br>Docker Hub å®˜ç½‘ï¼š<a href="https://hub.docker.com/">https://hub.docker.com</a> ï¼ˆä»“åº“ï¼‰</p></blockquote><h2 id="Docker-å…¥é—¨"><a href="#Docker-å…¥é—¨" class="headerlink" title="Docker å…¥é—¨"></a>Docker å…¥é—¨</h2><h3 id="Docker-ç®€ä»‹"><a href="#Docker-ç®€ä»‹" class="headerlink" title="Docker ç®€ä»‹"></a>Docker ç®€ä»‹</h3><ol><li><p>ä»€ä¹ˆæ˜¯ Docker</p><blockquote><p>Docker æ˜¯åŸºäº Go è¯­è¨€å®ç°çš„å¼€æºå®¹å™¨é¡¹ç›®ã€‚åˆ©ç”¨æ“ä½œç³»ç»Ÿæœ¬èº«å·²æœ‰çš„æœºåˆ¶å’Œç‰¹æ€§ï¼Œå¯ä»¥å®ç°è¿œè¶…ä¼ ç»Ÿè™šæ‹Ÿæœºçš„è½»é‡çº§è™šæ‹ŸåŒ–ã€‚å®ƒæ˜¯å†…æ ¸çº§çš„è™šæ‹ŸåŒ–ã€‚æœŸæœ›è¾¾åˆ°ä½¿é¡¹ç›®è¿è¡Œç¯å¢ƒâ€œä¸€æ¬¡å°è£…ï¼Œåˆ°å¤„è¿è¡Œçš„ç›®çš„â€ã€‚<br>åˆ©ç”¨ docker åˆ›å»ºçš„è¿è¡Œç¯å¢ƒå«åš docker å®¹å™¨ï¼Œå®¹å™¨æ˜¯é€šè¿‡ docker é•œåƒåˆ›å»ºçš„ï¼Œdocker é•œåƒæ–‡ä»¶å¯ä»¥æ”¾åœ¨ç§æœ‰ä»“åº“ä¸­ä¹Ÿå¯ä»¥æ”¾åœ¨å…±æœ‰ä»“åº“ä¸­ã€‚</p></blockquote></li><li><p>Docker ç‰¹ç‚¹</p><ul><li>æ•ˆç‡é«˜</li><li>èŒè´£æ˜ç¡®</li><li>ç»“æ„å®Œæ•´</li><li>å¥‘åˆå¾®æœåŠ¡æ¶æ„</li></ul></li><li><p>Docker æ¶æ„<br><img src="https://s1.ax1x.com/2020/09/01/dxO2ng.png" alt="Dockeræ¶æ„"></p></li></ol><ul><li><p>Docker daemon(Docker å®ˆæŠ¤è¿›ç¨‹)</p><blockquote><p>Docker daemon æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨å®¿ä¸»ï¼ˆDOCKER_HOSTï¼‰çš„åå°è¿›ç¨‹ã€‚æˆ‘ä»¬å¯é€šè¿‡ Docker å®¢æˆ·ç«¯ä¸ä¹‹é€šä¿¡ã€‚</p></blockquote></li><li><p>Client(Docker å®¢æˆ·ç«¯)</p><blockquote><p>Docker å®¢æˆ·ç«¯æ˜¯ Docker çš„ç”¨æˆ·ç•Œé¢ï¼Œå®ƒå¯ä»¥æ¥å—ç”¨æˆ·å‘½ä»¤å’Œé…ç½®æ ‡è¯†ï¼Œå¹¶ä¸ Docker daemon é€šä¿¡ã€‚å›¾ä¸­ï¼Œdocker build ç­‰éƒ½æ˜¯ Docker çš„ç›¸å…³å‘½ä»¤ã€‚</p></blockquote></li><li><p>Images(Docker é•œåƒ)</p><blockquote><p>Docker é•œåƒï¼ˆImageï¼‰å°±æ˜¯ä¸€ä¸ªåªè¯»çš„æ¨¡æ¿ã€‚é•œåƒå¯ä»¥ç”¨æ¥åˆ›å»º Docker å®¹å™¨ï¼Œä¸€ä¸ªé•œåƒå¯ä»¥åˆ›å»ºå¾ˆå¤šå®¹å™¨ã€‚ å°±å¥½ä¼¼ Java ä¸­çš„ ç±»å’Œå¯¹è±¡ï¼Œç±»å°±æ˜¯é•œåƒï¼Œå®¹å™¨å°±æ˜¯å¯¹è±¡ï¼</p></blockquote></li><li><p>Container(å®¹å™¨)</p><blockquote><p>å®¹å™¨æ˜¯é•œåƒçš„å¯è¿è¡Œå®ä¾‹ã€‚é•œåƒå’Œå®¹å™¨çš„å…³ç³»æœ‰ç‚¹ç±»ä¼¼äºé¢å‘å¯¹è±¡ä¸­ï¼Œç±»å’Œå¯¹è±¡çš„å…³ç³»ã€‚æˆ‘ä»¬å¯é€šè¿‡ Docker API æˆ–è€… CLI å‘½ä»¤æ¥å¯åœã€ç§»åŠ¨ã€åˆ é™¤å®¹å™¨</p></blockquote></li><li><p>Registry(ä»“åº“)</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">ä»“åº“ï¼ˆRepositoryï¼‰æ˜¯é›†ä¸­å­˜æ”¾é•œåƒæ–‡ä»¶çš„åœºæ‰€ã€‚ä»“åº“(Repository)å’Œä»“åº“æ³¨å†ŒæœåŠ¡å™¨ï¼ˆRegistryï¼‰æ˜¯æœ‰åŒºåˆ«çš„ã€‚ä»“åº“æ³¨å†ŒæœåŠ¡å™¨ä¸Šå¾€å¾€å­˜æ”¾ç€å¤šä¸ªä»“åº“ï¼Œæ¯ä¸ªä»“åº“ä¸­åˆåŒ…å«äº†å¤šä¸ªé•œåƒï¼Œæ¯ä¸ªé•œåƒæœ‰ä¸åŒçš„æ ‡ç­¾ï¼ˆtagï¼‰ã€‚ä»“åº“åˆ†ä¸ºå…¬å¼€ä»“åº“ï¼ˆPublicï¼‰å’Œç§æœ‰ä»“åº“ï¼ˆPrivateï¼‰ä¸¤ç§å½¢å¼ã€‚æœ€å¤§çš„å…¬å¼€ä»“åº“æ˜¯ Docker Hub(https:&#x2F;&#x2F;hub.docker.com&#x2F;)ï¼Œå­˜æ”¾äº†æ•°é‡åºå¤§çš„é•œåƒä¾›ç”¨æˆ·ä¸‹è½½ã€‚å›½å†…çš„å…¬å¼€ä»“åº“åŒ…æ‹¬é˜¿é‡Œäº‘ ã€ç½‘æ˜“äº‘ ç­‰<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h3></li></ul><blockquote><p>æœ¬æ¬¡å®‰è£…ä½¿ç”¨ Linux çš„ centos7 ç³»ç»Ÿ</p></blockquote><ol><li><a href="https://docs.docker.com/engine/install/centos/">å®˜ç½‘å®‰è£…å‚è€ƒ</a></li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å®‰è£…gccç›¸å…³ç¯å¢ƒ</span>yum -y <span class="token function">install</span> gccyum -y <span class="token function">install</span> gcc-c++<span class="token comment"># å¸è½½æ—§ç‰ˆæœ¬ï¼Œæ¨èåœ¨å®‰è£…å‰æ‰§è¡Œä¸€é</span>$ <span class="token function">sudo</span> yum remove docker <span class="token punctuation">\</span>                  docker-client <span class="token punctuation">\</span>                  docker-client-latest <span class="token punctuation">\</span>                  docker-common <span class="token punctuation">\</span>                  docker-latest <span class="token punctuation">\</span>                  docker-latest-logrotate <span class="token punctuation">\</span>                  docker-logrotate <span class="token punctuation">\</span>                  docker-engine<span class="token comment"># å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ…</span>yum <span class="token function">install</span> -y yum-utils<span class="token comment"># ä½¿ç”¨å›½å†…çš„åŠ é€Ÿ</span>yum-config-manager <span class="token punctuation">\</span>    --add-repo <span class="token punctuation">\</span>     http://mirrors.aliyun.com/dockerce/linux/centos/docker-ce.repo<span class="token comment"># æ›´æ–°yumè½¯ä»¶åŒ…ç´¢å¼•</span>yum makecache fast<span class="token comment"># å®‰è£… Docker CE</span>yum <span class="token function">install</span> docker-ce docker-ce-cli containerd.io<span class="token comment"># å¯åŠ¨ Docker</span>systemctl start docker<span class="token comment"># æµ‹è¯•å‘½ä»¤</span>docker versiondocker run hello-worlddocker images<span class="token comment"># å¸è½½</span>systemctl stop dockeryum -y remove docker-ce docker-ce-cli containerd.io<span class="token function">rm</span> -rf /var/lib/docker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/09/02/wSbHuF.png" alt="é•œåƒ"></p><h3 id="é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿ"><a href="#é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿ" class="headerlink" title="é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿ"></a>é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿ</h3><ol><li>ä»‹ç»ï¼š<a href="https://www.aliyun.com/product/acr">https://www.aliyun.com/product/acr</a></li><li>æ³¨å†Œä¸€ä¸ªå±äºè‡ªå·±çš„é˜¿é‡Œäº‘è´¦æˆ·(å¯å¤ç”¨æ·˜å®è´¦å·)</li><li>è¿›å…¥ç®¡ç†æ§åˆ¶å°è®¾ç½®å¯†ç ï¼Œå¼€é€š</li><li>æŸ¥çœ‹é•œåƒåŠ é€Ÿå™¨è‡ªå·±çš„</li></ol><p><img src="https://s1.ax1x.com/2020/09/02/wSOj4s.png" alt="é•œåƒåŠ é€Ÿå™¨"></p><ol start="5"><li>é€‰æ‹©å¯¹åº”çš„ç‰ˆæœ¬</li><li>é…ç½®é•œåƒåŠ é€Ÿ<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">mkdir</span> -p /etc/docker<span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;-</span><span class="token string">'EOF'&#123;  "registry-mirrors": ["https://14xliptq.mirror.aliyuncs.com"]&#125;EOF</span><span class="token function">sudo</span> systemctl daemon-reload<span class="token function">sudo</span> systemctl restart docker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="docker-çš„å¸¸ç”¨å‘½ä»¤"><a href="#docker-çš„å¸¸ç”¨å‘½ä»¤" class="headerlink" title="docker çš„å¸¸ç”¨å‘½ä»¤"></a>docker çš„å¸¸ç”¨å‘½ä»¤</h3></li></ol><h4 id="å¸®åŠ©å‘½ä»¤"><a href="#å¸®åŠ©å‘½ä»¤" class="headerlink" title="å¸®åŠ©å‘½ä»¤"></a>å¸®åŠ©å‘½ä»¤</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">docker version <span class="token comment"># æ˜¾ç¤º Docker ç‰ˆæœ¬ä¿¡æ¯ã€‚</span>docker info <span class="token comment"># æ˜¾ç¤º Docker ç³»ç»Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬é•œåƒå’Œå®¹å™¨æ•°ã€‚ã€‚</span>docker --help <span class="token comment"># å¸®åŠ©</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="é•œåƒå‘½ä»¤"><a href="#é•œåƒå‘½ä»¤" class="headerlink" title="é•œåƒå‘½ä»¤"></a>é•œåƒå‘½ä»¤</h4><ul><li><strong>docker</strong> <strong>images</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># åˆ—å‡ºæœ¬åœ°ä¸»æœºä¸Šçš„é•œåƒ</span><span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># docker images</span>REPOSITORY TAG IMAGE ID CREATEDSIZEhello-world latest bf756fb1ae65 <span class="token number">4</span> months ago<span class="token number">13</span>.3kB<span class="token comment"># è§£é‡Š</span>REPOSITORY é•œåƒçš„ä»“åº“æºTAG é•œåƒçš„æ ‡ç­¾IMAGE ID é•œåƒçš„IDCREATED é•œåƒåˆ›å»ºæ—¶é—´SIZE é•œåƒå¤§å°<span class="token comment"># åŒä¸€ä¸ªä»“åº“æºå¯ä»¥æœ‰å¤šä¸ª TAGï¼Œä»£è¡¨è¿™ä¸ªä»“åº“æºçš„ä¸åŒç‰ˆæœ¬ï¼Œæˆ‘ä»¬ä½¿ç”¨REPOSITORYï¼šTAG å®šä¹‰ä¸åŒ</span>çš„é•œåƒï¼Œå¦‚æœä½ ä¸å®šä¹‰é•œåƒçš„æ ‡ç­¾ç‰ˆæœ¬ï¼Œdockerå°†é»˜è®¤ä½¿ç”¨ lastest é•œåƒï¼<span class="token comment"># å¯é€‰é¡¹</span>-aï¼š åˆ—å‡ºæœ¬åœ°æ‰€æœ‰é•œåƒ-qï¼š åªæ˜¾ç¤ºé•œåƒid--digestsï¼š æ˜¾ç¤ºé•œåƒçš„æ‘˜è¦ä¿¡æ¯<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>docker</strong> <strong>search</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># docker search mysql</span>NAME                              DESCRIPTION                                     STARS               OFFICIAL            AUTOMATEDmysql                             MySQL is a widely used, open-source relationâ€¦   <span class="token number">9918</span>                <span class="token punctuation">[</span>OK<span class="token punctuation">]</span><span class="token comment"># docker search æŸä¸ªé•œåƒçš„åç§° å¯¹åº”DockerHubä»“åº“ä¸­çš„é•œåƒ</span><span class="token comment"># å¯é€‰é¡¹</span>--filter<span class="token operator">=</span>stars<span class="token operator">=</span><span class="token number">50</span> ï¼š åˆ—å‡ºæ”¶è—æ•°ä¸å°äºæŒ‡å®šå€¼çš„é•œåƒã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>docker</strong> <strong>pull</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ä¸‹è½½é•œåƒ</span><span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker pull mysql</span>Using default tag: latest <span class="token comment"># ä¸å†™tagï¼Œé»˜è®¤æ˜¯latest</span>latest: Pulling from library/mysql54fec2fa59d0: Already exists <span class="token comment"># åˆ†å±‚ä¸‹è½½</span>bcc6c6145912: Already exists951c3d959c9d: Already exists05de4d0e206e: Already exists319f0394ef42: Already existsd9185034607b: Already exists013a9c64dadc: Already exists42f3f7d10903: Pull completec4a3851d9207: Pull complete82a1cc65c182: Pull completea0a6b01efa55: Pull completebca5ce71f9ea: Pull completeDigest:sha256:61a2a33f4b8b4bc93b7b6b9e65e64044aaec594809f818aeffbff69a893d1944 <span class="token comment">#ç­¾å</span>Status: Downloaded newer image <span class="token keyword">for</span> mysql:latestdocker.io/library/mysql:latest <span class="token comment"># çœŸå®ä½ç½®</span><span class="token comment"># æŒ‡å®šç‰ˆæœ¬ä¸‹è½½</span><span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker pull mysql:5.7</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>docker</strong> <strong>rmi</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># åˆ é™¤é•œåƒ</span>docker rmi -f é•œåƒid <span class="token comment"># åˆ é™¤å•ä¸ª</span>docker rmi -f é•œåƒå:tag é•œåƒå:tag <span class="token comment"># åˆ é™¤å¤šä¸ª</span>docker rmi -f <span class="token variable"><span class="token variable">$(</span>docker images -qa<span class="token variable">)</span></span> <span class="token comment"># åˆ é™¤å…¨éƒ¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="å®¹å™¨å‘½ä»¤"><a href="#å®¹å™¨å‘½ä»¤" class="headerlink" title="å®¹å™¨å‘½ä»¤"></a>å®¹å™¨å‘½ä»¤</h4><ul><li><strong>æ–°å»ºå®¹å™¨å¹¶å¯åŠ¨</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å‘½ä»¤</span>docker run <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> IMAGE <span class="token punctuation">[</span>COMMAND<span class="token punctuation">]</span><span class="token punctuation">[</span>ARG<span class="token punctuation">..</span>.<span class="token punctuation">]</span><span class="token comment"># å¸¸ç”¨å‚æ•°è¯´æ˜</span>--name<span class="token operator">=</span><span class="token string">"Name"</span> <span class="token comment"># ç»™å®¹å™¨æŒ‡å®šä¸€ä¸ªåå­—</span>-d <span class="token comment"># åå°æ–¹å¼è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨çš„idï¼</span>-i <span class="token comment"># ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šè¿‡å’Œ -t ä¸€èµ·ä½¿ç”¨</span>-t <span class="token comment"># ç»™å®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªç»ˆç«¯ï¼Œé€šå¸¸å’Œ -i ä¸€èµ·ä½¿ç”¨</span>-P <span class="token comment"># éšæœºç«¯å£æ˜ å°„ï¼ˆå¤§å†™ï¼‰</span>-p <span class="token comment"># æŒ‡å®šç«¯å£æ˜ å°„ï¼ˆå°ç»“ï¼‰ï¼Œä¸€èˆ¬å¯ä»¥æœ‰å››ç§å†™æ³•</span>ip:hostPort:containerPortip::containerPorthostPort:containerPort <span class="token punctuation">(</span>å¸¸ç”¨<span class="token punctuation">)</span>containerPort<span class="token comment"># æµ‹è¯•</span><span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker images</span>REPOSITORY TAG IMAGE ID CREATEDSIZEcentos latest 470671670cac <span class="token number">3</span> months ago237MB<span class="token comment"># ä½¿ç”¨centosè¿›è¡Œç”¨äº¤äº’æ¨¡å¼å¯åŠ¨å®¹å™¨ï¼Œåœ¨å®¹å™¨å†…æ‰§è¡Œ/bin/bashå‘½ä»¤ï¼</span><span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker run -it centos /bin/bash</span><span class="token punctuation">[</span>root@dc8f24dd06d0 /<span class="token punctuation">]</span><span class="token comment"># ls # æ³¨æ„åœ°å€ï¼Œå·²ç»åˆ‡æ¢åˆ°å®¹å™¨å†…éƒ¨äº†ï¼</span>bin etc lib lost+found mnt proc run srv tmp vardev home lib64 media opt root sbin sys usr<span class="token punctuation">[</span>root@dc8f24dd06d0 /<span class="token punctuation">]</span><span class="token comment"># exit # ä½¿ç”¨ exit é€€å‡ºå®¹å™¨</span><span class="token builtin class-name">exit</span><span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>åˆ—å‡ºæ‰€æœ‰è¿è¡Œçš„å®¹å™¨</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å‘½ä»¤</span>docker <span class="token function">ps</span> <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span><span class="token comment"># å¸¸ç”¨å‚æ•°è¯´æ˜</span>-a <span class="token comment"># åˆ—å‡ºå½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ + å†å²è¿è¡Œè¿‡çš„å®¹å™¨</span>-l <span class="token comment"># æ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨</span>-n<span class="token operator">=</span>? <span class="token comment"># æ˜¾ç¤ºæœ€è¿‘nä¸ªåˆ›å»ºçš„å®¹å™¨</span>-q <span class="token comment"># é™é»˜æ¨¡å¼ï¼Œåªæ˜¾ç¤ºå®¹å™¨ç¼–å·ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>é€€å‡ºå®¹å™¨</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">exit</span> <span class="token comment"># å®¹å™¨åœæ­¢é€€å‡º</span>ctrl+P+Q <span class="token comment"># å®¹å™¨ä¸åœæ­¢é€€å‡º</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li><strong>å¯åŠ¨åœæ­¢å®¹å™¨</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">docker start <span class="token punctuation">(</span>å®¹å™¨id or å®¹å™¨å<span class="token punctuation">)</span> <span class="token comment"># å¯åŠ¨å®¹å™¨</span>docker restart <span class="token punctuation">(</span>å®¹å™¨id or å®¹å™¨å<span class="token punctuation">)</span> <span class="token comment"># é‡å¯å®¹å™¨</span>docker stop <span class="token punctuation">(</span>å®¹å™¨id or å®¹å™¨å<span class="token punctuation">)</span> <span class="token comment"># åœæ­¢å®¹å™¨</span>docker <span class="token function">kill</span> <span class="token punctuation">(</span>å®¹å™¨id or å®¹å™¨å<span class="token punctuation">)</span> <span class="token comment"># å¼ºåˆ¶åœæ­¢å®¹å™¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>åˆ é™¤å®¹å™¨</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">docker <span class="token function">rm</span> å®¹å™¨id <span class="token comment"># åˆ é™¤æŒ‡å®šå®¹å™¨</span>docker <span class="token function">rm</span> -f <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -a -q<span class="token variable">)</span></span> <span class="token comment"># åˆ é™¤æ‰€æœ‰å®¹å™¨</span>docker <span class="token function">ps</span> -a -q<span class="token operator">|</span><span class="token function">xargs</span> docker <span class="token function">rm</span> <span class="token comment"># åˆ é™¤æ‰€æœ‰å®¹å™¨</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="å¸¸ç”¨å…¶ä»–å‘½ä»¤"><a href="#å¸¸ç”¨å…¶ä»–å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å…¶ä»–å‘½ä»¤"></a>å¸¸ç”¨å…¶ä»–å‘½ä»¤</h4><ul><li><strong>åå°å¯åŠ¨å®¹å™¨</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å‘½ä»¤</span>docker run -d å®¹å™¨å<span class="token comment"># ä¾‹å­</span>docker run -d centos <span class="token comment"># å¯åŠ¨centosï¼Œä½¿ç”¨åå°æ–¹å¼å¯åŠ¨</span><span class="token comment"># é—®é¢˜ï¼š ä½¿ç”¨docker ps æŸ¥çœ‹ï¼Œå‘ç°å®¹å™¨å·²ç»é€€å‡ºäº†ï¼</span><span class="token comment"># è§£é‡Šï¼šDockerå®¹å™¨åå°è¿è¡Œï¼Œå°±å¿…é¡»æœ‰ä¸€ä¸ªå‰å°è¿›ç¨‹ï¼Œå®¹å™¨è¿è¡Œçš„å‘½ä»¤å¦‚æœä¸æ˜¯é‚£äº›ä¸€ç›´æŒ‚èµ·çš„å‘½</span>ä»¤ï¼Œå°±ä¼šè‡ªåŠ¨é€€å‡ºã€‚<span class="token comment"># æ¯”å¦‚ï¼Œä½ è¿è¡Œäº†nginxæœåŠ¡ï¼Œä½†æ˜¯dockerå‰å°æ²¡æœ‰è¿è¡Œåº”ç”¨ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå®¹å™¨å¯åŠ¨åï¼Œä¼šç«‹å³è‡ª</span>æ€ï¼Œå› ä¸ºä»–è§‰å¾—æ²¡æœ‰ç¨‹åºäº†ï¼Œæ‰€ä»¥æœ€å¥½çš„æƒ…å†µæ˜¯ï¼Œå°†ä½ çš„åº”ç”¨ä½¿ç”¨å‰å°è¿›ç¨‹çš„æ–¹å¼è¿è¡Œå¯åŠ¨ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>æŸ¥çœ‹æ—¥å¿—</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å‘½ä»¤</span>docker logs -f -t --tail å®¹å™¨id<span class="token comment"># ä¾‹å­ï¼šæˆ‘ä»¬å¯åŠ¨ centosï¼Œå¹¶ç¼–å†™ä¸€æ®µè„šæœ¬æ¥æµ‹è¯•ç©ç©ï¼æœ€åæŸ¥çœ‹æ—¥å¿—</span><span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker run -d centos /bin/sh -c "while true;do echo</span>kuangshen<span class="token punctuation">;</span><span class="token function">sleep</span> <span class="token number">1</span><span class="token punctuation">;</span>done"<span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>CONTAINER ID IMAGEc8530dbbe3b4 centos<span class="token comment"># -t æ˜¾ç¤ºæ—¶é—´æˆ³</span><span class="token comment"># -f æ‰“å°æœ€æ–°çš„æ—¥å¿—</span><span class="token comment"># --tail æ•°å­— æ˜¾ç¤ºå¤šå°‘æ¡ï¼</span><span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker logs -tf --tail 10 c8530dbbe3b4</span><span class="token number">2020</span>-05-11T08:46:40.656901941Z kuangshen<span class="token number">2020</span>-05-11T08:46:41.658765018Z kuangshen<span class="token number">2020</span>-05-11T08:46:42.661015375Z kuangshen<span class="token number">2020</span>-05-11T08:46:43.662865628Z kuangshen<span class="token number">2020</span>-05-11T08:46:44.664571547Z kuangshen<span class="token number">2020</span>-05-11T08:46:45.666718583Z kuangshen<span class="token number">2020</span>-05-11T08:46:46.668556725Z kuangshen<span class="token number">2020</span>-05-11T08:46:47.670424699Z kuangshen<span class="token number">2020</span>-05-11T08:46:48.672324512Z kuangshen<span class="token number">2020</span>-05-11T08:46:49.674092766Z kuangshen<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>æŸ¥çœ‹å®¹å™¨ä¸­è¿è¡Œçš„è¿›ç¨‹ä¿¡æ¯ï¼Œæ”¯æŒ ps çš„å‚æ•°</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å‘½ä»¤</span>docker <span class="token function">top</span> å®¹å™¨id<span class="token comment"># æµ‹è¯•</span><span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker top c8530dbbe3b4</span><span class="token environment constant">UID</span> PID <span class="token environment constant">PPID</span> C STIME TTY TIME CMDroot <span class="token number">27437</span> <span class="token number">27421</span> <span class="token number">0</span> <span class="token number">16</span>:43 ? 00:00:00 /bin/sh -c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>æŸ¥çœ‹å®¹å™¨/é•œåƒçš„å…ƒæ•°æ®</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å‘½ä»¤</span>docker inspect å®¹å™¨id<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li><strong>è¿›å…¥å®¹å™¨å†…éƒ¨</strong></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å‘½ä»¤1</span>docker <span class="token builtin class-name">exec</span> -it å®¹å™¨id bashShell<span class="token punctuation">(</span>/bin/bash<span class="token punctuation">)</span><span class="token comment"># å‘½ä»¤2</span>docker attach å®¹å™¨id bashShell<span class="token punctuation">(</span>/bin/bash<span class="token punctuation">)</span><span class="token comment"># åŒºåˆ«</span><span class="token comment"># exec æ˜¯åœ¨å®¹å™¨ä¸­æ‰“å¼€æ–°çš„ç»ˆç«¯ï¼Œå¹¶ä¸”å¯ä»¥å¯åŠ¨æ–°çš„è¿›ç¨‹</span><span class="token comment"># attach ç›´æ¥è¿›å…¥å®¹å™¨å¯åŠ¨å‘½ä»¤çš„ç»ˆç«¯ï¼Œä¸ä¼šå¯åŠ¨æ–°çš„è¿›ç¨‹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/09/03/w9X2sP.png" alt="dockerå›¾è§£"></p><h3 id="å®éªŒ"><a href="#å®éªŒ" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h3><h4 id="docker-éƒ¨ç½²-tomcat"><a href="#docker-éƒ¨ç½²-tomcat" class="headerlink" title="docker éƒ¨ç½² tomcat"></a>docker éƒ¨ç½² tomcat</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å®˜æ–¹æ–‡æ¡£è§£é‡Š</span><span class="token comment"># -it ï¼šäº¤äº’æ¨¡å¼</span><span class="token comment"># --rmï¼šå®¹å™¨å¯åŠ¨æˆåŠŸå¹¶é€€å‡ºä»¥åå®¹å™¨å°±è‡ªåŠ¨ç§»é™¤ï¼Œä¸€èˆ¬åœ¨æµ‹è¯•æƒ…å†µä¸‹ä½¿ç”¨ï¼</span>docker run -it --rm tomcat:9.0<span class="token comment"># 1ã€ä¸‹è½½tomcaté•œåƒ</span>docker pull tomcat<span class="token comment"># 2ã€å¯åŠ¨</span><span class="token comment"># -d åå°å¯åŠ¨</span><span class="token comment"># -p æœ¬æœºç«¯å£:å®¹å™¨ç«¯å£</span><span class="token comment"># --name é•œåƒåç§°</span>docker run -d -p <span class="token number">8080</span>:8080 --name tomcat9 tomcat<span class="token comment"># 3ã€è¿›å…¥tomcat</span>docker <span class="token builtin class-name">exec</span> -it tomcat9 /bin/bash<span class="token comment"># 4ã€æ€è€ƒï¼šæˆ‘ä»¬ä»¥åè¦éƒ¨ç½²é¡¹ç›®ï¼Œè¿˜éœ€è¦è¿›å…¥å®¹å™¨ä¸­ï¼Œæ˜¯ä¸æ˜¯ååˆ†éº»çƒ¦ï¼Œè¦æ˜¯æœ‰ä¸€ç§æŠ€æœ¯ï¼Œå¯ä»¥å°†å®¹å™¨å†…å’Œæˆ‘ä»¬Linuxè¿›è¡Œæ˜ å°„æŒ‚è½½å°±å¥½äº†ï¼Ÿæˆ‘ä»¬åé¢ä¼šå°†æ•°æ®å·æŠ€æœ¯æ¥è¿›è¡ŒæŒ‚è½½æ“ä½œï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ ¸å¿ƒå†…å®¹ï¼Œè¿™é‡Œå¤§å®¶å…ˆå¬å¬åè¯å°±å¥½ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±ä¼šè®²åˆ°ï¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="docker-éƒ¨ç½²-Nginx"><a href="#docker-éƒ¨ç½²-Nginx" class="headerlink" title="docker éƒ¨ç½² Nginx"></a>docker éƒ¨ç½² Nginx</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 1ã€æœç´¢é•œåƒ</span><span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker search nginx</span>NAME DESCRIPTION STARS OFFICIALnginx Official build of Nginx. <span class="token number">13159</span> <span class="token punctuation">[</span>OK<span class="token punctuation">]</span><span class="token comment"># 2ã€æ‹‰å–é•œåƒ</span><span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker pull nginx</span>Using default tag: latestlatest: Pulling from library/nginx54fec2fa59d0: Pull complete4ede6f09aefe: Pull completef9dc69acb465: Pull completeDigest:sha256:86ae264c3f4acb99b2dee4d0098c40cb8c46dcf9e1148f05d3a51c4df6758c12Status: Downloaded newer image <span class="token keyword">for</span> nginx:latestdocker.io/library/nginx:latest<span class="token comment"># 3ã€å¯åŠ¨å®¹å™¨</span><span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES<span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># docker images</span>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZEnginx               latest              4bb46517cac3        <span class="token number">2</span> weeks ago         133MBcentos              latest              0d120b6ccaa8        <span class="token number">3</span> weeks ago         215MBtomcat              <span class="token number">9.0</span>                 2ae23eb477aa        <span class="token number">4</span> weeks ago         647MB<span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># docker run -d --name nginx -p 8082:80 nginx</span>1485108ac9923bbaceb0cb306265467622cf71f08a588c28013ff5c231d006ba<span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                  NAMES1485108ac992        nginx               <span class="token string">"/docker-entrypoint.â€¦"</span>   <span class="token number">5</span> seconds ago       Up <span class="token number">4</span> seconds        <span class="token number">0.0</span>.0.0:8082-<span class="token operator">></span><span class="token number">80</span>/tcp   nginx<span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># curl 182.92.159.117:8082</span><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE html<span class="token operator">></span><span class="token operator">&lt;</span>html<span class="token operator">></span><span class="token operator">&lt;</span>head<span class="token operator">></span><span class="token operator">&lt;</span>title<span class="token operator">></span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/title<span class="token operator">></span><span class="token operator">&lt;</span>style<span class="token operator">></span>    body <span class="token punctuation">&#123;</span>        width: 35em<span class="token punctuation">;</span>        margin: <span class="token number">0</span> auto<span class="token punctuation">;</span>        font-family: Tahoma, Verdana, Arial, sans-serif<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token operator">&lt;</span>/style<span class="token operator">></span><span class="token operator">&lt;</span>/head<span class="token operator">></span><span class="token operator">&lt;</span>body<span class="token operator">></span><span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">1</span>></span>Welcome to nginx<span class="token operator">!</span><span class="token operator">&lt;</span>/h<span class="token operator"><span class="token file-descriptor important">1</span>></span><span class="token operator">&lt;</span>p<span class="token operator">></span>If you see this page, the nginx web server is successfully installed andworking. Further configuration is required.<span class="token operator">&lt;</span>/p<span class="token operator">></span><span class="token operator">&lt;</span>p<span class="token operator">></span>For online documentation and support please refer to<span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">"http://nginx.org/"</span><span class="token operator">></span>nginx.org<span class="token operator">&lt;</span>/a<span class="token operator">></span>.<span class="token operator">&lt;</span>br/<span class="token operator">></span>Commercial support is available at<span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">"http://nginx.com/"</span><span class="token operator">></span>nginx.com<span class="token operator">&lt;</span>/a<span class="token operator">></span>.<span class="token operator">&lt;</span>/p<span class="token operator">></span><span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token operator">&lt;</span>em<span class="token operator">></span>Thank you <span class="token keyword">for</span> using nginx.<span class="token operator">&lt;</span>/em<span class="token operator">></span><span class="token operator">&lt;</span>/p<span class="token operator">></span><span class="token operator">&lt;</span>/body<span class="token operator">></span><span class="token operator">&lt;</span>/html<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="commit-é•œåƒ"><a href="#commit-é•œåƒ" class="headerlink" title="commit é•œåƒ"></a>commit é•œåƒ</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">docker commit æäº¤å®¹å™¨æˆä¸ºä¸€ä¸ªæ–°çš„å‰¯æœ¬<span class="token comment">#ä¸gitç±»ä¼¼</span>docker commit -m <span class="token string">"æäº¤çš„æè¿°ä¿¡æ¯"</span> -a<span class="token operator">=</span><span class="token string">"ä½œè€…"</span> å®¹å™¨id ç›®æ ‡é•œåƒå:<span class="token punctuation">[</span>tag<span class="token punctuation">]</span>é€šè¿‡commité•œåƒæ¥è¿›è¡Œç‰ˆæœ¬çš„è¿­ä»£ï¼Œä¼šç›´æ¥ç”Ÿæˆä¸€ä¸ªæ–°çš„é•œåƒ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å®¹å™¨æ•°æ®å·"><a href="#å®¹å™¨æ•°æ®å·" class="headerlink" title="å®¹å™¨æ•°æ®å·"></a>å®¹å™¨æ•°æ®å·</h2><blockquote><p><strong>é—®é¢˜</strong>ï¼šmysql å®¹å™¨åˆ é™¤çš„æ—¶å€™ä¼šæŠŠæ•°æ®ä¸€èµ·åˆ æ‰</p><p><strong>å®¹å™¨æ•°æ®å·</strong>ï¼šå®¹å™¨ä¹‹é—´å¯ä»¥è¿›è¡Œæ•°æ®å…±äº«çš„æŠ€æœ¯ï¼Œdocker å®¹å™¨ä¸­äº§ç”Ÿçš„æ•°æ®åŒæ­¥åˆ°æœ¬åœ°ï¼Œå·æŠ€æœ¯ï¼Œç›®å½•çš„æŒ‚è½½ï¼ŒæŠŠå®¹å™¨ä¸­çš„å†…å®¹æŒ‚è½½åˆ° linux ä¸­</p></blockquote><p><img src="https://s1.ax1x.com/2020/09/06/werpm4.png" alt="æ•°æ®å·æŒ‚è½½"></p><h3 id="ä½¿ç”¨æ•°æ®å·"><a href="#ä½¿ç”¨æ•°æ®å·" class="headerlink" title="ä½¿ç”¨æ•°æ®å·"></a>ä½¿ç”¨æ•°æ®å·</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">docker run -it -v ä¸»æœºç›®å½•:å®¹å™¨å†…ç›®å½•<span class="token comment"># æµ‹è¯•</span>docker run -it -v /home/ceshi:/home/ceshi centos00000000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/09/06/wegMWR.png" alt="wegMWR.png"><br><img src="https://s1.ax1x.com/2020/09/06/weglS1.png" alt="weglS1.png"></p><p><strong>äºŒè€…å®ç°äº†åŒå‘ç»‘å®š</strong></p><blockquote><p>ä»¥åä¿®æ”¹åªéœ€è¦åœ¨æœ¬åœ°ä¿®æ”¹å³å¯ï¼Œå®¹å™¨å†…ä¼šè‡ªåŠ¨åŒæ­¥</p></blockquote><p><strong>æµ‹è¯• mysql æŒ‚è½½</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å®‰è£…mysql</span>docker pull mysql:5.7<span class="token comment"># å¯åŠ¨mysql</span><span class="token comment"># -e é…ç½®ç¯å¢ƒ</span><span class="token comment"># MYSQL_ROOT_PASSOWRD=root åˆå§‹åŒ–rootç”¨æˆ·å¯†ç ä¸ºroot</span>docker run -d -p <span class="token number">8082</span>:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span>root --name mysql01 mysql:5.7<span class="token comment">#ç„¶åå°±èƒ½ç”¨navicatè®¿é—®äº†ï¼Œè¿›è¡Œä»»ä½•æ“ä½œéƒ½å¯ä»¥å¯¹linuxå’Œdockerå®¹å™¨è¿›è¡ŒåŒæ­¥</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å…·åæŒ‚è½½å’ŒåŒ¿åæŒ‚è½½"><a href="#å…·åæŒ‚è½½å’ŒåŒ¿åæŒ‚è½½" class="headerlink" title="å…·åæŒ‚è½½å’ŒåŒ¿åæŒ‚è½½"></a>å…·åæŒ‚è½½å’ŒåŒ¿åæŒ‚è½½</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># åŒ¿åæŒ‚è½½</span>-v å®¹å™¨å†…è·¯å¾„docker run -d -P --name nginx01 -v /etc/nginx nginx<span class="token comment"># åŒ¿åæŒ‚è½½çš„ç¼ºç‚¹ï¼Œå°±æ˜¯ä¸å¥½ç»´æŠ¤ï¼Œé€šå¸¸ä½¿ç”¨å‘½ä»¤ docker volumeç»´æŠ¤</span>docker volume <span class="token function">ls</span><span class="token comment"># å…·åæŒ‚è½½</span>-v å·å:/å®¹å™¨å†…è·¯å¾„docker run -d -P --name nginx02 -v nginxconfig:/etc/nginx nginx<span class="token comment"># æŸ¥çœ‹æŒ‚è½½çš„è·¯å¾„</span><span class="token punctuation">[</span>root@kuangshen ~<span class="token punctuation">]</span><span class="token comment"># docker volume inspect nginxconfig</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">"CreatedAt"</span><span class="token builtin class-name">:</span> <span class="token string">"2020-05-13T17:23:00+08:00"</span>,<span class="token string">"Driver"</span><span class="token builtin class-name">:</span> <span class="token string">"local"</span>,<span class="token string">"Labels"</span><span class="token builtin class-name">:</span> null,<span class="token string">"Mountpoint"</span><span class="token builtin class-name">:</span> <span class="token string">"/var/lib/docker/volumes/nginxconfig/_data"</span>,<span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"nginxconfig"</span>,<span class="token string">"Options"</span><span class="token builtin class-name">:</span> null,<span class="token string">"Scope"</span><span class="token builtin class-name">:</span> <span class="token string">"local"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token comment"># æ€ä¹ˆåˆ¤æ–­æŒ‚è½½çš„æ˜¯å·åè€Œä¸æ˜¯æœ¬æœºç›®å½•åï¼Ÿ</span>ä¸æ˜¯/å¼€å§‹å°±æ˜¯å·åï¼Œæ˜¯/å¼€å§‹å°±æ˜¯ç›®å½•å<span class="token comment"># æ”¹å˜æ–‡ä»¶çš„è¯»å†™æƒé™</span><span class="token comment"># ro: readonly</span><span class="token comment"># rw: readwrite</span><span class="token comment"># æŒ‡å®šå®¹å™¨å¯¹æˆ‘ä»¬æŒ‚è½½å‡ºæ¥çš„å†…å®¹çš„è¯»å†™æƒé™</span>docker run -d -P --name nginx02 -v nginxconfig:/etc/nginx:ro nginxdocker run -d -P --name nginx02 -v nginxconfig:/etc/nginx:rw nginx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="DockerFile"><a href="#DockerFile" class="headerlink" title="DockerFile"></a>DockerFile</h2><blockquote><p><strong>Dockerfile</strong>å°±æ˜¯ç”¨æ¥æ„å»º docker é•œåƒçš„æ„å»ºæ–‡ä»¶,å‘½ä»¤è„šæœ¬</p><p>é€šè¿‡è„šæœ¬å¯ä»¥ç”Ÿæˆå¯¹è±¡ï¼Œè„šæœ¬æ˜¯ä¸€ä¸ªä¸ªçš„å‘½ä»¤</p><p>æµç¨‹ï¼šå¼€å‘åº”ç”¨=&gt;DockerFile=&gt;æ‰“åŒ…ä¸ºé•œåƒ=&gt;ä¸Šä¼ åˆ°ä»“åº“ï¼ˆç§æœ‰ä»“åº“ï¼Œå…¬æœ‰ä»“åº“ï¼‰=&gt; ä¸‹è½½é•œåƒ =&gt; å¯åŠ¨è¿è¡Œ</p></blockquote><h3 id="DockerFile-æ„å»ºæµç¨‹"><a href="#DockerFile-æ„å»ºæµç¨‹" class="headerlink" title="DockerFile æ„å»ºæµç¨‹"></a>DockerFile æ„å»ºæµç¨‹</h3><p><strong>åŸºç¡€çŸ¥è¯†</strong></p><ol><li>æ¯æ¡ä¿ç•™å­—æŒ‡ä»¤éƒ½å¿…é¡»ä¸ºå¤§å†™å­—æ¯ä¸”åé¢è¦è·Ÿéšè‡³å°‘ä¸€ä¸ªå‚æ•°</li><li>æŒ‡ä»¤æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹ï¼Œé¡ºåºæ‰§è¡Œ</li><li>#è¡¨ç¤ºæ³¨é‡Š</li><li>æ¯æ¡æŒ‡ä»¤éƒ½ä¼šåˆ›å»ºä¸€æ¡æ–°çš„é•œåƒå±‚ï¼Œå¹¶å¯¹é•œåƒå±‚è¿›è¡Œæäº¤</li></ol><p><strong>æµç¨‹</strong></p><ol><li>docker ä»åŸºç¡€é•œåƒè¿è¡Œä¸€ä¸ªå®¹å™¨</li><li>æ‰§è¡Œä¸€æ¡æŒ‡ä»¤å¹¶å¯¹å®¹å™¨åšå‡ºä¿®æ”¹</li><li>æ‰§è¡Œç±»ä¼¼ docker commit çš„æ“ä½œæäº¤ä¸€ä¸ªæ–°çš„é•œåƒå±‚</li><li>Docker åŸºäºåˆšæäº¤çš„é•œåƒè¿è¡Œä¸€ä¸ªæ–°çš„å®¹å™¨</li><li>æ‰§è¡Œä¸‹ä¸€æ¡ dockerFile æŒ‡ä»¤ç›´åˆ°æ‰€æœ‰çš„éƒ½æ‰§è¡Œå®Œæˆ</li></ol><p><strong>dockerFile</strong>,<strong>é•œåƒ</strong>,<strong>å®¹å™¨</strong>:</p><ul><li>DockerFile æ˜¯è½¯ä»¶çš„åŸææ–™ (æºä»£ç )</li><li>Docker é•œåƒåˆ™æ˜¯è½¯ä»¶çš„äº¤ä»˜å“ (.apk)</li><li>Docker å®¹å™¨åˆ™æ˜¯è½¯ä»¶çš„è¿è¡ŒçŠ¶æ€ ï¼ˆå®¢æˆ·ä¸‹è½½å®‰è£…æ‰§è¡Œï¼‰</li></ul><p>DockerFile é¢å‘å¼€å‘ï¼ŒDocker é•œåƒæˆä¸ºäº¤ä»˜æ ‡å‡†ï¼ŒDocker å®¹å™¨åˆ™æ¶‰åŠéƒ¨ç½²ä¸è¿ç»´ï¼Œä¸‰è€…ç¼ºä¸€ä¸å¯ï¼</p><p><img src="https://s1.ax1x.com/2020/09/07/wuVYfx.png" alt="ä¸‰è€…å…³ç³»"></p><p><strong>DockerFile</strong>ï¼šéœ€è¦å®šä¹‰ä¸€ä¸ª DockerFile,DockerFile å®šä¹‰äº†è¿›ç¨‹éœ€è¦çš„ä¸€åˆ‡ä¸œè¥¿ã€‚DockerFile æ¶‰åŠçš„å†…å®¹åŒ…æ‹¬æ‰§è¡Œä»£ç æˆ–è€…æ˜¯æ–‡ä»¶ã€ç¯å¢ƒå˜é‡ã€ä¾èµ–åŒ…ã€è¿è¡Œæ—¶ç¯å¢ƒã€åŠ¨æ€é“¾æ¥åº“ã€æ“ä½œç³»ç»Ÿçš„å‘è¡Œç‰ˆã€æœåŠ¡è¿›<br>ç¨‹å’Œå†…æ ¸è¿›ç¨‹ï¼ˆå½“å¼•ç”¨è¿›è¡Œéœ€è¦å’Œç³»ç»ŸæœåŠ¡å’Œå†…æ ¸è¿›ç¨‹æ‰“äº¤é“ï¼Œè¿™æ—¶éœ€è¦è€ƒè™‘å¦‚ä½•è®¾è®¡ namespace çš„æƒ<br>é™æ§åˆ¶ï¼‰ç­‰ç­‰ã€‚</p><p><strong>Docker é•œåƒ</strong>ï¼šåœ¨ DockerFile å®šä¹‰äº†ä¸€ä¸ªæ–‡ä»¶ä¹‹åï¼ŒDocker build æ—¶ä¼šäº§ç”Ÿä¸€ä¸ª Docker é•œåƒï¼Œå½“è¿è¡Œ Docker é•œåƒæ—¶ï¼Œä¼šçœŸæ­£å¼€å§‹æä¾›æœåŠ¡ï¼›<br><strong>Docker å®¹å™¨</strong>ï¼šå®¹å™¨æ˜¯ç›´æ¥æä¾›æœåŠ¡çš„ã€‚</p><h3 id="DockerFile-æŒ‡ä»¤"><a href="#DockerFile-æŒ‡ä»¤" class="headerlink" title="DockerFile æŒ‡ä»¤"></a>DockerFile æŒ‡ä»¤</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FROM              <span class="token comment">#åŸºç¡€é•œåƒï¼Œå½“å‰é•œåƒåŸºäºå“ªä¸ªç¯å¢ƒ</span>MAINTAINER        <span class="token comment"># é•œåƒç»´æŠ¤è€…çš„å§“åæ··åˆé‚®ç®±åœ°å€</span>RUN               <span class="token comment"># å®¹å™¨æ„å»ºæ—¶éœ€è¦è¿è¡Œçš„å‘½ä»¤</span>EXPOSE            <span class="token comment"># å½“å‰å®¹å™¨å¯¹å¤–ä¿ç•™å‡ºçš„ç«¯å£</span>WORKDIR           <span class="token comment"># æŒ‡å®šåœ¨åˆ›å»ºå®¹å™¨åï¼Œç»ˆç«¯é»˜è®¤ç™»å½•çš„è¿›æ¥å·¥ä½œç›®å½•ï¼Œä¸€ä¸ªè½è„šç‚¹</span>ENV               <span class="token comment"># ç”¨æ¥åœ¨æ„å»ºé•œåƒè¿‡ç¨‹ä¸­è®¾ç½®ç¯å¢ƒå˜é‡</span>ADD               <span class="token comment"># å°†å®¿ä¸»æœºç›®å½•ä¸‹çš„æ–‡ä»¶æ‹·è´è¿›é•œåƒä¸”ADDå‘½ä»¤ä¼šè‡ªåŠ¨å¤„ç†URLå’Œè§£å‹tarå‹ç¼©åŒ…</span>COPY              <span class="token comment"># ç±»ä¼¼ADDï¼Œæ‹·è´æ–‡ä»¶å’Œç›®å½•åˆ°é•œåƒä¸­ï¼</span>VOLUME            <span class="token comment"># å®¹å™¨æ•°æ®å·ï¼Œç”¨äºæ•°æ®ä¿å­˜å’ŒæŒä¹…åŒ–å·¥ä½œ</span>CMD               <span class="token comment"># æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ï¼ŒdockerFileä¸­å¯ä»¥æœ‰å¤šä¸ªCMDæŒ‡ä»¤ï¼Œä½†åªæœ‰æœ€åä¸€ä¸ªç”Ÿæ•ˆï¼</span>ENTRYPOINT        <span class="token comment"># æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ï¼å’ŒCMDä¸€æ ·</span>ONBUILD           <span class="token comment"># å½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿çš„DockerFileæ—¶è¿è¡Œå‘½ä»¤ï¼Œçˆ¶é•œåƒåœ¨è¢«å­é•œåƒç»§æ‰¿åï¼Œçˆ¶é•œåƒçš„è¢«è§¦å‘</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h3><p><strong>ç¼–å†™ä¸€ä¸ª centos</strong></p><blockquote><p>å®˜æ–¹é»˜è®¤çš„ centos é•œåƒæ²¡æœ‰ vim ifconfig ç­‰åŠŸèƒ½ï¼Œæˆ‘ä»¬ç»™ä»–åŠ ä¸Š</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># åˆ›å»ºä¸€ä¸ªdockerfile-centosï¼Œåç§°å¯ä»¥éšä¾¿å–</span><span class="token comment"># ç¼–å†™ä»¥ä¸‹ä»£ç </span>FROM centosMAINTAINER zhy<span class="token operator">&lt;</span><span class="token number">869994221</span>@qq.com<span class="token operator">></span>ENV MYPATH /usr/localWORKDIR <span class="token variable">$MYPATH</span>RUN yum <span class="token function">install</span> -y <span class="token function">vim</span>RUN yum <span class="token function">install</span> -y net-toolsEXPOSE <span class="token number">80</span>CMD <span class="token builtin class-name">echo</span> <span class="token variable">$MYPATH</span>CMD <span class="token builtin class-name">echo</span> <span class="token string">"===========end=========="</span>CMD /bin/bash<span class="token comment"># ä¿å­˜å¹¶build â†“æ ¼å¼</span><span class="token comment"># docker build -f dockerfileæ–‡ä»¶å -t åç§°:ç‰ˆæœ¬ .</span><span class="token comment"># æ³¨æ„åˆ«å¿˜äº†æœ€åæœ‰ä¸ª.  . è¡¨ç¤ºå½“å‰ç›®å½•</span>docker build -f dockerfile-centos -t mycentos:1.0 <span class="token builtin class-name">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/09/07/wuu3Js.png" alt="build"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># æŸ¥çœ‹æœ¬åœ°é•œåƒä»“åº“,å‘ç°å·²ç»æ‰“åŒ…æˆåŠŸ</span><span class="token punctuation">[</span>root@iZitgsup0vfxnqZ DockerFileDir<span class="token punctuation">]</span><span class="token comment"># docker images</span>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZEmycentos            <span class="token number">1.0</span>                 a38375cb8526        <span class="token number">2</span> minutes ago       295MBcentos              latest              0d120b6ccaa8        <span class="token number">3</span> weeks ago         215MB<span class="token comment"># è¿è¡Œè‡ªå·±çš„é•œåƒ</span>docker run -it mycentos:1.0<span class="token comment"># å¯ä»¥å‘ç°å·¥ä½œç©ºé—´è¢«åˆ‡æ¢æˆäº†/usr/local</span><span class="token comment"># æµ‹è¯•vim å’ŒifconfigåŠŸèƒ½ï¼Œå‘ç°å¯ä»¥ä½¿ç”¨ï¼Œè¯æ˜æˆåŠŸ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è‡ªå®šä¹‰é•œåƒ tomcat</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Docker-ç½‘ç»œ"><a href="#Docker-ç½‘ç»œ" class="headerlink" title="Docker ç½‘ç»œ"></a>Docker ç½‘ç»œ</h2><blockquote><p>æŸ¥çœ‹æœ¬åœ° ip <code>ip addr</code></p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">lo <span class="token number">127.0</span>.0.1 <span class="token comment"># æœ¬æœºå›ç¯åœ°å€</span>eth0 <span class="token number">172.17</span>.90.138 <span class="token comment"># é˜¿é‡Œäº‘çš„ç§æœ‰IP</span>docker0 <span class="token number">172.18</span>.0.1 <span class="token comment"># dockerç½‘æ¡¥</span><span class="token comment"># é—®é¢˜ï¼šDocker æ˜¯å¦‚ä½•å¤„ç†å®¹å™¨ç½‘ç»œè®¿é—®çš„ï¼Ÿ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>åŸç†</p></blockquote><ol><li>æ¯ä¸€ä¸ªå®‰è£…äº† Docker çš„ linux ä¸»æœºéƒ½æœ‰ä¸€ä¸ª docker0 çš„è™šæ‹Ÿç½‘å¡ã€‚è¿™æ˜¯ä¸ªæ¡¥æ¥ç½‘å¡ï¼Œä½¿ç”¨äº†<code>veth-pair</code>æŠ€æœ¯ï¼</li><li>æ¯å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œlinux ä¸»æœºå°±ä¼šå¤šäº†ä¸€ä¸ªè™šæ‹Ÿç½‘å¡ã€‚</li></ol><blockquote><p>ç»“è®ºï¼šé•œåƒ å’Œ é•œåƒä¹‹é—´å…±ç”¨ä¸€ä¸ªè·¯ç”±å™¨ã€‚å°±æ˜¯ docker0ã€‚ä»»ä½•ä¸€ä¸ªå®¹å™¨å¯åŠ¨é»˜è®¤éƒ½æ˜¯ docker0 ç½‘ç»œã€‚docker é»˜è®¤ä¼šç»™å®¹å™¨åˆ†é…ä¸€ä¸ªå¯ç”¨ ipã€‚</p></blockquote><p><img src="https://s1.ax1x.com/2020/09/08/wQF09x.png" alt="åŸç†ç¤ºæ„å›¾"></p><blockquote><p>å°ç»“</p></blockquote><p>Docker ä½¿ç”¨ Linux æ¡¥æ¥ï¼Œåœ¨å®¿ä¸»æœºè™šæ‹Ÿä¸€ä¸ª Docker å®¹å™¨ç½‘æ¡¥(docker0)ï¼ŒDocker å¯åŠ¨ä¸€ä¸ªå®¹å™¨æ—¶ä¼šæ ¹æ® Docker ç½‘æ¡¥çš„ç½‘æ®µåˆ†é…ç»™å®¹å™¨ä¸€ä¸ª IP åœ°å€ï¼Œç§°ä¸º Container-IPï¼ŒåŒæ—¶ Docker ç½‘æ¡¥æ˜¯æ¯ä¸ªå®¹å™¨çš„é»˜è®¤ç½‘å…³ã€‚å› ä¸ºåœ¨åŒä¸€å®¿ä¸»æœºå†…çš„å®¹å™¨éƒ½æ¥å…¥åŒä¸€ä¸ªç½‘æ¡¥ï¼Œè¿™æ ·å®¹å™¨ä¹‹é—´å°±èƒ½å¤Ÿé€šè¿‡å®¹å™¨çš„ Container-IP ç›´æ¥é€šä¿¡ã€‚</p><p><img src="https://s1.ax1x.com/2020/09/08/wQFTKS.png"><br>Docker å®¹å™¨ç½‘ç»œå°±å¾ˆå¥½çš„åˆ©ç”¨äº† Linux è™šæ‹Ÿç½‘ç»œæŠ€æœ¯ï¼Œåœ¨æœ¬åœ°ä¸»æœºå’Œå®¹å™¨å†…åˆ†åˆ«åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæ¥å£ï¼Œå¹¶<br>è®©ä»–ä»¬å½¼æ­¤è”é€šï¼ˆè¿™æ ·ä¸€å¯¹æ¥å£å« veth pairï¼‰ï¼›</p><p>Docker ä¸­çš„ç½‘ç»œæ¥å£é»˜è®¤éƒ½æ˜¯è™šæ‹Ÿçš„æ¥å£ã€‚è™šæ‹Ÿæ¥å£çš„ä¼˜åŠ¿å°±æ˜¯è½¬å‘æ•ˆç‡æé«˜ï¼ˆå› ä¸º Linux æ˜¯åœ¨å†…æ ¸ä¸­<br>è¿›è¡Œæ•°æ®çš„å¤åˆ¶æ¥å®ç°è™šæ‹Ÿæ¥å£ä¹‹é—´çš„æ•°æ®è½¬å‘ï¼Œæ— éœ€é€šè¿‡å¤–éƒ¨çš„ç½‘ç»œè®¾å¤‡äº¤æ¢ï¼‰ï¼Œå¯¹äºæœ¬åœ°ç³»ç»Ÿå’Œå®¹<br>å™¨ç³»ç»Ÿæ¥è¯´ï¼Œè™šæ‹Ÿæ¥å£è·Ÿä¸€ä¸ªæ­£å¸¸çš„ä»¥å¤ªç½‘å¡ç›¸æ¯”å¹¶æ²¡æœ‰åŒºåˆ«ï¼Œåªæ˜¯ä»–çš„é€Ÿåº¦å¿«å¾ˆå¤šã€‚</p><h3 id="è‡ªå®šä¹‰ç½‘ç»œ"><a href="#è‡ªå®šä¹‰ç½‘ç»œ" class="headerlink" title="è‡ªå®šä¹‰ç½‘ç»œ"></a>è‡ªå®šä¹‰ç½‘ç»œ</h3><blockquote><p>å®˜æ–¹çš„ docker0 æœ‰å¾ˆå¤§çš„å±€é™æ€§: <strong>ä¸æ”¯æŒå®¹å™¨åè¿æ¥è®¿é—®</strong></p><p><strong>â€“link</strong> çš„æ–¹å¼åŸç†å…¶å®æ˜¯<strong>åœ¨ host ä¸­é…ç½®äº†å¦ä¸€æ–¹å®¹å™¨çš„ ip</strong>ï¼Œæ–¹æ³•å¤ªè¿‡äºç¬¨é‡ä¹Ÿä¸æ¨è</p><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<strong>è‡ªå®šä¹‰ç½‘ç»œ:</strong><br>docker network â€“help æŸ¥çœ‹ç›¸å…³çš„å‘½ä»¤</p></blockquote><p>æ‰€æœ‰çš„ç½‘ç»œæ¨¡å¼</p><table><thead><tr><th align="center">ç½‘ç»œæ¨¡å¼</th><th align="center">é…ç½®</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">bridge æ¨¡å¼</td><td align="center">â€“net=bridge</td><td align="center">é»˜è®¤å€¼ï¼Œåœ¨ Docker ç½‘æ¡¥ docker0 ä¸Šä¸ºå®¹å™¨åˆ›å»ºæ–°çš„ç½‘ç»œæ ˆ</td></tr><tr><td align="center">none æ¨¡å¼</td><td align="center">â€“net=none</td><td align="center">ä¸é…ç½®ç½‘ç»œï¼Œç”¨æˆ·å¯ä»¥ç¨åè¿›å…¥å®¹å™¨ï¼Œè‡ªè¡Œé…ç½®</td></tr><tr><td align="center">container æ¨¡å¼</td><td align="center">â€“net=container:name/id</td><td align="center">å®¹å™¨å’Œå¦å¤–ä¸€ä¸ªå®¹å™¨å…±äº« Network namespaceã€‚kubernetes ä¸­çš„ pod å°±æ˜¯å¤šä¸ªå®¹å™¨å…±äº«ä¸€ä¸ª Network namespaceã€‚</td></tr><tr><td align="center">host æ¨¡å¼</td><td align="center">â€“net=host</td><td align="center">å®¹å™¨å’Œå®¿ä¸»æœºå…±äº« Network namespace</td></tr><tr><td align="center">ç”¨æˆ·è‡ªå®šä¹‰</td><td align="center">â€“net=è‡ªå®šä¹‰ç½‘ç»œ</td><td align="center">ç”¨æˆ·è‡ªå·±ä½¿ç”¨ network ç›¸å…³å‘½ä»¤å®šä¹‰ç½‘ç»œï¼Œåˆ›å»ºå®¹å™¨çš„æ—¶å€™å¯ä»¥æŒ‡å®šä¸ºè‡ªå·±å®šä¹‰çš„ç½‘ç»œ</td></tr></tbody></table><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># è¿™é‡Œçš„ --net bridge æ˜¯é»˜è®¤å‚æ•°ï¼Œæˆ‘ä»¬ä¸å†™ä¹Ÿå­˜åœ¨</span>docker run -d -P --name tomcat01  --net bridge tomcat<span class="token comment"># docker0çš„ç‰¹ç‚¹ï¼šé»˜è®¤ï¼ŒåŸŸåä¸èƒ½è®¿é—®ï¼Œ--linkå¯ä»¥æ‰“é€š</span><span class="token comment"># è‡ªå®šä¹‰ç½‘ç»œ</span><span class="token comment"># --driver æ§åˆ¶ç½‘ç»œæ¨¡å¼</span><span class="token comment"># --subnet 192.168.0.0/16å­ç½‘åœ°å€  èŒƒå›´æ˜¯:192.168.0.2  ~ 192.168.255.254</span><span class="token comment"># --gateway 192.168.0.1ç½‘å…³</span><span class="token comment">#</span><span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet</span>0eb3d858e34963ff9442b4e3290e7954e6c6233bed364af57820472b8e02b295<span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># docker network ls</span>NETWORK ID          NAME                DRIVER              SCOPE6c820a2a1f08        bridge              bridge              <span class="token builtin class-name">local</span>ebc0fc48ebb0        <span class="token function">host</span>                <span class="token function">host</span>                <span class="token builtin class-name">local</span>0eb3d858e349        mynet               bridge              <span class="token builtin class-name">local</span>d872bbcd6c68        none                null                <span class="token builtin class-name">local</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/09/08/wQT3Kf.png" alt="è‡ªå®šä¹‰ç½‘ç»œ"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#è®¾ç½®ç½‘ç»œæ¨¡å¼ä¸ºmynetå¯åŠ¨ä¸€ä¸ªtomcat</span><span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># docker run -d -P --name tomcat01 --net mynet tomcat</span>150349e401d9436d8828218d53d9005c02ad2b5909cf2ab892b3bc03b03a4872<span class="token comment">#è®¾ç½®ç½‘ç»œæ¨¡å¼ä¸ºmynetå†æ¬¡å¯åŠ¨ä¸€ä¸ªtomcat</span><span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># docker run -d -P --name tomcat02 --net mynet tomcat</span>ad65e04a7131dc40f430e53bdc6de96d1319f4ef177346b7701b64b7f864023a<span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat01 ip addr</span><span class="token number">1</span>: lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">></span> mtu <span class="token number">65536</span> qdisc noqueue state UNKNOWN group default qlen <span class="token number">1000</span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00    inet <span class="token number">127.0</span>.0.1/8 scope <span class="token function">host</span> lo       valid_lft forever preferred_lft forever<span class="token number">35</span>: eth0@if36: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc noqueue state UP group default    link/ether 02:42:c0:a8:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid <span class="token number">0</span>    inet <span class="token number">192.168</span>.0.2/16 brd <span class="token number">192.168</span>.255.255 scope global eth0 <span class="token comment"># ipè¢«åˆ†é…åˆ°äº†æ–°åˆ›å»ºçš„å­ç½‘ä¸­</span>       valid_lft forever preferred_lft forever<span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat02 ip addr</span><span class="token number">1</span>: lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">></span> mtu <span class="token number">65536</span> qdisc noqueue state UNKNOWN group default qlen <span class="token number">1000</span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00    inet <span class="token number">127.0</span>.0.1/8 scope <span class="token function">host</span> lo       valid_lft forever preferred_lft forever<span class="token number">37</span>: eth0@if38: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">></span> mtu <span class="token number">1500</span> qdisc noqueue state UP group default    link/ether 02:42:c0:a8:00:03 brd ff:ff:ff:ff:ff:ff link-netnsid <span class="token number">0</span>    inet <span class="token number">192.168</span>.0.3/16 brd <span class="token number">192.168</span>.255.255 scope global eth0 <span class="token comment"># ipè¢«åˆ†é…åˆ°äº†æ–°åˆ›å»ºçš„å­ç½‘ä¸­</span>       valid_lft forever preferred_lft forever<span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it tomcat02 ping tomcat01  # äºŒè€…ç›¸äº’å¯ä»¥é€šè¿‡åç§°pingé€š</span>PING tomcat01 <span class="token punctuation">(</span><span class="token number">192.168</span>.0.2<span class="token punctuation">)</span> <span class="token number">56</span><span class="token punctuation">(</span><span class="token number">84</span><span class="token punctuation">)</span> bytes of data.<span class="token number">64</span> bytes from tomcat01.mynet <span class="token punctuation">(</span><span class="token number">192.168</span>.0.2<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.113</span> ms<span class="token number">64</span> bytes from tomcat01.mynet <span class="token punctuation">(</span><span class="token number">192.168</span>.0.2<span class="token punctuation">)</span>: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.087</span> ms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä¼˜ç¼ºç‚¹</strong></p><blockquote><p>ä¸åŒçš„é›†ç¾¤ä½¿ç”¨ä¸åŒçš„ç½‘ç»œï¼Œä¿è¯é›†ç¾¤æ˜¯å®‰å…¨çš„</p></blockquote><blockquote><p>å¦‚æœ redis æ˜¯ä¸€ä¸ªé›†ç¾¤ï¼Œmysql æ˜¯ä¸€ä¸ªé›†ç¾¤ï¼Œé‚£ä¹ˆä¸¤ä¸ªé›†ç¾¤ä¹‹é—´æ˜¯æœ‰å£éšœçš„ï¼ˆç½‘æ®µä¸åŒï¼‰ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±è¦å–è§£å†³ç½‘ç»œè¿é€šçš„é—®é¢˜</p></blockquote><p><img src="https://s1.ax1x.com/2020/09/08/wQHQnf.png" alt="ç½‘å…³ä¸åŒ"></p><h3 id="ç½‘ç»œè¿é€š"><a href="#ç½‘ç»œè¿é€š" class="headerlink" title="ç½‘ç»œè¿é€š"></a>ç½‘ç»œè¿é€š</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># docker0 ä¸‹æœ‰ä¸€ä¸ªdocker_tomcat01</span><span class="token comment"># mynet ä¸‹æœ‰ä¸¤ä¸ª tomcat01å’Œtomcat02</span><span class="token comment"># æµ‹è¯•æ‰“é€šdocker_tomcat01å’Œmynet</span>docker network connect mynet docker_tomcat01<span class="token comment"># æŸ¥çœ‹mynetçš„è¯¦ç»†ä¿¡æ¯</span><span class="token punctuation">[</span>root@iZitgsup0vfxnqZ ~<span class="token punctuation">]</span><span class="token comment"># docker network inspect mynet</span><span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span>        <span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"mynet"</span>,        <span class="token string">"Id"</span><span class="token builtin class-name">:</span> <span class="token string">"0eb3d858e34963ff9442b4e3290e7954e6c6233bed364af57820472b8e02b295"</span>,        <span class="token string">"Created"</span><span class="token builtin class-name">:</span> <span class="token string">"2020-09-08T18:07:28.409882695+08:00"</span>,        <span class="token string">"Scope"</span><span class="token builtin class-name">:</span> <span class="token string">"local"</span>,        <span class="token string">"Driver"</span><span class="token builtin class-name">:</span> <span class="token string">"bridge"</span>,        <span class="token string">"EnableIPv6"</span><span class="token builtin class-name">:</span> false,        <span class="token string">"IPAM"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>            <span class="token string">"Driver"</span><span class="token builtin class-name">:</span> <span class="token string">"default"</span>,            <span class="token string">"Options"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>,            <span class="token string">"Config"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>                <span class="token punctuation">&#123;</span>                    <span class="token string">"Subnet"</span><span class="token builtin class-name">:</span> <span class="token string">"192.168.0.0/16"</span>,                    <span class="token string">"Gateway"</span><span class="token builtin class-name">:</span> <span class="token string">"192.168.0.1"</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>,        <span class="token string">"Internal"</span><span class="token builtin class-name">:</span> false,        <span class="token string">"Attachable"</span><span class="token builtin class-name">:</span> false,        <span class="token string">"Ingress"</span><span class="token builtin class-name">:</span> false,        <span class="token string">"ConfigFrom"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>            <span class="token string">"Network"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>        <span class="token punctuation">&#125;</span>,        <span class="token string">"ConfigOnly"</span><span class="token builtin class-name">:</span> false,        <span class="token string">"Containers"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>            <span class="token string">"150349e401d9436d8828218d53d9005c02ad2b5909cf2ab892b3bc03b03a4872"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                <span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"tomcat01"</span>,                <span class="token string">"EndpointID"</span><span class="token builtin class-name">:</span> <span class="token string">"d1c9dd70443e27017e413a5be8babebc91cff460754e5e39e6a0b5a637f57ce1"</span>,                <span class="token string">"MacAddress"</span><span class="token builtin class-name">:</span> <span class="token string">"02:42:c0:a8:00:02"</span>,                <span class="token string">"IPv4Address"</span><span class="token builtin class-name">:</span> <span class="token string">"192.168.0.2/16"</span>,                <span class="token string">"IPv6Address"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>            <span class="token punctuation">&#125;</span>,            <span class="token comment">###### docker_tomcat01è¢«åŠ å…¥åˆ°äº†å®¹å™¨ä¸­ï¼Œå¯ä»¥è¿›è¡Œç½‘ç»œé€šä¿¡äº†</span>            <span class="token string">"44eeb6cf00bafc1a8838d631531ebb543470286605ebf3bed1f858b98e1b9a3b"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                <span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"docker_tomcat01"</span>,                <span class="token string">"EndpointID"</span><span class="token builtin class-name">:</span> <span class="token string">"4fc2a9afad58cc9fdd015e1b1483adba92f3a34a4a1f94514fb1a5bddc9448b2"</span>,                <span class="token string">"MacAddress"</span><span class="token builtin class-name">:</span> <span class="token string">"02:42:c0:a8:00:04"</span>,                <span class="token string">"IPv4Address"</span><span class="token builtin class-name">:</span> <span class="token string">"192.168.0.4/16"</span>,                <span class="token string">"IPv6Address"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>            <span class="token punctuation">&#125;</span>,            <span class="token string">"ad65e04a7131dc40f430e53bdc6de96d1319f4ef177346b7701b64b7f864023a"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>                <span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"tomcat02"</span>,                <span class="token string">"EndpointID"</span><span class="token builtin class-name">:</span> <span class="token string">"61621c213e50cc4746837acff797abc4b25886c93eab18bd5c27a2f985a4820f"</span>,                <span class="token string">"MacAddress"</span><span class="token builtin class-name">:</span> <span class="token string">"02:42:c0:a8:00:03"</span>,                <span class="token string">"IPv4Address"</span><span class="token builtin class-name">:</span> <span class="token string">"192.168.0.3/16"</span>,                <span class="token string">"IPv6Address"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>,        <span class="token string">"Options"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>,        <span class="token string">"Labels"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token comment">## ä¸€ä¸ªå®¹å™¨ï¼Œä¸¤ä¸ªipåœ°å€</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¾®æœåŠ¡ </tag>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dubboé‡åˆ°çš„é—®é¢˜</title>
      <link href="2020/08/10/dubbo-yu-dao-de-wen-ti/"/>
      <url>2020/08/10/dubbo-yu-dao-de-wen-ti/</url>
      
        <content type="html"><![CDATA[<p>é—®é¢˜äº§ç”Ÿç¯å¢ƒï¼š  </p><ul><li>dubbo 2.7.6</li><li>springboot 2.2.6</li></ul><p><strong>é—®é¢˜</strong>ï¼š</p><blockquote><p>å¯ç”¨dubboå, æ²¡æœ‰é…ç½®dubbo.application.name,å¯åŠ¨åº”ç”¨å°†ä¼šæŠ›å‡ºå¼‚å¸¸.</p></blockquote><pre class="line-numbers language-log" data-language="log"><code class="language-log">java.lang.IllegalStateException: Invalid name&#x3D;&quot;org.apache.dubbo.config.ApplicationConfig#0&quot; contains illegal character, only digit, letter, &#39;-&#39;, &#39;_&#39; or &#39;.&#39; is legal.at org.apache.dubbo.config.utils.ConfigValidationUtils.checkProperty(ConfigValidationUtils.java:588) ~[dubbo-2.7.6.jar:2.7.6]at org.apache.dubbo.config.utils.ConfigValidationUtils.checkName(ConfigValidationUtils.java:546) ~[dubbo-2.7.6.jar:2.7.6]at org.apache.dubbo.config.utils.ConfigValidationUtils.validateApplicationConfig(ConfigValidationUtils.java:386) ~[dubbo-2.7.6.jar:2.7.6]at org.apache.dubbo.config.bootstrap.DubboBootstrap.checkGlobalConfigs(DubboBootstrap.java:526) ~[dubbo-2.7.6.jar:2.7.6]at org.apache.dubbo.config.bootstrap.DubboBootstrap.initialize(DubboBootstrap.java:513) ~[dubbo-2.7.6.jar:2.7.6]at org.apache.dubbo.config.bootstrap.DubboBootstrap.start(DubboBootstrap.java:740) ~[dubbo-2.7.6.jar:2.7.6]at org.apache.dubbo.config.spring.context.DubboBootstrapApplicationListener.onContextRefreshedEvent(DubboBootstrapApplicationListener.java:59) ~[dubbo-2.7.6.jar:2.7.6]at org.apache.dubbo.config.spring.context.DubboBootstrapApplicationListener.onApplicationContextEvent(DubboBootstrapApplicationListener.java:52) ~[dubbo-2.7.6.jar:2.7.6]at org.apache.dubbo.config.spring.context.OneTimeExecutionApplicationContextEventListener.onApplicationEvent(OneTimeExecutionApplicationContextEventListener.java:40) ~[dubbo-2.7.6.jar:2.7.6]at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:172) ~[spring-context-5.2.5.RELEASE.jar:5.2.5.RELEASE]at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:165) ~[spring-context-5.2.5.RELEASE.jar:5.2.5.RELEASE]at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:139) ~[spring-context-5.2.5.RELEASE.jar:5.2.5.RELEASE]at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:403) ~[spring-context-5.2.5.RELEASE.jar:5.2.5.RELEASE]at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:360) ~[spring-context-5.2.5.RELEASE.jar:5.2.5.RELEASE]at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:897) ~[spring-context-5.2.5.RELEASE.jar:5.2.5.RELEASE]at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:553) ~[spring-context-5.2.5.RELEASE.jar:5.2.5.RELEASE]at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:747) [spring-boot-2.2.6.RELEASE.jar:2.2.6.RELEASE]at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397) [spring-boot-2.2.6.RELEASE.jar:2.2.6.RELEASE]at org.springframework.boot.SpringApplication.run(SpringApplication.java:315) [spring-boot-2.2.6.RELEASE.jar:2.2.6.RELEASE]at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226) [spring-boot-2.2.6.RELEASE.jar:2.2.6.RELEASE]at org.springframework.boot.SpringApplication.run(SpringApplication.java:1215) [spring-boot-2.2.6.RELEASE.jar:2.2.6.RELEASE]at com.bjsxt.provider.ProviderApplication.main(ProviderApplication.java:17) [classes&#x2F;:na]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è§£å†³æ–¹æ³•</strong>ï¼š</p><blockquote><p>é…ç½®dubboçš„æ—¶å€™æ²¡æœ‰é…ç½®dubbo.application.nameï¼Œé…ç½®ä¸Šå³å¯</p></blockquote><p><img src="https://s1.ax1x.com/2020/08/10/aHGKiR.png" alt="é…ç½®æ–‡ä»¶"></p><blockquote><p>ä¹Ÿæœ‰äººè¯´å¯ä»¥ç»™protocolé…ç½®ä¸Šä¸€ä¸ªidï¼Œå¦‚æœæ²¡æœ‰idçš„è¯ä¼šè‡ªåŠ¨ç”¨springçš„ï¼Œå°±ä¼šå‡ºç°#0çš„æƒ…å†µï¼Œä½†æˆ‘è¯•äº†ä¸è¡Œ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> dubbo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dubbo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ€§è¡¨_æ¨¡æ‹ŸArrayListçš„å®ç°</title>
      <link href="2020/08/08/xian-xing-biao-mo-ni-arraylist-de-shi-xian/"/>
      <url>2020/08/08/xian-xing-biao-mo-ni-arraylist-de-shi-xian/</url>
      
        <content type="html"><![CDATA[<h1 id="çº¿æ€§è¡¨"><a href="#çº¿æ€§è¡¨" class="headerlink" title="çº¿æ€§è¡¨"></a>çº¿æ€§è¡¨</h1><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><p>çº¿æ€§è¡¨å±äºæœ€åŸºæœ¬ã€æœ€ç®€å•ã€ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œä»é€»è¾‘ä¸Šåˆ’åˆ†å®ƒå±äºçº¿æ€§ç»“æ„ã€‚ä¸€ä¸ªçº¿æ€§è¡¨æ˜¯ç”± n ä¸ªå…·æœ‰ç›¸åŒç‰¹æ€§çš„æ•°æ®å…ƒç´ ç»„æˆçš„æœ‰é™åºåˆ—ï¼Œæ•°æ®å…ƒç´ ä¹‹é—´å…·æœ‰ä¸€ç§çº¿æ€§çš„æˆ–â€œä¸€å¯¹ä¸€â€çš„é€»è¾‘å…³ç³»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://s1.ax1x.com/2020/08/08/aINGkR.png" alt="çº¿æ€§è¡¨"></p><p>ä»ä¸¥è°¨çš„è§’åº¦ä¸Šæ¥è®²ï¼Œçº¿æ€§è¡¨åº”è¯¥æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªè¦æ±‚ï¼š</p><ol><li>ç¬¬ä¸€ä¸ªæ•°æ®å…ƒç´ æ²¡æœ‰ç›´æ¥å‰é©±ï¼Œè¿™ä¸ªæ•°æ®å…ƒç´ è¢«ç§°ä¸ºå¼€å§‹èŠ‚ç‚¹ï¼›</li><li>æœ€åä¸€ä¸ªæ•°æ®å…ƒç´ æ²¡æœ‰ç›´æ¥åç»§ï¼Œè¿™ä¸ªæ•°æ®å…ƒç´ è¢«ç§°ä¸ºç»ˆç«¯èŠ‚ç‚¹ï¼›</li><li>é™¤äº†ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªæ•°æ®å…ƒç´ å¤–ï¼Œå…¶å®ƒæ•°æ®å…ƒç´ æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªç›´æ¥å‰é©±å’Œä¸€ä¸ªç›´æ¥åç»§ã€‚</li></ol><h2 id="çº¿æ€§è¡¨çš„ç‰¹ç‚¹"><a href="#çº¿æ€§è¡¨çš„ç‰¹ç‚¹" class="headerlink" title="çº¿æ€§è¡¨çš„ç‰¹ç‚¹"></a>çº¿æ€§è¡¨çš„ç‰¹ç‚¹</h2><ol><li><strong>é¡ºåºæ€§</strong><br>åœ¨çº¿æ€§è¡¨ä¸­ï¼Œç›¸é‚»æ•°æ®å…ƒç´ ä¹‹é—´å­˜åœ¨ç€åºå¶å…³ç³»ï¼Œä¹Ÿå°±æ˜¯å­˜åœ¨ç€å…ˆåå…³ç³»ã€‚</li><li><strong>ç›¸åŒæ•°æ®ç±»å‹</strong><br>åœ¨çº¿æ€§è¡¨ä¸­ï¼Œæ¯ä¸€ä¸ªæ•°æ®å…ƒç´ éƒ½å±äºç›¸åŒæ•°æ®ç±»å‹ã€‚ç›¸åŒæ•°æ®ç±»å‹æ„å‘³ç€åœ¨å†…å­˜ä¸­å­˜å‚¨æ—¶ï¼Œæ¯<br>ä¸ªå…ƒç´ ä¼šå ç”¨ç›¸åŒçš„å†…å­˜ç©ºé—´ï¼Œä¾¿äºåç»­çš„æŸ¥è¯¢å®šä½ã€‚</li><li><strong>æœ‰é™æ€§</strong><br>åœ¨çº¿æ€§è¡¨ä¸­ï¼Œæ•°æ®å…ƒç´ çš„ä¸ªæ•° n å°±æ˜¯ä¸ºçº¿æ€§è¡¨çš„é•¿åº¦ï¼Œn æ˜¯ä¸€ä¸ªæœ‰é™å€¼ã€‚å½“ n=0 æ—¶çº¿æ€§è¡¨ä¸ºç©º<br>è¡¨ã€‚åœ¨éç©ºçš„çº¿æ€§è¡¨ä¸­æ¯ä¸ªæ•°æ®å…ƒç´ åœ¨çº¿æ€§è¡¨ä¸­éƒ½æœ‰å”¯ä¸€ç¡®å®šçš„åºå·ï¼Œä¾‹å¦‚ç¬¬ä¸€ä¸ªå…ƒç´ çš„åºå·æ˜¯ 0ï¼Œ<br>ç¬¬ i ä¸ªå…ƒç´ çš„åºå·ä¸º i-1ã€‚åœ¨ä¸€ä¸ªå…·æœ‰ n &gt; 0 ä¸ªæ•°æ®å…ƒç´ çš„çº¿æ€§è¡¨ä¸­ï¼Œæ•°æ®å…ƒç´ åºå·çš„èŒƒå›´æ˜¯[0, n-1]ã€‚</li></ol><h2 id="çº¿æ€§è¡¨çš„å­˜å‚¨ç»“æ„"><a href="#çº¿æ€§è¡¨çš„å­˜å‚¨ç»“æ„" class="headerlink" title="çº¿æ€§è¡¨çš„å­˜å‚¨ç»“æ„"></a>çº¿æ€§è¡¨çš„å­˜å‚¨ç»“æ„</h2><ol><li><p>é¡ºåºå­˜å‚¨ç»“æ„ (<strong>é¡ºåºè¡¨</strong>)</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">é¡ºåºè¡¨æ˜¯é‡‡ç”¨ä¸€ç»„åœ°å€è¿ç»­çš„å­˜å‚¨å•å…ƒæ¥ä¾æ¬¡å­˜æ”¾çº¿æ€§è¡¨ä¸­çš„å„ä¸ªå…ƒç´ ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/08/08/aIUP9x.png" alt="é¡ºåºè¡¨"></p></li><li><p>é“¾å¼å­˜å‚¨ç»“æ„ (<strong>é“¾è¡¨</strong>)</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">é“¾è¡¨ä¸­çš„å­˜å‚¨å…ƒç´ çš„åœ°å€ä¸ä¸€å®šæ˜¯è¿ç»­çš„ï¼Œå…ƒç´ èŠ‚ç‚¹ä¸­å­˜æ”¾æ•°æ®å…ƒç´ ä»¥åŠç›¸é‚»å…ƒç´ çš„åœ°å€ä¿¡æ¯<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/08/08/aIUEuD.png" alt="é“¾è¡¨"></p></li></ol><h1 id="é¡ºåºè¡¨"><a href="#é¡ºåºè¡¨" class="headerlink" title="é¡ºåºè¡¨"></a>é¡ºåºè¡¨</h1><h2 id="é¡ºåºè¡¨çš„ç‰¹ç‚¹"><a href="#é¡ºåºè¡¨çš„ç‰¹ç‚¹" class="headerlink" title="é¡ºåºè¡¨çš„ç‰¹ç‚¹"></a>é¡ºåºè¡¨çš„ç‰¹ç‚¹</h2><ul><li><p><strong>é¡ºåºè¡¨æ ¹æ®ç´¢å¼•æŸ¥è¯¢å…ƒç´ çš„ç‰¹ç‚¹</strong><br>å› ä¸ºé¡ºåºè¡¨ï¼ˆæ­¤å¤„ï¼Œä¹Ÿå°±æ˜¯æ•°ç»„ï¼‰çš„å†…å­˜ç©ºé—´æ˜¯è¿ç»­çš„ï¼Œå¹¶ä¸”å­˜å‚¨çš„æ•°æ®å±äºç›¸åŒæ•°æ®ç±»å‹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ•°ç»„çš„â€œé¦–åœ°å€+ç´¢å¼•â€å°±èƒ½å¿«é€Ÿçš„æ‰¾åˆ°æ•°ç»„ä¸­å¯¹åº”ç´¢å¼•çš„å…ƒç´ å€¼ï¼Œä»è€Œå¾—å‡ºæ•°ç»„çš„ä¼˜ç‚¹ï¼šæŸ¥æ‰¾å¿«ã€‚<br><img src="https://s1.ax1x.com/2020/08/08/aIUvxf.png" alt="é¡ºåºè¡¨"></p></li><li><p><strong>é¡ºåºè¡¨åˆ é™¤å…ƒç´ çš„ç‰¹ç‚¹</strong></p><ul><li>å¦‚æœåˆ é™¤çš„æ˜¯æœ€åä¸€ä½ï¼Œç›´æ¥è®¾ç½®æˆé»˜è®¤å€¼</li><li>å¦‚æœåˆ é™¤çš„æ˜¯ä¸­é—´çš„æŸä¸€ä½ï¼Œä»è¿™ä¸€ä½å¼€å§‹å¾€åçš„æ‰€æœ‰å…ƒç´ å¾€å‰æŒªä¸€ä½ï¼Œæœ€åä¸€ä½è®¾ç½®ä¸ºé»˜è®¤å€¼<br><img src="https://img-blog.csdnimg.cn/20190919192451529.gif" alt="é¡ºåºè¡¨åˆ é™¤"></li></ul></li><li><p><strong>é¡ºåºè¡¨æ’å…¥å…ƒç´ çš„ç‰¹ç‚¹</strong></p><ul><li>å…ˆæ£€æŸ¥æ•°ç»„æ˜¯å¦éœ€è¦æ‰©å®¹ã€‚å¦‚æœæ•°ç»„çš„ç©ºé—´é•¿åº¦å’Œæ•°ç»„æ·»åŠ å…ƒç´ ä¸ªæ•°ç›¸ç­‰ï¼Œåˆ™éœ€åš<strong>æ‰©å®¹æ“ä½œ</strong><ul><li>å®šä¹‰ä¸€ä¸ªç©ºé—´é•¿åº¦æ›´å¤§çš„æ–°æ•°ç»„</li><li>æŠŠåŸæ•°ç»„ä¸­çš„å…ƒç´ å…¨éƒ¨æ‹·è´åˆ°æ–°æ•°ç»„ä¸­</li><li>è®©åŸæ•°ç»„æŒ‡å‘æ–°æ•°ç»„ï¼Œä¹Ÿå°±æ˜¯è®©åŸæ•°ç»„ä¿å­˜æ–°æ•°ç»„çš„åœ°å€å€¼</li></ul></li><li>æŠŠ<strong>æ’å…¥ç´¢å¼•åŠå…¶ä¹‹åçš„å…ƒç´ </strong>å¾€åæŒªåŠ¨ä¸€ä½(<strong>ä»åå¾€å‰æŒªåŠ¨</strong>)</li><li>æŠŠæ’å…¥çš„å…ƒç´ èµ‹å€¼åˆ°æ’å…¥ç´¢å¼•çš„ä½ç½®ä¸­<br><img src="https://img-blog.csdnimg.cn/20190919191026970.gif" alt="é¡ºåºè¡¨æ’å…¥"></li></ul></li></ul><h2 id="é¡ºåºè¡¨ä¼˜åŠ£åŠ¿çš„æ€»ç»“"><a href="#é¡ºåºè¡¨ä¼˜åŠ£åŠ¿çš„æ€»ç»“" class="headerlink" title="é¡ºåºè¡¨ä¼˜åŠ£åŠ¿çš„æ€»ç»“"></a>é¡ºåºè¡¨ä¼˜åŠ£åŠ¿çš„æ€»ç»“</h2><ul><li>ä¼˜ç‚¹ï¼š<br>æ— é¡»å…³å¿ƒè¡¨ä¸­å…ƒç´ ä¹‹é—´çš„å…³ç³»ï¼Œæ‰€ä»¥ä¸ç”¨å¢åŠ é¢å¤–çš„å­˜å‚¨ç©ºé—´ï¼›<strong>å¯ä»¥æ ¹æ®ç´¢å¼•å¿«é€Ÿåœ°æ“ä½œè¡¨ä¸­ä»»æ„ä½ç½®çš„å…ƒç´ </strong>ï¼Œå¹¶ä¸”æ“ä½œä»»ä½•ä¸€ä¸ªå…ƒç´ çš„<strong>è€—æ—¶éƒ½æ˜¯ä¸€æ ·</strong>ã€‚</li><li>ç¼ºç‚¹ï¼š<br><strong>æ’å…¥å’Œåˆ é™¤æ“ä½œéœ€è¦ç§»åŠ¨å¤§é‡å…ƒç´ </strong>ã€‚ä½¿ç”¨å‰éœ€äº‹å…ˆåˆ†é…å¥½å†…å­˜ç©ºé—´ï¼Œå½“çº¿æ€§è¡¨é•¿åº¦å˜åŒ–è¾ƒå¤§æ—¶ï¼Œéš¾ä»¥ç¡®å®šå­˜å‚¨ç©ºé—´çš„å®¹é‡ã€‚åˆ†é…ç©ºé—´è¿‡å¤§ä¼šé€ æˆå­˜å‚¨ç©ºé—´çš„å·¨å¤§æµªè´¹ï¼Œåˆ†é…çš„ç©ºé—´è¿‡å°ï¼Œéš¾ä»¥é€‚åº”é—®é¢˜çš„éœ€æ±‚ã€‚</li></ul><h2 id="æ¨¡æ‹Ÿ-ArrayList-å®ç°"><a href="#æ¨¡æ‹Ÿ-ArrayList-å®ç°" class="headerlink" title="æ¨¡æ‹Ÿ ArrayList å®ç°"></a>æ¨¡æ‹Ÿ ArrayList å®ç°</h2><p><strong>éœ€æ±‚</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/*** éœ€è¦å®ç°ä»¥ä¸‹å‡ ä¸ªæ–¹æ³•* 1)æ·»åŠ å…ƒç´ çš„æ–¹æ³• --> add(Object element)* 2)æ ¹æ®ç´¢å¼•è·å–å…ƒç´ çš„æ–¹æ³• --> get(int index)* 3)æ ¹æ®ç´¢å¼•åˆ é™¤å…ƒç´ çš„æ–¹æ³• --> remove(int index)* 4)æ ¹æ®ç´¢å¼•æ’å…¥å…ƒç´ çš„æ–¹æ³• --> add(int index,Object element)*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä¹¦å†™ ArrayList ç±»</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayList</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * ç”¨æ¥ä¿å­˜å€¼     */</span>    <span class="token keyword">private</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elementData<span class="token punctuation">;</span>    <span class="token comment">/**     * é›†åˆçš„å…ƒç´ ä¸ªæ•°     */</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span>    <span class="token comment">/**     * è·å–æ•°ç»„ä¸­å®é™…å­˜æ”¾å…ƒç´ çš„ä¸ªæ•°     *     * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>size<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>     <span class="token comment">/**     * æ— å‚æ„é€ ï¼Œé»˜è®¤è®¾ç½®æ•°ç»„çš„ç©ºé—´é•¿åº¦     */</span>    <span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æŒ‡å®šè®¾ç½®æ•°ç»„çš„ç©ºé—´é•¿åº¦     *     * @param cap éœ€è¦è®¾ç½®çš„æ•°ç»„é•¿åº¦     */</span>    <span class="token keyword">public</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token keyword">int</span> cap<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// åˆ¤æ–­capæ˜¯å¦åˆæ³•</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>cap <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"å‚æ•°ä¸åˆæ³•ï¼Œcap:"</span> <span class="token operator">+</span> cap<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// å®ä¾‹åŒ–æ•°ç»„</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span>cap<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ·»åŠ å…ƒç´      *     * @param element å…ƒç´      */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Object</span> element<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 1.åˆ¤æ–­æ•°ç»„æ˜¯å¦éœ€è¦æ‰©å®¹</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 2.æŠŠelementæ·»åŠ è¿›å…¥æ•°ç»„ä¸­</span>        elementData<span class="token punctuation">[</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">;</span>        <span class="token comment">// 3.æ›´æ–°sizeå€¼</span>        size<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ ¹æ®ç´¢å¼•è¿”å›å…ƒç´ å€¼     *     * @param index ç´¢å¼•å€¼     * @return ç´¢å¼•å¯¹åº”çš„å…ƒç´ å€¼     */</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// åˆ¤æ–­ç´¢å¼•æ˜¯å¦åˆæ³• èŒƒå›´æ˜¯ 0 &lt;---> size-1</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">rangeCheck</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ ¹æ®ç´¢å¼•è¿”å›å¯¹åº”çš„å…ƒç´ å€¼</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * ç§»é™¤ç´¢å¼•ä½ç½®çš„å…ƒç´      *     * @param index     * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// åˆ¤æ–­å…ƒç´ çš„åˆæ³•æ€§</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">rangeCheck</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//index ==>sizeçš„å…ƒç´ å¾€å‰ç§» i å–ä¸åˆ°size</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> index<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            elementData<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> elementData<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// sizeå¤§å°è°ƒæ•´</span>        size<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> index<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ£€æŸ¥ç´¢å¼•çš„åˆæ³•æ€§ï¼Œé€‚ç”¨ä¸getå’Œremove     *     * @param index ç´¢å¼•ä½ç½®     */</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">rangeCheck</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> index <span class="token operator">>=</span> size<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ArrayIndexOutOfBoundsException</span><span class="token punctuation">(</span><span class="token string">"ç´¢å¼•è¶Šç•Œï¼Œindex = "</span> <span class="token operator">+</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ ¹æ®ç´¢å¼•æ’å…¥å…ƒç´      *     * @param index   ç´¢å¼•     * @param element å…ƒç´      */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token class-name">Object</span> element<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// åˆ¤æ–­ç´¢å¼•æ˜¯å¦åˆæ³• [0,size] ==>æ’å…¥å…ƒç´ å¯ä»¥æ·»åŠ åˆ°å®é™…å…ƒç´ çš„æœ€æœ«å°¾</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> index <span class="token operator">></span> size<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ArrayIndexOutOfBoundsException</span><span class="token punctuation">(</span><span class="token string">"ç´¢å¼•å¼‚å¸¸ï¼Œindex = "</span> <span class="token operator">+</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// åˆ¤æ–­æ•°ç»„æ˜¯å¦éœ€è¦æ‰©å®¹</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ’å…¥ç´¢å¼•åŠå…¶ä»¥åçš„å…ƒç´ å¾€åæŒªåŠ¨ä¸€ä½ (å€’ç€å¾€åæŒªåŠ¨)</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> index<span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            elementData<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> elementData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// indexå¯¹åº”çš„ä½ç½®æ’å…¥element</span>        elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">;</span>        <span class="token comment">// sizeå¤§å°è°ƒæ•´</span>        size<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * åˆ¤æ–­æ•°ç»„æ˜¯å¦éœ€è¦æ‰§è¡Œæ‰©å®¹æ“ä½œ     */</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData<span class="token punctuation">.</span>length <span class="token operator">==</span> size<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// 1å½“æ•°ç»„çš„ç©ºé—´é•¿åº¦ä¸å®é™…å­˜æ”¾çš„å…ƒç´ ä¸ªæ•°ç›¸åŒæ—¶ï¼Œéœ€è¦æ‰©å®¹</span>            <span class="token comment">// 2åˆ›å»ºä¸€ä¸ªæ¯”åŸæ•°ç»„ç©ºé—´é•¿åº¦æ›´å¤§çš„æ–°æ•°ç»„</span>            <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> newArr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span>elementData<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token comment">// 3æŠŠåŸæ•°ç»„ä¸­çš„å…ƒç´ copyè¿›å…¥æ–°æ•°ç»„</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                newArr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> elementData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">// 4è®©åŸæ•°ç»„ä¿å­˜æ–°æ•°ç»„çš„åœ°å€å€¼</span>            elementData <span class="token operator">=</span> newArr<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> çº¿æ€§è¡¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> çº¿æ€§è¡¨ </tag>
            
            <tag> ArrayList </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue-routerä¼ å‚çš„ä¸€äº›é—®é¢˜</title>
      <link href="2020/08/06/vue-router-chuan-can-de-yi-xie-wen-ti/"/>
      <url>2020/08/06/vue-router-chuan-can-de-yi-xie-wen-ti/</url>
      
        <content type="html"><![CDATA[<h1 id="query-æ–¹å¼ä¼ å‚å’Œæ¥æ”¶å‚æ•°"><a href="#query-æ–¹å¼ä¼ å‚å’Œæ¥æ”¶å‚æ•°" class="headerlink" title="query æ–¹å¼ä¼ å‚å’Œæ¥æ”¶å‚æ•°"></a>query æ–¹å¼ä¼ å‚å’Œæ¥æ”¶å‚æ•°</h1><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// ä¼ å‚</span><span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  path<span class="token operator">:</span> <span class="token string">'/xxx'</span><span class="token punctuation">,</span>  query<span class="token operator">:</span> <span class="token punctuation">&#123;</span>    id<span class="token operator">:</span> id<span class="token punctuation">,</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token comment">// æ¥æ”¶å‚æ•°:</span><span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ³¨æ„ï¼ä¼ å‚æ˜¯<code>$router</code>,æ¥æ”¶å‚æ•°æ˜¯<code>$route</code></strong></p><h1 id="routeå’Œ-router-çš„åŒºåˆ«"><a href="#routeå’Œ-router-çš„åŒºåˆ«" class="headerlink" title="$routeå’Œ $router çš„åŒºåˆ«"></a>$routeå’Œ $router çš„åŒºåˆ«</h1><p><img src="https://segmentfault.com/img/bVbbI7f?w=652&h=425"></p><ul><li><code>$router</code>ä¸º VueRouter å®ä¾‹ï¼Œæƒ³è¦å¯¼èˆªåˆ°ä¸åŒ URLï¼Œåˆ™ä½¿ç”¨<code>$router.push</code>æ–¹æ³•</li><li><code>$route</code>ä¸ºå½“å‰ router è·³è½¬å¯¹è±¡ï¼Œé‡Œé¢å¯ä»¥è·å– nameã€pathã€queryã€params ç­‰</li></ul><h1 id="params-æ–¹å¼ä¼ å‚å’Œæ¥æ”¶å‚æ•°"><a href="#params-æ–¹å¼ä¼ å‚å’Œæ¥æ”¶å‚æ•°" class="headerlink" title="params æ–¹å¼ä¼ å‚å’Œæ¥æ”¶å‚æ•°"></a>params æ–¹å¼ä¼ å‚å’Œæ¥æ”¶å‚æ•°</h1><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">// ä¼ å‚</span><span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  name<span class="token operator">:</span> <span class="token string">'xxx'</span><span class="token punctuation">,</span>  params<span class="token operator">:</span> <span class="token punctuation">&#123;</span>    id<span class="token operator">:</span> id<span class="token punctuation">,</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token comment">// æ¥æ”¶å‚æ•°</span><span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ³¨æ„:params ä¼ å‚ï¼Œpush é‡Œé¢åªèƒ½æ˜¯ <code>name:&#39;xxxx&#39;</code>,ä¸èƒ½æ˜¯<code>path:&#39;/xxx&#39;</code>,å› ä¸º params åªèƒ½ç”¨ name æ¥å¼•å…¥è·¯ç”±ï¼Œå¦‚æœè¿™é‡Œå†™æˆäº† pathï¼Œæ¥æ”¶å‚æ•°é¡µé¢ä¼šæ˜¯ undefinedï¼</strong></p><blockquote><p>query ç›¸å½“äº get è¯·æ±‚ï¼Œè€Œ params ç›¸å½“äº post è¯·æ±‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mysqlæ•°æ®åº“å¯¼å…¥SQLæŠ¥é”™</title>
      <link href="2020/08/06/mysql-shu-ju-ku-dao-ru-sql-bao-cuo/"/>
      <url>2020/08/06/mysql-shu-ju-ku-dao-ru-sql-bao-cuo/</url>
      
        <content type="html"><![CDATA[<blockquote><p><strong>mysql å¯¼å…¥ sql æ–‡ä»¶çš„æ—¶å€™æŠ¥é”™,1273- Unknown collation: utf8mb4_0900_ai_ci</strong></p></blockquote><p><img src="https://img-blog.csdnimg.cn/20200624135840489.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MTM2NzUyMw==,size_16,color_FFFFFF,t_70" alt="1"></p><blockquote><p>åŸå› æ˜¯å› ä¸º MySQL 5.7 ä½¿ç”¨çš„é»˜è®¤ä¸º<code>utf8mb4_unicode_ci</code>ï¼Œä½†æ˜¯ä» MySQL8.0 å¼€å§‹ä½¿ç”¨çš„å·²ç»æ”¹<code>utf8mb4_0900_ai_ci</code>äº†<br>æ‰€ä»¥å½“æˆ‘ä»¬<strong>ä» mysql8 å¾€ mysql5 å¯¼å…¥ sql æ–‡ä»¶çš„æ—¶å€™ä¼šæŠ¥é”™</strong><br>è§£å†³åŠæ³•ï¼š<br>å°†æ‰€æœ‰çš„ <code>utf8mb4_0900_ai_ci</code> æ›¿æ¢ä¸º <code>utf8mb4_unicode_ci</code> å³å¯ä»¥å°† 8.x ç‰ˆæœ¬æ•°æ®åº“æ’åºæ”¹æˆ 5.x ç‰ˆæœ¬çš„<br>åè¿‡æ¥ä¹Ÿå¯ä»¥å°† 5.x ç‰ˆæœ¬çš„æ’åºè§„åˆ™æ”¹æˆ 8.x</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dubboå­¦ä¹ å’Œå®æˆ˜</title>
      <link href="2020/08/01/dubbo-xue-xi-he-shi-zhan/"/>
      <url>2020/08/01/dubbo-xue-xi-he-shi-zhan/</url>
      
        <content type="html"><![CDATA[<h1 id="Dubbo-å­¦ä¹ ä¸å®æˆ˜"><a href="#Dubbo-å­¦ä¹ ä¸å®æˆ˜" class="headerlink" title="Dubbo å­¦ä¹ ä¸å®æˆ˜"></a>Dubbo å­¦ä¹ ä¸å®æˆ˜</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><strong>Dubbo æ˜¯ä»€ä¹ˆ</strong><br><img src="https://s1.ax1x.com/2020/08/01/a3lwc9.png" alt="Duboo"></p><p>Dubbo å®˜ç½‘åœ°å€ï¼š<a href="http://dubbo.apache.org/zh-cn/">http://dubbo.apache.org/zh-cn/</a></p><blockquote><p>Dubbo æœ€æ—©æ˜¯ Alibaba å¼€æºçš„åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ï¼Œå®ƒæœ€å¤§çš„ç‰¹ç‚¹æ˜¯æŒ‰ç…§åˆ†å±‚çš„æ–¹å¼æ¥æ¶æ„ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼å¯ä»¥ä½¿å„ä¸ªå±‚ä¹‹é—´è§£è€¦åˆï¼ˆæˆ–è€…æœ€å¤§é™åº¦åœ°æ¾è€¦åˆï¼‰ã€‚ä»æœåŠ¡æ¨¡å‹çš„è§’åº¦æ¥çœ‹ï¼Œ Dubbo é‡‡ç”¨çš„æ˜¯ä¸€ç§éå¸¸ç®€å•çš„æ¨¡å‹ï¼Œè¦ä¹ˆæ˜¯æä¾›æ–¹æä¾›æœåŠ¡ï¼Œè¦ä¹ˆæ˜¯æ¶ˆè´¹æ–¹æ¶ˆè´¹æœåŠ¡ï¼Œæ‰€ä»¥åŸºäºè¿™ä¸€ç‚¹å¯ä»¥æŠ½è±¡å‡ºæœåŠ¡æä¾›æ–¹ï¼ˆProviderï¼‰å’ŒæœåŠ¡æ¶ˆè´¹æ–¹ï¼ˆConsumerï¼‰ä¸¤ä¸ªè§’è‰²ã€‚</p></blockquote><p><strong>å‘å±•å†å²</strong></p><ul><li>Dubbo æ˜¯æœ€å¼€å§‹æ˜¯é˜¿é‡Œå·´å·´å†…éƒ¨ä½¿ç”¨çš„ RPC æ¡†æ¶</li><li>2011 å¹´å¯¹å¤–æä¾›</li><li>2012 å¹´åœæ­¢æ›´æ–°</li><li>2017 å¹´å¼€å§‹ç»§ç»­æ›´æ–°</li><li>2019 å¹´æçŒ®ç»™ Apacheï¼Œç”± Apache ç»´æŠ¤ 2.7 ä»¥ä¸Šç‰ˆæœ¬</li></ul><p><strong>Dubbo èƒ½åšä»€ä¹ˆ</strong></p><ul><li>Dubbo å¯å®ç°é€æ˜åŒ–çš„è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼Œå°±åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·è°ƒç”¨è¿œç¨‹æ–¹æ³•ï¼Œåªéœ€ç®€å•é…ç½®å³å¯ï¼Œæ²¡æœ‰ä»»ä½• API ä¾µå…¥</li><li>è½¯è´Ÿè½½å‡è¡¡åŠå®¹é”™æœºåˆ¶ï¼Œå¯åœ¨å†…ç½‘æ›¿ä»£ F5 ç­‰ç¡¬ä»¶è´Ÿè½½å‡è¡¡å™¨ï¼Œé™ä½æˆæœ¬ï¼Œå‡å°‘å•ç‚¹</li><li>æœåŠ¡è‡ªåŠ¨æ³¨å†Œä¸å‘ç°ï¼Œä¸å†éœ€è¦å†™æ­»æœåŠ¡æä¾›æ–¹åœ°å€ï¼Œæ³¨å†Œä¸­å¿ƒåŸºäºæ¥å£åæŸ¥è¯¢æœåŠ¡æä¾›è€…çš„ IP åœ°å€ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¹³æ»‘æ·»åŠ æˆ–åˆ é™¤æœåŠ¡æä¾›è€…</li></ul><p><strong>äº§ç”ŸèƒŒæ™¯</strong><br><img src="https://s1.ax1x.com/2020/08/01/a31eD1.png" alt="æ¶æ„å‘å±•å†ç¨‹"></p><ul><li><p>å•ä¸€åº”ç”¨æ¶æ„ï¼ˆå•ä½“æ¶æ„ï¼‰</p><blockquote><p>å½“ç½‘ç«™æµé‡å¾ˆå°æ—¶ï¼Œåªéœ€ä¸€ä¸ªåº”ç”¨ï¼Œå°†æ‰€æœ‰åŠŸèƒ½éƒ½éƒ¨ç½²åœ¨ä¸€èµ·ï¼Œä»¥å‡å°‘éƒ¨ç½²èŠ‚ç‚¹å’Œæˆæœ¬ã€‚æ­¤æ—¶ï¼Œç”¨äºç®€åŒ–å¢åˆ æ”¹æŸ¥å·¥ä½œé‡çš„æ•°æ®è®¿é—®æ¡†æ¶(ORM) æ˜¯å…³é”®ã€‚</p></blockquote></li><li><p>å‚ç›´åº”ç”¨æ¶æ„</p><blockquote><p>å½“è®¿é—®é‡é€æ¸å¢å¤§ï¼Œå•ä¸€åº”ç”¨å¢åŠ æœºå™¨å¸¦æ¥çš„åŠ é€Ÿåº¦è¶Šæ¥è¶Šå°ï¼Œå°†åº”ç”¨æ‹†æˆäº’ä¸ç›¸å¹²çš„å‡ ä¸ªåº”ç”¨ï¼Œä»¥æå‡æ•ˆç‡ã€‚æ­¤æ—¶ï¼Œç”¨äºåŠ é€Ÿå‰ç«¯é¡µé¢å¼€å‘çš„ Web æ¡†æ¶(MVC) æ˜¯å…³é”®ã€‚</p></blockquote></li><li><p>åˆ†å¸ƒå¼æœåŠ¡æ¶æ„ï¼ˆRPC æ¶æ„ï¼‰</p><blockquote><p>å½“å‚ç›´åº”ç”¨è¶Šæ¥è¶Šå¤šï¼Œåº”ç”¨ä¹‹é—´äº¤äº’ä¸å¯é¿å…ï¼Œå°†æ ¸å¿ƒä¸šåŠ¡æŠ½å–å‡ºæ¥ï¼Œä½œä¸ºç‹¬ç«‹çš„æœåŠ¡ï¼Œé€æ¸å½¢æˆç¨³å®šçš„æœåŠ¡ä¸­å¿ƒï¼Œä½¿å‰ç«¯åº”ç”¨èƒ½æ›´å¿«é€Ÿçš„å“åº”å¤šå˜çš„å¸‚åœºéœ€æ±‚ã€‚<br>æ­¤æ—¶ï¼Œç”¨äºæé«˜ä¸šåŠ¡å¤ç”¨åŠæ•´åˆçš„åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶(RPC) æ˜¯å…³é”®</p></blockquote></li><li><p>æµåŠ¨è®¡ç®—æ¶æ„ï¼ˆSOA æ¶æ„ï¼‰</p><blockquote><p>å½“æœåŠ¡è¶Šæ¥è¶Šå¤šï¼Œå®¹é‡çš„è¯„ä¼°ï¼Œå°æœåŠ¡èµ„æºçš„æµªè´¹ç­‰é—®é¢˜é€æ¸æ˜¾ç°ï¼Œæ­¤æ—¶éœ€å¢åŠ ä¸€ä¸ªè°ƒåº¦ä¸­å¿ƒåŸºäºè®¿é—®å‹åŠ›å®æ—¶ç®¡ç†é›†ç¾¤å®¹é‡ï¼Œæé«˜é›†ç¾¤åˆ©ç”¨ç‡ã€‚<br>æ­¤æ—¶ï¼Œç”¨äºæé«˜æœºå™¨åˆ©ç”¨ç‡çš„èµ„æºè°ƒåº¦å’Œæ²»ç†ä¸­å¿ƒ(SOA) æ˜¯å…³é”®</p></blockquote></li></ul><h2 id="Dubbo-æ¶æ„è®²è§£"><a href="#Dubbo-æ¶æ„è®²è§£" class="headerlink" title="Dubbo æ¶æ„è®²è§£"></a>Dubbo æ¶æ„è®²è§£</h2><p><img src="https://dubbo.apache.org/img/architecture.png" alt="Dubboå®˜æ–¹æ¶æ„å›¾"></p><ul><li><p>çº¿æ¡</p><blockquote><p>è™šçº¿è¡¨ç¤ºå¼‚æ­¥ï¼Œå®ç°è¡¨ç¤ºåŒæ­¥ã€‚å¼‚æ­¥ä¸é˜»å¡çº¿ç¨‹æ€§èƒ½é«˜ï¼ŒåŒæ­¥é˜»å¡çº¿ç¨‹å¿…é¡»ç­‰å¾…å“åº”ç»“æŸæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œç›¸å¯¹æ€§è¾ƒä½</p></blockquote></li><li><p>Provider</p><blockquote><p>æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹</p></blockquote></li><li><p>Container</p><blockquote><p>æœåŠ¡è¿è¡Œå®¹å™¨ï¼ŒDubbo å®Œå…¨åŸºäº Spring å®ç°</p></blockquote></li><li><p>Registry</p><blockquote><p>æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ³¨å†Œä¸­å¿ƒã€‚æ³¨å†Œä¸­å¿ƒï¼Œæ”¾ç½®æ‰€æœ‰ Provider å¯¹å¤–æä¾›çš„ä¿¡æ¯ã€‚åŒ…å« Provider çš„ IPï¼Œè®¿é—®ç«¯å£ï¼Œè®¿é—®éµå®ˆçš„åè®®ï¼Œå¯¹å¤–æä¾›çš„æ¥å£ï¼Œæ¥å£ä¸­æœ‰å“ªäº›æ–¹æ³•ç­‰ç›¸å…³ä¿¡æ¯</p></blockquote></li><li><p>Consumer</p><blockquote><p>è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ã€‚</p></blockquote></li><li><p>Monitor</p><blockquote><p>ç»Ÿè®¡æœåŠ¡çš„è°ƒç”¨æ¬¡è°ƒå’Œè°ƒç”¨æ—¶é—´çš„ç›‘æ§ä¸­å¿ƒã€‚<br>ç›‘æ§ä¸­å¿ƒï¼Œç›‘æ§ Provider çš„å‹åŠ›æƒ…å†µç­‰ã€‚æ¯éš” 2 åˆ†é’Ÿ Consumer å’Œ Provider ä¼šæŠŠè°ƒç”¨æ¬¡æ•°å‘é€ç»™ Monitorï¼Œç”± Monitor è¿›è¡Œç»Ÿè®¡ã€‚</p></blockquote></li></ul><p><strong>æ‰§è¡Œæµç¨‹</strong></p><ol start="0"><li>startï¼šå¯åŠ¨ Spring å®¹å™¨æ—¶ä¼šæŠŠ Provider å¯åŠ¨</li><li>registerï¼šæŠŠ Provider ç›¸å…³ä¿¡æ¯æ³¨å†Œåˆ° Registry é‡Œ</li><li>subscribeï¼šConsumer ä» Registry ä¸­è®¢é˜… Provider çš„ä¿¡æ¯</li><li>notifyï¼šé€šçŸ¥ç»™ Consumer</li><li>invokeï¼šConsumer æ ¹æ® Registry é€šçŸ¥çš„ä¿¡æ¯è¿›è¡Œè°ƒç”¨ Provider ä¸­æ–¹æ³•ã€‚</li><li>count:Consumer å’Œ Provider æŠŠè°ƒç”¨æ¬¡æ•°ä¿¡æ¯å¼‚æ­¥å‘é€ç»™ Monitor è¿›è¡Œç»Ÿè®¡ã€‚</li></ol><h2 id="Dubbo-æ”¯æŒçš„åè®®"><a href="#Dubbo-æ”¯æŒçš„åè®®" class="headerlink" title="Dubbo æ”¯æŒçš„åè®®"></a>Dubbo æ”¯æŒçš„åè®®</h2><ol><li><p>Dubbo åè®®(å®˜æ–¹æ¨èåè®®)</p><ul><li><p>ä¼˜ç‚¹ï¼šé‡‡ç”¨ NIO å¤ç”¨å•ä¸€é•¿è¿æ¥ï¼Œå¹¶ä½¿ç”¨çº¿ç¨‹æ± å¹¶å‘å¤„ç†è¯·æ±‚ï¼Œå‡å°‘æ¡æ‰‹å’ŒåŠ å¤§å¹¶å‘æ•ˆç‡ï¼Œæ€§èƒ½è¾ƒå¥½ï¼ˆæ¨èä½¿ç”¨ï¼‰</p></li><li><p>ç¼ºç‚¹ï¼šå¤§æ–‡ä»¶ä¸Šä¼ æ—¶,å¯èƒ½å‡ºç°é—®é¢˜(ä¸ä½¿ç”¨ Dubbo æ–‡ä»¶ä¸Šä¼ )</p></li></ul></li><li><p>RMI(Remote Method Invocation)åè®®</p><ul><li>ä¼˜ç‚¹ï¼šjdk è‡ªå¸¦çš„åè®®</li><li>ç¼ºç‚¹ï¼šå¶å°”è¿æ¥å¤±è´¥</li></ul></li><li><p>Hessian åè®®</p><ul><li>ä¼˜ç‚¹ï¼šå¯ä¸åŸç”Ÿ Hessian äº’æ“ä½œï¼ŒåŸºäº HTTP åè®®</li><li>ç¼ºç‚¹ï¼šéœ€ hessian.jar æ”¯æŒï¼Œhttp çŸ­è¿æ¥çš„å¼€é”€å¤§</li></ul></li></ol><h2 id="Dubbo-æ”¯æŒçš„æ³¨å†Œä¸­å¿ƒ"><a href="#Dubbo-æ”¯æŒçš„æ³¨å†Œä¸­å¿ƒ" class="headerlink" title="Dubbo æ”¯æŒçš„æ³¨å†Œä¸­å¿ƒ"></a>Dubbo æ”¯æŒçš„æ³¨å†Œä¸­å¿ƒ</h2><ol><li>Zookeeper(å®˜æ–¹æ¨è)<ul><li>ä¼˜ç‚¹ï¼šæ”¯æŒåˆ†å¸ƒå¼.å¾ˆå¤šå‘¨è¾¹äº§å“</li><li>ç¼ºç‚¹ï¼šå—é™äº Zookeeper è½¯ä»¶çš„ç¨³å®šæ€§ã€‚Zookeeper æ˜¯ä¸€æ¬¾ä¸“é—¨ä¸ºåˆ†å¸ƒå¼æ¶æ„æä¾›è¾…åŠ©å‹å¤„ç†çš„è½¯ä»¶ï¼Œç¨³å®šè¾ƒä¼˜</li></ul></li><li>Multicast<ul><li>ä¼˜ç‚¹ï¼šå»ä¸­å¿ƒåŒ–,ä¸éœ€è¦å•ç‹¬å®‰è£…è½¯ä»¶.</li><li>ç¼ºç‚¹ï¼š2.2.1 Provider å’Œ Consumer å’Œ Registry ä¸èƒ½è·¨æœºæˆ¿(è·¯ç”±)</li></ul></li><li>Redis<ul><li>ä¼˜ç‚¹ï¼šæ”¯æŒé›†ç¾¤,æ€§èƒ½é«˜</li><li>ç¼ºç‚¹ï¼šè¦æ±‚æœåŠ¡å™¨æ—¶é—´åŒæ­¥.å¦åˆ™å¯èƒ½å‡ºç°é›†ç¾¤å¤±è´¥é—®é¢˜</li></ul></li><li>Simple<ul><li>ä¼˜ç‚¹ï¼šæ ‡å‡† RPC æœåŠ¡.æ²¡æœ‰å…¼å®¹é—®é¢˜</li><li>ç¼ºç‚¹ï¼šä¸æ”¯æŒé›†ç¾¤</li></ul></li></ol><h2 id="Spring-æ•´åˆ-Dubbo"><a href="#Spring-æ•´åˆ-Dubbo" class="headerlink" title="Spring æ•´åˆ Dubbo"></a>Spring æ•´åˆ Dubbo</h2><blockquote><p><strong>è¿™é‡Œé‡‡ç”¨ maven èšåˆå·¥ç¨‹</strong>æ–¹ä¾¿å¯¹ä¾èµ–å’Œé¡¹ç›®è¿›è¡Œç®¡ç†ï¼Œä¸ºäº†å‡å°‘ä»£ç é‡ï¼Œæˆ‘ä»¬æŠŠ provider æ–¹å’Œ consumer æ–¹å…¬ç”¨çš„æ¥å£æ”¾åœ¨ä¸€ä¸ªå…¬å…±é¡¹ç›®ä¸­ï¼Œå†åˆ†åˆ«å¼•ç”¨ã€‚provider æ˜¯æœåŠ¡ç«¯ï¼Œåº”è¯¥æ˜¯ä¸ª jar å·¥ç¨‹ï¼Œconsumer æ˜¯ web ç«¯ï¼Œåº”è¯¥æ˜¯ war å·¥ç¨‹ã€‚è€Œçˆ¶å·¥ç¨‹åº”è¯¥æ˜¯ pom ç±»å‹</p></blockquote><p><img src="https://s1.ax1x.com/2020/08/01/a3BXnK.png" alt="é¡¹ç›®ç»“æ„"></p><ol><li><p>å»ºç«‹çˆ¶å·¥ç¨‹</p><ul><li><p>å¯¼å…¥ä¾èµ–</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>        <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>        <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.bjsxt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modules</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>provider<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">></span></span>consumer<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modules</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">></span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring.version</span><span class="token punctuation">></span></span>5.2.5.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring.version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dubbo.version</span><span class="token punctuation">></span></span>2.7.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dubbo.version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>curator.version</span><span class="token punctuation">></span></span>4.2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>curator.version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>registry-zookeeper.version</span><span class="token punctuation">></span></span>2.7.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>registry-zookeeper.version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet.version</span><span class="token punctuation">></span></span>3.1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet.version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jsp.version</span><span class="token punctuation">></span></span>2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jsp.version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jstl.version</span><span class="token punctuation">></span></span>1.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jstl.version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencyManagement</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--Spring Context Dependence--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;spring.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--Spring MVC Dependence--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-webmvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;spring.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--Apache Dubbo Dependence--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.dubbo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>dubbo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;dubbo.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--Registry Zookeeper Dependence--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.dubbo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>dubbo-registry-zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;registry-zookeeper.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--Apache Curator Dependence--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.curator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>curator-framework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;curator.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--Servlet Dependence--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>javax.servlet-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;servlet.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--JSP Dependence--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jsp-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;jsp.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--JSTL Dependence--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.servlet.jsp.jstl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jstl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>$&#123;jstl.version&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencyManagement</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pluginManagement</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>            <span class="token comment">&lt;!--Tomcat Plugin--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.tomcat.maven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>tomcat7-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pluginManagement</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li><li><p>åˆ›å»º common å·¥ç¨‹<br><img src="https://s1.ax1x.com/2020/08/01/a3D3uV.png" alt="common"></p><ul><li>åˆ›å»º provider è¦æš´éœ²çš„æ¥å£ï¼Œå¹¶å†™å…¥æµ‹è¯•æ¡ˆä¾‹<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DemoDubboService</span> <span class="token punctuation">&#123;</span>  <span class="token comment">/**  *  æµ‹è¯•  * @param str å­—ç¬¦ä¸²  * @return String  */</span>  <span class="token class-name">String</span> <span class="token function">showMsg</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li><li><p>åˆ›å»º provider å·¥ç¨‹<br><img src="https://s1.ax1x.com/2020/08/01/a35cOe.png" alt="provider"></p><ul><li><p>åˆ›å»ºé¡¹ç›®ï¼Œæ·»åŠ ä¾èµ–</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">     <span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.bjsxt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>provider<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.bjsxt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>       <span class="token comment">&lt;!--spring context--></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-context<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>       <span class="token comment">&lt;!--dubbo core--></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.dubbo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>dubbo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>       <span class="token comment">&lt;!--dubbo zookeeper registry--></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.dubbo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>dubbo-registry-zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>       <span class="token comment">&lt;!--Apache Curator Dependence--></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.curator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>curator-framework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æ·»åŠ æ¥å£å®ç°ç±»(å®ç° common å·¥ç¨‹é‡Œæš´éœ²çš„æ¥å£)</p><blockquote><p><strong>é‡ç‚¹è¦æ³¨æ„çš„æ˜¯è¿™é‡Œç”¨çš„@Service æ˜¯ Dubbo çš„</strong></p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>bjsxt<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>bjsxt<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">DemoDubboService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span><span class="token comment">/*** @author ZhangHaoyu* @description å®ç°commonä¸­çš„dubboæ¥å£* @date 2020/7/31 21:53** @Service æ˜¯dubboçš„æ³¨è§£ é‡ç‚¹æ³¨æ„*/</span><span class="token annotation punctuation">@Service</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoDubboServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">DemoDubboService</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">showMsg</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"hello Dubbo "</span><span class="token operator">+</span>str<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æ·»åŠ  Dubbo é…ç½®æ–‡ä»¶</p><blockquote><p>Dubbo çš„é…ç½®æ–‡ä»¶å¿…é¡»æ”¾åœ¨<code>resources/META-INF/spring/*.xml</code>ä¸­</p></blockquote><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>dubbo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://dubbo.apache.org/schema/dubbo<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beanshttp://www.springframework.org/schema/beans/spring-beans-4.3.xsdhttp://dubbo.apache.org/schema/dubbohttp://dubbo.apache.org/schema/dubbo/dubbo.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--provideråç§°--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">dubbo:</span>application</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myProvide<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token comment">&lt;!--      é…ç½®æ³¨å†Œä¸­å¿ƒ      adresså¦‚æœæ˜¯é›†ç¾¤éœ€è¦çš„æ ¼å¼æ˜¯ï¼š          ip:port,ip:prot,ip:prot    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">dubbo:</span>registry</span> <span class="token attr-name">address</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>182.92.159.117:2181,182.92.159.117:2182,182.92.159.117:2183<span class="token punctuation">"</span></span> <span class="token attr-name">protocol</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zookeeper<span class="token punctuation">"</span></span> <span class="token attr-name">timeout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>60000<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token comment">&lt;!--é…ç½®æœåŠ¡åè®® å’Œæ³¨å†Œç«¯å£--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">dubbo:</span>protocol</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dubbo<span class="token punctuation">"</span></span> <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>20880<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token comment">&lt;!--å®ä¾‹åŒ–æ¥å£å®ç°ç±»--></span><span class="token comment">&lt;!--    &lt;bean id="service" class="com.bjsxt.dubbo.service.impl.DemoDubboServiceImpl"/>--></span>    <span class="token comment">&lt;!--æ³¨å†Œæ¥å£--></span><span class="token comment">&lt;!--    &lt;dubbo:service interface="com.bjsxt.dubbo.service.DemoDubboService" ref="service"/>--></span>    <span class="token comment">&lt;!--      æ‰«ææ¥å£çš„ä½ç½®æŒ‡å®š@Serviceï¼Œä¸æ˜¯Springä¸‹çš„æ˜¯Dubboä¸‹çš„      æ”¾å…¥springå®¹å™¨ä¸­è®©springæ¥ç®¡      --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">dubbo:</span>annotation</span> <span class="token attr-name">package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.bjsxt.dubbo.service.impl<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>åˆ›å»º Dubbo å¯åŠ¨ç±»</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>bjsxt<span class="token punctuation">.</span>dubbo</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>container<span class="token punctuation">.</span></span><span class="token class-name">Main</span><span class="token punctuation">;</span><span class="token comment">/*** @author ZhangHaoyu* @description Dubboçš„å¯åŠ¨ç±»* @date 2020/7/31 22:33*/</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Start</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// Mainæ˜¯DubboåŒ…ä¸‹çš„</span>        <span class="token class-name">Main</span><span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>å¯åŠ¨å¯èƒ½ä¼šå‡ºç°çš„é—®é¢˜ï¼š</p><ul><li>warn log4j xxx:</li></ul><blockquote><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å¯¼å…¥ä¸€ä¸ª log4j.properties å°±èƒ½çœ‹åˆ°å¯åŠ¨æ—¶å€™çš„æ—¥å¿—è¾“å‡º</p></blockquote></li></ul><p><img src="https://s1.ax1x.com/2020/08/01/a3TUeg.png" alt="å¯åŠ¨æˆåŠŸ"></p></li></ol><ul><li><p>ç”¨ linux è§‚å¯ŸèŠ‚ç‚¹ä¸‹æœ‰ä»€ä¹ˆä¸œè¥¿</p><blockquote><p>ç¨‹åºå¯åŠ¨åï¼Œprovider ä¼šå» Registry æ³¨å†ŒèŠ‚ç‚¹</p></blockquote><p><img src="https://s1.ax1x.com/2020/08/01/a3TvtA.png" alt="æ³¨å†ŒæˆåŠŸ"></p>   <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">###æ³¨å†Œä¿¡æ¯ï¼š######</span>    <span class="token comment"># è§£ç å‰</span><span class="token punctuation">[</span>dubbo%3A%2F%2F192.168.111.1%3A20880%2Fcom.bjsxt.dubbo.service.DemoDubboService%3Fanyhost%3Dtrue%26application%3DmyProvide%26deprecated%3Dfalse%26dubbo%3D2.0.2%26dynamic%3Dtrue%26generic%3Dfalse%26interface%3Dcom.bjsxt.dubbo.service.DemoDubboService%26methods%3DshowMsg%26pid%3D19116%26release%3D2.7.6%26side%3Dprovider%26timestamp%3D1596258937758<span class="token punctuation">]</span>    <span class="token comment"># è§£ç å</span>   <span class="token punctuation">[</span>dubbo://192.168.111.1:20880/com.bjsxt.dubbo.service.DemoDubboService?anyhost<span class="token operator">=</span>true<span class="token operator">&amp;</span><span class="token assign-left variable">application</span><span class="token operator">=</span>myProvide<span class="token operator">&amp;</span><span class="token assign-left variable">deprecated</span><span class="token operator">=</span>false<span class="token operator">&amp;</span><span class="token assign-left variable">dubbo</span><span class="token operator">=</span><span class="token number">2.0</span>.2<span class="token operator">&amp;</span><span class="token assign-left variable">dynamic</span><span class="token operator">=</span>true<span class="token operator">&amp;</span><span class="token assign-left variable">generic</span><span class="token operator">=</span>false<span class="token operator">&amp;</span><span class="token assign-left variable">interface</span><span class="token operator">=</span>com.bjsxt.dubbo.service.DemoDubboService<span class="token operator">&amp;</span><span class="token assign-left variable">methods</span><span class="token operator">=</span>showMsg<span class="token operator">&amp;</span><span class="token assign-left variable">pid</span><span class="token operator">=</span><span class="token number">19116</span><span class="token operator">&amp;</span><span class="token assign-left variable">release</span><span class="token operator">=</span><span class="token number">2.7</span>.6<span class="token operator">&amp;</span><span class="token assign-left variable">side</span><span class="token operator">=</span>provider<span class="token operator">&amp;</span><span class="token assign-left variable">timestamp</span><span class="token operator">=</span><span class="token number">1596258937758</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><ol start="4"><li><p>åˆ›å»º consumer å·¥ç¨‹(æ˜¯ä¸€ä¸ª war å·¥ç¨‹)</p><p><img src="https://s1.ax1x.com/2020/08/01/a3j0z9.png" alt="consumeré¡¹ç›®ç»“æ„"></p><ul><li><p>åˆ›å»ºé¡¹ç›®æ·»åŠ ä¾èµ–</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span>        <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>        <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.bjsxt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>consumer<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">></span></span>war<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.bjsxt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>javax.servlet-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-webmvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jsp-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.servlet.jsp.jstl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jstl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.dubbo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>dubbo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.dubbo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>dubbo-registry-zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--Apache Curator Dependence--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.curator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>curator-framework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.tomcat.maven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>tomcat7-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>port</span><span class="token punctuation">></span></span>8080<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>port</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-compiler-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span><span class="token punctuation">></span></span>6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">></span></span>6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ç¼–å†™é…ç½®æ–‡ä»¶</p><blockquote><p><strong>applicationContext-service.xml</strong></p></blockquote><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>p</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/p<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>aop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/aop<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans      http://www.springframework.org/schema/beans/spring-beans.xsd      http://www.springframework.org/schema/context      http://www.springframework.org/schema/context/spring-context.xsd      http://www.springframework.org/schema/aop      http://www.springframework.org/schema/aop/spring-aop.xsd      http://www.springframework.org/schema/util      http://www.springframework.org/schema/util/spring-util.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.bjsxt.service<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>spring-dubbo.xml</strong></p></blockquote><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>dubbo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://dubbo.apache.org/schema/dubbo<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>dubbot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://dubbo.apache.org/schema/dubbo<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beanshttp://www.springframework.org/schema/beans/spring-beans-4.3.xsdhttp://dubbo.apache.org/schema/dubbohttp://dubbo.apache.org/schema/dubbo/dubbo.xsdhttp://www.springframework.org/schema/contexthttp://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--é…ç½®æœåŠ¡åç§°--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">dubbo:</span>application</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myConsumer<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token comment">&lt;!--é…ç½®æ³¨å†Œä¸­å¿ƒåœ°å€ä»¥åŠè®¿é—®åè®®--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">dubbo:</span>registry</span> <span class="token attr-name">address</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>182.92.159.117:2181,182.92.159.117:2182,182.92.159.117:2183<span class="token punctuation">"</span></span> <span class="token attr-name">protocol</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zookeeper<span class="token punctuation">"</span></span> <span class="token attr-name">timeout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>60000<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token comment">&lt;!--dubbo æ‰«æè‡ªå·±@Reference æ³¨è§£  ç»™ç”¨çš„æ¥å£å†™ä¸Š--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">dubbo:</span>annotation</span> <span class="token attr-name">package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.bjsxt.service.impl<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>springmvc.xml</strong></p></blockquote><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>p</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/p<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>aop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/aop<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>mvc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/mvc<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beanshttp://www.springframework.org/schema/beans/spring-beans.xsdhttp://www.springframework.org/schema/contexthttp://www.springframework.org/schema/context/spring-context.xsdhttp://www.springframework.org/schema/aophttp://www.springframework.org/schema/aop/spring-aop.xsdhttp://www.springframework.org/schema/utilhttp://www.springframework.org/schema/util/spring-util.xsdhttp://www.springframework.org/schema/mvchttp://www.springframework.org/schema/mvc/spring-mvc.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>     <span class="token comment">&lt;!--æ³¨è§£æ‰«æ--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.bjsxt.web.controller<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token comment">&lt;!--springmvcæ³¨è§£æ‰«æ--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>annotation-driven</span><span class="token punctuation">/></span></span>    <span class="token comment">&lt;!--è§†å›¾è§£æå™¨--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>org.springframework.web.servlet.view.InternalResourceViewResolver<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>prefix<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/WEB-INF/jsp/<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>suffix<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>.jsp<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>web.xml</strong></p></blockquote><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://java.sun.com/xml/ns/javaee<span class="token punctuation">"</span></span>        <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>        <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://java.sun.com/xml/ns/javaeehttp://java.sun.com/xml/ns/javaee/web-app_3_0.xsd<span class="token punctuation">"</span></span>        <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>3.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>context-param</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">></span></span>contextConfigLocation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">></span></span>classpath:spring/applicationContext-*.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>context-param</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>listener</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>listener-class</span><span class="token punctuation">></span></span>org.springframework.web.context.ContextLoaderListener<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>listener-class</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>listener</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>springmvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">></span></span>org.springframework.web.servlet.DispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">></span></span>contextConfigLocation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">></span></span>classpath:spring/springmvc.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>load-on-startup</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>load-on-startup</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>springmvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--SpringMVC ä¸­çš„ç¼–ç è¿‡æ»¤å™¨--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>encodeFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">></span></span>org.springframework.web.filter.CharacterEncodingFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">></span></span>encoding<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">></span></span>utf-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>encodeFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>åˆ›å»ºä¸šåŠ¡å±‚</p><blockquote><p>è¿™é‡Œçš„ä¸šåŠ¡å±‚æ˜¯è‡ªå·±å†™çš„</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DemoService</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**    *  æµ‹è¯•    * @param str å­—ç¬¦ä¸²    * @return String    */</span>    <span class="token class-name">String</span> <span class="token function">showMsg</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å®ç°ç±»:</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>bjsxt<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>bjsxt<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">DemoDubboService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>bjsxt<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">DemoService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Reference</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span><span class="token punctuation">;</span><span class="token comment">/*** @author ZhangHaoyu* @description Consumerçš„ä¸šåŠ¡å±‚ serviceè¦å¼„æˆspringé‡Œçš„* @date 2020/7/31 23:44*/</span><span class="token annotation punctuation">@Service</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">DemoService</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**    *  Referenceæ˜¯dubboçš„æ³¨è§£ï¼Œ    *      æ‰«æè¿™ä¸ªæ³¨è§£å»Registeryä¸­æ‰¾å¯¹åº”çš„ä¿¡æ¯    */</span>    <span class="token annotation punctuation">@Reference</span>    <span class="token keyword">private</span> <span class="token class-name">DemoDubboService</span> demoDubboService<span class="token punctuation">;</span>    <span class="token comment">/**    *  çœ‹ä¼¼æ˜¯è°ƒç”¨äº†è‡ªå·±çš„æ–¹æ³•ï¼Œ    *      å®åˆ™é€šè¿‡@Referenceæ³¨å…¥åˆ°çš„å¯¹è±¡ç”Ÿæˆäº†ä¸€ä¸ªä»£ç†å¯¹è±¡    *          æ‰§è¡Œçš„æ˜¯å¦ä¸€ä¸ªæœåŠ¡å™¨çš„æ–¹æ³•    * @param str å­—ç¬¦ä¸²    * @return String    */</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">showMsg</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> demoDubboService<span class="token punctuation">.</span><span class="token function">showMsg</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>åˆ›å»º controller å±‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>bjsxt<span class="token punctuation">.</span>web<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>bjsxt<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">DemoService</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span><span class="token comment">/*** @author ZhangHaoyu* @description* @date 2020/7/31 23:59*/</span><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">DemoService</span> demoService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/getMsg"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> demoService<span class="token punctuation">.</span><span class="token function">showMsg</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>å¯åŠ¨é¡¹ç›®æµ‹è¯•ç»“æœ<br><img src="https://s1.ax1x.com/2020/08/01/a8S5h8.png" alt="å¯åŠ¨é¡¹ç›®"><br><img src="https://s1.ax1x.com/2020/08/01/a8S66H.png" alt="æµ‹è¯•ç»“æœ"></p></li></ul></li></ol><h2 id="springboot-æ•´åˆ-Dubbo"><a href="#springboot-æ•´åˆ-Dubbo" class="headerlink" title="springboot æ•´åˆ Dubbo"></a>springboot æ•´åˆ Dubbo</h2><ol><li>åˆ›å»ºæœåŠ¡æ¥å£ï¼Œæ·»åŠ æ¥å£<br><img src="https://s1.ax1x.com/2020/08/08/aIBvDK.png" alt="æœåŠ¡æ¥å£æ¨¡å—"></li><li>åˆ›å»º provider æ¨¡å—<br><img src="https://s1.ax1x.com/2020/08/08/aIDjRs.png" alt="æä¾›è€…æ¨¡å—"></li></ol><blockquote><p>ä¿®æ”¹ pom æ–‡ä»¶,æ·»åŠ ä¾èµ–</p></blockquote><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.bjsxt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>springbootdubbo_api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.dubbo/dubbo-spring-boot-starter --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.dubbo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>dubbo-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.7.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--dubbo for zookeeper registry--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.dubbo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>dubbo-registry-zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.7.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!-- å»é™¤loggingåŒ…é˜²æ­¢å¤šä¸ªæ—¥å¿—ä¾èµ–å†²çª --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-logging<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.junit.vintage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>junit-vintage-engine<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½® Dubbo</p></blockquote><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">dubbo</span><span class="token punctuation">:</span>  <span class="token key atrule">application</span><span class="token punctuation">:</span>    <span class="token key atrule">name</span><span class="token punctuation">:</span> myProvider <span class="token comment"># æŒ‡å®šæœåŠ¡çš„åç§°</span>  <span class="token key atrule">registry</span><span class="token punctuation">:</span>    <span class="token comment"># springçš„é…ç½®æ–¹å¼åœ¨è¿™é‡Œä¾æ—§é€‚ç”¨</span>    <span class="token comment">#    address: 182.92.159.117:2181,182.92.159.117:2182,182.92.159.117:2183</span>    <span class="token comment">#    protocol: zookeeper</span>    <span class="token comment"># springbootçš„é…ç½®æ–¹å¼</span>    <span class="token key atrule">address</span><span class="token punctuation">:</span> zookeeper<span class="token punctuation">:</span>//182.92.159.117<span class="token punctuation">:</span>2181<span class="token punctuation">?</span>backup=182.92.159.117<span class="token punctuation">:</span><span class="token number">2182</span><span class="token punctuation">,</span>182.92.159.117<span class="token punctuation">:</span><span class="token number">2183</span>    <span class="token key atrule">timeout</span><span class="token punctuation">:</span> <span class="token number">10000</span> <span class="token comment">#10s</span>  <span class="token key atrule">protocol</span><span class="token punctuation">:</span>    <span class="token key atrule">name</span><span class="token punctuation">:</span> dubbo <span class="token comment"># é…ç½®åè®®åç§°</span>    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">20880</span> <span class="token comment"># é…ç½®ç«¯å£</span>  <span class="token key atrule">scan</span><span class="token punctuation">:</span>    <span class="token key atrule">base-packages</span><span class="token punctuation">:</span> com.bjsxt.springbootdubbo_provider.service.impl <span class="token comment">#é…ç½®æ‰«æåŒ…çš„ä½ç½®</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ä¹¦å†™å®ç°ç±»ï¼Œæä¾›ç»™å…¶ä»–æœåŠ¡å™¨ä½¿ç”¨</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * @author ZhangHaoyu * @description  providerçš„å®ç°ç±»ï¼Œå°†æ¥è¦æ”¾åˆ°æ³¨å†Œä¸­å¿ƒä¸Šçš„ *                  2.7.7ä¸­ç”¨çš„æ˜¯@DubboService @Serviceè¢«å¼ƒç”¨ * @date 2020/8/1 18:44 */</span><span class="token annotation punctuation">@DubboService</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoDubboServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">DemoDubboService</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">showMsg</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"hello dubbo "</span><span class="token operator">+</span>str<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å¯åŠ¨ provider</p></blockquote><blockquote><p><strong>é—®é¢˜</strong>:<br>å¦‚æœåœ¨é¡¹ç›®ä¸­æ·»åŠ çš„æ˜¯ spring-boot-starter-web å¯åŠ¨å™¨ï¼Œé‚£ä¹ˆåœ¨å¯åŠ¨ dubbo åè¿˜ä¼šç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œå› ä¸ºåœ¨ web å¯åŠ¨å™¨ä¸­å†…ç½®äº†ä¸€ä¸ª Tomcatï¼ŒTomcat çš„å¯åŠ¨ä¸ä¼šå½±å“ dubbo çš„è¿è¡Œï¼Œä½†æ˜¯ä¼šå¤šå ç”¨ä¸€ä¸ªç«¯å£ï¼Œæœªæ¥åœ¨å…¶ä»–çš„ Provider ä¸­è¿˜éœ€è¦è€ƒè™‘ç«¯å£åˆ†é…çš„é—®é¢˜ï¼Œé¿å…ç«¯å£æŠ¢å ã€‚</p></blockquote><blockquote><p><strong>è§£å†³</strong>:<br>å¯ä»¥ä½¿ç”¨ spring-boot-starter èµ·æ¥å¯åŠ¨ Dubboï¼Œåœ¨è¯¥å¯åŠ¨å™¨ä¸­å¹¶æœªåŒ…å« Tomcat æ‰€ä»¥å¹¶ä¸ä¼šç›‘å¬ç«¯å£ã€‚</p></blockquote><ol><li><p>åˆ›å»º consumer æ¨¡å—<br> <img src="https://s1.ax1x.com/2020/08/09/ao4BcT.png" alt="ao4BcT.png"></p><blockquote><p><strong>consumer åº”è¯¥æ˜¯ä¸€ä¸ª web é¡¹ç›®</strong></p></blockquote></li></ol><blockquote><p>åˆ›å»ºé¡¹ç›®å¯¼å…¥ä¾èµ–</p></blockquote><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.bjsxt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>springbootdubbo_api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.dubbo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>dubbo-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.7.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.dubbo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>dubbo-registry-zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.7.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.junit.vintage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>junit-vintage-engine<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ä¹¦å†™ä¸šåŠ¡å±‚æ¥å£</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DemoService</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> <span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ä¹¦å†™ä¸šåŠ¡å±‚æ¥å£å®ç°ç±»</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/*è¿™é‡Œçš„serviceæ˜¯springè‡ªå·±çš„*/</span><span class="token annotation punctuation">@Service</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">DemoService</span> <span class="token punctuation">&#123;</span>  <span class="token comment">/**    * Dubbo2.7.7ä»¥åæ”¹æˆäº†@DubboReference    * ä¹‹å‰ç‰ˆæœ¬ä¸­æ˜¯@Reference    */</span>    <span class="token annotation punctuation">@DubboReference</span>    <span class="token keyword">private</span> <span class="token class-name">DemoDubboService</span> demoDubboService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> demoDubboService<span class="token punctuation">.</span><span class="token function">showMsg</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>é…ç½® application.yml</p></blockquote><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">dubbo</span><span class="token punctuation">:</span>  <span class="token key atrule">application</span><span class="token punctuation">:</span>    <span class="token key atrule">name</span><span class="token punctuation">:</span> myConsumer <span class="token comment">#æœåŠ¡åç§°</span>  <span class="token key atrule">registry</span><span class="token punctuation">:</span>    <span class="token key atrule">address</span><span class="token punctuation">:</span> zookeeper<span class="token punctuation">:</span>//182.92.159.117<span class="token punctuation">:</span>2181<span class="token punctuation">?</span>backup=182.92.159.117<span class="token punctuation">:</span><span class="token number">2182</span><span class="token punctuation">,</span>182.92.159.117<span class="token punctuation">:</span><span class="token number">2183</span>    <span class="token key atrule">timeout</span><span class="token punctuation">:</span> <span class="token number">10000</span> <span class="token comment">#10s</span>  <span class="token key atrule">protocol</span><span class="token punctuation">:</span>    <span class="token key atrule">name</span><span class="token punctuation">:</span> dubbo <span class="token comment">#é…ç½®åè®®åç§°</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ç¼–å†™ controller</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoController</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">DemoService</span> demoService<span class="token punctuation">;</span>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/getMsg"</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> demoService<span class="token punctuation">.</span><span class="token function">getMsg</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å¯åŠ¨ consumer æ¨¡å—</p></blockquote><p><img src="https://s1.ax1x.com/2020/08/09/aobmKx.png" alt="è®¿é—®ç»“æœ"></p><h2 id="Dubbo-ç›‘æ§ä¸ç®¡ç†"><a href="#Dubbo-ç›‘æ§ä¸ç®¡ç†" class="headerlink" title="Dubbo ç›‘æ§ä¸ç®¡ç†"></a>Dubbo ç›‘æ§ä¸ç®¡ç†</h2><blockquote><p>é€šè¿‡ Dubbo Monitor æ¥ç»Ÿè®¡æœåŠ¡çš„è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼ŒæœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒï¼Œç›‘æ§ä¸­å¿ƒåˆ™ä½¿ç”¨æ•°æ®ç»˜åˆ¶å›¾è¡¨æ¥æ˜¾ç¤º</p></blockquote><p><strong>ä¿®æ”¹ dubbo.properties</strong></p><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">dubbo.container</span><span class="token punctuation">=</span><span class="token attr-value">log4j,spring,registry,jetty</span><span class="token attr-name">dubbo.application.name</span><span class="token punctuation">=</span><span class="token attr-value">simple-monitor</span><span class="token attr-name">dubbo.application.owner</span><span class="token punctuation">=</span><span class="token comment">#dubbo.registry.address=multicast://224.5.6.7:1234</span><span class="token comment"># zookeeperçš„æ³¨å†Œä¸­å¿ƒï¼Œéœ€è¦å†™å…¥zookeeperçš„åœ°å€ï¼Œå¦‚æœæ˜¯é›†ç¾¤éƒ½è¦å†™å…¥</span><span class="token attr-name">dubbo.registry.address</span><span class="token punctuation">=</span><span class="token attr-value">zookeeper://182.92.159.117:2181?backup=182.92.159.117:2182,182.92.159.117:2183</span><span class="token comment">#dubbo.registry.address=redis://127.0.0.1:6379</span><span class="token comment">#dubbo.registry.address=dubbo://127.0.0.1:9090</span><span class="token attr-name">dubbo.protocol.port</span><span class="token punctuation">=</span><span class="token attr-value">7070</span><span class="token comment"># æ³¨å†Œä¸­å¿ƒæœåŠ¡ç›‘å¬ç«¯å£</span><span class="token attr-name">dubbo.jetty.port</span><span class="token punctuation">=</span><span class="token attr-value">7777</span><span class="token attr-name">dubbo.jetty.directory</span><span class="token punctuation">=</span><span class="token attr-value">$&#123;user.home&#125;/monitor</span><span class="token attr-name">dubbo.charts.directory</span><span class="token punctuation">=</span><span class="token attr-value">$&#123;dubbo.jetty.directory&#125;/charts</span><span class="token attr-name">dubbo.statistics.directory</span><span class="token punctuation">=</span><span class="token attr-value">$&#123;user.home&#125;/monitor/statistics</span><span class="token attr-name">dubbo.log4j.file</span><span class="token punctuation">=</span><span class="token attr-value">logs/dubbo-monitor-simple.log</span><span class="token attr-name">dubbo.log4j.level</span><span class="token punctuation">=</span><span class="token attr-value">WARN</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å¯åŠ¨ Dubbo Monitor</strong><br><img src="https://s1.ax1x.com/2020/08/09/aT9NVA.png" alt="å¯åŠ¨"><br>ä¸€ä¸ªæ˜¯ Windows çš„ä¸€ä¸ªæ˜¯ Linux çš„</p><p><img src="https://s1.ax1x.com/2020/08/09/aT9R5q.png" alt="å¯åŠ¨æˆåŠŸ"></p><p>è®¿é—®ç«¯å£ ip:(dubbo.jetty.prot) æˆ‘çš„æ˜¯ localhost:7777<br><img src="https://s1.ax1x.com/2020/08/09/aT942T.png" alt="è®¿é—®æˆåŠŸ"></p><blockquote><p>é€šè¿‡ Dubbo-Admin<br>ä¸»è¦åŒ…å«ï¼šè·¯ç”±è§„åˆ™ã€åŠ¨æ€é…ç½®ã€æœåŠ¡é™çº§ã€è®¿é—®æ§åˆ¶ã€æƒé‡è°ƒæ•´ã€è´Ÿè½½å‡è¡¡ç­‰ç®¡ç†åŠŸèƒ½ã€‚</p></blockquote><p><img src="https://s1.ax1x.com/2020/08/09/aTiiCt.png" alt="application.properties"></p><p><strong>ä¿®æ”¹ application.properites</strong></p><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment"># æ³¨å†Œåœ°å€</span><span class="token attr-name">admin.registry.address</span><span class="token punctuation">=</span><span class="token attr-value">zookeeper://182.92.159.117:2181?backup=182.92.159.117:2182,182.92.159.117:2183</span><span class="token comment"># é…ç½®ä¸­å¿ƒ</span><span class="token attr-name">admin.config-center</span><span class="token punctuation">=</span><span class="token attr-value">zookeeper://182.92.159.117:2181?backup=182.92.159.117:2182,182.92.159.117:2183</span><span class="token comment"># å…ƒæ•°æ®æŠ¥è¡¨</span><span class="token attr-name">admin.metadata-report.address</span><span class="token punctuation">=</span><span class="token attr-value">zookeeper://182.92.159.117:2181?backup=182.92.159.117:2182,182.92.159.117:2183</span><span class="token comment"># dubbo-adminçš„ç›‘å¬ç«¯å£</span><span class="token attr-name">server.port</span><span class="token punctuation">=</span><span class="token attr-value">9999</span><span class="token comment"># ä»¥ä¸‹ä¸éœ€è¦ä¿®æ”¹</span><span class="token attr-name">admin.registry.group</span><span class="token punctuation">=</span><span class="token attr-value">dubbo</span><span class="token attr-name">admin.apollo.token</span><span class="token punctuation">=</span><span class="token attr-value">e16e5cd903fd0c97a116c873b448544b9d086de9</span><span class="token attr-name">admin.apollo.appId</span><span class="token punctuation">=</span><span class="token attr-value">test</span><span class="token attr-name">admin.apollo.env</span><span class="token punctuation">=</span><span class="token attr-value">dev</span><span class="token attr-name">admin.apollo.cluster</span><span class="token punctuation">=</span><span class="token attr-value">default</span><span class="token attr-name">admin.apollo.namespace</span><span class="token punctuation">=</span><span class="token attr-value">dubbo</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å¯åŠ¨ Dubbo-Admin</strong><br><code>java -jar dubbo-admin-server.jar</code></p><p><a href="https://imgchr.com/i/aTiDxK"><img src="https://s1.ax1x.com/2020/08/09/aTiDxK.png" alt="å¯åŠ¨é¡¹ç›®"></a></p><p><strong>è®¿é—®ç«¯å£</strong><br><img src="https://s1.ax1x.com/2020/08/09/aTiLIs.png" alt="è®¿é—®ç«¯å£"></p><h2 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h2><blockquote><p>è´Ÿè½½å‡è¡¡ï¼ˆLoad Balanceï¼‰ï¼Œæ˜¯æŒ‡å°†è´Ÿè½½ï¼ˆå·¥ä½œä»»åŠ¡ï¼Œè®¿é—®è¯·æ±‚ï¼‰è¿›è¡Œå¹³è¡¡ã€åˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒï¼ˆæœåŠ¡å™¨ï¼Œç»„ä»¶ï¼‰ä¸Šè¿›è¡Œæ‰§è¡Œã€‚</p></blockquote><p><img src="https://s1.ax1x.com/2020/08/10/ab2Zb4.png" alt="å…¸å‹çš„ä¸€ä¸ªä¾‹å­"></p><blockquote><p>è¿™ä¸€ç§å¤è€çš„æ–¹å¼ï¼Œé€šè¿‡å…¥å£æä¾›ä¸åŒçº¿è·¯ã€ä¸åŒæœåŠ¡å™¨é“¾æ¥çš„æ–¹å¼ï¼Œæ¥å®ç°è´Ÿè½½å‡è¡¡ï¼Œä¸€èˆ¬åœ¨æä¾›ä¸‹è½½ä¸šåŠ¡çš„ç½‘ç«™æ¯”è¾ƒå¸¸è§ã€‚</p></blockquote><h3 id="è´Ÿè½½å‡è¡¡è§£å†³æ–¹æ¡ˆåˆ†ç±»åŠç‰¹å¾"><a href="#è´Ÿè½½å‡è¡¡è§£å†³æ–¹æ¡ˆåˆ†ç±»åŠç‰¹å¾" class="headerlink" title="è´Ÿè½½å‡è¡¡è§£å†³æ–¹æ¡ˆåˆ†ç±»åŠç‰¹å¾"></a>è´Ÿè½½å‡è¡¡è§£å†³æ–¹æ¡ˆåˆ†ç±»åŠç‰¹å¾</h3><p><strong>é›†ä¸­å¼è´Ÿè½½å‡è¡¡</strong></p><blockquote><p>å³åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´ä½¿ç”¨ç‹¬ç«‹çš„è´Ÿè½½å‡è¡¡è®¾æ–½(å¯ä»¥æ˜¯ç¡¬ä»¶ï¼Œå¦‚ F5, ä¹Ÿå¯ä»¥æ˜¯è½¯ä»¶ï¼Œå¦‚ nginx), ç”±è¯¥è®¾æ–½è´Ÿè´£<strong>æŠŠè®¿é—®è¯·æ±‚é€šè¿‡æŸç§ç­–ç•¥è½¬å‘è‡³æœåŠ¡ç«¯</strong></p></blockquote><p><strong>å¸¸è§çš„é›†ä¸­å¼è´Ÿè½½å‡è¡¡æ–¹å¼</strong></p><ul><li><p>DNS è½®è¯¢</p><blockquote><p>å¤§å¤šåŸŸåæ³¨å†Œå•†éƒ½æ”¯æŒ DNS è½®è¯¢ï¼ŒDNS æœåŠ¡å™¨å°†è§£æè¯·æ±‚æŒ‰ç…§é…ç½®é¡ºåºï¼Œé€ä¸€åˆ†é…åˆ°ä¸åŒçš„ IP ä¸Šï¼Œè¿™æ ·å°±å®Œæˆäº†ç®€å•çš„è´Ÿè½½å‡è¡¡</p></blockquote></li><li><p>åå‘ä»£ç†è´Ÿè½½å‡è¡¡<br><img src="https://s1.ax1x.com/2020/08/10/abRW0e.png" alt="åå‘ä»£ç†"></p><blockquote><p>ä½¿ç”¨ä»£ç†æœåŠ¡å™¨ï¼Œå¯ä»¥å°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨çš„æœåŠ¡å™¨ã€‚Nginx æ˜¯æ¯”è¾ƒå¸¸è§çš„æœåŠ¡åå‘ä»£ç†æŠ€æœ¯ã€‚åœ¨ Nginx ä¸­æ˜¯æ”¯æŒå¯¹ä»£ç†çš„æœåŠ¡çš„è´Ÿè½½å‡è¡¡å¤„ç†çš„ã€‚</p></blockquote></li><li><p>åŸºäºç¡¬ä»¶çš„è´Ÿè½½å‡è¡¡<br><img src="https://s1.ax1x.com/2020/08/10/abhypn.png" alt="ç¡¬ä»¶è´Ÿè½½å‡è¡¡å™¨"></p><blockquote><p>ç¡¬ä»¶è´Ÿè½½å‡è¡¡è§£å†³æ–¹æ¡ˆæ˜¯ç›´æ¥åœ¨æœåŠ¡å™¨å’Œå¤–éƒ¨ç½‘ç»œé—´å®‰è£…è´Ÿè½½å‡è¡¡è®¾å¤‡ï¼Œè¿™ç§è®¾å¤‡æˆ‘ä»¬é€šå¸¸ç§°ä¹‹ä¸ºè´Ÿè½½å‡è¡¡å™¨ï¼Œç”±äºä¸“é—¨çš„è®¾å¤‡å®Œæˆä¸“é—¨çš„ä»»åŠ¡ï¼Œç‹¬ç«‹äºæ“ä½œç³»ç»Ÿï¼Œæ•´ä½“æ€§èƒ½å¾—åˆ°å¤§é‡æé«˜ï¼ŒåŠ ä¸Šå¤šæ ·åŒ–çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œæ™ºèƒ½åŒ–çš„æµé‡ç®¡ç†ï¼Œå¯è¾¾åˆ°æœ€ä½³çš„è´Ÿè½½å‡è¡¡éœ€æ±‚ã€‚</p></blockquote></li><li><p>è¿›ç¨‹å†…è´Ÿè½½å‡è¡¡<br><img src="https://s1.ax1x.com/2020/08/10/abhRmT.png" alt="è¿›ç¨‹å†…è´Ÿè½½å‡è¡¡"></p><blockquote><p>å°†è´Ÿè½½å‡è¡¡é€»è¾‘é›†æˆåˆ°æœåŠ¡ç»„ä»¶ä¸­ï¼ŒæœåŠ¡ç»„ä»¶ä»æœåŠ¡æ³¨å†Œä¸­å¿ƒè·çŸ¥æœ‰å“ªäº›åœ°å€å¯ç”¨ï¼Œç„¶åæ ¹æ®æŒ‡å®šçš„è´Ÿè½½å‡è¡¡ç­–ç•¥é€‰æ‹©å‡ºä¸€ä¸ªåˆé€‚çš„æœåŠ¡æ¥è°ƒç”¨ã€‚</p></blockquote></li></ul><h3 id="Dubbo-çš„å†…ç½®è´Ÿè½½å‡è¡¡ç­–ç•¥"><a href="#Dubbo-çš„å†…ç½®è´Ÿè½½å‡è¡¡ç­–ç•¥" class="headerlink" title="Dubbo çš„å†…ç½®è´Ÿè½½å‡è¡¡ç­–ç•¥"></a>Dubbo çš„å†…ç½®è´Ÿè½½å‡è¡¡ç­–ç•¥</h3><ul><li><p>Random</p><blockquote><p>éšæœºè®¿é—®é›†ç¾¤ä¸­èŠ‚ç‚¹ã€‚è®¿é—®æ¦‚ç‡å’Œæƒé‡æœ‰å…³ã€‚æ˜¯ Dubbo çš„é»˜è®¤è´Ÿè½½å‡è¡¡ç­–ç•¥<br>æƒé‡ï¼ˆweightï¼‰ï¼šå æœ‰æ¯”ä¾‹ã€‚é›†ç¾¤ä¸­æ¯ä¸ªé¡¹ç›®éƒ¨ç½²çš„æœåŠ¡å™¨çš„æ€§èƒ½å¯èƒ½æ˜¯ä¸åŒï¼Œæ€§èƒ½å¥½çš„æœåŠ¡å™¨æƒé‡åº”è¯¥é«˜ä¸€äº›ã€‚</p></blockquote></li><li><p>RoundRobin</p><blockquote><p>è½®è¯¢ã€‚è®¿é—®é¢‘ç‡å’Œæƒé‡æœ‰å…³ã€‚</p></blockquote></li><li><p>LeastActive</p><blockquote><p>æœ€å°‘æ´»è·ƒè°ƒç”¨æ•°ï¼Œç›¸åŒæ´»è·ƒæ•°çš„éšæœºã€‚<br>å¦‚æœæŸä¸ªæœºå™¨æ€§èƒ½è¶Šå·®ï¼Œé‚£ä¹ˆæ¥æ”¶çš„è¯·æ±‚è¶Šå°‘ï¼Œè¶Šä¸æ´»è·ƒï¼Œæ­¤æ—¶å°±ä¼šç»™ä¸æ´»è·ƒçš„æ€§èƒ½å·®çš„æœºå™¨åˆ†é…æ›´å°‘çš„è¯·æ±‚ã€‚</p></blockquote></li><li><p>ConsistentHash</p><blockquote><p>ä¸€è‡´æ€§ Hash ç®—æ³•ï¼Œç›¸åŒå‚æ•°çš„è¯·æ±‚ä¸€å®šåˆ†å‘åˆ°åŒä¸€ä¸ª Provider å¦‚æœéœ€è¦æŸä¸€ç±»è¯·æ±‚éƒ½åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ä¸€è‡´æ€§ Hash ç­–ç•¥ã€‚</p></blockquote></li></ul><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">Dubbo çš„è´Ÿè½½å‡è¡¡å¯ä»¥åœ¨ Consumer æˆ–è€… Providerä¸­é€šè¿‡é…ç½®æ–‡ä»¶æˆ–è€…æ³¨è§£æ¥é…ç½®<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="åœ¨-Consumer-ä¸­é…ç½®è´Ÿè½½å‡è¡¡"><a href="#åœ¨-Consumer-ä¸­é…ç½®è´Ÿè½½å‡è¡¡" class="headerlink" title="åœ¨ Consumer ä¸­é…ç½®è´Ÿè½½å‡è¡¡"></a>åœ¨ Consumer ä¸­é…ç½®è´Ÿè½½å‡è¡¡</h3><p>å‰æï¼šæœ‰ä¸€ä¸ªé›†ç¾¤æˆ–è€…ä¼ªé›†ç¾¤<br>$\color{red}{åœ¨ Dubbo ä¸­ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šè´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œé‚£ä¹ˆ Dubbo é»˜è®¤çš„ä½¿ç”¨éšæœºç­–ç•¥è°ƒç”¨<br>Providerã€‚}$</p><p><a href="http://dubbo.apache.org/zh-cn/blog/dubbo-loadbalance.html">dubbo è´Ÿè½½å‡è¡¡å®˜æ–¹æ–‡æ¡£</a></p><ul><li><p><strong>é€šè¿‡æ³¨è§£é…ç½®è´Ÿè½½å‡è¡¡</strong></p><ul><li>æŒ‡å®šè´Ÿè½½å‡è¡¡ç­–ç•¥<ul><li><code>@Reference(loadbalance =&quot;è´Ÿè½½å‡è¡¡ç­–ç•¥&quot;)</code></li><li>ä¿®æ”¹<code>@Refrence</code> æ³¨è§£æ·»åŠ  loadbalance å±æ€§æŒ‡å®šè´Ÿè½½å‡è¡¡ç­–ç•¥</li></ul></li><li>é€šè¿‡ Provider çš„<code>@Service</code>æ³¨è§£é…ç½®æƒé‡<ul><li><code>@Service(weight = æƒé‡æ•°)</code></li></ul></li></ul></li><li><p><strong>é€šè¿‡é…ç½®æ–‡ä»¶é…ç½®é…ç½®è´Ÿè½½å‡è¡¡</strong></p><ul><li>æ³¨è§£é…ç½®æ–¹å¼ï¼šå±€éƒ¨ï¼Œåªé’ˆå¯¹å½“å‰ä¸šåŠ¡å±‚ç”Ÿæ•ˆ</li><li>é…ç½®æ–‡ä»¶æ–¹å¼ï¼šå…¨å±€ï¼Œå¯¹æ‰€æœ‰ä¸šåŠ¡å±‚ç”Ÿæ•ˆ</li></ul><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">dubbo</span><span class="token punctuation">:</span>  <span class="token key atrule">consumer</span><span class="token punctuation">:</span>  <span class="token key atrule">loadbalance</span><span class="token punctuation">:</span> random<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="åœ¨-Provider-ä¸­é…ç½®è´Ÿè½½å‡è¡¡"><a href="#åœ¨-Provider-ä¸­é…ç½®è´Ÿè½½å‡è¡¡" class="headerlink" title="åœ¨ Provider ä¸­é…ç½®è´Ÿè½½å‡è¡¡"></a>åœ¨ Provider ä¸­é…ç½®è´Ÿè½½å‡è¡¡</h3></li><li><p>åœ¨ Dubbo çš„<code>@Service</code> æ³¨è§£ä¸­é…ç½®è´Ÿè½½å‡è¡¡ä»¥åŠæƒé‡</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span><span class="token punctuation">(</span>loadbalance <span class="token operator">=</span> <span class="token string">"roundrobin"</span><span class="token punctuation">,</span>weight<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>é€šè¿‡é…ç½®æ–‡ä»¶é…ç½®è´Ÿè½½å‡è¡¡</p></li><li><pre><code class="yml">dubbo:  provider:  loadbalance: aoundrobin</code></pre></li></ul>]]></content>
      
      
      <categories>
          
          <category> Dubbo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ </tag>
            
            <tag> Dubbo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Zookeeperå­¦ä¹ </title>
      <link href="2020/07/27/zookeeper-xue-xi/"/>
      <url>2020/07/27/zookeeper-xue-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="Zookeeper-å­¦ä¹ ä¸å®æˆ˜"><a href="#Zookeeper-å­¦ä¹ ä¸å®æˆ˜" class="headerlink" title="Zookeeper å­¦ä¹ ä¸å®æˆ˜"></a>Zookeeper å­¦ä¹ ä¸å®æˆ˜</h1><p>å‰ç½®çŸ¥è¯†ï¼š</p><ul><li>æŒæ¡ Linux æ“ä½œç³»ç»Ÿçš„ä½¿ç”¨</li><li>æŒæ¡ Mavenã€SpringBoot çš„ä½¿ç”¨</li></ul><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><blockquote><p>Zookeeper å®˜ç½‘ï¼š<a href="http://zookeeper.apache.org/">http://zookeeper.apache.org/</a></p></blockquote><blockquote><p>Zookeeper æ˜¯ Apache çš„ä¸€ä¸ªåˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ï¼Œæ˜¯ Apache Hadoop çš„ä¸€ä¸ªå­é¡¹ç›®ã€‚å®˜æ–¹æ–‡æ¡£ä¸Šè¿™ä¹ˆè§£é‡Š Zookeeperï¼Œå®ƒä¸»è¦æ˜¯ç”¨æ¥è§£å†³åˆ†å¸ƒå¼åº”ç”¨ä¸­ç»å¸¸é‡åˆ°çš„ä¸€äº›æ•°æ®ç®¡ç†é—®é¢˜ï¼Œå¦‚ï¼šç»Ÿä¸€å‘½åæœåŠ¡ã€çŠ¶æ€åŒæ­¥æœåŠ¡ã€é›†ç¾¤ç®¡ç†ã€åˆ†å¸ƒå¼åº”ç”¨é…ç½®é¡¹çš„ç®¡ç†ç­‰ã€‚</p></blockquote><blockquote><p>ç®€å•æ¥è¯´ zookeeper=æ–‡ä»¶ç³»ç»Ÿ+ç›‘å¬é€šçŸ¥æœºåˆ¶ã€‚</p></blockquote><h2 id="Zookeeper-å­˜å‚¨ç»“æ„"><a href="#Zookeeper-å­˜å‚¨ç»“æ„" class="headerlink" title="Zookeeper å­˜å‚¨ç»“æ„"></a>Zookeeper å­˜å‚¨ç»“æ„</h2><p><img src="https://s1.ax1x.com/2020/07/30/aK7mUx.png" alt="aK7mUx.png"></p><ol><li>Znode<blockquote><p>åœ¨ Zookeeper ä¸­ï¼Œznode æ˜¯ä¸€ä¸ªè·Ÿ Unix æ–‡ä»¶ç³»ç»Ÿè·¯å¾„ç›¸ä¼¼çš„èŠ‚ç‚¹ï¼Œå¯ä»¥å‘èŠ‚ç‚¹å­˜å‚¨æ•°æ®æˆ–è€…è·å–æ•°æ®ã€‚<br>Zookeeper åº•å±‚æ˜¯ä¸€å¥—æ•°æ®ç»“æ„ã€‚è¿™ä¸ªå­˜å‚¨ç»“æ„æ˜¯ä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œå…¶ä¸Šçš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œznodeâ€<br>Zookeeper ä¸­çš„æ•°æ®æ˜¯æŒ‰ç…§â€œæ ‘â€ç»“æ„è¿›è¡Œå­˜å‚¨çš„ã€‚è€Œä¸” znode èŠ‚ç‚¹è¿˜åˆ†ä¸º 4 ä¸­ä¸åŒçš„ç±»å‹ã€‚<br>æ¯ä¸€ä¸ª znode é»˜è®¤èƒ½å¤Ÿå­˜å‚¨ 1MB çš„æ•°æ®ï¼ˆå¯¹äºè®°å½•çŠ¶æ€æ€§è´¨çš„æ•°æ®æ¥è¯´ï¼Œå¤Ÿäº†ï¼‰<br>å¯ä»¥ä½¿ç”¨ zkCli å‘½ä»¤ï¼Œç™»å½•åˆ° Zookeeper ä¸Šï¼Œå¹¶é€šè¿‡ lsã€createã€deleteã€getã€set ç­‰å‘½ä»¤æ“ä½œè¿™äº› znode èŠ‚ç‚¹ã€‚</p></blockquote></li><li>Znode èŠ‚ç‚¹ç±»å‹<ul><li><code>persistent</code> æŒä¹…åŒ–ç›®å½•èŠ‚ç‚¹<ul><li>å®¢æˆ·ç«¯ä¸ zookeeper æ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹ä¾æ—§å­˜åœ¨ã€‚</li></ul></li><li><code>persistent_sequential</code> æŒä¹…åŒ–é¡ºåºç¼–å·ç›®å½•èŠ‚ç‚¹<ul><li>å®¢æˆ·ç«¯ä¸ zookeeper æ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹ä¾æ—§å­˜åœ¨ï¼Œåªæ˜¯ Zookeeper ç»™è¯¥èŠ‚ç‚¹åç§°è¿›è¡Œé¡ºåºç¼–å·</li></ul></li><li><code>ephemeral</code> ä¸´æ—¶ç›®å½•èŠ‚ç‚¹<ul><li>å®¢æˆ·ç«¯ä¸ zookeeper æ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹è¢«åˆ é™¤ã€‚</li></ul></li><li><code>ephemeral_sequential</code> ä¸´æ—¶é¡ºåºç¼–å·ç›®å½•èŠ‚ç‚¹<ul><li>å®¢æˆ·ç«¯ä¸ zookeeper æ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹è¢«åˆ é™¤ï¼Œåªæ˜¯ Zookeeper ç»™è¯¥èŠ‚ç‚¹åç§°è¿›è¡Œé¡ºåºç¼–å·ã€‚</li></ul></li></ul></li></ol><h2 id="ç›‘å¬é€šçŸ¥æœºåˆ¶"><a href="#ç›‘å¬é€šçŸ¥æœºåˆ¶" class="headerlink" title="ç›‘å¬é€šçŸ¥æœºåˆ¶"></a>ç›‘å¬é€šçŸ¥æœºåˆ¶</h2><blockquote><p>Zookeeper æ˜¯ä½¿ç”¨è§‚å¯Ÿè€…è®¾è®¡æ¨¡å¼æ¥è®¾è®¡çš„ã€‚å½“å®¢æˆ·ç«¯æ³¨å†Œç›‘å¬å®ƒå…³å¿ƒçš„ç›®å½•èŠ‚ç‚¹æ—¶ï¼Œå½“ç›®å½•èŠ‚ç‚¹å‘ç”Ÿå˜åŒ–ï¼ˆæ•°æ®æ”¹å˜ã€è¢«åˆ é™¤ã€å­ç›®å½•èŠ‚ç‚¹å¢åŠ åˆ é™¤ï¼‰æ—¶ï¼ŒZookeeper ä¼šé€šçŸ¥å®¢æˆ·ç«¯ã€‚</p></blockquote><h2 id="å®‰è£…-zookeeper-æµç¨‹"><a href="#å®‰è£…-zookeeper-æµç¨‹" class="headerlink" title="å®‰è£… zookeeper æµç¨‹"></a>å®‰è£… zookeeper æµç¨‹</h2><h3 id="å•æœºç‰ˆ-zookeeper"><a href="#å•æœºç‰ˆ-zookeeper" class="headerlink" title="å•æœºç‰ˆ zookeeper"></a>å•æœºç‰ˆ zookeeper</h3><p>å‰ç½®æ¡ä»¶ï¼š<strong>Linux æ“ä½œç³»ç»Ÿï¼Œå¹¶ä¸”å®‰è£…æœ‰ JDK</strong></p><ul><li><p>ä¸Šä¼  Zookeeper åˆ° linux ç³»ç»Ÿ<br><img src="https://s1.ax1x.com/2020/07/30/aKzT1I.png" alt="aKzT1I.png"></p></li><li><p>è§£å‹ Zookeeper å‹ç¼©åŒ…,å¹¶æŠŠ copy åˆ°<code>/usr/local/ä¸‹</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> -zxvf zookeeper-3.6.0.tar.gz<span class="token function">cp</span> zookeeper-3.6.0 /usr/local/zookeeper -r<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>Zookeeper ç›®å½•ç»“æ„ï¼š</p><p><img src="https://s1.ax1x.com/2020/07/30/aMEGUx.png" alt="ç›®å½•ç»“æ„"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">1. binï¼šæ”¾ç½®è¿è¡Œè„šæœ¬å’Œå·¥å…·è„šæœ¬ï¼Œ2. confï¼šzookeeper é»˜è®¤è¯»å–é…ç½®çš„ç›®å½•ï¼Œé‡Œé¢ä¼šæœ‰é»˜è®¤çš„é…ç½®æ–‡ä»¶3. docsï¼šzookeeper ç›¸å…³çš„æ–‡æ¡£4. libï¼šzookeeper æ ¸å¿ƒçš„ jar5. logsï¼šzookeeper æ—¥å¿—<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>é…ç½® Zookeeper</p><blockquote><p><strong>Zookeeper åœ¨å¯åŠ¨æ—¶é»˜è®¤çš„å» conf ç›®å½•ä¸‹æŸ¥æ‰¾ä¸ªåç§°ä¸º zoo.cfg çš„é…ç½®æ–‡ä»¶</strong><br>conf ç›®å½•ä¸‹æœ‰ä¸€ä¸ª zoo_simple.cfg çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠä»– copy ä¸€ä»½ï¼Œæ”¹åä¸º zoo.cfg å³å¯ã€‚</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> zoo_sample.cfg zoo.cfg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>ä¿®æ”¹ zoo.cfg çš„é…ç½®</strong></p><ul><li><p>è®¾ç½®ç¼“å­˜è·¯å¾„<br><img src="https://s1.ax1x.com/2020/07/30/aMZunJ.png" alt="zoo.cfg"></p><p>dataDir è®¾ç½®æ•°æ®ç¼“å­˜è·¯å¾„<br>å¯ä»¥åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª data ç›®å½•ï¼Œç”¨äºå­˜æ”¾æ•°æ®ç¼“å­˜</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> data<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul></li><li><p>å¯åŠ¨ Zookeeper</p><ul><li><code>./zkServer.sh start</code> <strong>é»˜è®¤çš„ä¼šå» conf ç›®å½•ä¸‹åŠ è½½ zoo.cfg é…ç½®æ–‡ä»¶</strong></li><li><code>./zkServer.sh start</code> <strong>é…ç½®æ–‡ä»¶çš„è·¯å¾„</strong></li></ul></li><li><p>åœæ­¢ Zookeeper</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./zkServer.sh stop <span class="token comment">#åœæ­¢å½“å‰zookeeper</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>æŸ¥çœ‹ Zookeeper çŠ¶æ€</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./zkServer.sh status <span class="token comment"># æŸ¥çœ‹zookeeperçŠ¶æ€</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>ä½¿ç”¨å®¢æˆ·ç«¯è¿æ¥å•æœºç‰ˆ Zookeeper</p><ul><li><code>bin/zkCli.sh</code> é»˜è®¤è¿æ¥æœ¬åœ°åœ°å€ï¼Œé»˜è®¤ç«¯å£ 2181</li><li><code>bin/zkCli.sh -server ip:port</code> è¿æ¥æŒ‡å®š IP åœ°å€ä¸ç«¯å£</li></ul></li></ul><h3 id="zookeeper-é›†ç¾¤å®‰è£…ä¸è„šæœ¬"><a href="#zookeeper-é›†ç¾¤å®‰è£…ä¸è„šæœ¬" class="headerlink" title="zookeeper é›†ç¾¤å®‰è£…ä¸è„šæœ¬"></a>zookeeper é›†ç¾¤å®‰è£…ä¸è„šæœ¬</h3><ol><li>Zookeeper é›†ç¾¤è¯´æ˜</li></ol><ul><li>zookeeper é›†ç¾¤ä¸­çš„è§’è‰²<blockquote><p>Zookeeper é›†ç¾¤ä¸­çš„è§’è‰²ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç±»:<br><img src="https://s1.ax1x.com/2020/07/30/aMlGOf.png" alt="zookeeperé›†ç¾¤è§’è‰²"></p></blockquote></li></ul><ol start="2"><li>é›†ç¾¤å®‰è£…</li></ol><blockquote><p>ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œæˆ‘ä»¬ç”¨ 3 ä¸ª zookeeper æ­å»ºä¸€ä¸ªä¼ªé›†ç¾¤ï¼Œåº”ç”¨éƒ¨ç½²åœ°å€æ˜¯ä½ çš„æœ¬æœºï¼Œå®¢æˆ·ç«¯ç›‘å¬çš„ç«¯å£åˆ†åˆ«æ˜¯ 2181ã€2182ã€2183 ï¼ŒæŠ•ç¥¨é€‰ä¸¾ç«¯å£åˆ†åˆ«ä¸º 2881/3881ã€2882/3882ã€2883/3883</p></blockquote><ul><li><p>åœ¨/usr/local ä¸‹åˆ›å»ºä¸€ä¸ªç›®å½•<br><img src="https://s1.ax1x.com/2020/07/30/aM14Ug.png" alt="zookeeperCluster"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> /usr/local/zookeeperCluster<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>æŠŠè§£å‹åçš„ zookeeper ç›®å½•åˆ†åˆ« copy åˆ°è¿™ä¸ªç›®å½•ä¸‹ï¼Œå¹¶æ”¹å</p><p><img src="https://s1.ax1x.com/2020/07/30/aM3NGj.png" alt="é›†ç¾¤"><br>å¤åˆ¶ä¸¤ä»½ Zookeeper åº”ç”¨ã€‚ç”¨äºæ¨¡æ‹Ÿé›†ç¾¤ä¸­çš„ 3 ä¸ªèŠ‚ç‚¹ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> -r zookeeper-3.6.0 /usr/local/zookeeperCluster/<span class="token function">mv</span> zookeeper-3.6.0 zookeeper01<span class="token function">cp</span> -r zookeeper01 zookeeper02<span class="token function">cp</span> -r zookeeper01 zookeeper03<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æä¾›é…ç½®æ–‡ä»¶</p><ul><li>ç»™æ¯ä¸€ä¸ªçš„ conf ç›®å½•ä¸‹æ·»åŠ ä¸€ä¸ª zoo.cfg</li><li>åœ¨æ¯ä¸€ä¸ªçš„æ ¹ç›®å½•ä¸‹åˆ›å»º data ç›®å½•ç”¨äºå­˜æ”¾ç¼“å­˜</li><li>ä¿®æ”¹ zoo.cfg ä¸­çš„ dataDir å‚æ•°æŒ‡å‘ data ç›®å½•</li></ul></li><li><p>æä¾›å”¯ä¸€æ ‡è¯†</p><ul><li><p>åœ¨ data ç›®å½•ä¸­åˆ›å»ºæ–‡ä»¶</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">myid:touch myid<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>ä¸ºåº”ç”¨æä¾›å”¯ä¸€æ ‡è¯†ã€‚æœ¬ç¯å¢ƒä¸­ä½¿ç”¨ 1ã€2ã€3 ä½œä¸ºæ¯ä¸ªèŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†ã€‚<br><img src="https://s1.ax1x.com/2020/07/30/aM8t0K.png" alt="å”¯ä¸€æ ‡è¯†"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token punctuation">[</span>å”¯ä¸€æ ‡è¯†<span class="token punctuation">]</span> <span class="token operator">>></span> myid<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul></li><li><p>ä¿®æ”¹é…ç½®æ–‡ä»¶<code>zoo.cfg</code> è®¾ç½®ç›‘å¬å®¢æˆ·ç«¯ã€æŠ•ç¥¨ã€é€‰ä¸¾ç«¯å£</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">clientPort</span><span class="token operator">=</span><span class="token number">2181</span> <span class="token comment">#æœåŠ¡ç«¯å£æ ¹æ®åº”ç”¨åšå¯¹åº”ä¿®æ”¹,zk01-2181,zk02-2182,zk03-2183</span>server.1<span class="token operator">=</span><span class="token number">192.168</span>.233.130:2881:3881server.2<span class="token operator">=</span><span class="token number">192.168</span>.233.130:2882:3882server.3<span class="token operator">=</span><span class="token number">192.168</span>.233.130:2883:3883<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/07/30/aM8ONF.png" alt="ä¸¾ä¾‹"></p></li><li><p>ç¼–å†™å¯åŠ¨ã€å…³é—­é›†ç¾¤è„šæœ¬<br><img src="https://s1.ax1x.com/2020/07/30/aMGBUU.png" alt="ç¼–å†™è„šæœ¬"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># åœ¨zookeeperClusterä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</span><span class="token function">touch</span> shutdownAll.sh<span class="token comment"># ä½¿ç”¨ chmod å‘½ä»¤ä¸ºæ–‡ä»¶æˆæƒ</span><span class="token function">chmod</span> <span class="token number">777</span> <span class="token punctuation">[</span>æ–‡ä»¶å<span class="token punctuation">]</span> <span class="token comment"># 777 è¡¨ç¤ºä¸ºæ–‡ä»¶åˆ†é…å¯è¯»ï¼Œå¯å†™ï¼Œå¯æ‰§è¡Œæƒé™ã€‚</span><span class="token comment"># ç¼–å†™</span>zookeeper01/bin/zkServer.sh stopzookeeper02/bin/zkServer.sh stopzookeeper03/bin/zkServer.sh stop<span class="token comment"># åŒç†åˆ›å»ºstartAll.shï¼Œå¹¶æˆæƒ</span><span class="token function">touch</span> startAll.sh<span class="token function">chmod</span> <span class="token number">777</span> <span class="token punctuation">[</span>æ–‡ä»¶å<span class="token punctuation">]</span><span class="token comment"># ç¼–å†™</span>zookeeper01/bin/zkServer.sh startzookeeper02/bin/zkServer.sh startzookeeper03/bin/zkServer.sh start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>è¿æ¥é›†ç¾¤<br><strong>å¯ä»¥ä½¿ç”¨ä»»ä½•èŠ‚ç‚¹ä¸­çš„å®¢æˆ·ç«¯å·¥å…·è¿æ¥é›†ç¾¤ä¸­çš„ä»»ä½•èŠ‚ç‚¹ã€‚</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./zkCli.sh -server <span class="token number">182.92</span>.159.117:2183<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Zookeeper-å¸¸ç”¨å‘½ä»¤"><a href="#Zookeeper-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="Zookeeper å¸¸ç”¨å‘½ä»¤"></a>Zookeeper å¸¸ç”¨å‘½ä»¤</h2></li></ul><ol><li><p><code>ls</code></p><ul><li><code>ls /path</code></li><li>ä½¿ç”¨ ls å‘½ä»¤æŸ¥çœ‹ zookeeper ä¸­çš„å†…å®¹ã€‚åœ¨ ZooKeeper æ§åˆ¶å°å®¢æˆ·ç«¯ä¸­ï¼Œæ²¡æœ‰é»˜è®¤åˆ—è¡¨åŠŸèƒ½ï¼Œå¿…é¡»æŒ‡å®šè¦åˆ—è¡¨èµ„æºçš„ä½ç½®ã€‚ å¦‚ï¼š <code>ls /</code> æˆ–è€… <code>ls /path</code></li></ul></li><li><p><code>create</code></p><blockquote><p>ä½¿ç”¨ create å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„ Znodeã€‚<code>create [-e] [-s] path data</code> åˆ›å»ºèŠ‚ç‚¹ï¼Œå¦‚ï¼š <code>create /test 123</code> åˆ›å»ºä¸€ä¸ª/test èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹æºå¸¦æ•°æ®ä¿¡æ¯ 123ã€‚ <code>create -e /test 123</code> åˆ›å»ºä¸€ä¸ªä¸´æ—¶èŠ‚ç‚¹/testï¼Œæºå¸¦æ•°æ®ä¸º 123ï¼Œä¸´æ—¶èŠ‚ç‚¹åªåœ¨å½“å‰ä¼šè¯ç”Ÿå‘½å‘¨æœŸä¸­æœ‰æ•ˆï¼Œä¼šè¯ç»“æŸèŠ‚ç‚¹è‡ªåŠ¨åˆ é™¤ã€‚<code>create -s /test 123</code> åˆ›å»ºä¸€ä¸ªé¡ºåºèŠ‚ç‚¹/testï¼Œæºå¸¦æ•°æ® 123ï¼Œåˆ›å»ºçš„é¡ºåºèŠ‚ç‚¹ç”± ZooKeeper è‡ªåŠ¨ä¸ºèŠ‚ç‚¹å¢åŠ åç¼€ä¿¡æ¯ï¼Œå¦‚-/test00000001 ç­‰ã€‚-e å’Œ-s å‚æ•°å¯ä»¥è”åˆä½¿ç”¨ã€‚</p></blockquote></li><li><p><code>get</code></p><ul><li><code>get [-s] /path</code></li><li>get å‘½ä»¤è·å– Znode ä¸­çš„æ•°æ®ã€‚</li></ul></li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>zk: <span class="token number">182.92</span>.159.117:2183<span class="token punctuation">(</span>CONNECTED<span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">]</span> get -s /bjsxt <span class="token comment"># æ‰§è¡Œè¯­å¥ï¼Œè·å–bjsxtèŠ‚ç‚¹çš„è¯¦ç»†ä¿¡æ¯</span><span class="token number">123123123</span> <span class="token comment"># å­˜æ”¾çš„æ•°æ®</span>cZxid <span class="token operator">=</span> 0x200000004 <span class="token comment">#åˆ›å»ºæ—¶ zxid(znode æ¯æ¬¡æ”¹å˜æ—¶é€’å¢çš„äº‹åŠ¡ id)</span>ctime <span class="token operator">=</span> Mon Jul <span class="token number">27</span> <span class="token number">20</span>:48:56 CST <span class="token number">2020</span> <span class="token comment">#åˆ›å»ºæ—¶é—´æˆ³</span>mZxid <span class="token operator">=</span> 0x200000009 <span class="token comment"># æœ€è¿‘ä¸€æ¬¡æ›´è¿‘çš„ zxid</span>mtime <span class="token operator">=</span> Mon Jul <span class="token number">27</span> <span class="token number">21</span>:14:54 CST <span class="token number">2020</span> <span class="token comment"># æœ€è¿‘ä¸€æ¬¡æ›´æ–°çš„æ—¶é—´æˆ³</span>pZxid <span class="token operator">=</span> 0x30000001c <span class="token comment"># å­èŠ‚ç‚¹çš„zxid</span>cversion <span class="token operator">=</span> <span class="token number">7</span> <span class="token comment"># å­èŠ‚ç‚¹æ›´æ–°æ¬¡æ•°</span>dataVersion <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment"># èŠ‚ç‚¹æ•°æ®æ›´æ–°æ¬¡æ•°</span>aclVersion <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment"># èŠ‚ç‚¹ ACL(æˆæƒä¿¡æ¯)çš„æ›´æ–°æ¬¡æ•°</span>ephemeralOwner <span class="token operator">=</span> 0x0 <span class="token comment"># :å¦‚æœè¯¥èŠ‚ç‚¹ä¸ºephemeral èŠ‚ç‚¹(ä¸´æ—¶ï¼Œç”Ÿå‘½å‘¨æœŸä¸ session ä¸€æ ·),</span>dataLength <span class="token operator">=</span> <span class="token number">9</span> <span class="token comment"># èŠ‚ç‚¹æ•°æ®å­—èŠ‚æ•°</span>numChildren <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment"># å­èŠ‚ç‚¹æ•°é‡</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="4"><li><p><code>set</code></p><ul><li><code>set /path [data]</code></li><li>æ·»åŠ æˆ–ä¿®æ”¹ Znode ä¸­çš„å€¼<br><img src="https://s1.ax1x.com/2020/07/31/aMJazd.png" alt="ç¤ºä¾‹"></li></ul></li><li><p><code>delete</code></p><ul><li><code>delete /path</code></li><li>åˆ é™¤ Znodeã€‚</li></ul></li></ol><h2 id="Java-æ“ä½œ-Zookeeper"><a href="#Java-æ“ä½œ-Zookeeper" class="headerlink" title="Java æ“ä½œ Zookeeper"></a>Java æ“ä½œ Zookeeper</h2><p><strong>ä»¥ maven é¡¹ç›®ä¸ºä¾‹</strong></p><ol><li><p>åˆ›å»ºé¡¹ç›®å¯¼å…¥ zookeeper ä¾èµ–</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.6.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æ­¥éª¤</p><ul><li><p>æ–°å»ºç±»ï¼Œå®ç° Watherï¼Œé‡å†™æ–¹æ³•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ZnodeDemo</span> <span class="token keyword">implements</span> <span class="token class-name">Watcher</span> <span class="token punctuation">&#123;</span> <span class="token annotation punctuation">@Override</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token class-name">WatchedEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token comment">// è·å–é“¾æ¥äº‹ä»¶</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Event<span class="token punctuation">.</span>KeeperState<span class="token punctuation">.</span>SyncConnected</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¿æ¥æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>åˆ›å»ºè¿æ¥ Zookeeper çš„å¯¹è±¡</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * @param connectString : è¿æ¥çš„ç«¯å£ï¼Œå¦‚æœæ˜¯é›†ç¾¤éœ€è¦éƒ½å†™ä¸Š * @param sessionTimeout : è®¾ç½®è¶…æ—¶æ—¶é—´ * @param watcher : ç›‘è§†è€…å¯¹è±¡ï¼Œæœ¬ä¾‹å°±ç”¨è‡ªå·±äº†*/</span><span class="token class-name">ZooKeeper</span> zooKeeper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZooKeeper</span><span class="token punctuation">(</span><span class="token string">"182.92.159.117:2181,182.92.159.117:2182,182.92.159.117:2183"</span><span class="token punctuation">,</span><span class="token number">1500000</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">ZnodeDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>åˆ›å»ºä¸€ä¸ª Znode</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/*** @param path*                åˆ›å»ºèŠ‚ç‚¹çš„è·¯å¾„* @param data*                èŠ‚ç‚¹è¦å­˜æ”¾çš„æ•°æ®* @param acl*                è®¿é—®æ§åˆ¶åˆ—è¡¨* @param createMode*                ç±»å‹ï¼Œæ˜¯æŒä¹…çš„è¿˜æ˜¯çŸ­æš‚çš„ï¼Œæ˜¯å¦å³zookeeperè‡ªåŠ¨æ’åº*/</span> <span class="token class-name">String</span> path <span class="token operator">=</span> zooKeeper<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"/bjsxt/test"</span><span class="token punctuation">,</span> <span class="token string">"zs"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">ZooDefs<span class="token punctuation">.</span>Ids</span><span class="token punctuation">.</span>OPEN_ACL_UNSAFE<span class="token punctuation">,</span> <span class="token class-name">CreateMode</span><span class="token punctuation">.</span>EPHEMERAL_SEQUENTIAL<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å›ç±»å‹æ˜¯ä¸ªåœ°å€ï¼Œæˆ‘ä»¬è¾“å‡ºä¸€ä¸‹</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>è·å– Znode ä¸­çš„æ•°æ®</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// è·å–æŒ‡å®šèŠ‚ç‚¹çš„å€¼</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data <span class="token operator">=</span> zooKeeper<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ZnodeDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Stat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>è·å–æ‰€æœ‰å­—èŠ‚ä¸­çš„æ•°æ®</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> children <span class="token operator">=</span> zooKeeper<span class="token punctuation">.</span><span class="token function">getChildren</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ZnodeDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token operator">-></span><span class="token punctuation">&#123;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data <span class="token operator">=</span> zooKeeper<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">"/"</span> <span class="token operator">+</span> child<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ZnodeDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Stat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">KeeperException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>è®¾ç½® Znode ä¸­çš„å€¼</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è®¾ç½® Znode ä¸­çš„å€¼</span><span class="token class-name">Stat</span> stat <span class="token operator">=</span> zooKeeper<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token string">"/bjsxt/test0000000001"</span><span class="token punctuation">,</span><span class="token string">"bjsxt"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stat<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>åˆ é™¤ Znode</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">zooKeeper<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">"/bjsxt/test0000000001"</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="åŸºäº-RMI-å®ç°è¿œç¨‹æ–¹æ³•è°ƒç”¨"><a href="#åŸºäº-RMI-å®ç°è¿œç¨‹æ–¹æ³•è°ƒç”¨" class="headerlink" title="åŸºäº RMI å®ç°è¿œç¨‹æ–¹æ³•è°ƒç”¨"></a>åŸºäº RMI å®ç°è¿œç¨‹æ–¹æ³•è°ƒç”¨</h2></li></ul></li><li><p>RMI ä»‹ç»</p><blockquote><p>RMI(Remote Method Invocation) è¿œç¨‹æ–¹æ³•è°ƒç”¨<br>RMI æ˜¯ jdk1.2 æ¨å‡ºçš„åŠŸèƒ½ï¼Œå®ƒå¯ä»¥å®ç°ä¸€ä¸ª Java åº”ç”¨åƒè°ƒç”¨æœ¬åœ°é¡¹ç›®æ–¹æ³•ä¸€æ ·è°ƒç”¨å¦ä¸€ä¸ªæœåŠ¡å™¨ Java åº”ç”¨ä¸­çš„æ–¹æ³•<br><strong>RMI æ˜¯ Java è¯­è¨€çš„è¿œç¨‹è°ƒç”¨ï¼Œæ— æ³•å®ç°è·¨è¯­è¨€</strong></p></blockquote></li><li><p>æ‰§è¡Œæµç¨‹<br><img src="https://s1.ax1x.com/2020/07/31/alW3v9.png" alt="RMIæ‰§è¡Œæµç¨‹"></p><blockquote><p>Registry(æ³¨å†Œè¡¨)æ˜¯æ”¾ç½®æ‰€æœ‰æœåŠ¡å™¨å¯¹è±¡çš„å‘½åç©ºé—´ã€‚ æ¯æ¬¡æœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå®ƒéƒ½ä¼šä½¿ç”¨ bind()æˆ– rebind()æ–¹æ³•æ³¨å†Œè¯¥å¯¹è±¡ã€‚ è¿™äº›æ˜¯ä½¿ç”¨ç§°ä¸ºç»‘å®šåç§°çš„å”¯ä¸€åç§°æ³¨å†Œçš„ã€‚<br>è¦è°ƒç”¨è¿œç¨‹å¯¹è±¡ï¼Œå®¢æˆ·ç«¯éœ€è¦è¯¥å¯¹è±¡çš„å¼•ç”¨ã€‚å³é€šè¿‡æœåŠ¡ç«¯ç»‘å®šçš„åç§°ä»æ³¨å†Œè¡¨ä¸­è·å–å¯¹è±¡(lookup()æ–¹æ³•)ã€‚</p></blockquote></li><li><p>RMI æ¥å£ä»‹ç»</p></li></ol><ul><li><p>Remote æ¥å£</p><blockquote><p><code>java.rmi.Remote</code> å®šä¹‰äº†æ­¤æ¥å£ä¸ºè¿œç¨‹è°ƒç”¨æ¥å£ã€‚å¦‚æœæ¥å£è¢«å¤–éƒ¨è°ƒç”¨ï¼Œéœ€è¦ç»§æ‰¿æ­¤æ¥å£ã€‚</p></blockquote></li><li><p>RemoteException ç±»</p><blockquote><p><code>java.rmi.RemoteException</code> ç»§æ‰¿äº† Remote æ¥å£çš„æ¥å£ï¼Œå¦‚æœæ–¹æ³•æ˜¯å…è®¸è¢«è¿œç¨‹è°ƒç”¨çš„ï¼Œéœ€è¦æŠ›å‡ºæ­¤å¼‚å¸¸ã€‚</p></blockquote></li><li><p>UnicastRemoteObject ç±»</p><blockquote><p><code>java.rmi.server.UnicastRemoteObject</code> æ­¤ç±»å®ç°äº† Remote æ¥å£å’Œ Serializable æ¥å£ã€‚<strong>è‡ªå®šä¹‰æ¥å£å®ç°ç±»é™¤äº†å®ç°è‡ªå®šä¹‰æ¥å£è¿˜éœ€è¦ç»§æ‰¿æ­¤ç±»</strong>ã€‚</p></blockquote></li><li><p>LocateRegistry ç±»</p><blockquote><p><code>java.rmi.registry.LocateRegistry</code>å¯ä»¥é€šè¿‡ LocateRegistry åœ¨æœ¬æœºä¸Šåˆ›å»º Registryï¼Œé€šè¿‡ç‰¹å®šçš„ç«¯å£å°±å¯ä»¥è®¿é—®è¿™ä¸ª Registryã€‚</p></blockquote></li><li><p>Naming ç±»</p><blockquote><p><code>java.rmi.Naming</code>Naming å®šä¹‰äº†å‘å¸ƒå†…å®¹å¯è®¿é—® RMI åç§°ã€‚ä¹Ÿæ˜¯é€šè¿‡ Naming è·å–åˆ°æŒ‡å®šçš„è¿œç¨‹æ–¹æ³•ã€‚</p></blockquote></li></ul><ol start="4"><li>ä»£ç å®ç°</li></ol><ul><li><p>åˆ›å»º Server ç«¯</p><ul><li><p>åˆ›å»ºæ¥å£<br><img src="https://s1.ax1x.com/2020/07/31/al7YtI.png" alt="service"></p><ul><li>è¦ç»§æ‰¿<code>Rempte</code>æ¥å£ï¼Œå¹¶ä¸”è¯¥æ¥å£ä¸‹çš„æ‰€æœ‰è¢«è¿œç¨‹è°ƒç”¨çš„æ–¹æ³•è¦æŠ›å‡º<code>RemoteException</code>å¼‚å¸¸</li></ul></li><li><p>å®ç°æ¥å£<br><img src="https://s1.ax1x.com/2020/07/31/al7XjO.png" alt="å®ç°ç±»"></p><ul><li>å®ç° <code>Remote</code> æ¥å£çš„åŒæ—¶å¿…é¡»ç»§æ‰¿ <code>UnicastRemoteObject</code> ç±»</li></ul></li><li><p>åˆ›å»ºä¸»æ–¹æ³•<br><img src="https://s1.ax1x.com/2020/07/31/alHB26.png" alt="å¯åŠ¨ç±»"></p><ul><li>è¦å…ˆå®ä¾‹åŒ–å¯¹è±¡ï¼Œå†åˆ›å»ºæœ¬åœ°æ³¨å†Œè¡¨<code>LocateRegistry</code> å‚æ•°æ˜¯ç›‘å¬æœ¬åœ°çš„ç«¯å£ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰äººå»è®¿é—®è€… <code>Registry</code>ã€‚æœ€åç”¨ <code>Naming.bind</code> æŠŠæ³¨å†Œå†…å®¹å‘å¸ƒå‡ºå»ï¼Œå¯ä»¥ä¾›å…¶ä»– RMI è®¿é—®</li></ul></li></ul></li><li><p>åˆ›å»ºå®¢æˆ·ç«¯</p><ul><li>å¤åˆ¶æœåŠ¡ç«¯æ¥å£ï¼ŒåŒä¸Š</li><li>åˆ›å»ºä¸»æ–¹æ³•<br><img src="https://s1.ax1x.com/2020/07/31/alblod.png" alt="alblod.png"><ul><li>ä¸»æ–¹æ³•ä¸­ç”¨ Naming çš„ lookup æ–¹æ³•è®¿é—®é‚£ä¸ªåœ°å€ï¼ŒæŠŠè·å–åˆ°çš„å¯¹è±¡å¼ºè½¬å°±èƒ½è°ƒç”¨è¯¥å¯¹è±¡ä¸‹çš„æ–¹æ³•äº†</li></ul></li></ul></li></ul><h2 id="åŸºäº-Zookeeper-å®ç°è¿œç¨‹æ–¹æ³•è°ƒç”¨"><a href="#åŸºäº-Zookeeper-å®ç°è¿œç¨‹æ–¹æ³•è°ƒç”¨" class="headerlink" title="åŸºäº Zookeeper å®ç°è¿œç¨‹æ–¹æ³•è°ƒç”¨"></a>åŸºäº Zookeeper å®ç°è¿œç¨‹æ–¹æ³•è°ƒç”¨</h2><blockquote><p>é“ç†è·Ÿ RMI ä¸€æ ·ï¼Œæ–¹ä¾¿äº†ç«¯å£çš„å¯»æ‰¾ï¼ŒæœåŠ¡ç«¯å°†æš´éœ²å‡ºæ¥çš„ç«¯å£ä¿¡æ¯æ”¾åˆ° Zookeeper çš„ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œå®¢æˆ·ç«¯å»è®¿é—®è¿™äº›èŠ‚ç‚¹ï¼Œè·å–åˆ° path åç”¨ Naming çš„ lookup è·å–å¯¹åº”çš„å¯¹è±¡ï¼Œå°±èƒ½ä½¿ç”¨è¿œç¨‹çš„æ–¹æ³•äº†</p></blockquote><ol><li><p>åˆ›å»ºæœåŠ¡ç«¯</p><ul><li><p>åˆ›å»ºé¡¹ç›®æ”¾å…¥ zookeeper ä¾èµ–</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.6.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åˆ›å»ºæ¥å£ï¼Œæ­¥éª¤ RMI ä¸€æ ·</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UsersService</span> <span class="token keyword">extends</span> <span class="token class-name">Remote</span> <span class="token punctuation">&#123;</span><span class="token class-name">String</span> <span class="token function">findUsers</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">RemoteException</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>åˆ›å»ºå®ç°ç±»ï¼Œæ­¥éª¤è·Ÿ RMI çš„ä¸€æ ·</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UsersServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">UnicastRemoteObject</span> <span class="token keyword">implements</span> <span class="token class-name">UsersService</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">public</span> <span class="token class-name">UsersServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">RemoteException</span> <span class="token punctuation">&#123;</span>   <span class="token punctuation">&#125;</span>   <span class="token annotation punctuation">@Override</span>   <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">findUsers</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">RemoteException</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">return</span> <span class="token string">"Hello Zookeeper "</span><span class="token operator">+</span>str<span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ä¸»æ–¹æ³•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServerDemo</span> <span class="token keyword">implements</span> <span class="token class-name">Watcher</span> <span class="token punctuation">&#123;</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span><span class="token class-name">AlreadyBoundException</span><span class="token punctuation">,</span> <span class="token class-name">KeeperException</span><span class="token punctuation">,</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">&#123;</span>   <span class="token comment">// newå‡ºè¦æš´éœ²çš„å¯¹è±¡</span>   <span class="token class-name">UsersService</span> usersService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsersServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// å¼€å¯æœ¬åœ°ç›‘å¬8888</span>   <span class="token class-name">LocateRegistry</span><span class="token punctuation">.</span><span class="token function">createRegistry</span><span class="token punctuation">(</span><span class="token number">8888</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// è®¾ç½®url</span>   <span class="token class-name">String</span> url <span class="token operator">=</span><span class="token string">"rmi://localhost:8888/user"</span><span class="token punctuation">;</span>   <span class="token comment">// Naming ç»‘å®šä»–ä»¬</span>   <span class="token class-name">Naming</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>usersService<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// åˆ›å»ºZookeeperå¯¹è±¡</span>   <span class="token class-name">ZooKeeper</span> zooKeeper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZooKeeper</span><span class="token punctuation">(</span><span class="token string">"182.92.159.117:2181,182.92.159.117:2182,182.92.159.117:2183"</span><span class="token punctuation">,</span><span class="token number">150000</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">ServerDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// æŠŠurlä¿¡æ¯æ”¾å…¥åˆ°zookeeperèŠ‚ç‚¹ä¸­</span>   zooKeeper<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"/bjsxt/service"</span><span class="token punctuation">,</span>url<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">ZooDefs<span class="token punctuation">.</span>Ids</span><span class="token punctuation">.</span>OPEN_ACL_UNSAFE<span class="token punctuation">,</span><span class="token class-name">CreateMode</span><span class="token punctuation">.</span>PERSISTENT<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// æ‰“å°æœåŠ¡å‘å¸ƒæˆåŠŸ</span>   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æœåŠ¡å‘å¸ƒæˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li><li><p>åˆ›å»ºå®¢æˆ·ç«¯</p><ul><li><p>åˆ›å»ºé¡¹ç›®æ”¾å…¥ zookeeper ä¾èµ–</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>zookeeper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.6.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>åˆ›å»ºæ¥å£</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UsersService</span> <span class="token punctuation">&#123;</span>  <span class="token class-name">String</span> <span class="token function">findUsers</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>åˆ›å»ºä¸»æ–¹æ³•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/* è¦ä½¿ç”¨zookeeperï¼Œéœ€è¦ä¸€ä¸ªwatcherç›‘æ§ï¼Œæœ¬ä¾‹å°±ç”¨è‡ªå·±ã€‚ è¦é‡å†™processæ–¹æ³•*/</span> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClientDemo</span> <span class="token keyword">implements</span> <span class="token class-name">Watcher</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span><span class="token class-name">KeeperException</span><span class="token punctuation">,</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">,</span><span class="token class-name">NotBoundException</span><span class="token punctuation">&#123;</span>     <span class="token comment">// åˆ›å»ºzookeeperå¯¹è±¡</span>     <span class="token class-name">ZooKeeper</span> zooKeeper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZooKeeper</span><span class="token punctuation">(</span><span class="token string">"182.92.159.117:2181,182.92.159.117:2182,182.92.159.117:2183"</span><span class="token punctuation">,</span><span class="token number">150000</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">ClientDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// ä»zookeeperä¸Šè·å–èŠ‚ç‚¹ä¿¡æ¯ï¼Œæ˜¯å­—èŠ‚æ•°ç»„</span>     <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> zooKeeper<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token string">"/bjsxt/service"</span><span class="token punctuation">,</span><span class="token function">newClientDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// å­—èŠ‚æ•°ç»„è½¬æ¢æˆå­—ç¬¦ä¸²</span>     <span class="token class-name">String</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// é€šè¿‡Namingç±»çš„lookupæ–¹æ³•è·å–åˆ°å¯¹è±¡</span>     <span class="token class-name">UsersService</span> usersService <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UsersService</span><span class="token punctuation">)</span><span class="token class-name">Naming</span><span class="token punctuation">.</span><span class="token function">lookup</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// è°ƒç”¨è¿œç¨‹çš„æ–¹æ³•</span>     <span class="token class-name">String</span> result <span class="token operator">=</span> usersService<span class="token punctuation">.</span><span class="token function">findUsers</span><span class="token punctuation">(</span><span class="token string">"zhy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// è¾“å‡ºç»“æœ</span>     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token comment">/*     å®ç°Watcheræ¥å£è¦é‡å†™çš„æ–¹æ³•     ç”¨äºç›‘å¬zookeeperæ˜¯å¦è¿æ¥æˆåŠŸï¼Œå¯ä»¥è¿›ä¸€æ­¥æ“ä½œ   */</span>   <span class="token annotation punctuation">@Override</span>   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token class-name">WatchedEvent</span> event<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">if</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Event<span class="token punctuation">.</span>KeeperState<span class="token punctuation">.</span>SyncConnected</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¿æ¥æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> Zookeeper </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼æŠ€æœ¯ </tag>
            
            <tag> Zookeeper </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>rediså­¦ä¹ </title>
      <link href="2020/07/04/redis-xue-xi/"/>
      <url>2020/07/04/redis-xue-xi/</url>
      
        <content type="html"><![CDATA[<p><strong>å†™åœ¨å‰</strong>ï¼šå­¦ä¹ ç¬”è®°æ˜¯ç»“åˆå°šå­¦å ‚çš„è¯¾ç¨‹å’Œç‹‚ç¥çš„redisè¯¾ç¨‹å†™çš„ï¼Œç‹‚ç¥çš„è§†é¢‘åœ°å€ï¼š<a href="https://www.bilibili.com/video/BV1S54y1R7SB?p=1">https://www.bilibili.com/video/BV1S54y1R7SB?p=1</a></p><h1 id="rediså­¦ä¹ "><a href="#rediså­¦ä¹ " class="headerlink" title="rediså­¦ä¹ "></a>rediså­¦ä¹ </h1><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p><img src="https://s1.ax1x.com/2020/07/04/NxbaA1.png" alt="ç»å…¸"><br>åœ¨ä»¥å‰ä¸€ä¸ªåŸºæœ¬çš„ç½‘ç«™è®¿é—®é‡ä¸ä¼šå¤ªå¤§ï¼Œå•ä¸ªæ•°æ®åº“å®Œå…¨è¶³å¤Ÿäº†</p><p><img src="https://s1.ax1x.com/2020/07/04/NxqcxU.png" alt="ç¼“å­˜"><br>æˆ‘ä»¬å¸Œæœ›å»å‡è½»æ•°æ®çš„å‹åŠ›ï¼Œå¯ä»¥ç”¨ç¼“å­˜æ¥ä¿è¯æ•ˆç‡</p><h2 id="NoSQL"><a href="#NoSQL" class="headerlink" title="NoSQL"></a>NoSQL</h2><h3 id="NoSQLæ¦‚è¿°"><a href="#NoSQLæ¦‚è¿°" class="headerlink" title="NoSQLæ¦‚è¿°"></a>NoSQLæ¦‚è¿°</h3><blockquote><p>NoSQL = not only sql<br>éå…³ç³»å‹æ•°æ®åº“<br>éšç€äº’è”ç½‘web2.0ç½‘ç«™çš„å…´èµ·ï¼Œä¼ ç»Ÿçš„å…³ç³»æ•°æ®åº“åœ¨å¤„ç†web2.0ç½‘ç«™ï¼Œç‰¹åˆ«æ˜¯è¶…å¤§è§„æ¨¡å’Œé«˜å¹¶å‘çš„SNSç±»å‹çš„web2.0çº¯åŠ¨æ€ç½‘ç«™å·²ç»æ˜¾å¾—åŠ›ä¸ä»å¿ƒï¼Œå‡ºç°äº†å¾ˆå¤šéš¾ä»¥å…‹æœçš„é—®é¢˜ï¼Œè€Œéå…³ç³»å‹çš„æ•°æ®åº“åˆ™ç”±äºå…¶æœ¬èº«çš„ç‰¹ç‚¹å¾—åˆ°äº†éå¸¸è¿…é€Ÿçš„å‘å±•ã€‚NoSQLæ•°æ®åº“çš„äº§ç”Ÿå°±æ˜¯ä¸ºäº†è§£å†³å¤§è§„æ¨¡æ•°æ®é›†åˆå¤šé‡æ•°æ®ç§ç±»å¸¦æ¥çš„æŒ‘æˆ˜ï¼Œå°¤å…¶æ˜¯å¤§æ•°æ®åº”ç”¨éš¾é¢˜ã€‚Rediså°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚</p></blockquote><h3 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><ul><li>æ–¹ä¾¿æ‹“å±•ï¼ˆæ•°æ®ä¹‹é—´æ²¡æœ‰å…³ç³»ï¼Œå¾ˆå¥½æ‹“å±•ï¼‰</li><li>å¤§é‡æ•°æ®é«˜æ€§èƒ½ï¼ˆRedisä¸€ç§’å†™8wæ¬¡ï¼Œè¯»å–11wï¼Œæ€§èƒ½é«˜)</li><li>æ•°æ®åº“ç±»å‹æ˜¯å¤šæ ·æ€§çš„ï¼ˆä¸éœ€è¦è®¾è®¡æ•°æ®åº“ï¼Œéšå–éšç”¨ï¼‰</li><li>ä¼ ç»Ÿçš„RDBMSå’ŒNoSQL  <pre class="line-numbers language-none"><code class="language-none">ä¼ ç»Ÿçš„RDBMS- ç»“æ„åŒ–ç»„ç»‡- SQL- æ•°æ®å’Œå…³ç³»éƒ½å­˜åœ¨å•ç‹¬çš„è¡¨ä¸­- æ“ä½œæ•°æ®å®šä¹‰è¯­è¨€- ä¸¥æ ¼çš„ä¸€è‡´æ€§- åŸºç¡€çš„äº‹åŠ¡<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>  <pre class="line-numbers language-none"><code class="language-none">NoSQL- ä¸ä»…ä»…æ˜¯æ•°æ®- æ²¡æœ‰å›ºå®šçš„æŸ¥è¯¢è¯­è¨€- é”®å€¼å¯¹å­˜å‚¨ï¼Œåˆ—å­˜å‚¨ï¼Œæ–‡æ¡£å­˜å‚¨ï¼Œï¼Œï¼Œå›¾åƒæ•°æ®åº“ï¼Œç¤¾äº¤å…³ç³»- æœ€ç»ˆä¸€è‡´æ€§- CAPå®šç†å’ŒBASEï¼ˆå¼‚åœ°å¤šæ´»ï¼‰- é«˜æ€§èƒ½ï¼Œé«˜å¯ç”¨ï¼Œé«˜å¯æ‰©<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»"></a>åˆ†ç±»</h3></li><li>KVé”®å€¼å¯¹<ul><li>redis</li><li>tair</li><li>memecache</li></ul></li><li>æ–‡æ¡£å‹æ•°æ®åº“ï¼ˆbsonæ ¼å¼å’Œjsonæ ¼å¼ï¼‰<ul><li>mongoDB</li></ul></li><li>åˆ—å­˜å‚¨æ•°æ®åº“<ul><li>HBase</li><li>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ</li></ul></li><li>å›¾å…³ç³»æ•°æ®åº“<ul><li>Neo4j</li><li>InfoGrid</li></ul></li></ul><h2 id="Rediså…¥é—¨"><a href="#Rediså…¥é—¨" class="headerlink" title="Rediså…¥é—¨"></a>Rediså…¥é—¨</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><blockquote><p>ä»‹ç»  </p></blockquote><p>Redisï¼ˆRemote Dictionary Server )ï¼Œå³è¿œç¨‹å­—å…¸æœåŠ¡ï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€Key-Valueæ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚</p><blockquote><p>ç”¨é€”</p></blockquote><ul><li>å†…å­˜å­˜å‚¨ï¼ŒæŒä¹…åŒ–ï¼ˆrdbï¼Œaofï¼‰</li><li>æ•ˆç‡é«˜ï¼Œå¯ä»¥ç”¨äºé«˜é€Ÿç¼“å­˜</li><li>å‘å¸ƒè®¢é˜…ç³»ç»Ÿ</li><li>åœ°å›¾ä¿¡æ¯åˆ†æ</li><li>è®¡æ—¶å™¨ï¼Œè®¡æ•°å™¨ï¼Œæµè§ˆé‡</li><li>â€¦â€¦</li></ul><blockquote><p>ç‰¹æ€§</p></blockquote><ul><li>å¤šæ ·çš„æ•°æ®ç±»å‹</li><li>æŒä¹…åŒ–</li><li>é›†ç¾¤</li><li>äº‹åŠ¡</li><li>â€¦â€¦<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3>å®˜ç½‘ä¸‹è½½å¥½.tar.gzå‹ç¼©åŒ…ï¼Œæ”¾å…¥~ç›®å½•ä¸­  </li></ul><blockquote><p>è§£å‹.tar.gz  </p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> -zxvf redis<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/07/05/US6fpR.png" alt="è§£å‹"></p><blockquote><p>éœ€è¦å®‰è£…gcc  </p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum <span class="token function">install</span> -y gcc-c++<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>ç¼–è¯‘ redisï¼Œè¿›å…¥è§£å‹å®Œæˆçš„ç›®å½•ä¸­  </p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#è¿›å…¥æ ¹ç›®å½•æ‰§è¡Œ</span><span class="token function">make</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>å®‰è£… redisï¼Œåœ¨æ ¹ç›®å½•ä¸­æ‰§è¡Œ  </p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">make</span> <span class="token function">install</span> <span class="token assign-left variable">PREFIX</span><span class="token operator">=</span>/usr/local/redis<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>è¿˜åœ¨è¿™ä¸ªæ ¹ç›®å½•ä¸­ï¼ŒæŠŠredis.confå¤åˆ¶åˆ°/usr/local/redis/binä¸­  </p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> redis.conf /usr/local/redis/bin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>ä¿®æ”¹redis.confä¸­çš„å†…å®¹</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /usr/local/redis/bin<span class="token function">vim</span> redis.conf<span class="token comment"># 1ã€ä¿®æ”¹</span><span class="token builtin class-name">bind</span> <span class="token number">127.0</span>.0.1 ä¸ºbind <span class="token number">0.0</span>.0.0<span class="token comment"># 2ã€ä¿®æ”¹daemonize</span>daemonize no æ”¹ä¸º daemonize <span class="token function">yes</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å»usr/local/redis/binä¸­åå°å¯åŠ¨redis  </p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./redis-server redis.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="æµ‹è¯•æ€§èƒ½"><a href="#æµ‹è¯•æ€§èƒ½" class="headerlink" title="æµ‹è¯•æ€§èƒ½"></a>æµ‹è¯•æ€§èƒ½</h3><p><strong>redis-benchmark</strong>æ˜¯å®˜æ–¹è‡ªå¸¦çš„æµ‹è¯•æ€§èƒ½çš„å·¥å…·ï¼Œåœ¨binç›®å½•ä¸­<br><img src="https://s1.ax1x.com/2020/07/04/NzEA3D.png" alt="å‚æ•°é…ç½®"></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment">#æµ‹è¯•100ä¸ªå¹¶å‘è¿æ¥ï¼Œ10wè¯·æ±‚</span>redis-benchmark -h localhost -p <span class="token number">6379</span> -c <span class="token number">100</span> -n <span class="token number">100000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/07/04/NzAvjJ.png" alt="æµ‹è¯•å›¾"></p><h3 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h3><p>redisé»˜è®¤æœ‰16ä¸ªæ•°æ®åº“ï¼ˆ0-15ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨<code>select num</code>è¿›è¡Œåˆ‡æ¢</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token keyword">select</span> <span class="token number">2</span> <span class="token comment">#åˆ‡æ¢æ•°æ®åº“</span>OK<span class="token number">127.0</span>.0.1:6379<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token keyword">select</span> <span class="token number">0</span>OK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æŸ¥çœ‹æ•°æ®åº“å¤§å°ï¼š<code>dbsize</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> dbsize <span class="token comment"># æŸ¥çœ‹æ•°æ®åº“å¤§å°</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ·»åŠ é”®å€¼å¯¹ï¼š<code>set key value</code>å’Œ<code>get key</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> name zhy <span class="token comment"># æ·»åŠ å€¼</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> dbsize<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get name <span class="token comment"># è·å–å€¼</span><span class="token string">"zhy"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸‹çš„æ‰€æœ‰é”®ï¼š<code>keys *</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> keys * <span class="token comment">#æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸‹çš„æ‰€æœ‰é”®</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"name"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"mylist"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"counter:__rand_int__"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"key:__rand_int__"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¸…ç©ºæ•°æ®åº“ï¼š<code>flushdb</code>å’Œ<code>flushall</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> flushdb <span class="token comment">#æ¸…ç©ºå½“å‰æ•°æ®åº“</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> flushall <span class="token comment"># æ¸…ç©ºæ‰€æœ‰æ•°æ®åº“</span>OK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p><strong>Redisæ˜¯å•çº¿ç¨‹çš„</strong>  </p></blockquote><p>Redisæ˜¯åŸºäºå†…å­˜æ“ä½œçš„ï¼ŒCPUä¸æ˜¯Redisçš„ç“¶é¢ˆï¼Œè€Œæ˜¯æœºå™¨å†…å­˜å’Œç½‘ç»œå¸¦å®½ã€‚<br>Redis6.0ä»¥åå¥½åƒæœ‰äº†å¤šçº¿ç¨‹çš„åŠŸèƒ½</p><h3 id="Redis-Key"><a href="#Redis-Key" class="headerlink" title="Redis-Key"></a>Redis-Key</h3><blockquote><p>è¿™äº›å¸¸ç”¨æŒ‡ä»¤è¦ç†Ÿè®°ï¼Œåœ¨javaä¸­ä¹Ÿæ˜¯è¿™äº›</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> keys * <span class="token comment">#æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„æ‰€æœ‰key</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"name"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> exists name <span class="token comment">#åˆ¤æ–­å½“å‰keyæ˜¯å¦å­˜åœ¨</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span> <span class="token comment">#å­˜åœ¨æ—¶è¿”å›1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> exists qwe<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> move name <span class="token number">1</span> <span class="token comment">#ç§»åŠ¨å½“å‰keyåˆ°å…¶ä»–æ•°æ®åº“</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> keys *<span class="token punctuation">(</span>empty list or <span class="token builtin class-name">set</span><span class="token punctuation">)</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> name zhy <span class="token comment">#è®¾ç½®ä¸€ä¸ªkey value</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> age <span class="token number">20</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get name <span class="token comment">#è·å–keyçš„value</span><span class="token string">"zhy"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> expire name <span class="token number">10</span> <span class="token comment">#è®¾ç½®æœ‰æ•ˆæ—¶é•¿ï¼Œå•ä½second</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> ttl name <span class="token comment">#æŸ¥çœ‹keyçš„å‰©ä½™æ—¶é•¿</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">5</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> ttl name <span class="token comment"># keyè¿‡æœŸåæ—¶é•¿ä¸º-2</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> -2<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get name<span class="token punctuation">(</span>nil<span class="token punctuation">)</span> <span class="token comment">#è¿‡æœŸåè·å–ä¸åˆ°äº†</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæœ‰ä¸ä¼šçš„å‘½ä»¤å¯ä»¥å»<a href="http://www.redis.cn/commands.html">redisä¸­æ–‡ç½‘</a>æŸ¥çœ‹å­¦ä¹ </p><h3 id="stringç±»å‹"><a href="#stringç±»å‹" class="headerlink" title="stringç±»å‹"></a>stringç±»å‹</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> key1 v1 <span class="token comment"># è®¾ç½®å€¼</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get key1 <span class="token comment"># è·å¾—å€¼</span><span class="token string">"v1"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> keys * <span class="token comment"># è·å–æ‰€æœ‰çš„key</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"key1"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> exists key1 <span class="token comment"># åˆ¤æ–­æ˜¯å¦å­˜åœ¨</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> append key1 hello <span class="token comment"># è¿½åŠ å­—ç¬¦ä¸²</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">7</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get key1 <span class="token string">"v1hello"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> append name zs <span class="token comment"># å¦‚æœå½“å‰keyä¸å­˜åœ¨ï¼Œå°±ä¼šæ–°å»ºä¸€ä¸ªkey</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> strlen key1 <span class="token comment"># è·å–å­—ç¬¦ä¸²é•¿åº¦</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">7</span><span class="token comment">###########################################################</span><span class="token comment">#è‡ªå¢å’Œè‡ªå‡ï¼šincr/decr/incrby/decrby</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> views <span class="token number">0</span> <span class="token comment"># åˆå§‹æµè§ˆé‡ä¸º0</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get views<span class="token string">"0"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> incr views <span class="token comment"># è‡ªå¢1</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> incr views<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get views<span class="token string">"2"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> decr views <span class="token comment"># è‡ªå‡1</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> decr views<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get views<span class="token string">"0"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> incrby views <span class="token number">10</span> <span class="token comment"># è®¾ç½®å¢é•¿å€¼</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">10</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> decrby views <span class="token number">5</span> <span class="token comment"># è®¾ç½®è‡ªå‡å€¼</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">5</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get views<span class="token string">"5"</span><span class="token comment">###########################################################</span><span class="token comment">#å­—ç¬¦ä¸²èŒƒå›´ï¼šgetrange key start end</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> key hello,redis <span class="token comment"># è®¾ç½®keyå€¼</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get key<span class="token string">"hello,redis"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> getrange key <span class="token number">2</span> <span class="token number">6</span> <span class="token comment"># æˆªå–å­—ç¬¦ä¸² [2,6]</span><span class="token string">"llo,r"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> getrange key <span class="token number">0</span> -1 <span class="token comment"># ç›´æ¥è¿”å›å…¨éƒ¨å­—ç¬¦ä¸²ï¼Œæœ‰çš„pythonçš„å‘³é“</span><span class="token string">"hello,redis"</span><span class="token comment">#æ›¿æ¢ï¼šsetrange key start string</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> key2 abcdefg <span class="token comment"># è®¾ç½®å€¼</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get ket2<span class="token punctuation">(</span>nil<span class="token punctuation">)</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get key2<span class="token string">"abcdefg"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> setrange key2 <span class="token number">1</span> xxx æ›¿æ¢æŒ‡å®šä½ç½®å¼€å§‹çš„å­—ç¬¦ä¸²<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">7</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get key2<span class="token string">"axxxefg"</span><span class="token comment"># del åˆ é™¤</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get k2<span class="token string">"v2"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> del k2 <span class="token comment"># åˆ é™¤æŒ‡å®šçš„key</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get k2<span class="token punctuation">(</span>nil<span class="token punctuation">)</span><span class="token comment">###########################################################</span><span class="token comment"># setex (set with expire)  è®¾ç½®è¿‡æœŸæ—¶é—´</span><span class="token comment"># setnx (set if not exist)  ä¸å­˜åœ¨è®¾ç½®ï¼Œï¼Œå¸¸å¸¸ç”¨äºåˆ†å¸ƒå¼é”ä¸­</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> setex key3 <span class="token number">30</span> hello <span class="token comment"># è®¾ç½®key3çš„å€¼30ç§’åè¿‡æœŸ</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> ttl key3 <span class="token comment"># æŸ¥çœ‹key3å‰©ä½™æ—¶é—´</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">20</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> setnx mykey redis <span class="token comment">#å¦‚æœmykeyä¸å­˜åœ¨ï¼Œåˆ›å»ºå¹¶è®¾ç½®</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> setnx mykey mysql <span class="token comment"># å› ä¸ºmykeyå­˜åœ¨äº†ï¼Œæ‰€ä»¥ä¸æˆåŠŸ</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get mykey<span class="token string">"redis"</span><span class="token comment">###########################################################</span><span class="token comment">#mset</span><span class="token comment">#mget</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> mset k1 v1 k2 v2 k3 v3 <span class="token comment"># åŒæ—¶è®¾ç½®å¤šä¸ªå€¼</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> keys *<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"k3"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"k1"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"k2"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> mget k1 k2 k3 <span class="token comment"># åŒæ—¶è·å–å¤šä¸ªå€¼</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"v1"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"v2"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v3"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> msetnx k1 v1 k4 v4 <span class="token comment"># msetnxæ˜¯åŸå­æ€§æ“ä½œï¼Œä¸€èµ·æˆåŠŸæˆ–ä¸€èµ·å¤±è´¥</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> keys *<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"k3"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"k1"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"k2"</span><span class="token comment">###########################################################</span><span class="token comment"># å¯¹è±¡</span><span class="token builtin class-name">set</span> user:1 <span class="token punctuation">&#123;</span>name:zhangsan,age:3<span class="token punctuation">&#125;</span> <span class="token comment">#è®¾ç½®ä¸€ä¸ªuser:1å¯¹è±¡å€¼ä¸ºjsonå­—ç¬¦ä¸²ä¿å­˜</span><span class="token comment"># è¿™é‡Œçš„keyæ˜¯ user:&#123;id&#125;:&#123;field&#125;ï¼Œåœ¨redisä¸­å®Œå…¨ok</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> mset user:10001:name zhangsan user:10001:age <span class="token number">20</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> mget user:10001:name user:10001:age<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"zhangsan"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"20"</span><span class="token comment">###########################################################</span><span class="token comment">#getset  å…ˆgetå†set</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> getset db mysql <span class="token comment">#å¦‚æœä¸å­˜åœ¨å€¼ï¼Œåˆ™è¿”å›nilï¼Œå¹¶è®¾ç½®</span><span class="token punctuation">(</span>nil<span class="token punctuation">)</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> getset db redis <span class="token comment">#å¦‚æœå­˜åœ¨ï¼Œè·å–å¹¶è®¾ç½®æ–°çš„å€¼</span><span class="token string">"mysql"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get db<span class="token string">"redis"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ä½¿ç”¨åœºæ™¯</p></blockquote><ul><li>è®¡æ•°å™¨</li><li>ç»Ÿè®¡å¤šå•ä½çš„æ•°é‡</li></ul><h3 id="listç±»å‹"><a href="#listç±»å‹" class="headerlink" title="listç±»å‹"></a>listç±»å‹</h3><p>åœ¨redisä¸­listå¯ä»¥è¢«ç©æˆæ ˆï¼Œé˜Ÿåˆ—ç­‰ç­‰<br><img src="https://s1.ax1x.com/2020/07/04/NzwZY6.png" alt="åŒå‘é“¾è¡¨"><br>æ‰€æœ‰listå‘½ä»¤éƒ½æ˜¯ä»¥<code>l</code>å¼€å¤´çš„</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">###########################################################</span><span class="token comment"># lpush å·¦æ’å…¥</span><span class="token comment"># rpush å³æ’å…¥</span><span class="token comment"># lrange æ ¹æ®åŒºé—´å–å€¼</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lpush list <span class="token number">1</span> <span class="token comment">#å°†ä¸€ä¸ªå€¼æˆ–è€…å¤šä¸ªå€¼ï¼Œæ’å…¥åˆ—è¡¨å¤´éƒ¨ï¼ˆå·¦ï¼‰</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lpush list <span class="token number">2</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lpush list <span class="token number">3</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrange list <span class="token number">0</span> -1 <span class="token comment">#è·å–æ‰€æœ‰å€¼</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrange list <span class="token number">0</span> <span class="token number">1</span> <span class="token comment">#æ ¹æ®startå’Œendè·å–å€¼</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> rpush list right å°†ä¸€ä¸ªå€¼æˆ–è€…å¤šä¸ªå€¼æ’å…¥åˆ°åˆ—è¡¨å°¾éƒ¨ï¼ˆå³ï¼‰<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrange list <span class="token number">0</span> -1<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"right"</span><span class="token comment">###########################################################</span><span class="token comment"># lpop  å·¦ç§»é™¤ç¬¬ä¸€ä¸ª</span><span class="token comment"># rpop  å³ç§»é™¤ç¬¬ä¸€ä¸ª</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrange list <span class="token number">0</span> -1<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"right"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lpop list <span class="token comment"># å·¦ç§»é™¤ç¬¬ä¸€ä¸ª</span><span class="token string">"3"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> rpop list <span class="token comment"># å³ç§»é™¤ç¬¬ä¸€ä¸ª</span><span class="token string">"right"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrange list <span class="token number">0</span> -1<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token comment">###########################################################</span><span class="token comment"># lindex é€šè¿‡ä¸‹æ ‡è·å–å€¼</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lindex list <span class="token number">1</span> <span class="token comment">#è·å–ä¸‹æ ‡æ˜¯1çš„å€¼</span><span class="token string">"1"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lindex list <span class="token number">0</span><span class="token string">"2"</span><span class="token comment">###########################################################</span><span class="token comment"># llen è·å–åˆ—è¡¨çš„é•¿åº¦</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> llen list<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span><span class="token comment">###########################################################</span><span class="token comment"># lrem key num value  ç§»é™¤æŒ‡å®šçš„å€¼</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrange list <span class="token number">0</span> -1 <span class="token comment">#è·å–æ‰€æœ‰çš„å€¼</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"bbb"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"bbb"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"aaa"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"aaa"</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"aaa"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrem list <span class="token number">1</span> aaa <span class="token comment"># ç§»é™¤ä¸€ä¸ªaaaï¼Œå¹¶ä¸”æ˜¯ç¬¬ä¸€ä¸ª</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrange list <span class="token number">0</span> -1<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"bbb"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"bbb"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"aaa"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"aaa"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrem list <span class="token number">2</span> bbb <span class="token comment"># ç§»é™¤ä¸¤ä¸ªbbb</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrange list <span class="token number">0</span> -1<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"aaa"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"aaa"</span><span class="token comment">###########################################################</span><span class="token comment"># ltrim key start end æˆªå–ï¼Œè£æ–­ï¼Œå¹¶å‚¨å­˜åœ¨keyä¸­</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lpush list hello<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lpush list hello1<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lpush list hello2<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lpush list hello3<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> ltrim list <span class="token number">1</span> <span class="token number">2</span> <span class="token comment">#é€šè¿‡ä¸‹æ ‡æˆªå–æŒ‡å®šçš„å…ƒç´ ï¼Œlisté‡Œåªå‰©ä¸‹äº†æˆªå–çš„å…ƒç´ </span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrange list <span class="token number">0</span> -1<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"hello2"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"hello1"</span><span class="token comment">###########################################################</span><span class="token comment">#rpoplpush  ç§»é™¤åˆ—è¡¨å°¾éƒ¨çš„ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°çš„åˆ—è¡¨ä¸­</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lpush list hello<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lpush list hello1<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lpush list hello2<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get list2 <span class="token comment">#list2ä¸€å¼€å§‹ä¸å­˜åœ¨</span><span class="token punctuation">(</span>nil<span class="token punctuation">)</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> rpoplpush list list2 <span class="token comment"># ç§»é™¤å°¾éƒ¨ç¬¬ä¸€ä¸ªï¼Œæ”¾åˆ°list2çš„å¤´éƒ¨ï¼Œä¸å­˜åœ¨å°±åˆ›å»º</span><span class="token string">"hello"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrange list <span class="token number">0</span> -1<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"hello2"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"hello1"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrange list2 <span class="token number">0</span> -1<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"hello"</span><span class="token comment">###########################################################</span><span class="token comment"># lset ä¸€åˆ‡åŸºäºå­˜åœ¨çš„å‰æä¸‹æ“ä½œï¼ŒæŠŠä¸‹è§’æ ‡å¯¹åº”çš„å€¼æ›¿æ¢æ‰</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lpush list a<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> LRANGE list <span class="token number">0</span> -1<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"a"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> LSET list <span class="token number">0</span> bbbb <span class="token comment"># æŠŠä¸‹æ ‡æ˜¯0çš„å€¼æ›¿æ¢æ‰</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> LRANGE list <span class="token number">0</span> -1<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"bbbb"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> LSET list <span class="token number">1</span> bbbb <span class="token comment"># å¦‚æœä¸å­˜åœ¨å°±ä¼šæŠ¥é”™</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> ERR index out of range<span class="token comment">###########################################################</span><span class="token comment"># linsert key before/after value newValue  æŠŠæŸä¸ªå€¼æ’å…¥åˆ°æŸä¸ªå…ƒç´ çš„å‰é¢/åé¢</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrange list <span class="token number">0</span> -1<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"4"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> linsert list before <span class="token number">3</span> before <span class="token comment"># åœ¨3çš„å‰é¢æ’å…¥ä¸€ä¸ªbefore</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">5</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> linsert list after <span class="token number">3</span> after <span class="token comment"># åœ¨3çš„åé¢æ’å…¥ä¸€ä¸ªafter</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">6</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> lrange list <span class="token number">0</span> -1<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"4"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"before"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"after"</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token comment">###########################################################</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å°ç»“  </p></blockquote><ul><li>Listå®é™…ä¸Šæ˜¯ä¸€ä¸ªé“¾è¡¨ï¼ŒåŒå‘é“¾è¡¨ï¼Œbefore node after,left,right éƒ½å¯ä»¥æ’å…¥å€¼</li><li>å¦‚æœkeyä¸å­˜åœ¨å°±åˆ›å»ºæ–°çš„é“¾è¡¨</li><li>å¦‚æœkeyå­˜åœ¨ï¼Œæ–°å¢å†…å®¹</li><li>å¦‚æœç§»é™¤æ‰€æœ‰å€¼ï¼Œé“¾è¡¨å°±ä¸å­˜åœ¨äº†</li><li>åœ¨ä¸¤è¾¹æ’å…¥å’Œæ”¹åŠ¨å€¼æ•ˆç‡é«˜ï¼Œåœ¨ä¸­é—´æ’å…¥æ•ˆç‡ä½</li></ul><blockquote><p>ç”¨é€”</p></blockquote><ul><li>æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¶ˆæ¯æ’é˜Ÿ</li></ul><h3 id="setç±»å‹"><a href="#setç±»å‹" class="headerlink" title="setç±»å‹"></a>setç±»å‹</h3><p>setä¸­çš„å€¼æ˜¯å”¯ä¸€çš„ï¼Œæ— åºçš„</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">###########################################################</span><span class="token comment"># sadd key value æ·»åŠ setå€¼</span><span class="token comment"># smembers key  è·å–keyä¸­æ‰€æœ‰å€¼</span><span class="token comment"># sismembers key value  åˆ¤æ–­valueæ˜¯ä¸æ˜¯keyä¸­çš„</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> sadd myset hello <span class="token comment">#æ·»åŠ å€¼</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> sadd myset redis<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> sadd myset world<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> smembers myset <span class="token comment">#æŸ¥çœ‹æ‰€æœ‰å€¼</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"hello"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"world"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"redis"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> sismember myset hello <span class="token comment"># åˆ¤æ–­æ˜¯ä¸æ˜¯æˆå‘˜</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> sismember myset he<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token comment">###########################################################</span><span class="token comment"># scard key è·å–keyä¸­çš„å…ƒç´ ä¸ªæ•°</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> scard myset <span class="token comment">#è·å–ä¸ªæ•°</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span><span class="token comment">###########################################################</span><span class="token comment"># srem key value  ç§»é™¤å…ƒç´ </span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> srem myset hello<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token comment">###########################################################</span><span class="token comment"># srandmember key [num=1] éšæœºå–å‡ºæŒ‡å®šä¸ªæ•°çš„ï¼Œé»˜è®¤1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> smembers <span class="token builtin class-name">set</span> <span class="token comment">#æŸ¥çœ‹æ‰€æœ‰</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"4"</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"5"</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"6"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> srandmember <span class="token builtin class-name">set</span> <span class="token comment">#éšæœºå–ä¸€ä¸ª</span><span class="token string">"4"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> srandmember <span class="token builtin class-name">set</span><span class="token string">"1"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> srandmember <span class="token builtin class-name">set</span> <span class="token number">3</span> <span class="token comment"># éšæœºæŠ½å–æŒ‡å®šä¸ªæ•°çš„</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"6"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"4"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"5"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> srandmember <span class="token builtin class-name">set</span> <span class="token number">3</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"4"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token comment">###########################################################</span><span class="token comment"># spop key  éšæœºç§»é™¤ä¸€ä¸ª</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> smembers <span class="token builtin class-name">set</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"4"</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"5"</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"6"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> spop <span class="token builtin class-name">set</span> <span class="token comment"># éšæœºç§»é™¤ä¸€ä¸ª</span><span class="token string">"5"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> spop <span class="token builtin class-name">set</span><span class="token string">"4"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> smembers <span class="token builtin class-name">set</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"6"</span><span class="token comment">###########################################################</span><span class="token comment"># smove key1 key2 valueå°†ä¸€ä¸ªæŒ‡å®šçš„å€¼ç§»åŠ¨åˆ°å¦å¤–ä¸€ä¸ªkeyä¸­</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> smembers <span class="token builtin class-name">set</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> exists set3 <span class="token comment">#key3ä¸å­˜åœ¨</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> smove <span class="token builtin class-name">set</span> set3 <span class="token number">1</span> <span class="token comment">#å°†1ä»setç§»åŠ¨åˆ°key3</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> exists set3 <span class="token comment"># è‡ªåŠ¨åˆ›å»ºäº†key3</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> SMEMBERS <span class="token builtin class-name">set</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> SMEMBERS set3<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token comment">###########################################################</span><span class="token comment"># äº¤é›† intersection</span><span class="token comment"># å·®é›† Difference</span><span class="token comment"># å¹¶é›† Union</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> SMEMBERS user1<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> SMEMBERS user2<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"4"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"5"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> SDIFF user1 user2 <span class="token comment">#å·®é›† user1ä¸­æœ‰çš„user2ä¸­æ²¡æœ‰</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> SDIFF user2 user1 <span class="token comment">#å·®é›† user2ä¸­æœ‰çš„user1ä¸­æ²¡æœ‰</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"4"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"5"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> SINTER user1 user2 <span class="token comment">#äº¤é›†</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> SUNION user1 user2 <span class="token comment">#å¹¶é›†</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"2"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"3"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"4"</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"5"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥ç”¨äºåšå…±åŒå…³æ³¨çš„åŠŸèƒ½ï¼ŒæŠŠå¥½å‹ï¼Œå…³æ³¨éƒ½å°è£…åˆ°ä¸€ä¸ªsetä¸­ï¼Œå­˜å…¥redis</p><h3 id="hashç±»å‹"><a href="#hashç±»å‹" class="headerlink" title="hashç±»å‹"></a>hashç±»å‹</h3><p>Mapé›†åˆï¼Œkey-mapï¼Œè¿™æ—¶å€™çš„å€¼æ˜¯ä¸€ä¸ªmapï¼Œæœ¬è´¨ä¸stringç±»å‹æ²¡å¤ªå¤§åŒºåˆ«<br><strong>å¤§key å°key field</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">###########################################################</span><span class="token comment"># hset map key value æ·»åŠ å€¼</span><span class="token comment"># hget map key è·å–å€¼</span><span class="token comment"># hmset map key1 value1 key2 value2 ... æ·»åŠ å¤šä¸ªå€¼</span><span class="token comment"># hmget map key1 key2 ...  è·å–å¤šä¸ªå€¼</span><span class="token comment"># hmgetall è·å–æ‰€æœ‰ä¿¡æ¯ï¼Œä¸€é”®ä¸€å€¼å‡ºç°</span><span class="token comment"># hdel map key åˆ é™¤æŒ‡å®šçš„key</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hset myhash username zhangsan <span class="token comment">#æ·»åŠ å€¼</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hget myhash username <span class="token comment">#è·å–å€¼</span><span class="token string">"zhangsan"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hmset myhash age <span class="token number">20</span> sex <span class="token number">0</span> <span class="token comment">#æ·»åŠ å¤šä¸ª</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hmget myhash username age sex <span class="token comment">#è·å–å¤šä¸ª</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"zhangsan"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"20"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"0"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hgetall myhash <span class="token comment">#è·å–æ‰€æœ‰ä¿¡æ¯ï¼Œä¸€é”®ä¸€å€¼å‡ºç°</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"username"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"zhangsan"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"age"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"20"</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"sex"</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"0"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hdel myhash sex <span class="token comment">#åˆ é™¤æŒ‡å®šçš„key</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hgetall myhash<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"username"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"zhangsan"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"age"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"20"</span><span class="token comment">###########################################################</span><span class="token comment"># hlen map  è·å–è¡¨çš„keyæ•°é‡</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hlen myhash<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span><span class="token comment">###########################################################</span><span class="token comment"># hexists map key åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hexists myhash username<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token comment">###########################################################</span><span class="token comment"># hvals map åªè·å¾—æ‰€æœ‰çš„value</span><span class="token comment"># hkeys map åªè·å¾—æ‰€æœ‰çš„key</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hkeys myhash <span class="token comment">#è·å–æ‰€æœ‰key</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"username"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"age"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hvals myhash <span class="token comment">#è·å–æ‰€æœ‰value</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"zhangsan"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"20"</span><span class="token comment">###########################################################</span><span class="token comment"># hincr è‡ªå¢ hincrby æŒ‡å®šè‡ªå¢</span><span class="token comment"># hdecr è‡ªå‡ hincrby æŒ‡å®šè‡ªå‡</span><span class="token comment"># hsetnx å¦‚æœä¸å­˜åœ¨åˆ›å»ºï¼Œå­˜åœ¨å°±ä¸åˆ›å»º</span><span class="token comment"># ...å¯ä»¥å»stringç±»å‹é‡ŒæŸ¥æ‰¾</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hsetnx myhash num <span class="token number">1</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hsetnx myhash num <span class="token number">1</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hincrby myhash num <span class="token number">5</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">6</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> hincrby myhash num -25<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> -19<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å°ç»“  </p></blockquote><p>hashé€‚åˆå­˜å‚¨ç»å¸¸å˜æ›´çš„æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·å¯¹è±¡ï¼Œusername,ageä»€ä¹ˆçš„ï¼Œ<code>hset user:100001 username zhangsan age 20</code>ï¼Œstringæ›´é€‚åˆå­˜å‚¨å­—ç¬¦ä¸²</p><h3 id="zsetç±»å‹"><a href="#zsetç±»å‹" class="headerlink" title="zsetç±»å‹"></a>zsetç±»å‹</h3><p>åœ¨setçš„åŸºç¡€ä¸Šå¢åŠ äº†ä¸€ä¸ªå€¼ï¼Œç”¨äºæ’åº<br>æ ¼å¼æ˜¯ï¼š<strong>key weight value</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">###########################################################</span><span class="token comment"># zadd key weight value key2 weight value2 æ·»åŠ </span><span class="token comment"># zRange key start end éå† ä»å°åˆ°å¤§</span><span class="token comment"># zRevRange key start end ä»å¤§åˆ°å°</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> zadd zset <span class="token number">1</span> one <span class="token comment"># æ·»åŠ ä¸€ä¸ªå€¼</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> zadd zset <span class="token number">1</span> two<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> zadd zset <span class="token number">99</span> thr<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> zadd zset <span class="token number">10</span> four <span class="token number">6</span> five <span class="token comment"># æ·»åŠ å¤šä¸ªå€¼</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> ZRANGE zset <span class="token number">0</span> -1 <span class="token comment"># éå†æ‰€æœ‰ï¼Œä»å°åˆ°å¤§</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"one"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"two"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"five"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"four"</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"thr"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> zRevRange zset <span class="token number">0</span> -1 <span class="token comment"># éå†ä»å¤§åˆ°å°</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"thr"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"four"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"five"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"two"</span><span class="token comment">###########################################################</span><span class="token comment"># zRangeByScore key min max [withScores]</span><span class="token comment"># -inf æ— ç©·å° +inf æ— ç©·å¤§</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> ZRANGEBYSCORE zset -inf +inf<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"one"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"two"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"five"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"four"</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"thr"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> ZRANGEBYSCORE zset -inf +inf withscores <span class="token comment">#é™„å¸¦æƒå€¼</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"one"</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"1"</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"two"</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"1"</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"five"</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"6"</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">"four"</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token string">"10"</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token string">"thr"</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token string">"99"</span><span class="token comment">###########################################################</span><span class="token comment"># zrem ç§»é™¤keyä¸­çš„å…ƒç´ </span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> zrem zset one <span class="token comment"># ç§»é™¤</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token comment">###########################################################</span><span class="token comment"># zcard æ˜¾ç¤ºkeyæœ‰å¤šå°‘å€¼</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> zcard zset<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span><span class="token comment">###########################################################</span><span class="token comment"># zcount key start end æ˜¾ç¤ºåŒºé—´ä¸­çš„ä¸ªæ•°</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> zcount zset <span class="token number">1</span> <span class="token number">50</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span><span class="token comment">###########################################################</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ€»ç»“</p></blockquote><ul><li>å­˜å‚¨ç­çº§æˆç»©è¡¨ï¼Œå·¥èµ„è¡¨</li><li>æ’è¡Œæ¦œ</li><li>æ™®é€šæ¶ˆæ¯ï¼Œé‡è¦æ¶ˆæ¯ï¼Œå¸¦æƒé‡è¿›è¡Œåˆ¤æ–­</li></ul><h3 id="geospatial-åœ°ç†ä½ç½®-ç±»å‹"><a href="#geospatial-åœ°ç†ä½ç½®-ç±»å‹" class="headerlink" title="geospatial(åœ°ç†ä½ç½®)ç±»å‹"></a>geospatial(åœ°ç†ä½ç½®)ç±»å‹</h3><blockquote><p>æœ‹å‹åœˆå®šä½ï¼Œé™„è¿‘çš„äººï¼Œæ‰“è½¦è·ç¦»è®¡ç®—</p></blockquote><h4 id="ç›¸å…³å‘½ä»¤"><a href="#ç›¸å…³å‘½ä»¤" class="headerlink" title="ç›¸å…³å‘½ä»¤"></a>ç›¸å…³å‘½ä»¤</h4><ul><li>geoAdd</li><li>geoDist</li><li>geoHash</li><li>geoPos</li><li>geoRadius</li><li>geoRadiusByMember<blockquote><p>geoAdd  </p></blockquote></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># geoadd key  ç»åº¦ ç»´åº¦ åç§°</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> geoadd china:city <span class="token number">112.83</span> <span class="token number">36.83</span> wuxiang<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> geoadd china:city <span class="token number">116.46</span> <span class="token number">39.92</span> beijing <span class="token number">117.2</span> <span class="token number">39.13</span> tianjin<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>geoPos  </p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># getpos key name1 name2 name 3</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> geopos china:city beijing changzhi taiyuan <span class="token comment">#è·å–å€¼</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"116.45999997854232788"</span>   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"39.9199990416181052"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"113.0799981951713562"</span>   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"36.18000022796537252"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"112.53000050783157349"</span>   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"37.87000021374301895"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>geodist è¿”å›ä¸¤ä¸ªä½ç½®é—´çš„è·ç¦»</p></blockquote><p>å•ä½ï¼š</p><ul><li>m</li><li>km</li><li>mi è‹±é‡Œ</li><li>ft è‹±å°º<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> geodist china:city beijing taiyuan <span class="token comment"># åŒ—äº¬åˆ°å¤ªåŸçš„è·ç¦»</span><span class="token string">"409485.2048"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>georadius ä»¥ç»™å®šçš„ç»åº¦çº¬åº¦ä¸ºä¸­å¿ƒï¼Œï¼Œæ‰¾å‡ºæŸä¸€åŠå¾„å†…çš„å…ƒç´   </p></blockquote></li></ul><p>é™„è¿‘çš„äººï¼ˆè·å¾—æ‰€æœ‰é™„è¿‘çš„äººçš„å®šä½é€šè¿‡åŠå¾„æŸ¥è¯¢ï¼‰</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># georadius key ä½ çš„ç»åº¦ ä½ çš„ç»´åº¦ åŠå¾„ å•ä½ [withdist withcoord count é™å®šæ˜¾ç¤ºçš„æ•°]</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> georadius china:city <span class="token number">112</span> <span class="token number">37</span> <span class="token number">10</span> km <span class="token comment"># å¯»æ‰¾åŠå¾„10km</span><span class="token punctuation">(</span>empty array<span class="token punctuation">)</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> georadius china:city <span class="token number">112</span> <span class="token number">37</span> <span class="token number">120</span> km<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"wuxiang"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"taiyuan"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> georadius china:city <span class="token number">112</span> <span class="token number">37</span> <span class="token number">200</span> km<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"changzhi"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"wuxiang"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"taiyuan"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> georadius china:city <span class="token number">112</span> <span class="token number">37</span> <span class="token number">200</span> km withdist withcoord count <span class="token number">1</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"wuxiang"</span>   <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"76.1938"</span>   <span class="token number">3</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"112.83000022172927856"</span>      <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"36.82999905262392559"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>geohash è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªä½ç½®çš„geohashè¡¨ç¤º</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># geohash key name1 name2 name3</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> geohash china:city changzhi taiyuan beijing <span class="token comment">#å°†äºŒç»´çš„ç»çº¬åº¦è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²è¶Šé•¿è¶Šç²¾å‡†ï¼Œä¸¤ä¸ªå­—ç¬¦ä¸²è¶Šæ¥è¿‘åœ°ç†ä½ç½®ä¹Ÿå°±è¶Šæ¥è¿‘</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"ww2mv4q7fb0"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"ww8p2wjbep0"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"wx4g455wfe0"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="geoåº•å±‚åŸç†"><a href="#geoåº•å±‚åŸç†" class="headerlink" title="geoåº•å±‚åŸç†"></a>geoåº•å±‚åŸç†</h4><blockquote><p>geoåº•å±‚çš„å®ç°åŸç†å°±ç®—Zsetï¼æˆ‘ä»¬å¯ä»¥ç”¨Zsetçš„å‘½ä»¤æ¥æ“ä½œgeo  </p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> zrange china:city <span class="token number">0</span> -1 <span class="token comment"># æŸ¥çœ‹èŒƒå›´ä¸­çš„å…ƒç´ </span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"changzhi"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"wuxiang"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"taiyuan"</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"tianjin"</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"beijing"</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> zrem china:city tianjin <span class="token comment"># ç§»é™¤ä¸€ä¸ªå…ƒç´ </span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Hyperloglog"><a href="#Hyperloglog" class="headerlink" title="Hyperloglog"></a>Hyperloglog</h3><blockquote><p>ä»€ä¹ˆæ˜¯åŸºæ•°ï¼Ÿ===ã€‹ä¸€ä¸ªæ•°æ®é›†å†…ä¸é‡å¤çš„å…ƒç´ çš„ä¸ªæ•°</p></blockquote><p>ç»Ÿè®¡ç½‘ç«™çš„æµè§ˆé‡ï¼Œä¸€ä¸ªidè®¿é—®å¤šæ¬¡è¿˜æ˜¯ä¸€æ¬¡</p><p>Hyperloglogçš„ä¼˜ç‚¹ï¼šå ç”¨çš„å†…å­˜æ˜¯å›ºå®šçš„ï¼Œ2^64ä¸åŒçš„å…ƒç´ çš„æŠ€æœ¯åªéœ€è¦12KBçš„å†…å­˜ã€‚è€Œä¼ ç»Ÿçš„æ–¹å¼ç”¨setä¿å­˜ç”¨æˆ·çš„idæ¥ç»Ÿè®¡ï¼Œå ç”¨çš„å†…å­˜å¤§ï¼Œè¿˜æœ‰å¾ˆå¤§çš„è¯¯å·®</p><blockquote><p>æµ‹è¯•ä½¿ç”¨</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># pfadd key value1 ...æ·»åŠ å…ƒç´ </span><span class="token comment"># pfcount key è·å–æ•°é‡</span><span class="token comment"># pfmerge newKey oldKey1 oldKey2 åˆå¹¶åˆ°newKeyï¼Œå»é™¤é‡å¤</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> pfadd key a b c d e f g h i j <span class="token comment"># åˆ›å»ºç¬¬ä¸€ç»„å…ƒç´ </span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> pfcount key <span class="token comment">#ç»Ÿè®¡ç¬¬ä¸€ç»„å…ƒç´ ä¸­çš„åŸºæ•°æ•°é‡</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">10</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> pfadd key2 abc bca as se <span class="token comment">#åˆ›å»ºç¬¬äºŒç»„</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> pfcount key2<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> pfmerge key3 key key2 <span class="token comment">#åˆå¹¶ä¸¤ç»„åˆ°key3ä¸­ï¼Œæ˜¯å¹¶é›†ï¼Œæ²¡æœ‰é‡å¤çš„</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> pfcount key3<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">14</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="BitMaps"><a href="#BitMaps" class="headerlink" title="BitMaps"></a>BitMaps</h3><blockquote><p>æŒ‰ä½å­˜å‚¨  </p></blockquote><p>ç»Ÿè®¡ç”¨æˆ·ä¿¡æ¯ï¼šæ´»è·ƒä¸æ´»è·ƒï¼Œç™»å½•æœªç™»å½•ï¼Œæ‰“å¡æœªæ‰“å¡ï¼ä¸¤ä¸ªçŠ¶æ€çš„ç ï¼Œéƒ½å¯ä»¥ç”¨bitmaps</p><p>Bitmapsä½å›¾ï¼Œæ•°æ®ç»“æ„ï¼Œåªæœ‰0ï¼Œ1ä¸¤ä¸ªçŠ¶æ€ã€‚<br>æ¯”å¦‚å­˜ä¸€ä¸ªå‘˜å·¥ä¸€å¹´çš„æ‰“å¡æƒ…å†µï¼Œéœ€è¦365byte,1å­—èŠ‚æ˜¯8byte,åˆ™éœ€è¦46å·¦å³byteå°±å¯ä»¥ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#ç”¨bitmapsè®°å½•å‘¨ä¸€åˆ°å‘¨æ—¥çš„æ‰“å¡</span><span class="token comment"># setbit key  num1 num2</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> setbit sign <span class="token number">0</span> <span class="token number">1</span> è®¾ç½®0çš„å€¼<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> setbit sign <span class="token number">1</span> <span class="token number">0</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> setbit sign <span class="token number">2</span> <span class="token number">0</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> setbit sign <span class="token number">3</span> <span class="token number">1</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> setbit sign <span class="token number">4</span> <span class="token number">1</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> setbit sign <span class="token number">5</span> <span class="token number">1</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> setbit sign <span class="token number">6</span> <span class="token number">1</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token comment"># getbit key num1</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> getbit sign <span class="token number">2</span> <span class="token comment">#è·å–2çš„å€¼</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> getbit sign <span class="token number">4</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token comment"># bitcount key [start end]ç»Ÿè®¡ä¸º1çš„å¤©æ•°</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> bitcount sign<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Redisäº‹åŠ¡"><a href="#Redisäº‹åŠ¡" class="headerlink" title="Redisäº‹åŠ¡"></a>Redisäº‹åŠ¡</h3><p><strong>rediså•æ¡å‘½ä»¤æ˜¯ä¿è¯åŸå­æ€§çš„ï¼Œä½†äº‹åŠ¡ä¸ä¿è¯åŸå­æ€§</strong></p><p>redisäº‹åŠ¡ï¼š</p><ul><li>å¼€å¯äº‹åŠ¡(multi)</li><li>å‘½ä»¤å…¥é˜Ÿ(â€¦)</li><li>æ‰§è¡Œäº‹åŠ¡(exec)</li></ul><p>é”ï¼š</p><ul><li>rediså®ç°ä¹è§‚é”</li></ul><blockquote><p>æ­£å¸¸æ‰§è¡Œäº‹åŠ¡</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> multi <span class="token comment">#å¼€å¯äº‹åŠ¡</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> k1 v1 <span class="token comment">#å‘½ä»¤å…¥é˜Ÿ</span>QUEUED<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> k2 v2QUEUED<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get k2QUEUED<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> k3 v3QUEUED<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">exec</span> <span class="token comment">#æ‰§è¡Œäº‹åŠ¡</span><span class="token number">1</span><span class="token punctuation">)</span> OK<span class="token number">2</span><span class="token punctuation">)</span> OK<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"v2"</span><span class="token number">4</span><span class="token punctuation">)</span> OK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>discard æ”¾å¼ƒäº‹åŠ¡ ï¼Œä¸­é—´çš„éƒ½ä¸æ‰§è¡Œ</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> multi <span class="token comment">#å¼€å¯äº‹åŠ¡</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> k1 v1QUEUED<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> k2 v2QUEUED<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> discard <span class="token comment">#æ”¾å¼ƒäº‹åŠ¡</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> get k1<span class="token punctuation">(</span>nil<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ç¼–è¯‘æ—¶å¼‚å¸¸ï¼Œæ‰€æœ‰äº‹åŠ¡éƒ½ä¸ä¼šæ‰§è¡Œ</p></blockquote><blockquote><p>è¿è¡Œæ—¶å¼‚å¸¸ï¼Œæ­£å¸¸çš„ä¼šæ‰§è¡Œ</p></blockquote><ul><li><p>æ‚²è§‚é”</p><ul><li>æ‚²è§‚é”ï¼Œæ­£å¦‚å…¶åï¼Œå…·æœ‰å¼ºçƒˆçš„ç‹¬å å’Œæ’ä»–ç‰¹æ€§ã€‚å®ƒæŒ‡çš„æ˜¯å¯¹æ•°æ®è¢«å¤–ç•Œï¼ˆåŒ…æ‹¬æœ¬ç³»ç»Ÿå½“å‰çš„å…¶ä»–äº‹åŠ¡ï¼Œä»¥åŠæ¥è‡ªå¤–éƒ¨ç³»ç»Ÿçš„äº‹åŠ¡å¤„ç†ï¼‰ä¿®æ”¹æŒä¿å®ˆæ€åº¦ï¼Œå› æ­¤ï¼Œåœ¨æ•´ä¸ªæ•°æ®å¤„ç†è¿‡ç¨‹ä¸­ï¼Œå°†æ•°æ®å¤„äºé”å®šçŠ¶æ€</li></ul></li><li><p>ä¹è§‚é”</p><ul><li>ä¹è§‚é”æœºåˆ¶é‡‡å–äº†æ›´åŠ å®½æ¾çš„åŠ é”æœºåˆ¶ã€‚æ‚²è§‚é”å¤§å¤šæ•°æƒ…å†µä¸‹ä¾é æ•°æ®åº“çš„é”æœºåˆ¶å®ç°ï¼Œä»¥ä¿è¯æ“ä½œæœ€å¤§ç¨‹åº¦çš„ç‹¬å æ€§ã€‚ä½†éšä¹‹è€Œæ¥çš„å°±æ˜¯æ•°æ®åº“ æ€§èƒ½çš„å¤§é‡å¼€é”€ï¼Œç‰¹åˆ«æ˜¯å¯¹é•¿äº‹åŠ¡è€Œè¨€ï¼Œè¿™æ ·çš„å¼€é”€å¾€å¾€æ— æ³•æ‰¿å—ã€‚ç›¸å¯¹æ‚²è§‚é”è€Œè¨€ï¼Œä¹è§‚é”æ›´å€¾å‘äºå¼€å‘è¿ç”¨</li><li>è·å–version</li><li>æ›´æ–°çš„æ—¶å€™æ¯”è¾ƒversion</li></ul></li></ul><p><strong>ç”¨watchæ¥åŠ é”ï¼Œæœ¬èº«å°±ç›¸å½“äºä¹è§‚é”</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> money <span class="token number">10</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> post <span class="token number">0</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token function">watch</span> money <span class="token comment">#ç›‘è§†ï¼ŒåŠ é”ï¼Œå¦‚æœæ˜¯å¤šçº¿ç¨‹æ“ä½œçš„è¯ï¼Œä¼šæç¤ºå¤±è´¥</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> multi <span class="token comment">#å¼€å¯äº‹åŠ¡</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> decrby money <span class="token number">3</span>QUEUED<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> incrby post <span class="token number">3</span>QUEUED<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">exec</span> <span class="token comment">#æ‰§è¡Œäº‹åŠ¡</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">7</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">3</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> UNWATCH <span class="token comment">#é‡Šæ”¾é”ï¼Œåœæ­¢ç›‘è§†</span>OK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Jedis"><a href="#Jedis" class="headerlink" title="Jedis"></a>Jedis</h2><blockquote><p>Jedisæ˜¯å®˜æ–¹æ¨èçš„javaè¿æ¥å¼€å‘å·¥å…·ï¼Œä½¿ç”¨javaæ“ä½œredisçš„ä¸­é—´ä»¶ï¼Œå¦‚æœè¦ç”¨javaæ“ä½œredisçš„è¯ï¼Œæˆ‘ä»¬ä¸€å®šè¦å¯¹Jediséå¸¸ç†Ÿæ‚‰</p></blockquote><ul><li><p>å¯¼å…¥å¯¹åº”çš„ä¾èµ–</p>  <pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!--å¯¼å…¥JedisåŒ…--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>redis.clients<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jedis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.3.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--fastjson--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>fastjson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.60<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>è¿æ¥æµ‹è¯•</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// new Jediså¯¹è±¡</span>    <span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jedis</span><span class="token punctuation">(</span><span class="token string">"182.92.159.117"</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// jedisæ‰€æœ‰å‘½ä»¤éƒ½æ˜¯å­¦è¿‡çš„æŒ‡ä»¤</span>    <span class="token comment">// è¾“å‡ºpongè¯æ˜è¿æ¥æˆåŠŸ</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span>jedis<span class="token punctuation">.</span><span class="token function">ping</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>  <img src="https://s1.ax1x.com/2020/07/05/U9343Q.png" alt="redisè¿æ¥æˆåŠŸ"></p></li><li><p>å¸¸ç”¨apiï¼šå°±æ˜¯æˆ‘ä»¬ä¸Šè¾¹çš„8ä¸ªç±»å‹çš„è¯­æ³•æŒ‡ä»¤</p></li></ul><h2 id="SpringBoot-æ•´åˆ"><a href="#SpringBoot-æ•´åˆ" class="headerlink" title="SpringBoot æ•´åˆ"></a>SpringBoot æ•´åˆ</h2><blockquote><p>åœ¨spring2.xä¹‹åï¼ŒåŸæ¥çš„Jediså˜æˆäº†lettuce</p></blockquote><p>jedisï¼šåº•å±‚é‡‡ç”¨çš„ç›´è¿ï¼Œå¤šä¸ªçº¿ç¨‹æ“ä½œï¼Œä¸å®‰å…¨ï¼Œå¦‚æœè¦é¿å…ä¸å®‰å…¨çš„éœ€è¦ä½¿ç”¨jedis poolè¿æ¥æ± </p><p>lettuceï¼šåº•å±‚é‡‡ç”¨nettyï¼Œå®ä¾‹å¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹ä¸­å…±äº«ï¼Œä¸å­˜åœ¨çº¿ç¨‹ä¸å®‰å…¨çš„æƒ…å†µï¼Œå‡å°‘çº¿ç¨‹æ•°é‡</p><p>redisè‡ªåŠ¨é…ç½®ç±»æºç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Bean</span><span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"redisTemplate"</span><span class="token punctuation">)</span> <span class="token comment">// ä»£è¡¨æˆ‘ä»¬å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªæ¥æ›¿æ¢ä»–</span><span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">UnknownHostException</span> <span class="token punctuation">&#123;</span>       <span class="token comment">// rediså¯¹è±¡éƒ½éœ€è¦åºåˆ—åŒ–ï¼Œé»˜è®¤çš„RedisTemplateæ²¡æœ‰è¿‡å¤šçš„è®¾ç½®</span>       <span class="token comment">// ä¸¤ä¸ªæ³›å‹éƒ½æ˜¯objectï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢</span><span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> template<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Bean</span><span class="token annotation punctuation">@ConditionalOnMissingBean</span>   <span class="token comment">// stringç±»å‹æ˜¯redisä¸­æœ€å¸¸ä½¿ç”¨çš„ï¼Œå•ç‹¬æå–å‡ºæ¥çš„</span><span class="token keyword">public</span> <span class="token class-name">StringRedisTemplate</span> <span class="token function">stringRedisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">UnknownHostException</span> <span class="token punctuation">&#123;</span><span class="token class-name">StringRedisTemplate</span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringRedisTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> template<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>  <span class="token key atrule">redis</span><span class="token punctuation">:</span>    <span class="token key atrule">host</span><span class="token punctuation">:</span> 182.92.159.117    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">6379</span>    <span class="token key atrule">database</span><span class="token punctuation">:</span> <span class="token number">0</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æµ‹è¯•è¿æ¥</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Autowired</span><span class="token keyword">private</span> <span class="token class-name">RedisTemplate</span> redisTemplate<span class="token punctuation">;</span><span class="token annotation punctuation">@Test</span><span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// opsForValueå°±æ˜¯æ“ä½œå­—ç¬¦ä¸²ï¼Œå…¶ä»–åŒç†</span>    redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">,</span><span class="token string">"zhangsan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// redisTemplate æ“ä½œä¸åŒçš„æ•°æ®ç±»å‹ï¼Œapiå’Œæˆ‘ä»¬çš„æŒ‡ä»¤æ˜¯ä¸€æ ·çš„</span>    <span class="token comment">// opsForValue æ“ä½œå­—ç¬¦ä¸² ç±»ä¼¼String</span>    <span class="token comment">// opsForList æ“ä½œList ç±»ä¼¼List</span>    <span class="token comment">// opsForSet</span>    <span class="token comment">// opsForHash</span>    <span class="token comment">// opsForZSet</span>    <span class="token comment">// opsForGeo</span>    <span class="token comment">// opsForHyperLogLog</span>    <span class="token comment">// é™¤äº†è¿›æœ¬çš„æ“ä½œï¼Œæˆ‘ä»¬å¸¸ç”¨çš„æ–¹æ³•éƒ½å¯ä»¥ç›´æ¥é€šè¿‡redisTemplateæ“ä½œï¼Œæ¯”å¦‚äº‹åŠ¡ï¼Œå’ŒåŸºæœ¬çš„CRUD</span>    <span class="token comment">// è·å–redisçš„è¿æ¥å¯¹è±¡</span>    <span class="token comment">// RedisConnection connection =</span>    redisTemplate<span class="token punctuation">.</span><span class="token function">getConnectionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// connection.flushDb();</span>    <span class="token comment">// connection.flushAll();</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æ–°å»ºé…ç½®ç±»ï¼šåŸç”Ÿçš„RedisTemplateåŠŸèƒ½å¤ªå°‘ï¼Œä¸èƒ½ä¼ å…¥ä¸­æ–‡</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisConfig</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span>            <span class="token keyword">throws</span> <span class="token class-name">UnknownHostException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>      // Jsonåºåˆ—åŒ–é…ç½®      Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class);      ObjectMapper om = new ObjectMapper();      om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);      om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);      jackson2JsonRedisSerializer.setObjectMapper(om);      // String çš„åºåˆ—åŒ–      StringRedisSerializer stringRedisSerializer = new              StringRedisSerializer();      // keyé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼      template.setKeySerializer(stringRedisSerializer);      // hashçš„keyä¹Ÿé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼      template.setHashKeySerializer(stringRedisSerializer);      // valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson      template.setValueSerializer(jackson2JsonRedisSerializer);      // hashçš„valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson      template.setHashValueSerializer(jackson2JsonRedisSerializer);      template.afterPropertiesSet();      return template;  &#125;</code></pre><p>  }</p>  <pre class="line-numbers language-none"><code class="language-none">- å°è£…RedisTemplateå·¥å…·ç±»å‚è€ƒç½‘ä¸Š## è¿›é˜¶### Redis.confè¯¦è§£&gt;å•ä½![ä¸åŒºåˆ†å¤§å°å†™](https:&#x2F;&#x2F;s1.ax1x.com&#x2F;2020&#x2F;07&#x2F;06&#x2F;UCerrT.png)&gt;åŒ…å«![åƒspringä¸€æ ·å¯ä»¥å¯¼å…¥å…¶ä»–é…ç½®æ–‡ä»¶](https:&#x2F;&#x2F;s1.ax1x.com&#x2F;2020&#x2F;07&#x2F;06&#x2F;UCeWGR.png)&gt;ç½‘ç»œ&#96;&#96;&#96;bashbind 127.0.0.1 # ç»‘å®šçš„ipprotected-mode yes # ä¿æŠ¤æ¨¡å¼port 6379 # ç«¯å£è®¾ç½®<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>é€šç”¨ GENERAL</p></blockquote></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">daemonize <span class="token function">yes</span> <span class="token comment"># ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œé»˜è®¤æ˜¯ noï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±å¼€å¯ä¸ºyesï¼</span>pidfile /var/run/redis_6379.pid <span class="token comment"># å¦‚æœä»¥åå°çš„æ–¹å¼è¿è¡Œï¼Œæˆ‘ä»¬å°±éœ€è¦æŒ‡å®šä¸€ä¸ª pid æ–‡ä»¶ï¼</span><span class="token comment"># æ—¥å¿—</span><span class="token comment"># Specify the server verbosity level.</span><span class="token comment"># This can be one of:</span><span class="token comment"># debug (a lot of information, useful for development/testing) å¼€å‘æµ‹è¯•ç¯å¢ƒ</span><span class="token comment"># verbose (many rarely useful info, but not a mess like the debug level)</span><span class="token comment"># notice (moderately verbose, what you want in production probably) ç”Ÿäº§ç¯å¢ƒ</span><span class="token comment"># warning (only very important / critical messages are logged)</span>loglevel noticelogfile <span class="token string">""</span> <span class="token comment"># æ—¥å¿—çš„æ–‡ä»¶ä½ç½®å</span>databases <span class="token number">16</span> <span class="token comment"># æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤æ˜¯ 16 ä¸ªæ•°æ®åº“</span>always-show-logo <span class="token function">yes</span> <span class="token comment"># æ˜¯å¦æ€»æ˜¯æ˜¾ç¤ºLOGO</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å¿«ç…§  </p></blockquote><p>æŒä¹…åŒ–ï¼Œ åœ¨è§„å®šçš„æ—¶é—´å†…ï¼Œæ‰§è¡Œäº†å¤šå°‘æ¬¡æ“ä½œï¼Œåˆ™ä¼šæŒä¹…åŒ–åˆ°æ–‡ä»¶ .rdb. aof<br>redis æ˜¯å†…å­˜æ•°æ®åº“ï¼Œå¦‚æœæ²¡æœ‰æŒä¹…åŒ–ï¼Œé‚£ä¹ˆæ•°æ®æ–­ç”µåŠå¤±ï¼</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å¦‚æœ900så†…ï¼Œå¦‚æœè‡³å°‘æœ‰ä¸€ä¸ª1 keyè¿›è¡Œäº†ä¿®æ”¹ï¼Œæˆ‘ä»¬åŠè¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</span>save <span class="token number">900</span> <span class="token number">1</span><span class="token comment"># å¦‚æœ300så†…ï¼Œå¦‚æœè‡³å°‘10 keyè¿›è¡Œäº†ä¿®æ”¹ï¼Œæˆ‘ä»¬åŠè¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</span>save <span class="token number">300</span> <span class="token number">10</span><span class="token comment"># å¦‚æœ60så†…ï¼Œå¦‚æœè‡³å°‘10000 keyè¿›è¡Œäº†ä¿®æ”¹ï¼Œæˆ‘ä»¬åŠè¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</span>save <span class="token number">60</span> <span class="token number">10000</span><span class="token comment"># æˆ‘ä»¬ä¹‹åå­¦ä¹ æŒä¹…åŒ–ï¼Œä¼šè‡ªå·±å®šä¹‰è¿™ä¸ªæµ‹è¯•ï¼</span>stop-writes-on-bgsave-error <span class="token function">yes</span> <span class="token comment"># æŒä¹…åŒ–å¦‚æœå‡ºé”™ï¼Œæ˜¯å¦è¿˜éœ€è¦ç»§ç»­å·¥ä½œï¼</span>rdbcompression <span class="token function">yes</span> <span class="token comment"># æ˜¯å¦å‹ç¼© rdb æ–‡ä»¶ï¼Œéœ€è¦æ¶ˆè€—ä¸€äº›cpuèµ„æºï¼</span>rdbchecksum <span class="token function">yes</span> <span class="token comment"># ä¿å­˜rdbæ–‡ä»¶çš„æ—¶å€™ï¼Œè¿›è¡Œé”™è¯¯çš„æ£€æŸ¥æ ¡éªŒï¼</span><span class="token function">dir</span> ./ <span class="token comment"># rdb æ–‡ä»¶ä¿å­˜çš„ç›®å½•ï¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>REPLICATION å¤åˆ¶ï¼Œæˆ‘ä»¬åé¢è®²è§£ä¸»ä»å¤åˆ¶çš„ï¼Œæ—¶å€™å†è¿›è¡Œè®²è§£</p></blockquote><blockquote><p>SECURITY</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token function">ping</span>PONG<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> config get requirepass <span class="token comment"># è·å–redisçš„å¯†ç </span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"requirepass"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">""</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> config <span class="token builtin class-name">set</span> requirepass <span class="token string">"123456"</span> <span class="token comment"># è®¾ç½®redisçš„å¯†ç </span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> config get requirepass <span class="token comment"># å‘ç°æ‰€æœ‰çš„å‘½ä»¤éƒ½æ²¡æœ‰æƒé™äº†</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> NOAUTH Authentication required.<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token function">ping</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> NOAUTH Authentication required.<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> auth <span class="token number">123456</span> <span class="token comment"># ä½¿ç”¨å¯†ç è¿›è¡Œç™»å½•ï¼</span>OK<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> config get requirepass<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"requirepass"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"123456"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä¿®æ”¹å®Œè¦è®°å¾—é‡å¯redis</strong></p><blockquote><p>é™åˆ¶ CLIENTS</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">maxclients <span class="token number">10000</span> <span class="token comment"># è®¾ç½®èƒ½è¿æ¥ä¸Šredisçš„æœ€å¤§å®¢æˆ·ç«¯çš„æ•°é‡</span>maxmemory <span class="token operator">&lt;</span>bytes<span class="token operator">></span> <span class="token comment"># redis é…ç½®æœ€å¤§çš„å†…å­˜å®¹é‡</span>maxmemory-policy noeviction <span class="token comment"># å†…å­˜åˆ°è¾¾ä¸Šé™ä¹‹åçš„å¤„ç†ç­–ç•¥</span><span class="token number">1</span>ã€volatile-lruï¼šåªå¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyè¿›è¡ŒLRUï¼ˆé»˜è®¤å€¼ï¼‰<span class="token number">2</span>ã€allkeys-lru ï¼š åˆ é™¤lruç®—æ³•çš„key<span class="token number">3</span>ã€volatile-randomï¼šéšæœºåˆ é™¤å³å°†è¿‡æœŸkey<span class="token number">4</span>ã€allkeys-randomï¼šéšæœºåˆ é™¤<span class="token number">5</span>ã€volatile-ttl ï¼š åˆ é™¤å³å°†è¿‡æœŸçš„<span class="token number">6</span>ã€noeviction ï¼š æ°¸ä¸è¿‡æœŸï¼Œè¿”å›é”™è¯¯<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>APPEND ONLY æ¨¡å¼ aofé…ç½®</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">appendonly no <span class="token comment"># é»˜è®¤æ˜¯ä¸å¼€å¯aofæ¨¡å¼çš„ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨rdbæ–¹å¼æŒä¹…åŒ–çš„ï¼Œåœ¨å¤§éƒ¨åˆ†æ‰€æœ‰çš„æƒ…å†µä¸‹ï¼Œ</span>rdbå®Œå…¨å¤Ÿç”¨ï¼appendfilename <span class="token string">"appendonly.aof"</span> <span class="token comment"># æŒä¹…åŒ–çš„æ–‡ä»¶çš„åå­—</span><span class="token comment"># appendfsync always # æ¯æ¬¡ä¿®æ”¹éƒ½ä¼š syncã€‚æ¶ˆè€—æ€§èƒ½</span>appendfsync everysec <span class="token comment"># æ¯ç§’æ‰§è¡Œä¸€æ¬¡ syncï¼Œå¯èƒ½ä¼šä¸¢å¤±è¿™1sçš„æ•°æ®ï¼</span><span class="token comment"># appendfsync no # ä¸æ‰§è¡Œ syncï¼Œè¿™ä¸ªæ—¶å€™æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æœ€å¿«ï¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="RedisæŒä¹…åŒ–"><a href="#RedisæŒä¹…åŒ–" class="headerlink" title="RedisæŒä¹…åŒ–"></a>RedisæŒä¹…åŒ–</h3><blockquote><p>Redis æ˜¯å†…å­˜æ•°æ®åº“ï¼Œå¦‚æœä¸å°†å†…å­˜ä¸­çš„æ•°æ®åº“çŠ¶æ€ä¿å­˜åˆ°ç£ç›˜ï¼Œé‚£ä¹ˆä¸€æ—¦æœåŠ¡å™¨è¿›ç¨‹é€€å‡ºï¼ŒæœåŠ¡å™¨ä¸­çš„æ•°æ®åº“çŠ¶æ€ä¹Ÿä¼šæ¶ˆå¤±ã€‚æ‰€ä»¥ Redis æä¾›äº†æŒä¹…åŒ–åŠŸèƒ½ï¼</p></blockquote><h4 id="RDB-Redis-DataBase"><a href="#RDB-Redis-DataBase" class="headerlink" title="RDB(Redis DataBase)"></a>RDB(Redis DataBase)</h4><blockquote><p>åœ¨ä¸»ä»å¤åˆ¶ä¸­ï¼Œrdbå°±æ˜¯å¤‡ç”¨äº†ï¼ä»æœºä¸Šé¢ï¼</p></blockquote><p>Redisä¼šå•ç‹¬åˆ›å»ºï¼ˆforkï¼‰ä¸€ä¸ªå­è¿›ç¨‹æ¥è¿›è¡ŒæŒä¹…åŒ–ï¼Œä¼šå…ˆå°†æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå¾…æŒä¹…åŒ–è¿‡ç¨‹<br>éƒ½ç»“æŸäº†ï¼Œå†ç”¨è¿™ä¸ªä¸´æ—¶æ–‡ä»¶æ›¿æ¢ä¸Šæ¬¡æŒä¹…åŒ–å¥½çš„æ–‡ä»¶ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸»è¿›ç¨‹æ˜¯ä¸è¿›è¡Œä»»ä½•IOæ“ä½œçš„ã€‚<br>è¿™å°±ç¡®ä¿äº†æé«˜çš„æ€§èƒ½ã€‚å¦‚æœéœ€è¦è¿›è¡Œå¤§è§„æ¨¡æ•°æ®çš„æ¢å¤ï¼Œä¸”å¯¹äºæ•°æ®æ¢å¤çš„å®Œæ•´æ€§ä¸æ˜¯éå¸¸æ•æ„Ÿï¼Œé‚£<br>RDBæ–¹å¼è¦æ¯”AOFæ–¹å¼æ›´åŠ çš„é«˜æ•ˆã€‚RDBçš„ç¼ºç‚¹æ˜¯æœ€åä¸€æ¬¡æŒä¹…åŒ–åçš„æ•°æ®å¯èƒ½ä¸¢å¤±ã€‚æˆ‘ä»¬é»˜è®¤çš„å°±æ˜¯<br>RDBï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦ä¿®æ”¹è¿™ä¸ªé…ç½®ï¼</p><p><strong>rdbä¿å­˜çš„æ–‡ä»¶æ˜¯dump.rdb</strong> éƒ½æ˜¯åœ¨æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶ä¸­å¿«ç…§ä¸­è¿›è¡Œé…ç½®çš„ï¼</p><p><img src="https://s1.ax1x.com/2020/07/06/UC1oUf.png" alt="test"></p><blockquote><p>è§¦å‘æœºåˆ¶</p></blockquote><ol><li>saveçš„è§„åˆ™æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œä¼šè‡ªåŠ¨è§¦å‘rdbè§„åˆ™</li><li>æ‰§è¡Œ flushall å‘½ä»¤ï¼Œä¹Ÿä¼šè§¦å‘æˆ‘ä»¬çš„rdbè§„åˆ™ï¼</li><li>é€€å‡ºredisï¼Œä¹Ÿä¼šäº§ç”Ÿ rdb æ–‡ä»¶ï¼  </li></ol><p><strong>å¤‡ä»½å°±è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª dump.rdb</strong></p><blockquote><p>æ¢å¤rdbæ–‡ä»¶</p></blockquote><ol><li>åªéœ€è¦å°†rdbæ–‡ä»¶æ”¾åœ¨æˆ‘ä»¬rediså¯åŠ¨ç›®å½•å°±å¯ä»¥ï¼Œrediså¯åŠ¨çš„æ—¶å€™ä¼šè‡ªåŠ¨æ£€æŸ¥dump.rdb æ¢å¤å…¶ä¸­çš„æ•°æ®</li><li>æŸ¥çœ‹éœ€è¦å­˜åœ¨çš„ä½ç½®<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> config get <span class="token function">dir</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"dir"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"/usr/local/bin"</span> <span class="token comment"># å¦‚æœåœ¨è¿™ä¸ªç›®å½•ä¸‹å­˜åœ¨dump.rdb æ–‡ä»¶ï¼Œå¯åŠ¨å°±ä¼šè‡ªåŠ¨æ¢å¤å…¶ä¸­çš„æ•°æ®</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li>ä¼˜ç‚¹ï¼š<ol><li>é€‚åˆå¤§è§„æ¨¡çš„æ•°æ®æ¢å¤</li><li>å¯¹æ•°æ®çš„å®Œæ•´æ€§è¦ä¸é«˜</li></ol></li><li>ç¼ºç‚¹ï¼š<ol><li>éœ€è¦ä¸€å®šçš„æ—¶é—´é—´éš”è¿›ç¨‹æ“ä½œï¼å¦‚æœredisæ„å¤–å®•æœºäº†ï¼Œè¿™ä¸ªæœ€åä¸€æ¬¡ä¿®æ”¹æ•°æ®å°±æ²¡æœ‰çš„äº†ï¼</li><li>forkè¿›ç¨‹çš„æ—¶å€™ï¼Œä¼šå ç”¨ä¸€å®šçš„å†…å®¹ç©ºé—´</li></ol></li></ol><h4 id="AOFï¼ˆAppend-Only-Fileï¼‰"><a href="#AOFï¼ˆAppend-Only-Fileï¼‰" class="headerlink" title="AOFï¼ˆAppend Only Fileï¼‰"></a>AOFï¼ˆAppend Only Fileï¼‰</h4><blockquote><p>å°†æˆ‘ä»¬çš„æ‰€æœ‰å‘½ä»¤éƒ½è®°å½•ä¸‹æ¥ï¼Œç±»ä¼¼äºhistoryï¼Œæ¢å¤çš„æ—¶å€™å°±æŠŠè¿™ä¸ªæ–‡ä»¶å…¨éƒ¨åœ¨æ‰§è¡Œä¸€éï¼</p></blockquote><p>ä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™æ“ä½œï¼Œå°†Redisæ‰§è¡Œè¿‡çš„æ‰€æœ‰æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼ˆè¯»æ“ä½œä¸è®°å½•ï¼‰ï¼Œåªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶ï¼Œrediså¯åŠ¨ä¹‹åˆä¼šè¯»å–è¯¥æ–‡ä»¶é‡æ–°æ„å»ºæ•°æ®ï¼Œæ¢è¨€ä¹‹ï¼Œredisé‡å¯çš„è¯å°±æ ¹æ®æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å°†å†™æŒ‡ä»¤ä»å‰åˆ°åæ‰§è¡Œä¸€æ¬¡ä»¥å®Œæˆæ•°æ®çš„æ¢å¤å·¥ä½œ</p><p><strong>Aofä¿å­˜çš„æ˜¯ appendonly.aof æ–‡ä»¶</strong></p><p>é»˜è®¤æ˜¯ä¸å¼€å¯çš„ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨è¿›è¡Œé…ç½®ï¼æˆ‘ä»¬åªéœ€è¦å°† appendonly æ”¹ä¸ºyeså°±å¼€å¯äº† aofï¼Œç„¶åé‡å¯ï¼Œredis å°±å¯ä»¥ç”Ÿæ•ˆäº†<br><img src="https://s1.ax1x.com/2020/07/06/UCURBQ.png" alt="å¼€å¯aof"></p><p>å¦‚æœaofæ–‡ä»¶æœ‰é—®é¢˜ï¼Œrediså°±ä¼šæŠ¥é”™ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è‡ªå¸¦çš„ä¿®å¤å·¥å…· redis-check-aof â€“fix</p><p><code>redis-check-aof --fix appendonly.aof</code>å³å¯ä¿®å¤</p><p><img src="https://s1.ax1x.com/2020/07/06/UCUvNR.png" alt="check"></p><blockquote><p>é‡å†™è§„åˆ™è¯´æ˜</p></blockquote><p>å¦‚æœaofæ–‡ä»¶å¤§äº64mï¼Œå°±ä¼šå¼€è¾Ÿä¸€ä¸ªæ–°çš„è¿›ç¨‹æŠŠæˆ‘ä»¬çš„æ–‡ä»¶è¿›è¡Œé‡å†™<br><img src="https://s1.ax1x.com/2020/07/06/UCacP1.png" alt="é‡å†™è§„åˆ™"></p><blockquote><p>ä¼˜ç¼ºç‚¹</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">appendonly no <span class="token comment"># é»˜è®¤æ˜¯ä¸å¼€å¯aofæ¨¡å¼çš„ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨rdbæ–¹å¼æŒä¹…åŒ–çš„ï¼Œåœ¨å¤§éƒ¨åˆ†æ‰€æœ‰çš„æƒ…å†µä¸‹ï¼Œ</span>rdbå®Œå…¨å¤Ÿç”¨ï¼appendfilename <span class="token string">"appendonly.aof"</span> <span class="token comment"># æŒä¹…åŒ–çš„æ–‡ä»¶çš„åå­—</span><span class="token comment"># appendfsync always # æ¯æ¬¡ä¿®æ”¹éƒ½ä¼š syncã€‚æ¶ˆè€—æ€§èƒ½</span>appendfsync everysec <span class="token comment"># æ¯ç§’æ‰§è¡Œä¸€æ¬¡ syncï¼Œå¯èƒ½ä¼šä¸¢å¤±è¿™1sçš„æ•°æ®ï¼</span><span class="token comment"># appendfsync no # ä¸æ‰§è¡Œ syncï¼Œè¿™ä¸ªæ—¶å€™æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æœ€å¿«ï¼</span><span class="token comment"># rewrite é‡å†™ï¼Œ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ä¼˜ç‚¹ï¼š<ul><li>æ¯ä¸€æ¬¡ä¿®æ”¹éƒ½åŒæ­¥ï¼Œæ–‡ä»¶çš„å®Œæ•´ä¼šæ›´åŠ å¥½</li><li>æ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼Œå¯èƒ½ä¼šä¸¢å¤±ä¸€ç§’çš„æ•°æ®</li><li>ä»ä¸åŒæ­¥ï¼Œæ•ˆç‡æœ€é«˜çš„</li></ul></li><li>ç¼ºç‚¹ï¼š<ul><li>ç›¸å¯¹äºæ•°æ®æ–‡ä»¶æ¥è¯´ï¼Œaofè¿œè¿œå¤§äº rdbï¼Œä¿®å¤çš„é€Ÿåº¦ä¹Ÿæ¯” rdbæ…¢</li><li>Aof è¿è¡Œæ•ˆç‡ä¹Ÿè¦æ¯” rdb æ…¢ï¼Œæ‰€ä»¥æˆ‘ä»¬redisé»˜è®¤çš„é…ç½®å°±æ˜¯rdbæŒä¹…åŒ–</li></ul></li></ul><p>æ‰©å±•ï¼š</p><ol><li>RDB æŒä¹…åŒ–æ–¹å¼èƒ½å¤Ÿåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å¯¹ä½ çš„æ•°æ®è¿›è¡Œå¿«ç…§å­˜å‚¨</li><li>AOF æŒä¹…åŒ–æ–¹å¼è®°å½•æ¯æ¬¡å¯¹æœåŠ¡å™¨å†™çš„æ“ä½œï¼Œå½“æœåŠ¡å™¨é‡å¯çš„æ—¶å€™ä¼šé‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥æ¢å¤åŸå§‹çš„æ•°æ®ï¼ŒAOFå‘½ä»¤ä»¥Redis åè®®è¿½åŠ ä¿å­˜æ¯æ¬¡å†™çš„æ“ä½œåˆ°æ–‡ä»¶æœ«å°¾ï¼ŒRedisè¿˜èƒ½å¯¹AOFæ–‡ä»¶è¿›è¡Œåå°é‡å†™ï¼Œä½¿å¾—AOFæ–‡ä»¶çš„ä½“ç§¯ä¸è‡³äºè¿‡å¤§ã€‚</li><li><strong>åªåšç¼“å­˜ï¼Œå¦‚æœä½ åªå¸Œæœ›ä½ çš„æ•°æ®åœ¨æœåŠ¡å™¨è¿è¡Œçš„æ—¶å€™å­˜åœ¨ï¼Œä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ä»»ä½•æŒä¹…åŒ–</strong></li><li>åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–æ–¹å¼<ol><li>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“redisé‡å¯çš„æ—¶å€™ä¼šä¼˜å…ˆè½½å…¥AOFæ–‡ä»¶æ¥æ¢å¤åŸå§‹çš„æ•°æ®ï¼Œå› ä¸ºåœ¨é€šå¸¸æƒ…å†µä¸‹AOF<br>æ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦æ¯”RDBæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦å®Œæ•´ã€‚</li><li>RDB çš„æ•°æ®ä¸å®æ—¶ï¼ŒåŒæ—¶ä½¿ç”¨ä¸¤è€…æ—¶æœåŠ¡å™¨é‡å¯ä¹Ÿåªä¼šæ‰¾AOFæ–‡ä»¶ï¼Œé‚£è¦ä¸è¦åªä½¿ç”¨AOFå‘¢ï¼Ÿä½œè€…å»ºè®®ä¸è¦ï¼Œå› ä¸ºRDBæ›´é€‚åˆç”¨äºå¤‡ä»½æ•°æ®åº“ï¼ˆAOFåœ¨ä¸æ–­å˜åŒ–ä¸å¥½å¤‡ä»½ï¼‰ï¼Œå¿«é€Ÿé‡å¯ï¼Œè€Œä¸”ä¸ä¼šæœ‰AOFå¯èƒ½æ½œåœ¨çš„Bugï¼Œç•™ç€ä½œä¸ºä¸€ä¸ªä¸‡ä¸€çš„æ‰‹æ®µã€‚</li></ol></li><li>æ€§èƒ½å»ºè®®<ol><li>å› ä¸ºRDBæ–‡ä»¶åªç”¨ä½œåå¤‡ç”¨é€”ï¼Œå»ºè®®åªåœ¨Slaveä¸ŠæŒä¹…åŒ–RDBæ–‡ä»¶ï¼Œè€Œä¸”åªè¦15åˆ†é’Ÿå¤‡ä»½ä¸€æ¬¡å°±å¤Ÿäº†ï¼Œåªä¿ç•™ save 900 1 è¿™æ¡è§„åˆ™ã€‚</li><li>å¦‚æœEnable AOF ï¼Œå¥½å¤„æ˜¯åœ¨æœ€æ¶åŠ£æƒ…å†µä¸‹ä¹Ÿåªä¼šä¸¢å¤±ä¸è¶…è¿‡ä¸¤ç§’æ•°æ®ï¼Œå¯åŠ¨è„šæœ¬è¾ƒç®€å•åªloadè‡ªå·±çš„AOFæ–‡ä»¶å°±å¯ä»¥äº†ï¼Œä»£ä»·ä¸€æ˜¯å¸¦æ¥äº†æŒç»­çš„IOï¼ŒäºŒæ˜¯AOF rewrite çš„æœ€åå°† rewrite è¿‡ç¨‹ä¸­äº§ç”Ÿçš„æ–°æ•°æ®å†™åˆ°æ–°æ–‡ä»¶é€ æˆçš„é˜»å¡å‡ ä¹æ˜¯ä¸å¯é¿å…çš„ã€‚åªè¦ç¡¬ç›˜è®¸å¯ï¼Œåº”è¯¥å°½é‡å‡å°‘AOF rewriteçš„é¢‘ç‡ï¼ŒAOFé‡å†™çš„åŸºç¡€å¤§å°é»˜è®¤å€¼64Må¤ªå°äº†ï¼Œå¯ä»¥è®¾åˆ°5Gä»¥ä¸Šï¼Œé»˜è®¤è¶…è¿‡åŸå¤§å°100%å¤§å°é‡å†™å¯ä»¥æ”¹åˆ°é€‚å½“çš„æ•°å€¼ã€‚</li><li>å¦‚æœä¸Enable AOF ï¼Œä»…é  Master-Slave Repllcation å®ç°é«˜å¯ç”¨æ€§ä¹Ÿå¯ä»¥ï¼Œèƒ½çœæ‰ä¸€å¤§ç¬”IOï¼Œä¹Ÿå‡å°‘äº†rewriteæ—¶å¸¦æ¥çš„ç³»ç»Ÿæ³¢åŠ¨ã€‚ä»£ä»·æ˜¯å¦‚æœMaster/Slave åŒæ—¶å€’æ‰ï¼Œä¼šä¸¢å¤±åå‡ åˆ†é’Ÿçš„æ•°æ®ï¼Œå¯åŠ¨è„šæœ¬ä¹Ÿè¦æ¯”è¾ƒä¸¤ä¸ª Master/Slave ä¸­çš„ RDBæ–‡ä»¶ï¼Œè½½å…¥è¾ƒæ–°çš„é‚£ä¸ªï¼Œå¾®åšå°±æ˜¯è¿™ç§æ¶æ„ã€‚</li></ol></li></ol><h3 id="Redis-å‘å¸ƒè®¢é˜…"><a href="#Redis-å‘å¸ƒè®¢é˜…" class="headerlink" title="Redis å‘å¸ƒè®¢é˜…"></a>Redis å‘å¸ƒè®¢é˜…</h3><blockquote><p>Redis å‘å¸ƒè®¢é˜…(pub/sub)æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡æ¨¡å¼ï¼šå‘é€è€…(pub)å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…è€…(sub)æ¥æ”¶æ¶ˆæ¯ã€‚å¾®ä¿¡ã€å¾®åšã€å…³æ³¨ç³»ç»Ÿï¼</p></blockquote><p>Redis å®¢æˆ·ç«¯å¯ä»¥è®¢é˜…ä»»æ„æ•°é‡çš„é¢‘é“</p><p><img src="https://s1.ax1x.com/2020/07/06/UP8xJK.png" alt="æµç¨‹å›¾"></p><blockquote><p>è¿™äº›å‘½ä»¤è¢«å¹¿æ³›ç”¨äºæ„å»ºå³æ—¶é€šä¿¡åº”ç”¨ï¼Œæ¯”å¦‚ç½‘ç»œèŠå¤©å®¤(chatroom)å’Œå®æ—¶å¹¿æ’­ã€å®æ—¶æé†’ç­‰ã€‚</p></blockquote><table><thead><tr><th align="center">åºå·</th><th align="center">å‘½ä»¤åŠæè¿°</th></tr></thead><tbody><tr><td align="center">1</td><td align="center"><code>Psubscribe pattern [parrten2 ....]</code><br>è®¢é˜…ä¸€ä¸ªæˆ–å¤šä¸ªç¬¦åˆç»™å®šæ¨¡å¼çš„é¢‘é“</td></tr><tr><td align="center">2</td><td align="center"><code>Pubsub &lt;subcommand&gt; [argument [argument ...]]</code><br>æŸ¥çœ‹è®¢é˜…ä¸å‘å¸ƒç³»ç»ŸçŠ¶æ€</td></tr><tr><td align="center">3</td><td align="center"><code>Publish channel message</code><br>å°†ä¿¡æ¯å‘é€åˆ°æŒ‡å®šçš„é¢‘é“</td></tr><tr><td align="center">4</td><td align="center"><code>Punsubscribe [pattern [pattern ...]]</code><br>é€€è®¢æ‰€æœ‰ç»™å®šæ¨¡å¼çš„é¢‘é“</td></tr><tr><td align="center">5</td><td align="center"><code>Subscribe channel [channel ...]</code><br>è®¢é˜…ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªé¢‘é“çš„ä¿¡æ¯</td></tr><tr><td align="center">6</td><td align="center"><code>Unsubscribe [channel [channel ...]]</code><br>æŒ‡é€€è®¢ç»™å®šçš„é¢‘é“</td></tr></tbody></table><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> subscribe zhy <span class="token comment"># è®¢é˜…ä¸€ä¸ªé¢‘é“</span>Reading messages<span class="token punctuation">..</span>. <span class="token punctuation">(</span>press Ctrl-C to quit<span class="token punctuation">)</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"subscribe"</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"zhy"</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span><span class="token comment"># ç­‰å¾…è¯»å–æ¨é€çš„ä¿¡æ¯</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"message"</span> <span class="token comment"># æ¶ˆæ¯</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">"zhy"</span> <span class="token comment"># æ¨é€é¢‘é“</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">"nihao"</span> <span class="token comment"># å…·ä½“å†…å®¹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> publish zhy nihao <span class="token comment"># å‘å¸ƒè€…å‘å¸ƒæ¶ˆæ¯åˆ°é¢‘é“</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span> <span class="token comment"># è¿™ä¸ªåœ°æ–¹æ˜¾ç¤ºçš„æ˜¯å‘é€ç»™äº†å¤šå°‘äºº</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> PUBLISH zhy <span class="token builtin class-name">test</span> <span class="token comment"># ä¸€æ—¦é€€è®¢æˆ–è€…é€€å‡ºï¼Œè¿™ä¸ªæ¶ˆæ¯å°±æ¥æ”¶ä¸åˆ°äº†</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ä½¿ç”¨åœºæ™¯ï¼š</p></blockquote><ol><li>å®æ—¶æ¶ˆæ¯ç³»ç»Ÿï¼</li><li>äº‹å®èŠå¤©ï¼ï¼ˆé¢‘é“å½“åšèŠå¤©å®¤ï¼Œå°†ä¿¡æ¯å›æ˜¾ç»™æ‰€æœ‰äººå³å¯ï¼ï¼‰</li><li>è®¢é˜…ï¼Œå…³æ³¨ç³»ç»Ÿéƒ½æ˜¯å¯ä»¥çš„ï¼<br>ç¨å¾®å¤æ‚çš„åœºæ™¯æˆ‘ä»¬å°±ä¼šä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶</li></ol><h3 id="Redisä¸»ä»å¤åˆ¶"><a href="#Redisä¸»ä»å¤åˆ¶" class="headerlink" title="Redisä¸»ä»å¤åˆ¶"></a>Redisä¸»ä»å¤åˆ¶</h3><h4 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>ä¸»ä»å¤åˆ¶ï¼Œæ˜¯æŒ‡å°†ä¸€å°RedisæœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–çš„RedisæœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸ºä¸»èŠ‚ç‚¹(master/leader)ï¼Œåè€…ç§°ä¸ºä»èŠ‚ç‚¹(slave/follower)ï¼›æ•°æ®çš„å¤åˆ¶æ˜¯å•å‘çš„ï¼Œåªèƒ½ç”±ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹ã€‚Masterä»¥å†™ä¸ºä¸»ï¼ŒSlave ä»¥è¯»ä¸ºä¸»ã€‚</p><p>ä¸»ä»å¤åˆ¶çš„ä½œç”¨ä¸»è¦åŒ…æ‹¬ï¼š</p><ol><li>æ•°æ®å†—ä½™ï¼šä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™æ–¹å¼ã€‚</li><li>æ•…éšœæ¢å¤ï¼šå½“ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ç”±ä»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿçš„æ•…éšœæ¢å¤ï¼›å®é™…ä¸Šæ˜¯ä¸€ç§æœåŠ¡çš„å†—ä½™ã€‚</li><li>è´Ÿè½½å‡è¡¡ï¼šåœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥ç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œç”±ä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ï¼ˆå³å†™Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯»Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä»èŠ‚ç‚¹ï¼‰ï¼Œåˆ†æ‹…æœåŠ¡å™¨è´Ÿè½½ï¼›å°¤å…¶æ˜¯åœ¨å†™å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è¯»è´Ÿè½½ï¼Œå¯ä»¥å¤§å¤§æé«˜RedisæœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚</li><li>é«˜å¯ç”¨ï¼ˆé›†ç¾¤ï¼‰åŸºçŸ³ï¼šé™¤äº†ä¸Šè¿°ä½œç”¨ä»¥å¤–ï¼Œä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„åŸºç¡€ï¼Œå› æ­¤è¯´ä¸»ä»å¤åˆ¶æ˜¯Redisé«˜å¯ç”¨çš„åŸºç¡€ã€‚</li></ol><p><img src="https://s1.ax1x.com/2020/07/06/UPBnN4.png" alt="ä¸€ä¸»ä¸‰ä»"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># info replication æ˜¾ç¤ºå½“å‰redisçš„ä¸»ä»ä¿¡æ¯</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> info replication<span class="token comment"># Replication</span>role:masterconnected_slaves:0master_replid:d49ac9bced0770f85ae058fd82de58d218ada58emaster_replid2:0000000000000000000000000000000000000000master_repl_offset:0second_repl_offset:-1repl_backlog_active:0repl_backlog_size:1048576repl_backlog_first_byte_offset:0repl_backlog_histlen:0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é…ç½®éœ€è¦ä¿®æ”¹çš„åœ°æ–¹ï¼š</p><ol><li>ç«¯å£</li><li>pidåå­—</li><li>logåå­—</li><li>dump.rdbåå­—</li></ol><p>ä¿®æ”¹å®Œæ¯•ä¹‹åå¯åŠ¨<br><img src="https://s1.ax1x.com/2020/07/06/UPyYQA.png" alt="çœ‹åå°è¿›ç¨‹"></p><h4 id="ä¸€ä¸»äºŒä»"><a href="#ä¸€ä¸»äºŒä»" class="headerlink" title="ä¸€ä¸»äºŒä»"></a>ä¸€ä¸»äºŒä»</h4><p><strong>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°RedisæœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹</strong>ï¼› æˆ‘ä»¬ä¸€èˆ¬æƒ…å†µä¸‹åªç”¨é…ç½®ä»æœºå°±å¥½äº†ï¼</p><p>è¯­æ³•:<code>slaveof host port</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:638<span class="token operator"><span class="token file-descriptor important">0</span>></span> SLAVEOF <span class="token number">127.0</span>.0.1 <span class="token number">6379</span> <span class="token comment"># SLAVEOF host 6379 ç»‘å®šä¸»æœº</span>OK<span class="token number">127.0</span>.0.1:638<span class="token operator"><span class="token file-descriptor important">0</span>></span> info replication <span class="token comment"># æŸ¥çœ‹ä¿¡æ¯</span><span class="token comment"># Replication</span>role:slave <span class="token comment"># å½“å‰è§’è‰²æ˜¯ä»æœº</span>master_host:127.0.0.1 <span class="token comment"># å¯ä»¥çš„çœ‹åˆ°ä¸»æœºçš„ä¿¡æ¯</span>master_port:6379<span class="token comment">###ä¸»æœºçš„è§†è§’</span><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> info replication<span class="token comment"># Replication</span>role:masterconnected_slaves:1 <span class="token comment"># å¤šäº†ä»æœºçš„é…ç½®</span>slave0:ip<span class="token operator">=</span><span class="token number">127.0</span>.0.1,port<span class="token operator">=</span><span class="token number">6380</span>,state<span class="token operator">=</span>online,offset<span class="token operator">=</span><span class="token number">42</span>,lag<span class="token operator">=</span><span class="token number">1</span> <span class="token comment"># å¤šäº†ä»æœºçš„é…ç½®</span>master_replid:a81be8dd257636b2d3e7a9f595e69d73ff03774emaster_replid2:0000000000000000000000000000000000000000master_repl_offset:42second_repl_offset:-1repl_backlog_active:1repl_backlog_size:1048576repl_backlog_first_byte_offset:1repl_backlog_histlen:42<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/07/06/UPcvxH.png" alt="ä¸»æœºä¿¡æ¯"></p><p><strong>æ³¨æ„ï¼š</strong>å‘½ä»¤é…ç½®æ˜¯æš‚æ—¶çš„ï¼Œè¦æƒ³æ°¸ä¹…æ€§é…ç½®éœ€è¦å»ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼</p><blockquote><p><strong>ä¸»æœºè®¾ç½®å€¼</strong></p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>></span> <span class="token builtin class-name">set</span> user zhangsanOK<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p><strong>ä»æœºä¼šè‡ªåŠ¨åŒæ­¥ä¸»æœºå†™å…¥çš„å€¼</strong></p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:638<span class="token operator"><span class="token file-descriptor important">0</span>></span> get user<span class="token string">"zhangsan"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p><strong>ä½†æ˜¯ä»æœºä¸å¯ä»¥å†™å…¥</strong></p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">127.0</span>.0.1:638<span class="token operator"><span class="token file-descriptor important">1</span>></span> <span class="token builtin class-name">set</span> k2 <span class="token number">2</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> READONLY You can't <span class="token function">write</span> against a <span class="token builtin class-name">read</span> only replica.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p><strong>ä¸»æœºå®•æœºåï¼Œä»æœºä¾æ—§è¿æ¥åˆ°ä¸»æœºæ‰§è¡Œè¯»æ“ä½œï¼Œä½†æ˜¯æ²¡æœ‰å†™æ“ä½œï¼Œå¦‚æœä¸»æœºæ¢å¤ï¼Œï¼Œä»æœºä¾æ—§å¯ä»¥ç›´æ¥è·å–åˆ°ä¸»æœºå†™çš„ä¿¡æ¯</strong></p></blockquote><blockquote><p><strong>å¦‚æœæ˜¯ä½¿ç”¨å‘½ä»¤è¡Œï¼Œæ¥é…ç½®çš„ä¸»ä»ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœé‡å¯äº†ï¼Œå°±ä¼šå˜å›ä¸»æœºï¼åªè¦å˜ä¸ºä»æœºï¼Œç«‹é©¬å°±ä¼šä»ä¸»æœºä¸­è·å–å€¼</strong></p></blockquote><blockquote><p>å¤åˆ¶åŸç†</p></blockquote><ul><li>Slave å¯åŠ¨æˆåŠŸè¿æ¥åˆ° master åä¼šå‘é€ä¸€ä¸ªsyncåŒæ­¥å‘½ä»¤</li><li>Master æ¥åˆ°å‘½ä»¤ï¼Œå¯åŠ¨åå°çš„å­˜ç›˜è¿›ç¨‹ï¼ŒåŒæ—¶æ”¶é›†æ‰€æœ‰æ¥æ”¶åˆ°çš„ç”¨äºä¿®æ”¹æ•°æ®é›†å‘½ä»¤ï¼Œåœ¨åå°è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œmasterå°†ä¼ é€æ•´ä¸ªæ•°æ®æ–‡ä»¶åˆ°slaveï¼Œå¹¶å®Œæˆä¸€æ¬¡å®Œå…¨åŒæ­¥ã€‚</li><li>å…¨é‡å¤åˆ¶ï¼šslaveæœåŠ¡åœ¨æ¥æ”¶åˆ°æ•°æ®åº“æ–‡ä»¶æ•°æ®åï¼Œå°†å…¶å­˜ç›˜å¹¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</li><li>å¢é‡å¤åˆ¶ï¼šMasterç»§ç»­å°†æ–°çš„æ‰€æœ‰æ”¶é›†åˆ°çš„ä¿®æ”¹å‘½ä»¤ä¾æ¬¡ä¼ ç»™slaveï¼Œå®ŒæˆåŒæ­¥</li></ul><h3 id="å“¨å…µæ¨¡å¼"><a href="#å“¨å…µæ¨¡å¼" class="headerlink" title="å“¨å…µæ¨¡å¼"></a>å“¨å…µæ¨¡å¼</h3><blockquote><p>æ¦‚è¿°<br>ä¸»ä»åˆ‡æ¢æŠ€æœ¯çš„æ–¹æ³•æ˜¯ï¼šå½“ä¸»æœåŠ¡å™¨å®•æœºåï¼Œéœ€è¦æ‰‹åŠ¨æŠŠä¸€å°ä»æœåŠ¡å™¨åˆ‡æ¢ä¸ºä¸»æœåŠ¡å™¨ï¼Œè¿™å°±éœ€è¦äººå·¥å¹²é¢„ï¼Œè´¹äº‹è´¹åŠ›ï¼Œè¿˜ä¼šé€ æˆä¸€æ®µæ—¶é—´å†…æœåŠ¡ä¸å¯ç”¨ã€‚è¿™ä¸æ˜¯ä¸€ç§æ¨èçš„æ–¹å¼ï¼Œæ›´å¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¼˜å…ˆè€ƒè™‘å“¨å…µæ¨¡å¼ã€‚Redisä»2.8å¼€å§‹æ­£å¼æä¾›äº†Sentinelï¼ˆå“¨å…µï¼‰ æ¶æ„æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p></blockquote><p><img src="https://s1.ax1x.com/2020/07/06/UPbCct.png" alt="UPbCct.png"></p><p>å‡è®¾ä¸»æœåŠ¡å™¨å®•æœºï¼Œå“¨å…µ1å…ˆæ£€æµ‹åˆ°è¿™ä¸ªç»“æœï¼Œç³»ç»Ÿå¹¶ä¸ä¼šé©¬ä¸Šè¿›è¡Œfailoverè¿‡ç¨‹ï¼Œä»…ä»…æ˜¯å“¨å…µ1ä¸»è§‚çš„è®¤<br>ä¸ºä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œè¿™ä¸ªç°è±¡æˆä¸º<strong>ä¸»è§‚ä¸‹çº¿</strong>ã€‚å½“åé¢çš„å“¨å…µä¹Ÿæ£€æµ‹åˆ°ä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œå¹¶ä¸”æ•°é‡è¾¾åˆ°ä¸€<br>å®šå€¼æ—¶ï¼Œé‚£ä¹ˆå“¨å…µä¹‹é—´å°±ä¼šè¿›è¡Œä¸€æ¬¡æŠ•ç¥¨ï¼ŒæŠ•ç¥¨çš„ç»“æœç”±ä¸€ä¸ªå“¨å…µå‘èµ·ï¼Œè¿›è¡Œfailover <strong>æ•…éšœè½¬ç§»</strong> æ“ä½œã€‚<br>åˆ‡æ¢æˆåŠŸåï¼Œå°±ä¼šé€šè¿‡å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œè®©å„ä¸ªå“¨å…µæŠŠè‡ªå·±ç›‘æ§çš„ä»æœåŠ¡å™¨å®ç°åˆ‡æ¢ä¸»æœºï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºå®¢è§‚ä¸‹çº¿ã€‚</p><ul><li>ä¼˜ç‚¹ï¼š<ul><li>å“¨å…µé›†ç¾¤ï¼ŒåŸºäºä¸»ä»å¤åˆ¶æ¨¡å¼ï¼Œæ‰€æœ‰çš„ä¸»ä»é…ç½®ä¼˜ç‚¹ï¼Œå®ƒå…¨æœ‰</li><li>ä¸»ä»å¯ä»¥åˆ‡æ¢ï¼Œæ•…éšœå¯ä»¥è½¬ç§»ï¼Œç³»ç»Ÿçš„å¯ç”¨æ€§å°±ä¼šæ›´å¥½</li><li>å“¨å…µæ¨¡å¼å°±æ˜¯ä¸»ä»æ¨¡å¼çš„å‡çº§ï¼Œæ‰‹åŠ¨åˆ°è‡ªåŠ¨ï¼Œæ›´åŠ å¥å£®</li></ul></li><li>ç¼ºç‚¹ï¼š<ul><li>Redisä¸å¥½åœ¨çº¿æ‰©å®¹ï¼Œé›†ç¾¤å®¹é‡ä¸€æ—¦åˆ°è¾¾ä¸Šé™ï¼Œåœ¨çº¿æ‰©å®¹å°±ååˆ†éº»çƒ¦</li><li>å®ç°å“¨å…µæ¨¡å¼çš„é…ç½®å…¶å®æ˜¯å¾ˆéº»çƒ¦ï¼Œé‡Œé¢æœ‰å¾ˆå¤šé€‰æ‹©</li></ul></li></ul><blockquote><p>å“¨å…µæ¨¡å¼çš„å…¨éƒ¨é…ç½®</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Example sentinel.conf</span><span class="token comment"># å“¨å…µsentinelå®ä¾‹è¿è¡Œçš„ç«¯å£ é»˜è®¤26379</span>port <span class="token number">26379</span><span class="token comment"># å“¨å…µsentinelçš„å·¥ä½œç›®å½•</span><span class="token function">dir</span> /tmp<span class="token comment"># å“¨å…µsentinelç›‘æ§çš„redisä¸»èŠ‚ç‚¹çš„ ip port</span><span class="token comment"># master-name å¯ä»¥è‡ªå·±å‘½åçš„ä¸»èŠ‚ç‚¹åå­— åªèƒ½ç”±å­—æ¯A-zã€æ•°å­—0-9 ã€è¿™ä¸‰ä¸ªå­—ç¬¦".-_"ç»„æˆã€‚</span><span class="token comment"># quorum é…ç½®å¤šå°‘ä¸ªsentinelå“¨å…µç»Ÿä¸€è®¤ä¸ºmasterä¸»èŠ‚ç‚¹å¤±è” é‚£ä¹ˆè¿™æ—¶å®¢è§‚ä¸Šè®¤ä¸ºä¸»èŠ‚ç‚¹å¤±è”äº†</span><span class="token comment"># sentinel monitor &lt;master-name> &lt;ip> &lt;redis-port> &lt;quorum></span>sentinel monitor mymaster <span class="token number">127.0</span>.0.1 <span class="token number">6379</span> <span class="token number">2</span><span class="token comment"># å½“åœ¨Rediså®ä¾‹ä¸­å¼€å¯äº†requirepass foobared æˆæƒå¯†ç  è¿™æ ·æ‰€æœ‰è¿æ¥Rediså®ä¾‹çš„å®¢æˆ·ç«¯éƒ½è¦æä¾›å¯†ç </span><span class="token comment"># è®¾ç½®å“¨å…µsentinel è¿æ¥ä¸»ä»çš„å¯†ç  æ³¨æ„å¿…é¡»ä¸ºä¸»ä»è®¾ç½®ä¸€æ ·çš„éªŒè¯å¯†ç </span><span class="token comment"># sentinel auth-pass &lt;master-name> &lt;password></span>sentinel auth-pass mymaster MySUPER--secret-0123passw0rd<span class="token comment"># æŒ‡å®šå¤šå°‘æ¯«ç§’ä¹‹å ä¸»èŠ‚ç‚¹æ²¡æœ‰åº”ç­”å“¨å…µsentinel æ­¤æ—¶ å“¨å…µä¸»è§‚ä¸Šè®¤ä¸ºä¸»èŠ‚ç‚¹ä¸‹çº¿ é»˜è®¤30ç§’</span><span class="token comment"># sentinel down-after-milliseconds &lt;master-name> &lt;milliseconds></span>sentinel down-after-milliseconds mymaster <span class="token number">30000</span><span class="token comment"># è¿™ä¸ªé…ç½®é¡¹æŒ‡å®šäº†åœ¨å‘ç”Ÿfailoverä¸»å¤‡åˆ‡æ¢æ—¶æœ€å¤šå¯ä»¥æœ‰å¤šå°‘ä¸ªslaveåŒæ—¶å¯¹æ–°çš„masterè¿›è¡Œ åŒæ­¥ï¼Œè¿™ä¸ªæ•°å­—è¶Šå°ï¼Œå®Œæˆfailoveræ‰€éœ€çš„æ—¶é—´å°±è¶Šé•¿ï¼Œä½†æ˜¯å¦‚æœè¿™ä¸ªæ•°å­—è¶Šå¤§ï¼Œå°±æ„å‘³ç€è¶Š å¤šçš„slaveå› ä¸ºreplicationè€Œä¸å¯ç”¨ã€‚å¯ä»¥é€šè¿‡å°†è¿™ä¸ªå€¼è®¾ä¸º 1 æ¥ä¿è¯æ¯æ¬¡åªæœ‰ä¸€ä¸ªslave å¤„äºä¸èƒ½å¤„ç†å‘½ä»¤è¯·æ±‚çš„çŠ¶æ€ã€‚</span><span class="token comment"># sentinel parallel-syncs &lt;master-name> &lt;numslaves></span>sentinel parallel-syncs mymaster <span class="token number">1</span><span class="token comment"># æ•…éšœè½¬ç§»çš„è¶…æ—¶æ—¶é—´ failover-timeout å¯ä»¥ç”¨åœ¨ä»¥ä¸‹è¿™äº›æ–¹é¢ï¼š</span><span class="token comment">#1. åŒä¸€ä¸ªsentinelå¯¹åŒä¸€ä¸ªmasterä¸¤æ¬¡failoverä¹‹é—´çš„é—´éš”æ—¶é—´ã€‚</span><span class="token comment">#2. å½“ä¸€ä¸ªslaveä»ä¸€ä¸ªé”™è¯¯çš„masteré‚£é‡ŒåŒæ­¥æ•°æ®å¼€å§‹è®¡ç®—æ—¶é—´ã€‚ç›´åˆ°slaveè¢«çº æ­£ä¸ºå‘æ­£ç¡®çš„masteré‚£é‡ŒåŒæ­¥æ•°æ®æ—¶ã€‚</span><span class="token comment">#3.å½“æƒ³è¦å–æ¶ˆä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„failoveræ‰€éœ€è¦çš„æ—¶é—´ã€‚</span><span class="token comment">#4.å½“è¿›è¡Œfailoveræ—¶ï¼Œé…ç½®æ‰€æœ‰slavesæŒ‡å‘æ–°çš„masteræ‰€éœ€çš„æœ€å¤§æ—¶é—´ã€‚ä¸è¿‡ï¼Œå³ä½¿è¿‡äº†è¿™ä¸ªè¶…æ—¶ï¼Œslavesä¾ç„¶ä¼šè¢«æ­£ç¡®é…ç½®ä¸ºæŒ‡å‘masterï¼Œä½†æ˜¯å°±ä¸æŒ‰parallel-syncsæ‰€é…ç½®çš„è§„åˆ™æ¥äº†</span><span class="token comment"># é»˜è®¤ä¸‰åˆ†é’Ÿ</span><span class="token comment"># sentinel failover-timeout &lt;master-name> &lt;milliseconds></span>sentinel failover-timeout mymaster <span class="token number">180000</span><span class="token comment"># SCRIPTS EXECUTION</span><span class="token comment">#é…ç½®å½“æŸä¸€äº‹ä»¶å‘ç”Ÿæ—¶æ‰€éœ€è¦æ‰§è¡Œçš„è„šæœ¬ï¼Œå¯ä»¥é€šè¿‡è„šæœ¬æ¥é€šçŸ¥ç®¡ç†å‘˜ï¼Œä¾‹å¦‚å½“ç³»ç»Ÿè¿è¡Œä¸æ­£å¸¸æ—¶å‘é‚®ä»¶é€šçŸ¥ç›¸å…³äººå‘˜ã€‚</span><span class="token comment">#å¯¹äºè„šæœ¬çš„è¿è¡Œç»“æœæœ‰ä»¥ä¸‹è§„åˆ™ï¼š</span><span class="token comment">#è‹¥è„šæœ¬æ‰§è¡Œåè¿”å›1ï¼Œé‚£ä¹ˆè¯¥è„šæœ¬ç¨åå°†ä¼šè¢«å†æ¬¡æ‰§è¡Œï¼Œé‡å¤æ¬¡æ•°ç›®å‰é»˜è®¤ä¸º10</span><span class="token comment">#è‹¥è„šæœ¬æ‰§è¡Œåè¿”å›2ï¼Œæˆ–è€…æ¯”2æ›´é«˜çš„ä¸€ä¸ªè¿”å›å€¼ï¼Œè„šæœ¬å°†ä¸ä¼šé‡å¤æ‰§è¡Œã€‚</span><span class="token comment">#å¦‚æœè„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ç”±äºæ”¶åˆ°ç³»ç»Ÿä¸­æ–­ä¿¡å·è¢«ç»ˆæ­¢äº†ï¼Œåˆ™åŒè¿”å›å€¼ä¸º1æ—¶çš„è¡Œä¸ºç›¸åŒã€‚</span><span class="token comment">#ä¸€ä¸ªè„šæœ¬çš„æœ€å¤§æ‰§è¡Œæ—¶é—´ä¸º60sï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œè„šæœ¬å°†ä¼šè¢«ä¸€ä¸ªSIGKILLä¿¡å·ç»ˆæ­¢ï¼Œä¹‹åé‡æ–°æ‰§è¡Œã€‚</span><span class="token comment">#é€šçŸ¥å‹è„šæœ¬:å½“sentinelæœ‰ä»»ä½•è­¦å‘Šçº§åˆ«çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆæ¯”å¦‚è¯´rediså®ä¾‹çš„ä¸»è§‚å¤±æ•ˆå’Œå®¢è§‚å¤±æ•ˆç­‰ç­‰ï¼‰ï¼Œå°†ä¼šå»è°ƒç”¨è¿™ä¸ªè„šæœ¬ï¼Œè¿™æ—¶è¿™ä¸ªè„šæœ¬åº”è¯¥é€šè¿‡é‚®ä»¶ï¼ŒSMSç­‰æ–¹å¼å»é€šçŸ¥ç³»ç»Ÿç®¡ç†å‘˜å…³äºç³»ç»Ÿä¸æ­£å¸¸è¿è¡Œçš„ä¿¡æ¯ã€‚è°ƒç”¨è¯¥è„šæœ¬æ—¶ï¼Œå°†ä¼ ç»™è„šæœ¬ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯äº‹ä»¶çš„ç±»å‹ï¼Œä¸€ä¸ªæ˜¯äº‹ä»¶çš„æè¿°ã€‚å¦‚æœsentinel.confé…ç½®æ–‡ä»¶ä¸­é…ç½®äº†è¿™ä¸ªè„šæœ¬è·¯å¾„ï¼Œé‚£ä¹ˆå¿…é¡»ä¿è¯è¿™ä¸ªè„šæœ¬å­˜åœ¨äºè¿™ä¸ªè·¯å¾„ï¼Œå¹¶ä¸”æ˜¯å¯æ‰§è¡Œçš„ï¼Œå¦åˆ™sentinelæ— æ³•æ­£å¸¸å¯åŠ¨æˆåŠŸã€‚</span><span class="token comment">#é€šçŸ¥è„šæœ¬</span><span class="token comment"># shellç¼–ç¨‹</span><span class="token comment"># sentinel notification-script &lt;master-name> &lt;script-path></span>sentinel notification-script mymaster /var/redis/notify.sh<span class="token comment"># å®¢æˆ·ç«¯é‡æ–°é…ç½®ä¸»èŠ‚ç‚¹å‚æ•°è„šæœ¬</span><span class="token comment"># å½“ä¸€ä¸ªmasterç”±äºfailoverè€Œå‘ç”Ÿæ”¹å˜æ—¶ï¼Œè¿™ä¸ªè„šæœ¬å°†ä¼šè¢«è°ƒç”¨ï¼Œé€šçŸ¥ç›¸å…³çš„å®¢æˆ·ç«¯å…³äºmasteråœ°å€å·²ç»å‘ç”Ÿæ”¹å˜çš„ä¿¡æ¯ã€‚</span><span class="token comment"># ä»¥ä¸‹å‚æ•°å°†ä¼šåœ¨è°ƒç”¨è„šæœ¬æ—¶ä¼ ç»™è„šæœ¬:</span><span class="token comment"># &lt;master-name> &lt;role> &lt;state> &lt;from-ip> &lt;from-port> &lt;to-ip> &lt;to-port></span><span class="token comment"># ç›®å‰&lt;state>æ€»æ˜¯â€œfailoverâ€,</span><span class="token comment"># &lt;role>æ˜¯â€œleaderâ€æˆ–è€…â€œobserverâ€ä¸­çš„ä¸€ä¸ªã€‚</span><span class="token comment"># å‚æ•° from-ip, from-port, to-ip, to-portæ˜¯ç”¨æ¥å’Œæ—§çš„masterå’Œæ–°çš„master(å³æ—§çš„slave)é€šä¿¡çš„</span><span class="token comment"># è¿™ä¸ªè„šæœ¬åº”è¯¥æ˜¯é€šç”¨çš„ï¼Œèƒ½è¢«å¤šæ¬¡è°ƒç”¨ï¼Œä¸æ˜¯é’ˆå¯¹æ€§çš„ã€‚</span><span class="token comment"># sentinel client-reconfig-script &lt;master-name> &lt;script-path>sentinel client-reconfig-script mymaster /var/redis/reconfig.sh # ä¸€èˆ¬éƒ½æ˜¯ç”±è¿ç»´æ¥é…ç½®ï¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Redisç¼“å­˜ç©¿é€å’Œé›ªå´©"><a href="#Redisç¼“å­˜ç©¿é€å’Œé›ªå´©" class="headerlink" title="Redisç¼“å­˜ç©¿é€å’Œé›ªå´©"></a>Redisç¼“å­˜ç©¿é€å’Œé›ªå´©</h3><h4 id="ç¼“å­˜ç©¿é€ï¼ˆæŸ¥ä¸åˆ°ï¼‰"><a href="#ç¼“å­˜ç©¿é€ï¼ˆæŸ¥ä¸åˆ°ï¼‰" class="headerlink" title="ç¼“å­˜ç©¿é€ï¼ˆæŸ¥ä¸åˆ°ï¼‰"></a>ç¼“å­˜ç©¿é€ï¼ˆæŸ¥ä¸åˆ°ï¼‰</h4><blockquote><p>æ¦‚å¿µ</p></blockquote><p>ç”¨æˆ·æƒ³è¦æŸ¥è¯¢ä¸€ä¸ªæ•°æ®ï¼Œå‘ç°rediså†…å­˜æ•°æ®åº“æ²¡æœ‰ï¼Œä¹Ÿå°±æ˜¯ç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼Œäºæ˜¯å‘æŒä¹…å±‚æ•°æ®åº“æŸ¥è¯¢ã€‚å‘ç°ä¹Ÿæ²¡æœ‰ï¼Œäºæ˜¯æœ¬æ¬¡æŸ¥è¯¢å¤±è´¥ã€‚å½“ç”¨æˆ·å¾ˆå¤šçš„æ—¶å€™ï¼Œç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­ï¼ˆç§’æ€ï¼ï¼‰ï¼Œäºæ˜¯éƒ½å»è¯·æ±‚äº†æŒä¹…å±‚æ•°æ®åº“ã€‚è¿™ä¼šç»™æŒä¹…å±‚æ•°æ®åº“é€ æˆå¾ˆå¤§çš„å‹åŠ›ï¼Œè¿™æ—¶å€™å°±ç›¸å½“äºå‡ºç°äº†ç¼“å­˜ç©¿é€ã€‚<br><img src="https://s1.ax1x.com/2020/07/06/UiMpjA.png" alt="æ­£å¸¸æ‰§è¡Œè¿‡ç¨‹"></p><blockquote><p>è§£å†³æ–¹æ¡ˆ</p></blockquote><p><strong>å¸ƒéš†è¿‡æ»¤å™¨</strong><br>å¸ƒéš†è¿‡æ»¤å™¨æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå¯¹æ‰€æœ‰å¯èƒ½æŸ¥è¯¢çš„å‚æ•°ä»¥hashå½¢å¼å­˜å‚¨ï¼Œåœ¨æ§åˆ¶å±‚å…ˆè¿›è¡Œæ ¡éªŒï¼Œä¸ç¬¦åˆåˆ™ä¸¢å¼ƒï¼Œä»è€Œé¿å…äº†å¯¹åº•å±‚å­˜å‚¨ç³»ç»Ÿçš„æŸ¥è¯¢å‹åŠ›ï¼›</p><p><img src="https://s1.ax1x.com/2020/07/06/UiMJCF.png" alt="å¸ƒéš†è¿‡æ»¤å™¨"></p><p><strong>ç¼“å­˜ç©ºå¯¹è±¡</strong>  </p><p>å½“å­˜å‚¨å±‚ä¸å‘½ä¸­åï¼Œå³ä½¿è¿”å›çš„ç©ºå¯¹è±¡ä¹Ÿå°†å…¶ç¼“å­˜èµ·æ¥ï¼ŒåŒæ—¶ä¼šè®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œä¹‹åå†è®¿é—®è¿™ä¸ªæ•°æ®å°†ä¼šä»ç¼“å­˜ä¸­è·å–ï¼Œä¿æŠ¤äº†åç«¯æ•°æ®æºï¼›<br><img src="https://s1.ax1x.com/2020/07/06/UiMBE6.png" alt="ç¼“å­˜ç©ºå¯¹è±¡"></p><p>ä½†æ˜¯è¿™ç§æ–¹æ³•ä¼šå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>å¦‚æœç©ºå€¼èƒ½å¤Ÿè¢«ç¼“å­˜èµ·æ¥ï¼Œè¿™å°±æ„å‘³ç€ç¼“å­˜éœ€è¦æ›´å¤šçš„ç©ºé—´å­˜å‚¨æ›´å¤šçš„é”®ï¼Œå› ä¸ºè¿™å½“ä¸­å¯èƒ½ä¼šæœ‰å¾ˆå¤šçš„ç©ºå€¼çš„é”®ï¼›</li><li>å³ä½¿å¯¹ç©ºå€¼è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨ç¼“å­˜å±‚å’Œå­˜å‚¨å±‚çš„æ•°æ®ä¼šæœ‰ä¸€æ®µæ—¶é—´çª—å£çš„ä¸ä¸€è‡´ï¼Œè¿™å¯¹äºéœ€è¦ä¿æŒä¸€è‡´æ€§çš„ä¸šåŠ¡ä¼šæœ‰å½±å“ï¼ˆå½“ä½ çš„æ•°æ®åº“å†…æœ‰äº†å€¼ï¼Œä½†æ˜¯ç¼“å­˜é‡Œä¾æ—§æ˜¯nullï¼‰</li></ol><h4 id="ç¼“å­˜å‡»ç©¿ï¼ˆé‡å¤ªå¤§ï¼Œç¼“å­˜è¿‡æœŸï¼ï¼‰"><a href="#ç¼“å­˜å‡»ç©¿ï¼ˆé‡å¤ªå¤§ï¼Œç¼“å­˜è¿‡æœŸï¼ï¼‰" class="headerlink" title="ç¼“å­˜å‡»ç©¿ï¼ˆé‡å¤ªå¤§ï¼Œç¼“å­˜è¿‡æœŸï¼ï¼‰"></a>ç¼“å­˜å‡»ç©¿ï¼ˆé‡å¤ªå¤§ï¼Œç¼“å­˜è¿‡æœŸï¼ï¼‰</h4><blockquote><p>æ¦‚è¿°</p></blockquote><p>å½“æŸä¸ªkeyåœ¨è¿‡æœŸçš„ç¬é—´ï¼Œæœ‰å¤§é‡çš„è¯·æ±‚å¹¶å‘è®¿é—®ï¼Œè¿™ç±»æ•°æ®ä¸€èˆ¬æ˜¯çƒ­ç‚¹æ•°æ®ï¼Œç”±äºç¼“å­˜è¿‡æœŸï¼Œä¼šåŒæ—¶è®¿é—®æ•°æ®åº“æ¥æŸ¥è¯¢æœ€æ–°æ•°æ®ï¼Œå¹¶ä¸”å›å†™ç¼“å­˜ï¼Œä¼šå¯¼ä½¿æ•°æ®åº“ç¬é—´å‹åŠ›è¿‡å¤§ã€‚</p><blockquote><p>è§£å†³æ–¹æ¡ˆ</p></blockquote><p><strong>è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸ</strong><br>ä»ç¼“å­˜å±‚é¢æ¥çœ‹ï¼Œæ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°çƒ­ç‚¹ key è¿‡æœŸåäº§ç”Ÿçš„é—®é¢˜</p><p><strong>åŠ äº’æ–¥é”</strong><br>åˆ†å¸ƒå¼é”ï¼šä½¿ç”¨åˆ†å¸ƒå¼é”ï¼Œä¿è¯å¯¹äºæ¯ä¸ªkeyåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹å»æŸ¥è¯¢åç«¯æœåŠ¡ï¼Œå…¶ä»–çº¿ç¨‹æ²¡æœ‰è·å¾—åˆ†å¸ƒå¼é”çš„æƒé™ï¼Œå› æ­¤åªéœ€è¦ç­‰å¾…å³å¯ã€‚è¿™ç§æ–¹å¼å°†é«˜å¹¶å‘çš„å‹åŠ›è½¬ç§»åˆ°äº†åˆ†å¸ƒå¼é”ï¼Œå› æ­¤å¯¹åˆ†å¸ƒå¼é”çš„è€ƒéªŒå¾ˆå¤§</p><p><img src="https://s1.ax1x.com/2020/07/06/UiQFM9.png" alt="åŠ ä¸€ä¸ªé”æ¥æ§åˆ¶"></p><h4 id="ç¼“å­˜é›ªå´©"><a href="#ç¼“å­˜é›ªå´©" class="headerlink" title="ç¼“å­˜é›ªå´©"></a>ç¼“å­˜é›ªå´©</h4><blockquote><p>æ¦‚å¿µ</p></blockquote><p>ç¼“å­˜é›ªå´©ï¼Œæ˜¯æŒ‡åœ¨æŸä¸€ä¸ªæ—¶é—´æ®µï¼Œç¼“å­˜é›†ä¸­è¿‡æœŸå¤±æ•ˆï¼Œç„¶åRediså®•æœº</p><p><img src="https://s1.ax1x.com/2020/07/06/UiQYIf.png" alt="ç¼“å­˜é›ªå´©"></p><p>æ¯”å¦‚é©¬ä¸Šå°±è¦åˆ°åŒ11é›¶ç‚¹ï¼Œå¾ˆå¿«å°±ä¼šè¿æ¥ä¸€æ³¢æŠ¢è´­ï¼Œè¿™æ³¢å•†å“æ—¶é—´æ¯”è¾ƒé›†ä¸­çš„æ”¾å…¥äº†ç¼“å­˜ï¼Œå‡è®¾ç¼“å­˜ä¸€ä¸ªå°æ—¶ã€‚é‚£ä¹ˆåˆ°äº†å‡Œæ™¨ä¸€ç‚¹é’Ÿçš„æ—¶å€™ï¼Œè¿™æ‰¹å•†å“çš„ç¼“å­˜å°±éƒ½è¿‡æœŸäº†ã€‚è€Œå¯¹è¿™æ‰¹å•†å“çš„è®¿é—®æŸ¥è¯¢ï¼Œéƒ½è½åˆ°äº†æ•°æ®åº“ä¸Šï¼Œå¯¹äºæ•°æ®åº“è€Œè¨€ï¼Œå°±ä¼šäº§ç”Ÿå‘¨æœŸæ€§çš„å‹åŠ›æ³¢å³°ã€‚äºæ˜¯æ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šè¾¾åˆ°å­˜å‚¨å±‚ï¼Œå­˜å‚¨å±‚çš„è°ƒç”¨é‡ä¼šæš´å¢ï¼Œé€ æˆå­˜å‚¨å±‚ä¹Ÿä¼šæŒ‚æ‰çš„æƒ…å†µã€‚</p><blockquote><p>è§£å†³æ–¹æ¡ˆ</p></blockquote><p><strong>redisé«˜å¯ç”¨</strong><br>è¿™ä¸ªæ€æƒ³çš„å«ä¹‰æ˜¯ï¼Œæ—¢ç„¶redisæœ‰å¯èƒ½æŒ‚æ‰ï¼Œé‚£æˆ‘å¤šå¢è®¾å‡ å°redisï¼Œè¿™æ ·ä¸€å°æŒ‚æ‰ä¹‹åå…¶ä»–çš„è¿˜å¯ä»¥ç»§ç»­å·¥ä½œï¼Œå…¶å®å°±æ˜¯æ­å»ºçš„é›†ç¾¤ã€‚ï¼ˆå¼‚åœ°å¤šæ´»ï¼ï¼‰</p><p><strong>é™æµé™çº§</strong><br>è¿™ä¸ªè§£å†³æ–¹æ¡ˆçš„æ€æƒ³æ˜¯ï¼Œåœ¨ç¼“å­˜å¤±æ•ˆåï¼Œé€šè¿‡åŠ é”æˆ–è€…é˜Ÿåˆ—æ¥æ§åˆ¶è¯»æ•°æ®åº“å†™ç¼“å­˜çš„çº¿ç¨‹æ•°é‡ã€‚æ¯”å¦‚å¯¹æŸä¸ªkeyåªå…è®¸ä¸€ä¸ªçº¿ç¨‹æŸ¥è¯¢æ•°æ®å’Œå†™ç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…ã€‚</p><p><strong>æ•°æ®é¢„çƒ­</strong><br>æ•°æ®åŠ çƒ­çš„å«ä¹‰å°±æ˜¯åœ¨æ­£å¼éƒ¨ç½²ä¹‹å‰ï¼Œæˆ‘å…ˆæŠŠå¯èƒ½çš„æ•°æ®å…ˆé¢„å…ˆè®¿é—®ä¸€éï¼Œè¿™æ ·éƒ¨åˆ†å¯èƒ½å¤§é‡è®¿é—®çš„æ•°æ®å°±ä¼šåŠ è½½åˆ°ç¼“å­˜ä¸­ã€‚åœ¨å³å°†å‘ç”Ÿå¤§å¹¶å‘è®¿é—®å‰æ‰‹åŠ¨è§¦å‘åŠ è½½ç¼“å­˜ä¸åŒçš„keyï¼Œè®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œè®©ç¼“å­˜å¤±æ•ˆçš„æ—¶é—´ç‚¹å°½é‡å‡åŒ€ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>swaggerå­¦ä¹ </title>
      <link href="2020/06/28/swagger/"/>
      <url>2020/06/28/swagger/</url>
      
        <content type="html"><![CDATA[<h1 id="Swaggerå­¦ä¹ "><a href="#Swaggerå­¦ä¹ " class="headerlink" title="Swaggerå­¦ä¹ "></a>Swaggerå­¦ä¹ </h1><h2 id="Swagger-ç®€ä»‹"><a href="#Swagger-ç®€ä»‹" class="headerlink" title="Swagger ç®€ä»‹"></a>Swagger ç®€ä»‹</h2><p>Swagger æ˜¯ä¸€å¥—å›´ç»• Open API è§„èŒƒæ„å»ºçš„å¼€æºå·¥å…·ï¼Œå¯ä»¥å¸®åŠ©è®¾è®¡ï¼Œæ„å»ºï¼Œè®°å½•å’Œä½¿ç”¨RESTAPIã€‚</p><h2 id="Open-API-ç®€ä»‹"><a href="#Open-API-ç®€ä»‹" class="headerlink" title="Open API ç®€ä»‹"></a>Open API ç®€ä»‹</h2><p>Open API è§„èŒƒ(OpenAPI Specification)ä»¥å‰å«åš Swagger è§„èŒƒï¼Œæ˜¯RESTAPIçš„APIæè¿°æ ¼å¼ã€‚</p><p>Open API æ–‡ä»¶å…è®¸æè¿°æ•´ä¸ª APIï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>æ¯ä¸ªè®¿é—®åœ°å€çš„ç±»å‹ã€‚POST æˆ– GET</li><li>æ¯ä¸ªæ“ä½œçš„å‚æ•°ã€‚åŒ…æ‹¬è¾“å…¥è¾“å‡ºå‚æ•°</li><li>è®¤è¯æ–¹æ³•</li><li>è¿æ¥ä¿¡æ¯ï¼Œå£°æ˜ï¼Œä½¿ç”¨å›¢é˜Ÿå’Œå…¶ä»–ä¿¡æ¯</li></ul><p><a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3">æºç å’Œè¯´æ˜å‚ç…§ç‚¹æˆ‘æŸ¥çœ‹</a></p><h2 id="Springfox"><a href="#Springfox" class="headerlink" title="Springfox"></a>Springfox</h2><p>ä½¿ç”¨ Swagger æ—¶å¦‚æœç¢°è§ç‰ˆæœ¬æ›´æ–°æˆ–è¿­ä»£æ—¶ï¼Œåªéœ€è¦æ›´æ”¹Swagger çš„æè¿°æ–‡ä»¶å³å¯ã€‚ä½†æ˜¯åœ¨é¢‘ç¹çš„æ›´æ–°é¡¹ç›®ç‰ˆæœ¬æ—¶å¾ˆå¤šå¼€å‘äººå‘˜è®¤ä¸ºå³ä½¿ä¿®æ”¹æè¿°æ–‡ä»¶ï¼ˆyml æˆ– jsonï¼‰ä¹Ÿæ˜¯ä¸€å®šçš„å·¥ä½œè´Ÿæ‹…ï¼Œä¹…è€Œä¹…ä¹‹å°±ç›´æ¥ä¿®æ”¹ä»£ç ï¼Œè€Œä¸å»ä¿®æ”¹æè¿°æ–‡ä»¶äº†ï¼Œè¿™æ ·åŸºäºæè¿°æ–‡ä»¶ç”Ÿæˆæ¥å£æ–‡æ¡£ä¹Ÿå¤±å»äº†æ„ä¹‰ã€‚</p><p>Marty Pitt ç¼–å†™äº†ä¸€ä¸ªåŸºäº Spring çš„ç»„ä»¶ swagger-springmvcã€‚Spring-fox å°±æ˜¯æ ¹æ®è¿™ä¸ªç»„ä»¶å‘å±•è€Œæ¥çš„å…¨æ–°é¡¹ç›®ã€‚Spring-fox æ˜¯æ ¹æ®ä»£ç ç”Ÿæˆæ¥å£æ–‡æ¡£ï¼Œæ‰€ä»¥æ­£å¸¸çš„è¿›è¡Œæ›´æ–°é¡¹ç›®ç‰ˆæœ¬ï¼Œä¿®æ”¹ä»£ç å³å¯ï¼Œè€Œä¸éœ€è¦è·Ÿéšä¿®æ”¹æè¿°æ–‡ä»¶ã€‚</p><p><a href="http://springfox.github.io/springfox/">å®˜ç½‘åœ°å€</a></p><p><a href="https://github.com/springfox/springfox">å®˜æ–¹æºç </a></p><h2 id="Swgger-ä½¿ç”¨"><a href="#Swgger-ä½¿ç”¨" class="headerlink" title="Swgger ä½¿ç”¨"></a>Swgger ä½¿ç”¨</h2><h3 id="é¡¹ç›®æ­å»º"><a href="#é¡¹ç›®æ­å»º" class="headerlink" title="é¡¹ç›®æ­å»º"></a>é¡¹ç›®æ­å»º</h3><ul><li><p>ç¼–å†™ SpringBoot é¡¹ç›®ï¼Œé¡¹ç›®ä¸­ controller ä¸­åŒ…å«ä¸€ä¸ª Handlerï¼Œæµ‹è¯•é¡¹ç›®ï¼Œä¿è¯ç¨‹åºå¯ä»¥æ­£ç¡®è¿è¡Œã€‚</p></li><li><p>å¯¼å…¥ Spring-fox ä¾èµ–</p>  <pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>io.springfox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>springfox-swagger2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.9.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>io.springfox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>springfox-swagger-ui<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.9.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ä¹¦å†™é…ç½®ç±»</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span> <span class="token comment">// springbooté…ç½®ç±»</span><span class="token annotation punctuation">@EnableSwagger2</span> <span class="token comment">// ä»£è¡¨å¯ç”¨äº†swagger</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SwaggerConfig</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>è®¿é—® swagger-ui</p><blockquote><p>å¯åŠ¨é¡¹ç›®ååœ¨æµè§ˆå™¨ä¸­è¾“å…¥<a href="http://ip:port/swagger-ui.htmlå³å¯ä»¥">http://ip:port/swagger-ui.htmlå³å¯ä»¥</a><br>è®¿é—®åˆ° swagger-ui é¡µé¢ï¼Œåœ¨é¡µé¢ä¸­å¯ä»¥å¯è§†åŒ–çš„è¿›è¡Œæ“ä½œé¡¹ç›®ä¸­æ‰€æœ‰<br>æ¥å£ã€‚</p></blockquote></li></ul><h3 id="åŸºæœ¬ä¿¡æ¯é…ç½®"><a href="#åŸºæœ¬ä¿¡æ¯é…ç½®" class="headerlink" title="åŸºæœ¬ä¿¡æ¯é…ç½®"></a>åŸºæœ¬ä¿¡æ¯é…ç½®</h3><p>Docketï¼šæ‘˜è¦å¯¹è±¡ï¼Œé€šè¿‡å¯¹è±¡é…ç½®æè¿°æ–‡ä»¶çš„ä¿¡æ¯</p><p>apiInfo:è®¾ç½®æè¿°æ–‡ä»¶ä¸­ infoã€‚å‚æ•°ç±»å‹ ApiInfo</p><p>select():è¿”å› ApiSelectorBuilder å¯¹è±¡ï¼Œé€šè¿‡å¯¹è±¡è°ƒç”¨ build()å¯ä»¥åˆ›å»º Docket å¯¹è±¡<br>ï¼ˆè¿™é‡Œç”¨æ¥åˆ›é€ è€…æ¨¡å¼ï¼‰</p><p><strong>ä»£ç å¦‚ä¸‹</strong>ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token annotation punctuation">@EnableSwagger2</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SwaggerConfig</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * é…ç½®swaggerçš„docket beanå®ä¾‹     * @return     */</span>    <span class="token annotation punctuation">@Bean</span>    <span class="token keyword">public</span> <span class="token class-name">Docket</span> <span class="token function">docket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">ApiInfo</span> apiInfo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">apiInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span>  <span class="token keyword">new</span> <span class="token class-name">Docket</span><span class="token punctuation">(</span><span class="token class-name">DocumentationType</span><span class="token punctuation">.</span>SWAGGER_2<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">apiInfo</span><span class="token punctuation">(</span>apiInfo<span class="token punctuation">)</span>                <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment">// 1ã€æŒ‡å®šæ‰«æçš„åŒ…ï¼Œè¿™äº›åŒ…ä¸‹æœ‰ç”¨ï¼Œå…¶ä»–çš„æ²¡ç”¨</span>                <span class="token comment">//.apis(RequestHandlerSelectors.basePackage("com.study.swagger.controller"))</span>                <span class="token comment">//.apis(RequestHandlerSelectors.basePackage("com.study.swagger.pojo"))</span>                <span class="token comment">// 2ã€é…ç½®è¿‡æ»¤ï¼Œè¿™äº›è·¯å¾„éƒ½ä¸ä½¿ç”¨</span>               <span class="token comment">// .paths(PathSelectors.ant("/hello"))</span>                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">ApiInfo</span> <span class="token function">apiInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">// ä½œè€…ä¿¡æ¯</span>        <span class="token class-name">Contact</span> contact <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Contact</span><span class="token punctuation">(</span><span class="token string">"å§“å"</span><span class="token punctuation">,</span> <span class="token string">"ä½ çš„ç½‘ç«™æˆ–è€…ä¸ªäººåšå®¢"</span><span class="token punctuation">,</span> <span class="token string">"é‚®ç®±"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span>  <span class="token keyword">new</span> <span class="token class-name">ApiInfo</span><span class="token punctuation">(</span><span class="token string">"zhy"</span>                <span class="token punctuation">,</span> <span class="token string">"description"</span>                <span class="token punctuation">,</span> <span class="token string">"0.1"</span><span class="token comment">//ä½ çš„ç‰ˆæœ¬</span>                <span class="token punctuation">,</span> <span class="token string">"http://zhang_hao_yu123.gitee.io"</span>                <span class="token punctuation">,</span> contact <span class="token comment">//ä½œè€…ä¿¡æ¯</span>                <span class="token punctuation">,</span> <span class="token string">"Apache 2.0"</span>                <span class="token punctuation">,</span> <span class="token string">"http://www.apache.org/licenses/LICENSE-2.0"</span> <span class="token comment">//é˜¿å¸•å¥‡è‡ªå·±çš„ï¼Œä¸åŠ¨</span>                <span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/07/02/NbKBRJ.png" alt="æ•ˆæœå›¾"></p><h3 id="å¸¸ç”¨æ³¨è§£"><a href="#å¸¸ç”¨æ³¨è§£" class="headerlink" title="å¸¸ç”¨æ³¨è§£"></a>å¸¸ç”¨æ³¨è§£</h3><ul><li><p><code>@NotIncludeSwagger</code></p><blockquote><p>åœ¨ä¸éœ€è¦ç”Ÿæˆæ¥å£æ–‡æ¡£çš„æ–¹æ³•ä¸Šé¢æ·»åŠ @NotIncludeSwagger æ³¨è§£åï¼Œè¯¥æ–¹æ³•å°†ä¸ä¼šè¢« Swagger è¿›è¡Œç”Ÿæˆåœ¨æ¥å£æ–‡æ¡£ä¸­ã€‚</p>  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@NotIncludeSwagger</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/getPeople2"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token class-name">People</span> <span class="token function">getPeople2</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> address<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">People</span> peo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">People</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    peo<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>    peo<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    peo<span class="token punctuation">.</span><span class="token function">setAddress</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> peo<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote></li><li><p><code>@Api</code></p><blockquote><p>@Api æ˜¯ç±»ä¸Šæ³¨è§£ã€‚æ§åˆ¶æ•´ä¸ªç±»ç”Ÿæˆæ¥å£ä¿¡æ¯çš„å†…å®¹ã€‚</p></blockquote><ul><li><p>tagsï¼šç±»çš„åç§°ã€‚å¯ä»¥æœ‰å¤šä¸ªå€¼ï¼Œå¤šä¸ªå€¼è¡¨ç¤ºå¤šä¸ªå‰¯æœ¬ã€‚</p></li><li><p>description:æè¿°ï¼Œå·²è¿‡æ—¶ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/people"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Api</span><span class="token punctuation">(</span>tags <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"mydemo"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>description <span class="token operator">=</span> <span class="token string">"æè¿°"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoController</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ swagger-ui.html ä¸­æ˜¾ç¤ºæ•ˆæœ:<br><img src="https://s1.ax1x.com/2020/07/02/NbMuO1.png" alt="@Api"></p></li></ul></li><li><p><code>@ApiOperation</code></p><blockquote><p>@ApiOperation å†™åœ¨æ–¹æ³•ä¸Šï¼Œå¯¹æ–¹æ³•è¿›è¡Œæ€»ä½“æè¿°</p></blockquote><ul><li>valueï¼šæ¥å£æè¿°</li><li>notesï¼šæç¤ºä¿¡æ¯<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"æ¥å£æè¿°"</span><span class="token punctuation">,</span>notes <span class="token operator">=</span> <span class="token string">"æ¥å£æç¤ºä¿¡æ¯"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>åœ¨ swagger-ui ä¸­æ˜¾ç¤ºæ•ˆæœ:<br><img src="https://s1.ax1x.com/2020/07/02/NbQ4KA.png" alt="@ApiOperation"></li></ul></li><li><p><code>@ApiParam</code></p><blockquote><p>@ApiParam å†™åœ¨æ–¹æ³•å‚æ•°å‰é¢ã€‚ç”¨äºå¯¹å‚æ•°è¿›è¡Œæè¿°æˆ–è¯´æ˜æ˜¯å¦ä¸ºå¿…æ·»é¡¹ç­‰è¯´æ˜ã€‚</p></blockquote><ul><li>nameï¼šå‚æ•°åç§°</li><li>valueï¼šå‚æ•°æè¿°</li><li>requiredï¼šæ˜¯å¦æ˜¯å¿…é¡»<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">People</span> <span class="token function">getPeople</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">,</span> <span class="token annotation punctuation">@ApiParam</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"å§“å"</span><span class="token punctuation">,</span>required <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span>  <span class="token class-name">String</span> address<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>æ•ˆæœå›¾ï¼š<br><img src="https://s1.ax1x.com/2020/07/02/NblJsA.png" alt="@ApiParam"></li></ul></li><li><p><code>@ApiModel</code></p><blockquote><p>@ApiModelæ˜¯ç±»ä¸Šæ³¨è§£ï¼Œä¸»è¦åº”ç”¨ Modelï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªæ³¨è§£ä¸€èˆ¬éƒ½æ˜¯å†™åœ¨å®ä½“ç±»ä¸Šã€‚</p></blockquote><ul><li>valueï¼šåç§°</li><li>descriptionï¼šæè¿°<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ApiModel</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"äººç±»"</span><span class="token punctuation">,</span>description <span class="token operator">=</span> <span class="token string">"æè¿°"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">People</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>æ•ˆæœå›¾ï¼š<br><img src="https://s1.ax1x.com/2020/07/02/Nbl4WF.png" alt="@ApiModel"></li></ul></li><li><p><code>@ApiModelProperty</code></p><blockquote><p>@ApiModelProperty å¯ä»¥ç”¨åœ¨æ–¹æ³•æˆ–å±æ€§ä¸Šã€‚ç”¨äºå½“å¯¹è±¡ä½œä¸ºå‚æ•°æ—¶å®šä¹‰è¿™ä¸ªå­—æ®µçš„å†…å®¹ã€‚</p></blockquote><ul><li>valueï¼šæè¿°</li><li>nameï¼šé‡å†™å±æ€§å</li><li>requiredï¼šæ˜¯å¦æ˜¯å¿…é¡»çš„</li><li>exampleï¼šç¤ºä¾‹å†…å®¹</li><li>hiddenï¼šæ˜¯å¦éšè—<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ApiModelProperty</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"å§“å"</span><span class="token punctuation">,</span>name <span class="token operator">=</span> <span class="token string">"name"</span><span class="token punctuation">,</span>required <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>example <span class="token operator">=</span> <span class="token string">"å¼ ä¸‰"</span><span class="token punctuation">)</span><span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>æ•ˆæœå›¾ï¼š<br><img src="https://s1.ax1x.com/2020/07/02/NblXFK.png" alt="@ApiModelProperty"></li></ul></li><li><p><code>@ApiIgnore</code></p></li></ul><blockquote><p>@ApiIgnore ç”¨äºæ–¹æ³•æˆ–ç±»æˆ–å‚æ•°ä¸Šï¼Œè¡¨ç¤ºè¿™ä¸ªæ–¹æ³•æˆ–ç±»è¢«å¿½ç•¥ã€‚å’Œä¹‹å‰è®²è§£çš„è‡ªå®šä¹‰æ³¨è§£@NotIncludeSwagger æ•ˆæœç±»ä¼¼ã€‚åªæ˜¯è¿™ä¸ªæ³¨è§£æ˜¯ Swagger å†…ç½®çš„æ³¨è§£ï¼Œè€Œ@NotIncludeSwagger æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„æ³¨è§£ã€‚</p></blockquote><ul><li><p><code>@ApiImplicitParam</code></p><blockquote><p>@ApiImplicitParam ç”¨åœ¨æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºå•ç‹¬çš„è¯·æ±‚å‚æ•°ï¼Œæ€»ä½“åŠŸèƒ½å’Œ@ApiParam ç±»ä¼¼ã€‚</p></blockquote><ul><li><p>nameï¼šå±æ€§å</p></li><li><p>valueï¼šæè¿°</p></li><li><p>requiredï¼šæ˜¯å¦æ˜¯å¿…é¡»çš„</p></li><li><p>paramTypeï¼šå±æ€§ç±»å‹</p></li><li><p>dataTypeï¼šæ•°æ®ç±»å‹</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/getPeople"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@ApiImplicitParam</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"address"</span><span class="token punctuation">,</span>value <span class="token operator">=</span> <span class="token string">"åœ°å€"</span><span class="token punctuation">,</span>required <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>paramType <span class="token operator">=</span><span class="token string">"query"</span><span class="token punctuation">,</span>dataType <span class="token operator">=</span> <span class="token string">"string"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token class-name">People</span> <span class="token function">getPeople</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">,</span> <span class="token annotation punctuation">@ApiParam</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"å§“å"</span><span class="token punctuation">,</span>required <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> address<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ•ˆæœå›¾ï¼š<br><img src="https://s1.ax1x.com/2020/07/02/Nb1lT0.png" alt="@ApiImplicitParam"></p><p>å¦‚æœå¸Œæœ›åœ¨æ–¹æ³•ä¸Šé…ç½®å¤šä¸ªå‚æ•°æ—¶ï¼Œä½¿ç”¨@ApiImplicitParams è¿›è¡Œé…ç½®ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ApiImplicitParams</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token annotation punctuation">@ApiImplicitParam</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span>value <span class="token operator">=</span> <span class="token string">"ç¼–å·"</span><span class="token punctuation">,</span>required <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token annotation punctuation">@ApiImplicitParam</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"name"</span><span class="token punctuation">,</span>value <span class="token operator">=</span> <span class="token string">"å§“å"</span><span class="token punctuation">,</span>required <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> swagger </category>
          
      </categories>
      
      
        <tags>
            
            <tag> swagger </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginxå­¦ä¹ </title>
      <link href="2020/06/25/nginx-xue-xi/"/>
      <url>2020/06/25/nginx-xue-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="Nginxå­¦ä¹ "><a href="#Nginxå­¦ä¹ " class="headerlink" title="Nginxå­¦ä¹ "></a>Nginxå­¦ä¹ </h1><h2 id="ç›¸å…³ç®€ä»‹"><a href="#ç›¸å…³ç®€ä»‹" class="headerlink" title="ç›¸å…³ç®€ä»‹"></a>ç›¸å…³ç®€ä»‹</h2><h3 id="è½¯ä»¶ä»‹ç»"><a href="#è½¯ä»¶ä»‹ç»" class="headerlink" title="è½¯ä»¶ä»‹ç»"></a>è½¯ä»¶ä»‹ç»</h3><blockquote><p>Nginxæ˜¯ä¸€æ¬¾è½»é‡çº§çš„Web æœåŠ¡å™¨/åå‘ä»£ç†æœåŠ¡å™¨åŠç”µå­é‚®ä»¶ï¼ˆIMAP/POP3ï¼‰ä»£ç†æœåŠ¡å™¨ï¼Œåœ¨BSD-like åè®®ä¸‹å‘è¡Œã€‚å…¶ç‰¹ç‚¹æ˜¯<font color = red>å æœ‰å†…å­˜å°‘ï¼Œå¹¶å‘èƒ½åŠ›å¼º</font>ï¼Œäº‹å®ä¸Šnginxçš„å¹¶å‘èƒ½åŠ›åœ¨åŒç±»å‹çš„ç½‘é¡µæœåŠ¡å™¨ä¸­è¡¨ç°è¾ƒå¥½ï¼Œä¸­å›½å¤§é™†ä½¿ç”¨nginxç½‘ç«™ç”¨æˆ·æœ‰ï¼šç™¾åº¦ã€äº¬ä¸œã€æ–°æµªã€ç½‘æ˜“ã€è…¾è®¯ã€æ·˜å®ç­‰ã€‚</p></blockquote><p><strong>nginxæœ€é«˜å¹¶å‘æ”¯æŒ50000ä¸ª</strong></p><h3 id="æ­£å‘ä»£ç†å’Œåå‘ä»£ç†"><a href="#æ­£å‘ä»£ç†å’Œåå‘ä»£ç†" class="headerlink" title="æ­£å‘ä»£ç†å’Œåå‘ä»£ç†"></a>æ­£å‘ä»£ç†å’Œåå‘ä»£ç†</h3><p><img src="https://s1.ax1x.com/2020/06/25/NBCsMt.jpg" alt="äºŒè€…åŒºåˆ«"><br><strong>æ­£å‘ä»£ç†</strong></p><blockquote><p>åœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰é…ç½®ä»£ç†æœåŠ¡å™¨ï¼Œé€šè¿‡ä»£ç†æœåŠ¡å™¨è¿›è¡Œäº’è”ç½‘è®¿é—®</p></blockquote><p><strong>åå‘ä»£ç†</strong></p><blockquote><p>å®¢æˆ·ç«¯ä¸çŸ¥é“å®é™…æä¾›æœåŠ¡çš„æœåŠ¡ç«¯ï¼Œç”¨æˆ·åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°nginxä¸­ï¼Œå†ç”±nginxå»å‘é€åˆ°å¯¹åº”çš„æœåŠ¡å™¨ï¼Œä»è€Œéšè—äº†çœŸå®çš„æœåŠ¡å™¨ï¼Œæé«˜äº†æœåŠ¡å™¨çš„å®‰å…¨æ€§ã€‚</p></blockquote><h3 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h3><p><img src="https://s1.ax1x.com/2020/06/25/NBi3B6.png" alt="è´Ÿè½½å‡è¡¡æ¡ˆä¾‹å›¾"></p><blockquote><p>è´Ÿè½½å‡è¡¡ï¼ˆLoad Balanceï¼‰å…¶æ„æ€å°±æ˜¯åˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šè¿›è¡Œæ‰§è¡Œï¼Œä¾‹å¦‚WebæœåŠ¡å™¨ã€FTPæœåŠ¡å™¨ã€ä¼ä¸šå…³é”®åº”ç”¨æœåŠ¡å™¨å’Œå…¶å®ƒå…³é”®ä»»åŠ¡æœåŠ¡å™¨ç­‰ï¼Œä»è€Œå…±åŒå®Œæˆå·¥ä½œä»»åŠ¡ã€‚</p></blockquote><h3 id="åŠ¨é™åˆ†ç¦»"><a href="#åŠ¨é™åˆ†ç¦»" class="headerlink" title="åŠ¨é™åˆ†ç¦»"></a>åŠ¨é™åˆ†ç¦»</h3><p><img src="https://s1.ax1x.com/2020/06/25/NBFVKI.png" alt="åŠ¨é™åˆ†ç¦»"></p><blockquote><p>ä¸ºäº†åŠ å¿«ç½‘ç«™çš„è§£æé€Ÿåº¦ï¼Œå¯ä»¥æŠŠåŠ¨æ€é¡µé¢å’Œé™æ€é¡µé¢ç”±ä¸åŒçš„æœåŠ¡å™¨æ¥è§£æï¼ŒåŠ å¿«è§£æé€Ÿåº¦ã€‚é™ä½åŸæ¥å•ä¸ªæœåŠ¡å™¨çš„å‹åŠ›</p></blockquote><h2 id="nginxçš„å®‰è£…"><a href="#nginxçš„å®‰è£…" class="headerlink" title="nginxçš„å®‰è£…"></a>nginxçš„å®‰è£…</h2><ul><li>ä½¿ç”¨è¿œç¨‹è¿æ¥å·¥å…·è¿æ¥Linuxæ“ä½œç³»ç»Ÿ  </li><li>å®‰è£…nginxç›¸å…³çš„ä¾èµ–<ul><li>gcc<blockquote><p>å®‰è£… nginx éœ€è¦å…ˆå°†å®˜ç½‘ä¸‹è½½çš„æºç è¿›è¡Œç¼–è¯‘ï¼Œç¼–è¯‘ä¾èµ– gcc ç¯å¢ƒï¼Œå¦‚æœæ²¡æœ‰ gccç¯å¢ƒ éœ€è¦å®‰è£… gcc<br>  yum install gcc-c++</p></blockquote></li><li>PCRE<blockquote><p>PCRE(Perl Compatible Regular Expressions)æ˜¯ä¸€ä¸ª Perl åº“ï¼ŒåŒ…æ‹¬ perl å…¼å®¹çš„æ­£åˆ™è¡¨è¾¾å¼åº“ã€‚nginx çš„ http æ¨¡å—ä½¿ç”¨ pcre æ¥è§£ææ­£åˆ™è¡¨è¾¾å¼ï¼Œæ‰€ä»¥éœ€è¦åœ¨ linux ä¸Šå®‰è£… pcre åº“ã€‚<br>  yum install -y pcre pcre-deve</p></blockquote></li><li>zlib<blockquote><p>zlib åº“æä¾›äº†å¾ˆå¤šç§å‹ç¼©å’Œè§£å‹ç¼©çš„æ–¹å¼ï¼Œnginx ä½¿ç”¨ zlib å¯¹ http åŒ…çš„å†…å®¹è¿›è¡Œ gzipï¼Œæ‰€ä»¥éœ€è¦åœ¨ linux ä¸Šå®‰è£… zlib åº“ã€‚<br>  yum install -y zlib zlib-devel</p></blockquote></li><li>openssl<blockquote><p>OpenSSL æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å®‰å…¨å¥—æ¥å­—å±‚å¯†ç åº“ï¼Œå›Šæ‹¬ä¸»è¦çš„å¯†ç ç®—æ³•ã€å¸¸ç”¨çš„å¯†é’¥å’Œè¯ä¹¦å°è£…ç®¡ç†åŠŸèƒ½åŠ SSL åè®®ï¼Œå¹¶æä¾›ä¸°å¯Œçš„åº”ç”¨ç¨‹åºä¾›æµ‹è¯•æˆ–å…¶å®ƒç›®çš„ä½¿ç”¨ã€‚<br>  nginx ä¸ä»…æ”¯æŒ http åè®®ï¼Œè¿˜æ”¯æŒ httpsï¼ˆå³åœ¨ ssl åè®®ä¸Šä¼ è¾“ httpï¼‰ï¼Œæ‰€ä»¥éœ€è¦åœ¨<br>  linux å®‰è£… openssl åº“ã€‚<br>  yum install -y openssl openssl-devel</p></blockquote></li></ul></li><li>nginxå®‰è£…<ul><li>æŠŠåœ¨å®˜ç½‘ä¸‹è½½çš„å‹ç¼©åŒ…æ”¾åˆ°linuxç³»ç»Ÿä¸­å¹¶è§£å‹</li><li>è¿›å…¥è§£å‹çš„ç›®å½•ä¸­è¿è¡Œ ./configure</li><li>å†æ‰§è¡Œç¼–è¯‘å’Œå®‰è£… make &amp;&amp; make install</li></ul></li></ul><h2 id="nginxçš„å¯åŠ¨å’Œåœæ­¢"><a href="#nginxçš„å¯åŠ¨å’Œåœæ­¢" class="headerlink" title="nginxçš„å¯åŠ¨å’Œåœæ­¢"></a>nginxçš„å¯åŠ¨å’Œåœæ­¢</h2><p><strong>nginxçš„å¯åŠ¨</strong></p><blockquote><p>è¿›å…¥/usr/localç›®å½•ä¸‹ï¼Œä¼šå‘ç°å¤šäº†ä¸€ä¸ªnginxçš„ç›®å½•<br><img src="https://s1.ax1x.com/2020/06/25/NBEBRg.png" alt="nginxç›®å½•å†…å®¹"></p></blockquote><blockquote><p>è¿›å…¥ç›®å½•ä¸­çš„sbinç›®å½•ï¼Œå¹¶æ‰§è¡Œ ./nginxå³å¯è¿è¡Œ<br>è¾“å…¥ ps aux | grep nginxå¯ä»¥çœ‹åˆ°å·²ç»å¯åŠ¨äº†<br><img src="https://s1.ax1x.com/2020/06/25/NBViwt.png" alt="å¯åŠ¨"></p></blockquote><blockquote><p>æˆ‘ä»¬é€šè¿‡è®¿é—®IPåœ°å€ï¼Œå°±èƒ½çœ‹åˆ°æ•ˆæœ<br><strong>å¦‚æœä¸èƒ½è®¿é—®çš„è¯ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰æ”¾è¡Œç«¯å£</strong><br><img src="https://s1.ax1x.com/2020/06/25/NBVlT0.png" alt="è®¿é—®"></p></blockquote><p><strong>nginxçš„åœæ­¢</strong>  </p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">cd &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;sbin  .&#x2F;nginx -s quit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="nginxçš„å¸¸ç”¨å‘½ä»¤"><a href="#nginxçš„å¸¸ç”¨å‘½ä»¤" class="headerlink" title="nginxçš„å¸¸ç”¨å‘½ä»¤"></a>nginxçš„å¸¸ç”¨å‘½ä»¤</h2><ul><li><code>./nginx -v</code> æŸ¥çœ‹ç‰ˆæœ¬</li><li><code>./nginx</code> å¯åŠ¨</li><li><code>./nginx -s -quit</code> å…³é—­</li><li><code>./nginx -s reload</code> é…ç½®æ–‡ä»¶é‡åŠ è½½</li></ul><h2 id="nginxé…ç½®æ–‡ä»¶"><a href="#nginxé…ç½®æ–‡ä»¶" class="headerlink" title="nginxé…ç½®æ–‡ä»¶"></a>nginxé…ç½®æ–‡ä»¶</h2><h3 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h3><p><strong>æ–‡ä»¶åœ¨../nginx/conf/nginx.conf</strong><br><img src="https://s1.ax1x.com/2020/06/25/NBKMm4.png" alt="nginxé…ç½®æ–‡ä»¶"></p><h3 id="é…ç½®æ–‡ä»¶ç»„æˆ"><a href="#é…ç½®æ–‡ä»¶ç»„æˆ" class="headerlink" title="é…ç½®æ–‡ä»¶ç»„æˆ"></a>é…ç½®æ–‡ä»¶ç»„æˆ</h3><ul><li><p>å…¨å±€å—</p><blockquote><p>ä»é…ç½®æ–‡ä»¶å¼€å§‹åˆ°eventså—ä¹‹é—´çš„å†…å®¹ï¼Œä¸»è¦è®¾ç½®ä¸€äº›å½±å“nginxæœåŠ¡å™¨æ•´ä½“è¿è¡Œçš„é…ç½®æŒ‡ä»¤</p></blockquote></li><li><p>eventså—</p><blockquote><p>eventså—æ¶‰åŠçš„æŒ‡ä»¤ä¸»è¦å½±å“NginxæœåŠ¡å™¨ä¸ç”¨æˆ·çš„ç½‘ç»œè¿æ¥</p></blockquote></li><li><p>httpå—</p><ul><li><p>httpå…¨å±€å—</p><blockquote><p>æœ€é‡è¦çš„éƒ¨åˆ†</p></blockquote></li><li><p>serverå—</p><blockquote><p>è¿™å—ä¸è™šæ‹Ÿä¸»æœºæœ‰å¯†åˆ‡å…³ç³»</p></blockquote><ul><li><p>å…¨å±€serverå—</p><blockquote><p>æœ€å¸¸è§çš„é…ç½®æ˜¯æœ¬è™šæ‹Ÿæœºä¸»æœºçš„ç›‘å¬é…ç½®å’Œæœ¬è™šæ‹Ÿæœºä¸»æœºçš„åç§°æˆ–è€…ipé…ç½®</p></blockquote></li><li><p>locationå—</p><blockquote><p>ä¸€ä¸ªserverå—å¯ä»¥é…ç½®å¤šä¸ªlocationå—ï¼Œä¸»è¦ä½œç”¨æ˜¯åŸºäºNginxæœåŠ¡å™¨æ¥æ”¶åˆ°çš„è¯·æ±‚å­—ç¬¦ä¸²ï¼Œå¯¹è™šæ‹Ÿä¸»æœºåç§°ä¹‹å¤–çš„å­—ç¬¦ä¸²è¿›è¡ŒåŒ¹é…ï¼Œå¯¹ç‰¹å®šçš„è¯·æ±‚è¿›è¡Œå¤„ç†ã€‚</p></blockquote></li></ul></li></ul></li></ul><h2 id="nginxçš„ä½¿ç”¨"><a href="#nginxçš„ä½¿ç”¨" class="headerlink" title="nginxçš„ä½¿ç”¨"></a>nginxçš„ä½¿ç”¨</h2><h3 id="åå‘ä»£ç†"><a href="#åå‘ä»£ç†" class="headerlink" title="åå‘ä»£ç†"></a>åå‘ä»£ç†</h3><h4 id="æ¡ˆä¾‹ä¸€"><a href="#æ¡ˆä¾‹ä¸€" class="headerlink" title="æ¡ˆä¾‹ä¸€"></a>æ¡ˆä¾‹ä¸€</h4><p><strong>é…ç½®åå‘ä»£ç†ï¼Œè®©æœ¬åœ°è®¿é—®<a href="http://www.123.comçš„æ—¶å€™è·³è½¬åˆ°Linuxä¸­çš„localhost:8080é¡µé¢">www.123.comçš„æ—¶å€™è·³è½¬åˆ°Linuxä¸­çš„localhost:8080é¡µé¢</a></strong></p><ul><li><p>ä¿®æ”¹æœ¬æœºhost</p><blockquote><p>æ‰“å¼€Cç›˜ä¸‹çš„<code>Windows\System32\drivers\etc</code>ä¸­çš„hostsï¼Œæ·»åŠ <code>è™šæ‹Ÿæœºip + www.123.com</code>ï¼Œåšä¸€ä¸ªè‡ªæ…°ç‰ˆçš„åŸŸå</p></blockquote><p>  <img src="https://s1.ax1x.com/2020/06/25/NBwY9O.png" alt="hosts"></p></li><li><p>é…ç½®Linuxä¸­çš„nginx.confæ–‡ä»¶å†…å®¹<br>  <img src="https://s1.ax1x.com/2020/06/25/NB0TeA.png" alt="NB0TeA.png"></p></li><li><p>æœ¬åœ°è®¿é—® <a href="http://www.123.com,å®ç°ç»“æœ/">www.123.comï¼Œå®ç°ç»“æœ</a><br>  <img src="https://s1.ax1x.com/2020/06/25/NBBQFx.png" alt="NBBQFx.png"></p></li></ul><p><strong>æ€»ç»“</strong></p><blockquote><p>é€šè¿‡è¿™ä¸ªæ¡ˆä¾‹å¯ä»¥äº†è§£åˆ°nginxçš„åå‘ä»£ç†æœºåˆ¶å’Œä½¿ç”¨</p></blockquote><h4 id="æ¡ˆä¾‹äºŒ"><a href="#æ¡ˆä¾‹äºŒ" class="headerlink" title="æ¡ˆä¾‹äºŒ"></a>æ¡ˆä¾‹äºŒ</h4><p><strong>æ ¹æ®è®¿é—®çš„è·¯å¾„è·³è½¬åˆ°ä¸åŒç«¯å£çš„æœåŠ¡ä¸­,nginxç›‘å¬ç«¯å£9001</strong></p><blockquote><p>è®¿é—® 192.168.111.130:9001/edu/a.htmlè·³è½¬åˆ°ä¸€ä¸ªtomcatä¸Š<br>è®¿é—®192.168.111.130:9001/dov/a.htmlè·³è½¬åˆ°å¦ä¸€ä¸ªtomcatä¸Š</p></blockquote><ul><li><p>å‰æœŸå‡†å¤‡</p><ul><li><p>é…ç½®ä¸¤ä¸ªtomcatï¼Œä¸€ä¸ª8080ç«¯å£ä¸€ä¸ª8081ç«¯å£ï¼Œåˆ«å¿˜äº†æ”¾è¡Œç«¯å£</p></li><li><p>åˆ†åˆ«åœ¨<code>/webapps</code>ç›®å½•ä¸‹åˆ›å»º<code>edu</code>å’Œ<code>vod</code>ï¼Œå¹¶ä¸”éšä¾¿å†™ä¸€ä¸ªé¡µé¢ç”¨äºéªŒè¯(æˆ‘è¿™é‡Œåˆ†åˆ«ç”¨è™šæ‹Ÿæœºå’Œé˜¿é‡Œäº‘è·‘ä¸¤ä¸ªtomcat)</p><p>  è¿™æ˜¯8080ç«¯å£çš„<br>  <img src="https://s1.ax1x.com/2020/06/25/NBgc8I.png" alt="8080"></p><p>  è¿™æ˜¯8081ç«¯å£çš„<br>  <img src="https://s1.ax1x.com/2020/06/25/NBgIaQ.png" alt="8081"></p></li></ul></li><li><p>ä¿®æ”¹é…ç½®æ–‡ä»¶<br>  <img src="https://s1.ax1x.com/2020/06/25/NBRikQ.png" alt="ä¿®æ”¹é…ç½®æ–‡ä»¶"></p></li><li><p>è¿è¡Œ</p><p>  è®¿é—®/vod/<br>  <img src="https://s1.ax1x.com/2020/06/25/NBfYdO.png" alt="NBfYdO.png"><br>  è®¿é—®/edu/<br>  <img src="https://s1.ax1x.com/2020/06/25/NBfaJH.png" alt="NBfaJH.png"></p></li></ul><p><strong>æ€»ç»“</strong></p><blockquote><p>é€šè¿‡è¿™ä¸ªæ¡ˆä¾‹å¯ä»¥ç†è§£serverç›‘å¬ç«¯å£çš„ä¿®æ”¹ï¼Œlocationçš„ä¸€éƒ¨åˆ†è¯­æ³•ï¼Œå¯ä»¥å°†å¤šä¸ªé¡¹ç›®éƒ¨ç½²åˆ°åŒä¸€ä¸ªnginxä¸Š</p></blockquote><p><strong>locationè¯­æ³•</strong></p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">location[&#x3D; | ~ | ~* |^~] uri&#123;    proxy_pass http:&#x2F;&#x2F;127.0.0.1:8080;#    xxxxx xxxxx&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://s1.ax1x.com/2020/06/25/NBf3sx.png" alt="NBf3sx.png"></p><h3 id="è´Ÿè½½å‡è¡¡-1"><a href="#è´Ÿè½½å‡è¡¡-1" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h3><h4 id="æ¡ˆä¾‹ä¸€-1"><a href="#æ¡ˆä¾‹ä¸€-1" class="headerlink" title="æ¡ˆä¾‹ä¸€"></a>æ¡ˆä¾‹ä¸€</h4><p><strong>æµè§ˆå™¨è®¿é—®<a href="http://192.168.111.130/edu/a.html%EF%BC%8C%E5%AE%9E%E7%8E%B0%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%EF%BC%8C%E5%B9%B3%E5%9D%87%E5%88%B08080%E5%92%8C8081%E7%AB%AF%E5%8F%A3%E4%B8%AD">http://192.168.111.130/edu/a.htmlï¼Œå®ç°è´Ÿè½½å‡è¡¡ï¼Œå¹³å‡åˆ°8080å’Œ8081ç«¯å£ä¸­</a></strong></p><ul><li>å‰æœŸå‡†å¤‡<ul><li>é…ç½®ä¸¤ä¸ªtomcatï¼Œä¸€ä¸ª8080ç«¯å£ä¸€ä¸ª8081ç«¯å£ï¼Œåˆ«å¿˜äº†æ”¾è¡Œç«¯å£</li><li>åˆ†åˆ«åœ¨<code>/webapps</code>ç›®å½•ä¸‹åˆ›å»º<code>edu</code>ï¼Œå¹¶ä¸”å†™ä¸€ä¸ª<code>a.html</code>é¡µé¢ç”¨äºéªŒè¯(æˆ‘è¿™é‡Œåˆ†åˆ«ç”¨è™šæ‹Ÿæœºå’Œé˜¿é‡Œäº‘è·‘ä¸¤ä¸ªtomcat)</li></ul></li><li>ä¿®æ”¹é…ç½®æ–‡ä»¶</li></ul><h4 id="nginxåˆ†é…æœåŠ¡å™¨ç­–ç•¥"><a href="#nginxåˆ†é…æœåŠ¡å™¨ç­–ç•¥" class="headerlink" title="nginxåˆ†é…æœåŠ¡å™¨ç­–ç•¥"></a>nginxåˆ†é…æœåŠ¡å™¨ç­–ç•¥</h4><ul><li><p>è½®è¯¢(é»˜è®¤)</p><blockquote><p>æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨downæ‰ï¼Œèƒ½è‡ªåŠ¨å‰”é™¤ã€‚</p></blockquote><p>  <img src="https://s1.ax1x.com/2020/06/25/NDSLNQ.png" alt="NDSLNQ.png"></p></li><li><p>æƒé‡weight</p><blockquote><p>weightä»£è¡¨æƒé‡é»˜è®¤ä¸º1,æƒé‡è¶Šé«˜è¢«åˆ†é…çš„å®¢æˆ·ç«¯è¶Šå¤š</p></blockquote><p>  <img src="https://s1.ax1x.com/2020/06/25/NDSIjP.png" alt="weight"></p></li><li><p>ip_hash</p><blockquote><p>æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—®ipçš„hashç»“æœåˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨,<font color = red>è¿™ç§æ–¹å¼å¯ä»¥è§£å†³sessionç›¸å…³çš„é—®é¢˜</font></p></blockquote><p>  <img src="https://s1.ax1x.com/2020/06/25/NDp14H.png" alt="NDp14H.png"></p></li><li><p>fair</p><blockquote><p>æ ¹æ®æµè§ˆå™¨å¯¹æ‰€æœ‰æœåŠ¡å™¨çš„ç›¸åº”æ—¶é—´æ¥åˆ†é…ï¼Œä¼˜å…ˆæœ€çŸ­çš„</p></blockquote><p>  <img src="https://s1.ax1x.com/2020/06/25/NDpLqK.png" alt="NDpLqK.png"></p><h4 id="è´Ÿè½½å‡è¡¡çš„å‚æ•°"><a href="#è´Ÿè½½å‡è¡¡çš„å‚æ•°" class="headerlink" title="è´Ÿè½½å‡è¡¡çš„å‚æ•°"></a>è´Ÿè½½å‡è¡¡çš„å‚æ•°</h4></li><li><p><code>upstream</code>æ¯ä¸ªè®¾å¤‡çš„çŠ¶æ€</p></li><li><p><code>down</code> è¡¨ç¤ºå•å‰çš„ server æš‚æ—¶ä¸å‚ä¸è´Ÿè½½</p></li><li><p><code>weight</code> é»˜è®¤ä¸º 1.weight è¶Šå¤§ï¼Œè´Ÿè½½çš„æƒé‡å°±è¶Šå¤§</p></li><li><p><code>fail_timeout</code> æ¬¡å¤±è´¥åï¼Œæš‚åœçš„æ—¶é—´ é»˜è®¤ 10s</p></li><li><p><code>max_fails</code> å…è®¸è¯·æ±‚å¤±è´¥çš„æ¬¡æ•°é»˜è®¤ä¸º 1.å½“è¶…è¿‡æœ€å¤§æ¬¡æ•°æ—¶ï¼Œè¿”å›</p></li><li><p><code>backup</code> å…¶å®ƒæ‰€æœ‰çš„é backup æœºå™¨ down æˆ–è€…å¿™çš„æ—¶å€™ï¼Œè¯·æ±‚ backup æœºå™¨ã€‚æ‰€ä»¥è¿™å°æœºå™¨å‹åŠ›ä¼šæœ€è½»ã€‚</p></li></ul><h3 id="åŠ¨é™åˆ†ç¦»-1"><a href="#åŠ¨é™åˆ†ç¦»-1" class="headerlink" title="åŠ¨é™åˆ†ç¦»"></a>åŠ¨é™åˆ†ç¦»</h3><blockquote><p>nginxæŠŠåŠ¨æ€è¯·æ±‚å’Œé™æ€è¯·æ±‚åˆ†ç¦»ï¼Œtomcatå¤„ç†åŠ¨æ€è¯·æ±‚ã€‚<strong>ä¸€ç§æ˜¯æŠŠå­˜ç²¹çš„é™æ€èµ„æºæ”¾åœ¨ä¸€ä¸ªç‹¬ç«‹çš„æœåŠ¡å™¨ï¼Œè¿™æ˜¯ä¸»æµçš„æ–¹æ¡ˆï¼Œå³å‰åç«¯åˆ†ç¦»ã€‚å¦ä¸€ç§æ˜¯åŠ¨æ€å’Œé™æ€æ–‡ä»¶æ··åˆåœ¨ä¸€èµ·å‘å¸ƒï¼Œé€šè¿‡nginxåˆ†å¼€ï¼Œå¦‚jspé¡¹ç›®</strong></p></blockquote><p><img src="https://s1.ax1x.com/2020/06/25/NDC439.png" alt="åŠ¨é™åˆ†ç¦»åŸç†å›¾"></p><p>å®ç°æ“ä½œè·Ÿä¸Šé¢çš„å·®ä¸å¤šï¼Œå°±ä¸åˆ—ä¸¾äº†ã€‚</p><h3 id="é«˜å¯ç”¨"><a href="#é«˜å¯ç”¨" class="headerlink" title="é«˜å¯ç”¨"></a>é«˜å¯ç”¨</h3><h4 id="å›¾æ–‡ä»‹ç»"><a href="#å›¾æ–‡ä»‹ç»" class="headerlink" title="å›¾æ–‡ä»‹ç»"></a>å›¾æ–‡ä»‹ç»</h4><p><img src="https://s1.ax1x.com/2020/06/25/NDF11J.png" alt="NDF11J.png"></p><p>è§£å†³ï¼š<br><img src="https://s1.ax1x.com/2020/06/25/NDklUf.png" alt="NDklUf.png"></p><h4 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h4><ul><li>ä¸¤å°nginxæœåŠ¡å™¨<br>  <strong>ä¸¤å°éƒ½éœ€è¦æœ‰tomcatï¼Œnginxï¼Œkeepalived</strong></li><li>keepalived  <pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yum install keepalived -y# å¯åŠ¨keepalivedsystemctl start keepalived.service<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li>è™šæ‹Ÿip</li></ul><h4 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h4><ul><li>ä¿®æ”¹/etc/keepalived/keepalivec.conf é…ç½®æ–‡ä»¶  <pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">! Configuration File for keepalivedglobal_defs &#123;notification_email &#123;    acassen@firewall.loc    failover@firewall.loc    sysadmin@firewall.loc&#125;notification_email_from Alexandre.Cassen@firewall.locsmtp_server 192.168.200.1smtp_connect_timeout 30router_id LVS_DEVEL     # ç»‘å®šhostsé‡Œçš„127.0.0.1vrrp_skip_check_adv_addrvrrp_strictvrrp_garp_interval 0vrrp_gna_interval 0&#125;#è„šæœ¬vrrp_script chk_http_port &#123;script &quot;&#x2F;usr&#x2F;local&#x2F;src&#x2F;nginx_check.sh&quot;interval 2 #ï¼ˆæ£€æµ‹è„šæœ¬æ‰§è¡Œçš„é—´éš”ï¼‰weight 2&#125;#vrrp_instance VI_1 &#123;    state MASTER  #ä¸»æœåŠ¡å™¨MASTERï¼Œå¤‡ç”¨æœåŠ¡å™¨BACKUP    interface ens32 # éœ€è¦ä¸ä½ çš„ç½‘å¡ç±»å‹ç›¸åŒ    virtual_router_id 51 #ä¸»å¤‡æœºéƒ½è¦ç›¸åŒ    priority 100 # æƒé‡ä¸»å¤‡æœºä¸€èˆ¬åˆ†åˆ«æ˜¯100 90    advert_int 1    authentication &#123;         auth_type PASS  # è®¤è¯ç­–ç•¥å¯†ç         auth_pass 1111    &#125;    virtual_ipaddress &#123;  # è™šæ‹Ÿipç»‘å®šï¼Œå¯ä»¥æ˜¯å¤šä¸ª        192.168.200.16        192.168.200.17        192.168.200.18    &#125;&#125;virtual_server 192.168.200.100 443 &#123;    delay_loop 6    lb_algo rr    lb_kind NAT    persistence_timeout 50    protocol TCP    real_server 192.168.201.100 443 &#123;        weight 1        SSL_GET &#123;            url &#123;            path &#x2F;            digest ff20ad2481f97b1754ef3e12ecd3a9cc            &#125;            url &#123;            path &#x2F;mrtg&#x2F;            digest 9b3a0c85a887a256d6939da88aabd8cd            &#125;            connect_timeout 3            nb_get_retry 3            delay_before_retry 3        &#125;    &#125;&#125;virtual_server 10.10.10.2 1358 &#123;    delay_loop 6    lb_algo rr     lb_kind NAT    persistence_timeout 50    protocol TCP    sorry_server 192.168.200.200 1358    real_server 192.168.200.2 1358 &#123;        weight 1        HTTP_GET &#123;            url &#123;             path &#x2F;testurl&#x2F;test.jsp            digest 640205b7b0fc66c1ea91c463fac6334d            &#125;            url &#123;             path &#x2F;testurl2&#x2F;test.jsp            digest 640205b7b0fc66c1ea91c463fac6334d            &#125;            url &#123;             path &#x2F;testurl3&#x2F;test.jsp            digest 640205b7b0fc66c1ea91c463fac6334d            &#125;            connect_timeout 3            nb_get_retry 3            delay_before_retry 3        &#125;    &#125;    real_server 192.168.200.3 1358 &#123;        weight 1        HTTP_GET &#123;            url &#123;             path &#x2F;testurl&#x2F;test.jsp            digest 640205b7b0fc66c1ea91c463fac6334c            &#125;            url &#123;             path &#x2F;testurl2&#x2F;test.jsp            digest 640205b7b0fc66c1ea91c463fac6334c            &#125;            connect_timeout 3            nb_get_retry 3            delay_before_retry 3        &#125;    &#125;&#125;virtual_server 10.10.10.3 1358 &#123;    delay_loop 3    lb_algo rr     lb_kind NAT    persistence_timeout 50    protocol TCP    real_server 192.168.200.4 1358 &#123;        weight 1        HTTP_GET &#123;            url &#123;             path &#x2F;testurl&#x2F;test.jsp            digest 640205b7b0fc66c1ea91c463fac6334d            &#125;            url &#123;             path &#x2F;testurl2&#x2F;test.jsp            digest 640205b7b0fc66c1ea91c463fac6334d            &#125;            url &#123;             path &#x2F;testurl3&#x2F;test.jsp            digest 640205b7b0fc66c1ea91c463fac6334d            &#125;            connect_timeout 3            nb_get_retry 3            delay_before_retry 3        &#125;    &#125;    real_server 192.168.200.5 1358 &#123;        weight 1        HTTP_GET &#123;            url &#123;             path &#x2F;testurl&#x2F;test.jsp            digest 640205b7b0fc66c1ea91c463fac6334d            &#125;            url &#123;             path &#x2F;testurl2&#x2F;test.jsp            digest 640205b7b0fc66c1ea91c463fac6334d            &#125;            url &#123;             path &#x2F;testurl3&#x2F;test.jsp            digest 640205b7b0fc66c1ea91c463fac6334d            &#125;            connect_timeout 3            nb_get_retry 3            delay_before_retry 3        &#125;    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>åœ¨<code>/usr/local/src/</code>ä¸‹æ·»åŠ å¯¹åº”çš„è„šæœ¬  <pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">#!&#x2F;bin&#x2F;bashA&#x3D;&#96;ps -C nginx â€“no-header |wc -l&#96;if [ $A -eq 0 ];then    &#x2F;usr&#x2F;local&#x2F;nginx&#x2F;sbin&#x2F;nginx  #ç›‘è§†çš„è·¯å¾„ï¼Œå°±æ˜¯nginxçš„å¯åŠ¨    sleep 2    if [ &#96;ps -C nginx --no-header |wc -l&#96; -eq 0 ];then        killall keepalived    fifi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h4></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼</title>
      <link href="2020/06/23/she-ji-mo-shi/"/>
      <url>2020/06/23/she-ji-mo-shi/</url>
      
        <content type="html"><![CDATA[<h1 id="è®¾è®¡æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼" class="headerlink" title="è®¾è®¡æ¨¡å¼"></a>è®¾è®¡æ¨¡å¼</h1><h2 id="åˆ›å»ºå‹æ¨¡å¼"><a href="#åˆ›å»ºå‹æ¨¡å¼" class="headerlink" title="åˆ›å»ºå‹æ¨¡å¼"></a>åˆ›å»ºå‹æ¨¡å¼</h2><h3 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h3><p>æ ¸å¿ƒä½œç”¨ï¼šä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªè®¿é—®è¯¥å®ä¾‹çš„å…¨å±€è®¿é—®ç‚¹</p><p>å¸¸è§åº”ç”¨åœºæ™¯ï¼š<br><img src="https://s1.ax1x.com/2020/06/23/NtRKgg.jpg" alt="NtRKgg.jpg"></p><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><ul><li>ç”±äºå•ä¾‹æ¨¡å¼åªç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†ç³»ç»Ÿæ€§èƒ½å¼€é”€ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„äº§ç”Ÿéœ€è¦æ¯”è¾ƒå¤šçš„èµ„æºæ—¶ï¼Œå¦‚è¯»å–é…ç½®ã€äº§ç”Ÿå…¶ä»–ä¾èµ–å¯¹è±¡æ—¶ï¼Œåˆ™å¯ä»¥é€šè¿‡åœ¨åº”ç”¨å¯åŠ¨æ—¶ç›´æ¥äº§ç”Ÿä¸€ä¸ªå•ä¾‹å¯¹è±¡ï¼Œç„¶åæ°¸ä¹…é©»ç•™å†…å­˜çš„æ–¹å¼æ¥è§£å†³</li><li>å•ä¾‹æ¨¡å¼å¯ä»¥åœ¨ç³»ç»Ÿè®¾ç½®å…¨å±€çš„è®¿é—®ç‚¹ï¼Œä¼˜åŒ–ç¯å…±äº«èµ„æºè®¿é—®ï¼Œä¾‹å¦‚å¯ä»¥è®¾è®¡ä¸€ä¸ªå•ä¾‹ç±»ï¼Œè´Ÿè´£æ‰€æœ‰æ•°æ®è¡¨çš„æ˜ å°„å¤„ç†</li></ul><h4 id="å¸¸è§çš„äº”ç§å•ä¾‹æ¨¡å¼å®ç°æ–¹å¼"><a href="#å¸¸è§çš„äº”ç§å•ä¾‹æ¨¡å¼å®ç°æ–¹å¼" class="headerlink" title="å¸¸è§çš„äº”ç§å•ä¾‹æ¨¡å¼å®ç°æ–¹å¼"></a>å¸¸è§çš„äº”ç§å•ä¾‹æ¨¡å¼å®ç°æ–¹å¼</h4><ul><li>ä¸»è¦ï¼š<ul><li>é¥¿æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼Œè°ƒç”¨æ•ˆç‡é«˜ã€‚ ä½†æ˜¯ï¼Œä¸èƒ½å»¶æ—¶åŠ è½½ã€‚ï¼‰<ul><li>é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼ä»£ç ä¸­ï¼Œstaticå˜é‡ä¼šåœ¨ç±»è£…è½½æ—¶åˆå§‹åŒ–ï¼Œæ­¤æ—¶ä¹Ÿä¸ä¼šæ¶‰åŠå¤šä¸ªçº¿ç¨‹å¯¹è±¡è®¿é—®è¯¥å¯¹è±¡çš„é—®é¢˜ã€‚è™šæ‹Ÿæœºä¿è¯åªä¼šè£…è½½ä¸€æ¬¡è¯¥ç±»ï¼Œè‚¯å®šä¸ä¼šå‘ç”Ÿå¹¶å‘è®¿é—®çš„é—®é¢˜ã€‚å› æ­¤ï¼Œå¯ä»¥çœç•¥synchronizedå…³é”®å­—ã€‚<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// ç±»åˆå§‹åŒ–ï¼Œç«‹å³åŠ è½½ï¼Œå¤©ç„¶çº¿ç¨‹å®‰å…¨</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> singleton <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ç§æœ‰æ„é€ å™¨</span>     <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token comment">// æä¾›å”¯ä¸€æ–¹æ³•è°ƒç”¨ç±»å¯¹è±¡ï¼Œæ–¹æ³•æ²¡æœ‰åŒæ­¥ï¼Œè°ƒç”¨æ•ˆç‡é«˜</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> singleton<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li><li>æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼Œè°ƒç”¨æ•ˆç‡ä¸é«˜ã€‚ ä½†æ˜¯ï¼Œå¯ä»¥å»¶æ—¶åŠ è½½ã€‚ï¼‰  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton2</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// å»¶è¿ŸåŠ è½½ï¼ŒçœŸæ­£ç”¨çš„æ—¶å€™æ‰åŠ è½½ï¼Œèµ„æºåˆ©ç”¨æ•ˆç‡é«˜ï¼Œè°ƒç”¨æ•ˆç‡ä½</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton2</span> instance<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">Singleton2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token comment">// æ–¹æ³•åŒæ­¥è°ƒç”¨æ•ˆç‡ä½</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token class-name">Singleton2</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li><li>å…¶ä»–ï¼š<ul><li>åŒé‡æ£€æµ‹é”å¼ï¼ˆç”±äºJVMåº•å±‚å†…éƒ¨æ¨¡å‹åŸå› ï¼Œå¶å°”ä¼šå‡ºé—®é¢˜ã€‚ä¸å»ºè®®ä½¿ç”¨ï¼‰  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton3</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**    * è¿™ä¸ªæ¨¡å¼å°†åŒæ­¥å†…å®¹ä¸‹æ–¹åˆ°ifå†…éƒ¨ï¼Œæé«˜äº†æ‰§è¡Œçš„æ•ˆç‡    * ä¸å¿…æ¯æ¬¡è·å–å¯¹è±¡æ—¶éƒ½è¿›è¡ŒåŒæ­¥ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡æ‰åŒæ­¥    * åˆ›å»ºäº†ä»¥åå°±æ²¡å¿…è¦äº†    *    *    */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Singleton3</span> instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton3</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Singleton3</span> sc<span class="token punctuation">;</span>            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Singleton3</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                sc <span class="token operator">=</span> instance<span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>sc <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">Singleton3</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span>sc <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                            sc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                    instance <span class="token operator">=</span> sc<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">Singleton3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>é™æ€å†…éƒ¨ç±»å¼(çº¿ç¨‹å®‰å…¨ï¼Œè°ƒç”¨æ•ˆç‡é«˜ã€‚ ä½†æ˜¯ï¼Œå¯ä»¥å»¶æ—¶åŠ è½½)<ul><li>å¤–éƒ¨ç±»æ²¡æœ‰staticå±æ€§ï¼Œåˆ™ä¸ä¼šåƒé¥¿æ±‰å¼é‚£æ ·ç«‹å³åŠ è½½å¯¹è±¡ã€‚</li><li>åªæœ‰çœŸæ­£è°ƒç”¨getInstance(),æ‰ä¼šåŠ è½½é™æ€å†…éƒ¨ç±»ã€‚åŠ è½½ç±»æ—¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ instanceæ˜¯static finalç±»å‹ï¼Œä¿è¯äº†å†…å­˜ä¸­åªæœ‰è¿™æ ·ä¸€ä¸ªå®ä¾‹å­˜åœ¨ï¼Œè€Œä¸”åªèƒ½è¢«èµ‹å€¼ä¸€æ¬¡ï¼Œä»è€Œä¿è¯äº†çº¿ç¨‹å®‰å…¨æ€§. </li><li>å…¼å¤‡äº†å¹¶å‘é«˜æ•ˆè°ƒç”¨å’Œå»¶è¿ŸåŠ è½½çš„ä¼˜åŠ¿ï¼<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Singleton4</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span>  <span class="token class-name">Singleton4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">SingletonClassInstance</span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Singleton4</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton4</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">SingletonClassInstance</span><span class="token punctuation">.</span>instance<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li><li>æšä¸¾å•ä¾‹(çº¿ç¨‹å®‰å…¨ï¼Œè°ƒç”¨æ•ˆç‡é«˜ï¼Œä¸èƒ½å»¶æ—¶åŠ è½½)  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Singleton5</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**    * å®šä¹‰ä¸€ä¸ªæšä¸¾å…ƒç´ ï¼Œä»£è¡¨ä¸€ä¸ªå®ä¾‹    *ä¸€ä¸ªæšä¸¾å…ƒç´ æœ¬èº«å°±æ˜¯å•ä¾‹    */</span>    INSTANCE<span class="token punctuation">;</span>    <span class="token comment">/**    * å•ä¾‹å¯ä»¥æœ‰è‡ªå·±çš„æ“ä½œ    */</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">singletonOperation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token comment">//åŠŸèƒ½å¤„ç†</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li><li>æ³¨æ„ï¼š<ul><li>é˜²æ­¢åå°„è·å–ä¸åŒå¯¹è±¡çš„æ¼æ´  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// é—®é¢˜ï¼šé€šè¿‡åå°„è·å–åˆ°æ„é€ æ–¹æ³•ï¼Œå¯ä»¥åŒæ—¶åˆ›å»ºå¤šä¸ªå¯¹è±¡</span><span class="token class-name">Constructor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> constructor <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token function">getConstructor</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>constructor<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// åˆ›å»ºå‡ºçš„obj1å’Œobj2çš„åœ°å€æ˜¯ä¸ä¸€æ ·çš„</span><span class="token class-name">T</span> obj1 <span class="token operator">=</span> constructor<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">T</span> obj2 <span class="token operator">=</span> constructor<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è§£å†³ï¼šå› ä¸ºæ¯æ¬¡newå¯¹è±¡éƒ½è¦è°ƒç”¨æ„é€ æ–¹æ³•ï¼Œæ‰€ä»¥åœ¨æ„é€ æ–¹æ³•é‡Œåˆ¤ç©ºå³å¯</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">T</span> instance<span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token class-name">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>instance<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>é˜²æ­¢ååºåˆ—åŒ–è·å–ä¸åŒå¯¹è±¡çš„æ¼æ´  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">T</span> instance<span class="token punctuation">;</span><span class="token comment">// ååºåˆ—åŒ–æ—¶ï¼Œå¦‚æœå®šä¹‰äº†readResolve()åˆ™ç›´æ¥è¿”å›æ­¤æ–¹æ³•çš„æŒ‡å®šå¯¹è±¡ï¼Œä¸ç”¨å•ç‹¬åˆ›å»ºå¯¹è±¡</span><span class="token keyword">private</span> <span class="token class-name">Object</span> <span class="token function">readResolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ObjectStreamException</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> instance<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li></ul><h4 id="å¦‚ä½•é€‰æ‹©"><a href="#å¦‚ä½•é€‰æ‹©" class="headerlink" title="å¦‚ä½•é€‰æ‹©"></a>å¦‚ä½•é€‰æ‹©</h4><ul><li><strong>å•ä¾‹å¯¹è±¡å ç”¨èµ„æºå°‘ï¼Œä¸éœ€è¦å»¶æ—¶åŠ è½½</strong><ul><li>æšä¸¾å¼å¥½äºé¥¿æ±‰å¼</li></ul></li><li><strong>å•ä¾‹å¯¹è±¡å ç”¨èµ„æºå¤§ï¼Œéœ€è¦å»¶æ—¶åŠ è½½</strong><ul><li>é™æ€å†…éƒ¨ç±»å¼å¥½äºæ‡’æ±‰å¼</li></ul></li></ul><h3 id="å·¥å‚æ¨¡å¼"><a href="#å·¥å‚æ¨¡å¼" class="headerlink" title="å·¥å‚æ¨¡å¼"></a>å·¥å‚æ¨¡å¼</h3><h4 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><ul><li><p>å®ç°äº†åˆ›å»ºè€…å’Œè°ƒç”¨è€…çš„åˆ†ç¦»</p></li><li><p>è¯¦ç»†åˆ†ç±»</p><ul><li>ç®€å•å·¥å‚æ¨¡å¼</li><li>å·¥å‚æ–¹æ³•æ¨¡å¼</li><li>æŠ½è±¡å·¥å‚æ¨¡å¼<h4 id="é¢å‘å¯¹è±¡è®¾è®¡çš„åŸºæœ¬åŸåˆ™"><a href="#é¢å‘å¯¹è±¡è®¾è®¡çš„åŸºæœ¬åŸåˆ™" class="headerlink" title="é¢å‘å¯¹è±¡è®¾è®¡çš„åŸºæœ¬åŸåˆ™"></a>é¢å‘å¯¹è±¡è®¾è®¡çš„åŸºæœ¬åŸåˆ™</h4></li></ul></li><li><p>OCPï¼ˆå¼€é—­åŸåˆ™ï¼ŒOpen-Closed Principleï¼‰ï¼šä¸€ä¸ªè½¯ä»¶çš„å®ä½“åº”å½“å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚</p></li><li><p>DIPï¼ˆä¾èµ–å€’è½¬åŸåˆ™ï¼ŒDependence Inversion Principleï¼‰ï¼šè¦é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œä¸è¦é’ˆå¯¹å®ç°ç¼–ç¨‹ã€‚</p></li><li><p>LoDï¼ˆè¿ªç±³ç‰¹æ³•åˆ™ï¼ŒLaw of Demeterï¼‰ï¼šåªä¸ä½ ç›´æ¥çš„æœ‹å‹é€šä¿¡ï¼Œè€Œé¿å…å’Œé™Œç”Ÿäººé€šä¿¡ã€‚</p></li></ul><h4 id="æ ¸å¿ƒæœ¬è´¨"><a href="#æ ¸å¿ƒæœ¬è´¨" class="headerlink" title="æ ¸å¿ƒæœ¬è´¨"></a>æ ¸å¿ƒæœ¬è´¨</h4><ul><li>å®ä¾‹åŒ–å¯¹è±¡ï¼Œç”¨å·¥å‚æ–¹æ³•ä»£æ›¿newæ“ä½œ</li><li>å°†é€‰æ‹©å®ç°ç±»ã€åˆ›å»ºå¯¹è±¡ç»Ÿä¸€ç®¡ç†å’Œæ§åˆ¶ã€‚ä»è€Œå°†è°ƒç”¨è€…è·Ÿæˆ‘ä»¬å®ç°ç±»è§£è€¦</li></ul>]]></content>
      
      
      <categories>
          
          <category> GOF23 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GOF23 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ELè¡¨è¾¾å¼å’Œjstl</title>
      <link href="2020/06/19/el-biao-da-shi-he-jstl/"/>
      <url>2020/06/19/el-biao-da-shi-he-jstl/</url>
      
        <content type="html"><![CDATA[<h1 id="ELè¡¨è¾¾å¼å’Œjstl"><a href="#ELè¡¨è¾¾å¼å’Œjstl" class="headerlink" title="ELè¡¨è¾¾å¼å’Œjstl"></a>ELè¡¨è¾¾å¼å’Œjstl</h1><p>ä½œç”¨ï¼šè§£å†³äº†jspé¡µé¢æ•°æ®æ¸²æŸ“ä»£ç å†—ä½™çš„æ¯›ç—…ï¼Œæ›´åŠ ç®€å•ä¾¿æ·</p><h2 id="ELè¡¨è¾¾å¼"><a href="#ELè¡¨è¾¾å¼" class="headerlink" title="ELè¡¨è¾¾å¼"></a>ELè¡¨è¾¾å¼</h2><h3 id="ä½¿ç”¨ELè¡¨è¾¾å¼è·å–è¯·æ±‚æ•°æ®"><a href="#ä½¿ç”¨ELè¡¨è¾¾å¼è·å–è¯·æ±‚æ•°æ®" class="headerlink" title="ä½¿ç”¨ELè¡¨è¾¾å¼è·å–è¯·æ±‚æ•°æ®"></a>ä½¿ç”¨ELè¡¨è¾¾å¼è·å–è¯·æ±‚æ•°æ®</h3><ul><li>è·å–ç”¨æˆ·è¯·æ±‚æ•°æ®<ul><li><code>$&#123;param.é”®å&#125;</code> è·å–è¯·æ±‚å®ä½“ä¸­ä¸€ä¸ªé”®ä¸€ä¸ªå€¼çš„æ•°æ®</li><li><code>$&#123;paramValues.é”®å&#125;</code> è·å–è¯·æ±‚å®ä½“ä¸­åŒé”®ä¸åŒå€¼çš„æ•°æ®ï¼Œè¿”å›çš„æ˜¯Stringæ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨è§’æ ‡ç›´æ¥è·å– ä¾‹å¦‚ï¼šçˆ±å¥½</li></ul></li><li>è·å–è¯·æ±‚å¤´æ•°æ®<ul><li><code>$&#123;header&#125;</code>  è¿”å›æ‰€æœ‰çš„è¯·æ±‚å¤´æ•°æ®ï¼Œé”®å€¼å¯¹å½¢å¼</li><li><code>$&#123;header[&quot;é”®å&quot;]&#125;</code> è¿”å›æŒ‡å®šçš„é”®çš„è¯·æ±‚å¤´æ•°æ®</li><li><code>$&#123;headerValues[&quot;é”®å&quot;]&#125;</code>è¿”å›æŒ‡å®šçš„é”®å(åŒé”®ä¸åŒå€¼)çš„å€¼çš„æ•°ç»„</li></ul></li><li>è·å–Cookieæ•°æ®<ul><li><code>$&#123;cookie&#125;</code> è·å–æ‰€æœ‰çš„Cookieå¯¹è±¡,é”®å€¼å¯¹</li><li><code>$&#123;cookie.Cookieå¯¹è±¡çš„é”®å&#125;</code> è·å–å­˜å‚¨äº†æŒ‡å®šCookieæ•°æ®çš„Cookieå¯¹è±¡</li><li><code>$&#123;cookie.Cookieå¯¹è±¡çš„é”®å.name&#125;</code> è·å–å­˜å‚¨äº†æŒ‡å®šCookieæ•°æ®çš„Cookieå¯¹è±¡çš„å­˜å‚¨çš„é”®</li><li><code>$&#123;cookie.Cookieå¯¹è±¡çš„é”®å.value&#125;</code>è·å–å­˜å‚¨äº†æŒ‡å®šCookieæ•°æ®çš„Cookieå¯¹è±¡çš„å­˜å‚¨çš„å€¼<h3 id="ä½¿ç”¨ELè¡¨è¾¾å¼è·å–ä½œç”¨åŸŸæ•°æ®"><a href="#ä½¿ç”¨ELè¡¨è¾¾å¼è·å–ä½œç”¨åŸŸæ•°æ®" class="headerlink" title="ä½¿ç”¨ELè¡¨è¾¾å¼è·å–ä½œç”¨åŸŸæ•°æ®"></a>ä½¿ç”¨ELè¡¨è¾¾å¼è·å–ä½œç”¨åŸŸæ•°æ®</h3>ä½œç”¨åŸŸå¯¹è±¡ï¼špageContext  request  session application </li></ul></li><li>è·å–ä½œç”¨åŸŸæ•°æ® <ul><li>æ™®é€šå­—ç¬¦ä¸²æ•°æ® <code>$&#123;é”®å&#125;</code></li><li>å¯¹è±¡æ•°æ® <code>$&#123;é”®å.å±æ€§å&#125;</code></li><li>é›†åˆæ•°æ®<ul><li>listé›†åˆ <code>$&#123;é”®å[è§’æ ‡]&#125;</code></li><li>Mapé›†åˆ <code>$&#123;mapé›†åˆä½œç”¨åŸŸå­˜å‚¨çš„é”®å.mapé›†åˆå­˜å‚¨çš„æ•°æ®çš„é”®å&#125;</code></li></ul></li><li>ä½œç”¨åŸŸæŸ¥æ‰¾é¡ºåº <ul><li>pageContextâ€“&gt;requestâ€“&gt;sessionâ€“&gt;application</li></ul></li><li>è·å–æŒ‡å®šä½œç”¨åŸŸä¸­çš„æ•°æ® <ul><li><code>$&#123;pageScope.é”®å&#125;</code>       æŒ‡æ˜è·å–pageContextä½œç”¨åŸŸä¸­çš„æ•°æ®</li><li><code>$&#123;requestScope.é”®å&#125;</code>    æŒ‡æ˜è·å–requestä½œç”¨åŸŸä¸­çš„æ•°æ®</li><li><code>$&#123;sessionScope.é”®å&#125;</code>    æŒ‡æ˜è·å–sessionä½œç”¨åŸŸä¸­çš„æ•°æ®</li><li><code>$&#123;applicationScope.é”®å&#125;</code>æŒ‡æ˜è·å–applicationä½œç”¨åŸŸä¸­çš„æ•°æ®</li></ul></li></ul></li></ul><h3 id="ä½¿ç”¨ELè¡¨è¾¾å¼è¿›è¡Œè¿ç®—"><a href="#ä½¿ç”¨ELè¡¨è¾¾å¼è¿›è¡Œè¿ç®—" class="headerlink" title="ä½¿ç”¨ELè¡¨è¾¾å¼è¿›è¡Œè¿ç®—"></a>ä½¿ç”¨ELè¡¨è¾¾å¼è¿›è¡Œè¿ç®—</h3><ul><li>ç®—æœ¯è¿ç®—  <code>$&#123;1+2&#125;</code></li><li>å…³ç³»è¿ç®—  <code>$&#123;æ¯”è¾ƒè¡¨è¾¾å¼&#125;</code></li><li>é€»è¾‘è¿ç®—  <code>$&#123;é€»è¾‘è¡¨è¾¾å¼&#125;</code> ELè¡¨è¾¾å¼é‡Œæ²¡æœ‰&amp;å’Œ|<h3 id="ä½¿ç”¨ELè¡¨è¾¾å¼ç©ºå€¼åˆ¤æ–­empty"><a href="#ä½¿ç”¨ELè¡¨è¾¾å¼ç©ºå€¼åˆ¤æ–­empty" class="headerlink" title="ä½¿ç”¨ELè¡¨è¾¾å¼ç©ºå€¼åˆ¤æ–­empty"></a>ä½¿ç”¨ELè¡¨è¾¾å¼ç©ºå€¼åˆ¤æ–­empty</h3></li><li><code>$&#123;empty é”®å&#125;</code> åˆ¤æ–­è¯¥é”®æ˜¯å¦æœ‰å­˜å‚¨æœ‰æ•ˆæ•°æ®</li></ul><h2 id="jstl"><a href="#jstl" class="headerlink" title="jstl"></a>jstl</h2><h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>JSTLï¼ˆJava server pages standarded tag libraryï¼Œå³JSPæ ‡å‡†æ ‡ç­¾åº“ï¼‰æ˜¯ç”±JCPï¼ˆJava community Procesï¼‰æ‰€åˆ¶å®šçš„æ ‡å‡†è§„èŒƒï¼Œå®ƒä¸»è¦æä¾›ç»™Java Webå¼€å‘äººå‘˜ä¸€ä¸ªæ ‡å‡†é€šç”¨çš„æ ‡ç­¾åº“ï¼Œå¹¶ç”±Apacheçš„Jakartaå°ç»„æ¥ç»´æŠ¤ã€‚å¼€å‘äººå‘˜å¯ä»¥åˆ©ç”¨è¿™äº›æ ‡ç­¾å–ä»£JSPé¡µé¢ä¸Šçš„Javaä»£ç ï¼Œä»è€Œæé«˜ç¨‹åºçš„å¯è¯»æ€§ï¼Œé™ä½ç¨‹åºçš„ç»´æŠ¤éš¾åº¦ã€‚</p><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><ul><li>å¯¼å…¥jaråŒ…<ul><li>jstl.jar</li><li>standard.jar</li></ul></li><li>ä½¿ç”¨taglibæ ‡ç­¾å¼•å…¥èµ„æºï¼Œ<code>&lt;%@taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;</code></li><li>æ ¸å¿ƒæ ‡ç­¾åº“<ul><li><code>c:out value=&quot;$&#123;è¡¨è¾¾å¼&#125;&quot; default=&quot;é»˜è®¤å€¼&quot;</code> å°†æ•°æ®ç›´æ¥æ˜¾ç¤ºåˆ°é¡µé¢ä¸Š</li><li><code>c:set value=&quot;æ•°æ®&quot; var=&quot;é”®å&quot; scope=&quot;ä½œç”¨åŸŸå&quot;</code> å­˜å‚¨æ•°æ®åˆ°ä½œç”¨åŸŸå¯¹è±¡ä¸­</li><li><code>c:remove var=&quot;è¦åˆ é™¤æ•°æ®çš„é”®å&quot; scope=&quot;ä½œç”¨åŸŸå&quot;</code> åˆ é™¤ä½œç”¨åŸŸä¸­çš„æŒ‡å®šé”®çš„æ•°æ®</li><li><code>c:if test=&quot;$&#123;è¡¨è¾¾å¼&#125;&quot;</code> é€»è¾‘åˆ¤æ–­æ ‡ç­¾éœ€è¦ä¾èµ–äºELçš„é€»è¾‘è¿ç®—ï¼Œä¹Ÿå°±æ˜¯è¡¨è¾¾å¼ä¸­æ¶‰åŠåˆ°çš„æ•°æ®å¿…é¡»ä»ä½œç”¨åŸŸä¸­è·å–</li><li><code>c:choose</code> æ¡ä»¶æˆç«‹åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œéƒ½ä¸æˆç«‹åˆ™æ‰§è¡Œotherwise<ul><li><code>&lt;c:when  test=&quot;&quot;&gt;æ‰§è¡Œå†…å®¹&lt;/c:when&gt;</code></li><li><code>&lt;c:otherwise&gt;æ‰§è¡Œå†…å®¹&lt;/c:otherwise&gt;</code><br><img src="https://s1.ax1x.com/2020/06/19/NMGDXT.png" alt="chooseä¾‹å­"></li></ul></li><li><code>c:foreach</code><ul><li><code>begin</code>:å£°æ˜å¾ªç¯çš„å¼€å§‹ä½ç½®</li><li><code>end</code>:å£°æ˜å¾ªç¯çš„ç»“æŸä½ç½®</li><li><code>step</code>:å£°æ˜å¾ªç¯çš„æ­¥é•¿</li><li><code>varStatus</code>:å£°æ˜å˜é‡è®°å½•å¾ªç¯çŠ¶æ€ ,ä¾‹å¦‚å˜é‡å:i</li><li><code>items</code>:å£°æ˜è¦éå†çš„æ•°æ®ï¼Œå¯ä»¥æ˜¯é›†åˆå’Œæ•°ç»„ç­‰,ä½¿ç”¨ELè¡¨è¾¾å¼æ¥è·å–</li><li><code>var</code>:å£°æ˜å˜é‡è®°å½•æ¯æ¬¡éå†çš„ç»“æœã€‚å¯ä»¥åšå¾ªç¯ä½“ä¸­ä½¿ç”¨ä½¿ç”¨ELè¡¨è¾¾å¼è·å–éå†å‡ºæ¥çš„æ•°æ®<br><img src="https://s1.ax1x.com/2020/06/19/NMG4c6.png" alt="foreachä¾‹å­"></li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> EL </category>
          
          <category> jstl </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EL </tag>
            
            <tag> jstl </tag>
            
            <tag> JavaWeb </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JSP</title>
      <link href="2020/06/19/jsp/"/>
      <url>2020/06/19/jsp/</url>
      
        <content type="html"><![CDATA[<h1 id="JSPå­¦ä¹ "><a href="#JSPå­¦ä¹ " class="headerlink" title="JSPå­¦ä¹ "></a>JSPå­¦ä¹ </h1><h2 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><p>æœ¬è´¨ä¸Šè¿˜æ˜¯Servletã€è·¨å¹³å°ï¼Œä¸€æ¬¡ç¼–å†™å¤„å¤„è¿è¡Œã€ç»„ä»¶è·¨å¹³å°ã€å¥å£®æ€§å’Œå®‰å…¨æ€§ã€‚</p><h2 id="è®¿é—®åŸç†"><a href="#è®¿é—®åŸç†" class="headerlink" title="è®¿é—®åŸç†"></a>è®¿é—®åŸç†</h2><p> æµè§ˆå™¨å‘æœåŠ¡å™¨å‘è¯·æ±‚ï¼Œä¸ç®¡è®¿é—®çš„æ˜¯ä»€ä¹ˆèµ„æºï¼Œå…¶å®éƒ½æ˜¯åœ¨è®¿é—®Servletï¼Œæ‰€ä»¥å½“è®¿é—®ä¸€ä¸ªjspé¡µé¢æ—¶ï¼Œå…¶å®ä¹Ÿæ˜¯åœ¨è®¿é—®ä¸€ä¸ªServletï¼ŒæœåŠ¡å™¨åœ¨æ‰§è¡Œjspçš„æ—¶å€™ï¼Œé¦–å…ˆæŠŠjspç¿»è¯‘æˆä¸€ä¸ªServletï¼Œæ‰€ä»¥æˆ‘ä»¬è®¿é—®jspæ—¶ï¼Œå…¶å®ä¸æ˜¯åœ¨è®¿é—®jspï¼Œè€Œæ˜¯åœ¨è®¿é—®jspç¿»è¯‘è¿‡åçš„é‚£ä¸ªServletã€‚</p><h2 id="pageæŒ‡ä»¤"><a href="#pageæŒ‡ä»¤" class="headerlink" title="pageæŒ‡ä»¤"></a>pageæŒ‡ä»¤</h2><pre class="line-numbers language-jsp" data-language="jsp"><code class="language-jsp">&lt;%--ç”³æ˜è½¬ä¹‰è¯­è¨€ --%&gt;&lt;%@page language&#x3D;&quot;java&quot;%&gt;&lt;%--ç”³æ˜è½¬ä¹‰æ—¶å¯¼å…¥çš„JavaåŒ…æ–‡ä»¶  --%&gt;&lt;%@page import&#x3D;&quot;java.util.*,java.lang.*&quot; %&gt;&lt;%--è®¾ç½®jspçš„æ•°æ®ä¿å­˜çš„ç¼–ç æ ¼å¼--%&gt;&lt;%@page pageEncoding&#x3D;&quot;utf-8&quot;%&gt;&lt;%--è®¾ç½®æ•°æ®çš„å“åº”ç¼–ç æ ¼å¼ï¼Œï¼Œç›¸å½“äºsetContentType--%&gt;&lt;%@page contentType&#x3D;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;%&gt;&lt;%-- è®¾ç½®sessionçš„çŠ¶æ€ï¼Œé»˜è®¤ä¸ºtrue --%&gt;&lt;%@page session&#x3D;&quot;false&quot;%&gt;&lt;%-- å¼€å¯å†…ç½®exceptionå¼‚å¸¸å¯¹è±¡çš„ä½¿ç”¨ï¼Œé»˜è®¤ä¸ºfalse --%&gt;&lt;%@pageisErrorPage&#x3D;&quot;false&quot;%&gt;&lt;%-- è®¾ç½®å½“jspè¿è¡Œå‡ºç°å¼‚å¸¸é”™è¯¯çš„æ—¶å€™è·³è½¬åˆ°æŒ‡å®šçš„é¡µé¢ --%&gt;&lt;%@page errorPage&#x3D;&quot;error.jsp&quot;%&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å±€éƒ¨ä»£ç å—"><a href="#å±€éƒ¨ä»£ç å—" class="headerlink" title="å±€éƒ¨ä»£ç å—"></a>å±€éƒ¨ä»£ç å—</h2><h3 id="ç‰¹ç‚¹-1"><a href="#ç‰¹ç‚¹-1" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><p>ä½¿ç”¨å±€éƒ¨ä»£ç å—å£°æ˜çš„Javaä»£ç ä¼šè¢«åŸæ ·è½¬ä¹‰åˆ°_JspServletæ–¹æ³•ä¸­</p><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>ä½¿ç”¨å±€éƒ¨ä»£ç å—åœ¨jspä¸­è¿›è¡Œé€»è¾‘åˆ¤æ–­ï¼Œä¹¦å†™éº»çƒ¦ï¼Œé˜…è¯»å›°éš¾ã€‚</p><h3 id="æ ¼å¼"><a href="#æ ¼å¼" class="headerlink" title="æ ¼å¼"></a>æ ¼å¼</h3><p>&lt;% xxxxx %&gt;</p><h2 id="å…¨å±€ä»£ç å—"><a href="#å…¨å±€ä»£ç å—" class="headerlink" title="å…¨å±€ä»£ç å—"></a>å…¨å±€ä»£ç å—</h2><h3 id="ç‰¹ç‚¹-2"><a href="#ç‰¹ç‚¹-2" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><p>å…¨å±€ä»£ç å£°æ˜çš„javaä»£ç ï¼Œåœ¨è¢«è½¬è¯‘æ—¶ï¼Œä¼šè¢«è½¬è¯‘æˆjspå¯¹åº”çš„Javaå…¨å±€ä»£ç </p><h3 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h3><p>å£°æ˜æ–¹æ³•å’Œå…¨å±€å˜é‡</p><h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h3><p>ä½¿ç”¨å…¨å±€ç”³æ˜æ–¹æ³•ï¼Œä½¿ç”¨å±€éƒ¨è°ƒç”¨æ–¹æ³•</p><h3 id="æ ¼å¼-1"><a href="#æ ¼å¼-1" class="headerlink" title="æ ¼å¼"></a>æ ¼å¼</h3><p>&lt;%! xxxx %&gt;</p><h2 id="è„šæœ¬æ®µè¯­å¥"><a href="#è„šæœ¬æ®µè¯­å¥" class="headerlink" title="è„šæœ¬æ®µè¯­å¥"></a>è„šæœ¬æ®µè¯­å¥</h2><h3 id="ç‰¹ç‚¹-3"><a href="#ç‰¹ç‚¹-3" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><p> å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿçš„è·å–å˜é‡æˆ–è€…æ–¹æ³•çš„è¿”å›å€¼ä½œä¸ºæ•°æ®å“åº”ç»™æµè§ˆå™¨</p><h3 id="æ ¼å¼-2"><a href="#æ ¼å¼-2" class="headerlink" title="æ ¼å¼"></a>æ ¼å¼</h3><p>&lt;%=å˜é‡åæˆ–è€…æ–¹æ³•%&gt;</p><h2 id="é™æ€å¼•å…¥å’ŒåŠ¨æ€å¼•å…¥"><a href="#é™æ€å¼•å…¥å’ŒåŠ¨æ€å¼•å…¥" class="headerlink" title="é™æ€å¼•å…¥å’ŒåŠ¨æ€å¼•å…¥"></a>é™æ€å¼•å…¥å’ŒåŠ¨æ€å¼•å…¥</h2><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>ä¸åŒçš„jspæ–‡ä»¶ç”¨ç›¸åŒçš„èµ„æºï¼Œå¦‚æœèµ„æºåœ¨æ¯ä¸ªjspé¡µé¢ä¸­éƒ½å•ç‹¬å£°æ˜ï¼Œåˆ™ä¼šå¯¼è‡´ä»£ç å†—ä½™é‡é«˜</p><h3 id="ç›®çš„"><a href="#ç›®çš„" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h3><p>å®ç°èµ„æºå…±äº«</p><ul><li>é™æ€å¼•å…¥<ul><li>æ ¼å¼ï¼š<code>&lt;%@include file=&quot;java.jsp&quot;%&gt;</code></li><li>ç‰¹ç‚¹ï¼šè¢«å¼•å…¥çš„jspæ–‡ä»¶å’ŒåŸæœ‰çš„jspæ–‡ä»¶è¢«ç¼–è¯‘æˆä¸€ä¸ªJavaæ–‡ä»¶</li><li>æ³¨æ„ï¼šé™æ€å¼•å…¥çš„ç›¸å…³jspæ–‡ä»¶ä¸­ä¸èƒ½ç”³æ˜åŒåå˜é‡</li></ul></li><li>åŠ¨æ€å¼•å…¥<ul><li>æ ¼å¼ï¼š<code>&lt;jsp:include page=&quot;java.jsp&quot;&gt;&lt;/jsp:include&gt;</code></li><li>ç‰¹ç‚¹ï¼šè¢«å¼•å…¥çš„æ–‡ä»¶ä¼šè¢«å•ç‹¬è½¬è¯‘ï¼ŒåŸæœ‰çš„jspæ–‡ä»¶ä¼šè°ƒç”¨è¢«å¼•å…¥çš„jspæ–‡ä»¶å¯ä»¥å£°æ˜åŒåå˜é‡<h2 id="è½¬å‘æ ‡ç­¾forward"><a href="#è½¬å‘æ ‡ç­¾forward" class="headerlink" title="è½¬å‘æ ‡ç­¾forward"></a>è½¬å‘æ ‡ç­¾forward</h2><h3 id="ç‰¹ç‚¹-4"><a href="#ç‰¹ç‚¹-4" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3>ä»å½“å‰jspè·³è½¬å¦å¤–ä¸€ä¸ªjspé¡µé¢<h3 id="æ ¼å¼-3"><a href="#æ ¼å¼-3" class="headerlink" title="æ ¼å¼"></a>æ ¼å¼</h3><code>&lt;jsp:forward page=&quot;è¦è½¬å‘çš„jspçš„ç›¸å¯¹è·¯å¾„&quot;&gt;&lt;/jsp:forward&gt;</code><h3 id="æ³¨æ„-1"><a href="#æ³¨æ„-1" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h3>forwardæ ‡ç­¾ä¸­é™¤äº†<code>&lt;jsp:param value=&quot;&quot; name=&quot;&quot;/&gt;</code>å­æ ‡ç­¾ä»¥å¤–ä¸èƒ½å‡ºç°å…¶ä»–å†…å®¹ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚valueå’Œnameä¼šå°†æ•°æ®ä»¥?çš„å½¢å¼æ‹¼æ¥åœ¨è½¬å‘è·¯å¾„çš„åé¢ã€‚<h2 id="å†…ç½®å¯¹è±¡"><a href="#å†…ç½®å¯¹è±¡" class="headerlink" title="å†…ç½®å¯¹è±¡"></a>å†…ç½®å¯¹è±¡</h2><h3 id="pageContext"><a href="#pageContext" class="headerlink" title="pageContext"></a>pageContext</h3></li></ul></li><li>é¡µé¢ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œæ­¤å¯¹è±¡å°å­˜äº†å¦å¤–8ä¸ªå¯¹è±¡</li><li>ä½œç”¨åŸŸï¼šå½“å‰é¡µé¢<h3 id="request"><a href="#request" class="headerlink" title="request"></a>request</h3></li><li>å°å­˜äº†è¯·æ±‚ç›¸å…³æ•°æ®ï¼Œç”±æœåŠ¡å™¨åˆ›å»º</li><li>ä½œç”¨åŸŸï¼šä¸€æ¬¡è¯·æ±‚<h3 id="session"><a href="#session" class="headerlink" title="session"></a>session</h3></li><li>ç”¨æ¥å­˜å‚¨ç”¨æˆ·çš„ä¸åŒè¯·æ±‚çš„å…±äº«æ•°æ®</li><li>ä½œç”¨åŸŸï¼šä¸€æ¬¡ä¼šè¯<h3 id="application"><a href="#application" class="headerlink" title="application"></a>application</h3></li><li>ServletContextå¯¹è±¡ï¼Œä¸€æ¬¡é¡¹ç›®åªæœ‰ä¸€ä¸ª</li><li>ä½œç”¨åŸŸï¼šé¡¹ç›®æ•´ä¸ªç”Ÿå‘½å‘¨æœŸ<h3 id="response"><a href="#response" class="headerlink" title="response"></a>response</h3></li><li>å“åº”ï¼Œè®¾ç½®ç¼–ç æ ¼å¼<h3 id="out"><a href="#out" class="headerlink" title="out"></a>out</h3></li><li>å“åº”å¯¹è±¡ï¼ŒJspå†…éƒ¨ä½¿ç”¨ã€‚å¸¦æœ‰ç¼“å†²åŒºçš„å“åº”å¯¹è±¡ï¼Œæ•ˆç‡é«˜äºresponseå¯¹è±¡<h3 id="page"><a href="#page" class="headerlink" title="page"></a>page</h3></li><li>ä»£è¡¨å½“å‰Jspçš„å¯¹è±¡ã€‚ç›¸å½“äºjavaä¸­çš„this<h3 id="exception"><a href="#exception" class="headerlink" title="exception"></a>exception</h3></li><li>å°å­˜äº†å¼‚å¸¸ä¿¡æ¯</li><li>ä½¿ç”¨æ­¤å¯¹è±¡éœ€è¦åœ¨pageæŒ‡å®šä¸­ä½¿ç”¨å±æ€§isErrorPage=â€trueâ€å¼€å¯ã€‚<h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3></li><li>ServletConfigï¼Œä¸»è¦æ˜¯ç”¨æ¥è·å–web.xmlä¸­çš„é…ç½®æ•°æ®ï¼Œå®Œæˆä¸€äº›åˆå§‹åŒ–æ•°æ®çš„è¯»å–</li></ul><h2 id="ä½œç”¨åŸŸå¯¹è±¡"><a href="#ä½œç”¨åŸŸå¯¹è±¡" class="headerlink" title="ä½œç”¨åŸŸå¯¹è±¡"></a>ä½œç”¨åŸŸå¯¹è±¡</h2><h3 id="pageContext-1"><a href="#pageContext-1" class="headerlink" title="pageContext"></a>pageContext</h3><ul><li>ä½œç”¨åŸŸï¼šå½“å‰é¡µé¢</li><li>å°å­˜äº†å¦å¤–8ä¸ªå¯¹è±¡ï¼Œå¯ä»¥è·å–å…¶ä»–å¯¹è±¡<h3 id="request-1"><a href="#request-1" class="headerlink" title="request"></a>request</h3></li><li>ä½œç”¨åŸŸï¼šä¸€æ¬¡è¯·æ±‚</li><li>ä¸€æ¬¡è¯·æ±‚çš„servletçš„æ•°æ®å…±äº«<h3 id="session-1"><a href="#session-1" class="headerlink" title="session"></a>session</h3></li><li>ä½œç”¨åŸŸï¼šä¸€æ¬¡ä¼šè¯</li><li>ä¸€ä¸ªç”¨æˆ·çš„ä¸åŒè¯·æ±‚çš„æ•°æ®å…±äº«<h3 id="application-1"><a href="#application-1" class="headerlink" title="application"></a>application</h3></li><li>ä½œç”¨åŸŸï¼šé¡¹ç›®å†…ï¼Œç›¸å½“äºServletContextå¯¹è±¡</li><li>ä¸åŒç”¨æˆ·çš„æ•°æ®æ®å…±äº«é—®é¢˜ï¼Œå°†æ•°æ®ä»ä¸€ä¸ªç”¨æˆ·æµè½¬ç»™å…¶ä»–ç”¨æˆ·</li></ul><h2 id="è·¯å¾„"><a href="#è·¯å¾„" class="headerlink" title="è·¯å¾„"></a>è·¯å¾„</h2><h3 id="ç»å¯¹è·¯å¾„"><a href="#ç»å¯¹è·¯å¾„" class="headerlink" title="ç»å¯¹è·¯å¾„"></a>ç»å¯¹è·¯å¾„</h3><p>/è™šæ‹Ÿé¡¹ç›®å/èµ„æºè·¯å¾„<br><strong>åœ¨jspä¸­èµ„æºçš„ç¬¬ä¸€ä¸ª/è¡¨ç¤ºçš„æ˜¯æœåŠ¡å™¨æ ¹ç›®å½•</strong></p><h3 id="ç›¸å¯¹è·¯å¾„"><a href="#ç›¸å¯¹è·¯å¾„" class="headerlink" title="ç›¸å¯¹è·¯å¾„"></a>ç›¸å¯¹è·¯å¾„</h3><p>../../èµ„æº</p><h3 id="ä½¿ç”¨jspä¸­è‡ªå¸¦çš„å…¨å±€è·¯å¾„å£°æ˜"><a href="#ä½¿ç”¨jspä¸­è‡ªå¸¦çš„å…¨å±€è·¯å¾„å£°æ˜" class="headerlink" title="ä½¿ç”¨jspä¸­è‡ªå¸¦çš„å…¨å±€è·¯å¾„å£°æ˜"></a>ä½¿ç”¨jspä¸­è‡ªå¸¦çš„å…¨å±€è·¯å¾„å£°æ˜</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html">&lt;%String  path = request.getContextPath();String  basePath = request.getScheme()+"://"+request.getServerName()+":"+request.getServerPort()+path+"/"; %><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>base</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&lt;%=base Path%><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> JSP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaWeb </tag>
            
            <tag> JSP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>servletå…¥é—¨</title>
      <link href="2020/06/19/servlet/"/>
      <url>2020/06/19/servlet/</url>
      
        <content type="html"><![CDATA[<h1 id="Servletå…¥é—¨å­¦ä¹ "><a href="#Servletå…¥é—¨å­¦ä¹ " class="headerlink" title="Servletå…¥é—¨å­¦ä¹ "></a>Servletå…¥é—¨å­¦ä¹ </h1><h2 id="Servletä»‹ç»"><a href="#Servletä»‹ç»" class="headerlink" title="Servletä»‹ç»"></a>Servletä»‹ç»</h2><p>ç‹­ä¹‰çš„Servletæ˜¯æŒ‡Javaè¯­è¨€å®ç°çš„ä¸€ä¸ªæ¥å£ï¼Œå¹¿ä¹‰çš„Servletæ˜¯æŒ‡ä»»ä½•å®ç°äº†è¿™ä¸ªServletæ¥å£çš„ç±»ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œäººä»¬å°†Servletç†è§£ä¸ºåè€…ã€‚Servletè¿è¡Œäºæ”¯æŒJavaçš„åº”ç”¨æœåŠ¡å™¨ä¸­ã€‚ä»åŸç†ä¸Šè®²ï¼ŒServletå¯ä»¥å“åº”ä»»ä½•ç±»å‹çš„è¯·æ±‚ï¼Œä½†ç»å¤§å¤šæ•°æƒ…å†µä¸‹Servletåªç”¨æ¥æ‰©å±•åŸºäºHTTPåè®®çš„WebæœåŠ¡å™¨ã€‚<br><img src="https://s1.ax1x.com/2020/06/19/NKDsVP.png" alt="Servletæ‰§è¡Œæµç¨‹"></p><p>è¦æ³¨æ„ï¼š</p><ul><li>servletæ‰§è¡Œä¼šè‡ªåŠ¨è°ƒç”¨serviceæ–¹æ³•</li><li>å¦‚æœæ²¡æœ‰serviceæ–¹æ³•ï¼Œåˆ™æ ¹æ®å‘é€çš„è¯·æ±‚çš„ç±»å‹(get/post)ï¼Œæ‰§è¡Œç›¸å¯¹åº”çš„è¯·æ±‚</li><li>å¦‚æœéƒ½æ²¡æœ‰çš„è¯ä¼šå»çˆ¶ç±»HttpServletä¸­è°ƒç”¨serviceæ–¹æ³•ï¼Œä½†æ˜¯æ ¹æ®æºç æˆ‘ä»¬å¯ä»¥å¾—çŸ¥ä¼šæŠ¥é”™</li><li> ä¸ç®¡æ˜¯getæ–¹å¼è¿˜æ˜¯postæ–¹å¼çš„è¯·æ±‚ï¼Œå¦‚æœServletç±»ä¸­æœ‰serviceæ–¹æ³•ï¼Œåˆ™ä¼˜å…ˆè°ƒç”¨Serviceæ–¹æ³•ã€‚ <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">service</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>       <span class="token class-name">String</span> method <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">long</span> errMsg<span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           errMsg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLastModified</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span>errMsg <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1L</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>               <span class="token keyword">long</span> ifModifiedSince <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token function">getDateHeader</span><span class="token punctuation">(</span><span class="token string">"If-Modified-Since"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token keyword">if</span><span class="token punctuation">(</span>ifModifiedSince <span class="token operator">&lt;</span> errMsg <span class="token operator">/</span> <span class="token number">1000L</span> <span class="token operator">*</span> <span class="token number">1000L</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                   <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">maybeSetLastModified</span><span class="token punctuation">(</span>resp<span class="token punctuation">,</span> errMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                   resp<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token number">304</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"HEAD"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           errMsg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLastModified</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">maybeSetLastModified</span><span class="token punctuation">(</span>resp<span class="token punctuation">,</span> errMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doHead</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doPost</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"PUT"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doPut</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"DELETE"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doDelete</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"OPTIONS"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doOptions</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"TRACE"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doTrace</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> resp<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>           <span class="token class-name">String</span> errMsg1 <span class="token operator">=</span> lStrings<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"http.method_not_implemented"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> errArgs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>method<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>           errMsg1 <span class="token operator">=</span> <span class="token class-name">MessageFormat</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>errMsg1<span class="token punctuation">,</span> errArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>           resp<span class="token punctuation">.</span><span class="token function">sendError</span><span class="token punctuation">(</span><span class="token number">501</span><span class="token punctuation">,</span> errMsg1<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ³¨è§£ä»‹ç»"><a href="#æ³¨è§£ä»‹ç»" class="headerlink" title="æ³¨è§£ä»‹ç»"></a>æ³¨è§£ä»‹ç»</h2><code>@WebServlet</code><blockquote><p>åœ¨servlet3.0ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨å†web.xmlé‡Œé¢é…ç½®servletï¼Œåªéœ€è¦åŠ ä¸Š@WebServletæ³¨è§£å°±å¯ä»¥ä¿®æ”¹è¯¥servletçš„å±æ€§äº†ã€‚</p></blockquote></li></ul><p>ä»¥ä¸‹æ˜¯ä¸€äº›æ³¨è§£çš„å±æ€§</p><table><thead><tr><th align="center">å±æ€§å</th><th align="center">ç±»å‹</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">name</td><td align="center">String</td><td align="center">æŒ‡å®šServlet çš„ name å±æ€§ï¼Œç­‰ä»·äº <code>&lt;servlet-name&gt;</code>ã€‚å¦‚æœæ²¡æœ‰æ˜¾å¼æŒ‡å®šï¼Œåˆ™è¯¥ Servlet çš„å–å€¼å³ä¸ºç±»çš„å…¨é™å®šå</td></tr><tr><td align="center">value</td><td align="center">String[]</td><td align="center">è¯¥å±æ€§ç­‰ä»·äº urlPatterns å±æ€§ã€‚ä¸¤ä¸ªå±æ€§ä¸èƒ½åŒæ—¶ä½¿ç”¨</td></tr><tr><td align="center">urlPatterns</td><td align="center">String[]</td><td align="center">æŒ‡å®šä¸€ç»„ Servlet çš„ URL åŒ¹é…æ¨¡å¼ã€‚ç­‰ä»·äº<code>&lt;url-pattern&gt;</code>æ ‡ç­¾</td></tr><tr><td align="center">loadOnStartup</td><td align="center">int</td><td align="center">æŒ‡å®š Servlet çš„åŠ è½½é¡ºåºï¼Œç­‰ä»·äº <code>&lt;load-on-startup&gt;</code>æ ‡ç­¾</td></tr><tr><td align="center">initParams</td><td align="center">WebInitParam[]</td><td align="center">æŒ‡å®šä¸€ç»„ Servlet åˆå§‹åŒ–å‚æ•°ï¼Œç­‰ä»·äº<code>&lt;init-param&gt;</code>æ ‡ç­¾</td></tr><tr><td align="center">asyncSupported</td><td align="center">boolean</td><td align="center">å£°æ˜ Servlet æ˜¯å¦æ”¯æŒå¼‚æ­¥æ“ä½œæ¨¡å¼ï¼Œç­‰ä»·äº<code>&lt;async-supported&gt;</code>æ ‡ç­¾</td></tr><tr><td align="center">description</td><td align="center">String</td><td align="center">è¯¥ Servlet çš„æè¿°ä¿¡æ¯ï¼Œç­‰ä»·äº <code>&lt;description&gt;</code>æ ‡ç­¾</td></tr><tr><td align="center">displayName</td><td align="center">String</td><td align="center">è¯¥ Servlet çš„æ˜¾ç¤ºåï¼Œé€šå¸¸é…åˆå·¥å…·ä½¿ç”¨ï¼Œç­‰ä»·äº<code>&lt;display-name&gt;</code>æ ‡ç­¾</td></tr></tbody></table><h2 id="request"><a href="#request" class="headerlink" title="request"></a>request</h2><h3 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h3><p>Requestå¯¹è±¡ä¸­å°å­˜äº†å½“å‰è¯·æ±‚çš„æ‰€æœ‰è¯·æ±‚ä¿¡æ¯</p><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><ul><li>è·å–è¯·æ±‚è¡Œæ•°æ®<ul><li><code>req.getMethod();</code> è·å–è¯·æ±‚æ–¹å¼</li><li><code>req.getRequestURL();</code> è·å–è¯·æ±‚çš„URL</li><li><code>req.getRequestURI();</code> è·å–è¯·æ±‚çš„URI</li><li><code>req.getScheme();</code> è·å–è¯·æ±‚åè®®</li></ul></li><li>è·å–è¯·æ±‚å¤´æ•°æ®<ul><li><code>req.getHeaderNames();</code> è·å–è¯·æ±‚å¤´çš„é”®çš„æšä¸¾</li><li><code>req.getHeader(&quot;é”®å&quot;);</code> è·å–æŒ‡å®šé”®çš„ä¿¡æ¯</li></ul></li><li>è·å–ç”¨æˆ·æ•°æ®<ul><li><code>req.getParameter(&quot;é”®å&quot;);</code> è·å–æŒ‡å®šé”®çš„ç”¨æˆ·æ•°æ®</li><li><code>req.getParameterValues(&quot;é”®å&quot;);</code> è·å–åŒé”®ä¸åŒå€¼çš„ç”¨æˆ·æ•°æ®ï¼ˆå¤šé€‰ï¼‰ï¼Œè¿”å›ç±»å‹æ˜¯æ•°ç»„</li></ul></li><li>æ³¨æ„<ul><li>å¦‚æœè¦è·å–çš„è¯·æ±‚æ•°æ®ä¸å­˜åœ¨ï¼Œè¿”å›ä¸ºnull</li><li>Requestå¯¹è±¡ç”±tomcatæœåŠ¡å™¨åˆ›å»ºï¼Œå¹¶ä½œä¸ºå®å‚ä¼ é€’ç»™å¤„ç†è¯·æ±‚çš„servletçš„service()æ–¹æ³•</li><li>è§£å†³ä¹±ç é—®é¢˜ï¼š<code>req.setCharacterEncoding(&quot;utf-8&quot;);</code><h2 id="response"><a href="#response" class="headerlink" title="response"></a>response</h2><h3 id="ä½œç”¨-1"><a href="#ä½œç”¨-1" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h3>ç”¨æ¥å“åº”æ•°æ®åˆ°æµè§ˆå™¨çš„ä¸€ä¸ªå¯¹è±¡<h3 id="ä½¿ç”¨-1"><a href="#ä½¿ç”¨-1" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3></li></ul></li><li>è®¾ç½®å“åº”å¤´<ul><li><code>setHeader(String name,  String value);</code> åœ¨ç›¸åº”å¤´ä¸­æ·»åŠ ä¿¡æ¯ï¼Œé”®åç›¸åŒä¼šè¦†ç›–åŸæœ‰çš„</li><li><code>addHeader(String name, String value);</code> åœ¨å“åº”å¤´ä¸­æ·»åŠ å“åº”ä¿¡æ¯ï¼Œä½†æ˜¯ä¸ä¼šè¦†ç›–åŸæœ‰çš„</li></ul></li><li>è®¾ç½®å“åº”çŠ¶æ€<ul><li><code>sendError(int num, String msg);</code> è‡ªå®šä¹‰ç›¸åº”çŠ¶æ€ç </li></ul></li><li>è®¾ç½®å“åº”å®ä½“<ul><li><code>resp.getWrite().write(String str);</code> å“åº”å…·ä½“çš„æ•°æ®ç»™æµè§ˆå™¨</li></ul></li><li>è®¾ç½®å“åº”ç¼–ç æ ¼å¼<ul><li><code>resp.setContentType(&quot;text/html;charset=utf-8&quot;);</code><h2 id="servletçš„ä½¿ç”¨"><a href="#servletçš„ä½¿ç”¨" class="headerlink" title="servletçš„ä½¿ç”¨"></a>servletçš„ä½¿ç”¨</h2></li></ul></li><li>åˆ›å»ºæ™®é€šçš„javaç±»å¹¶ç»§æ‰¿HttpServlet</li><li>è¦†å†™serviceæ–¹æ³•</li><li>åœ¨serviceä¸­ç¼–å†™ä¸šåŠ¡ä»£ç <ul><li>è®¾ç½®è¯·æ±‚ç¼–ç æ ¼å¼ <code>req.setCharacterEncoding(&quot;utf-8&quot;);</code></li><li>è®¾ç½®å“åº”ç¼–ç æ ¼å¼ <code>resp.setContentType(&quot;text/html;charset=utf-8&quot;);</code></li><li>è·å–è¯·æ±‚ä¿¡æ¯ <code>req.getParameter(&quot;æ•°æ®çš„name&quot;)</code></li><li>å¤„ç†è¯·æ±‚ä¿¡æ¯ <code>ä¸šåŠ¡å¤„ç†,è°ƒç”¨serviceå±‚ä»€ä¹ˆçš„</code></li><li>å“åº”å¤„ç†ç»“æœ<br><img src="https://s1.ax1x.com/2020/06/19/NKcJpT.png" alt="é‡å®šå‘ä¸è¯·æ±‚è½¬å‘"><ul><li>ç›´æ¥å¤„ç† <code>resp.getWriter().write()</code></li><li>è¯·æ±‚è½¬å‘ <code>request.getRequsetDispatcher().forward(requset,response)</code><ul><li>ç‰¹ç‚¹æ˜¯ï¼šä¸€æ¬¡è¯·æ±‚ï¼Œåœ°å€æ ä¿¡æ¯ä¸æ”¹å˜</li><li>é€šè¿‡<code>request.setAttribute(object name,Object value);</code>è§£å†³äº†ä¸€æ¬¡è¯·æ±‚å†…çš„ä¸åŒServletçš„æ•°æ®(è¯·æ±‚æ•°æ®+å…¶ä»–æ•°æ®)å…±äº«é—®é¢˜ã€‚</li></ul></li><li>é‡å®šå‘ <code>response.sendRedirect(&quot;è·¯å¾„&quot;)</code><ul><li>ç‰¹ç‚¹æ˜¯ï¼šä¸¤æ¬¡è¯·æ±‚ï¼Œrequestä¸èƒ½å…±ç”¨ï¼Œåœ°å€æ æ”¹å˜ï¼Œé¿å…è¡¨å•é‡å¤æäº¤</li></ul></li></ul></li></ul></li></ul><h2 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h2><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>è§£å†³äº†å‘é€ä¸åŒè¯·æ±‚çš„æ•°æ®å…±äº«é—®é¢˜<br><img src="https://s1.ax1x.com/2020/06/19/NKhz59.png" alt="cookie"></p><h3 id="ä½¿ç”¨-2"><a href="#ä½¿ç”¨-2" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//åˆ›å»ºcookieï¼ï¼ï¼ï¼</span>    <span class="token class-name">Cookie</span> cookie <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cookie</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token class-name">String</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è®¾ç½®æœ‰æ•ˆæœŸ</span>    cookie<span class="token punctuation">.</span><span class="token function">setMaxAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> seconds<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è®¾ç½®æœ‰æ•ˆè·¯å¾„</span>    cookie<span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token class-name">String</span> uri<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç”¨respå“åº”åˆ°æµè§ˆå™¨ä¸­</span>    resp<span class="token punctuation">.</span><span class="token function">addCookie</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><ul><li>å¦‚æœä¸è®¾ç½®æœ‰æ•ˆæœŸåˆ™é»˜è®¤å­˜å‚¨åœ¨æµè§ˆå™¨çš„å†…å­˜é‡Œï¼Œå…³é—­å³å¤±æ•ˆ</li><li>å¦‚æœä¸è®¾ç½®æœ‰æ•ˆè·¯å¾„åˆ™ä»»æ„é¡¹ç›®è·¯å¾„è¯·æ±‚éƒ½å«æœ‰cookie</li><li>å¦‚æœè®¾ç½®äº†æœ‰æ•ˆæœŸåˆ™å­˜å‚¨åˆ°å®¢æˆ·ç«¯çš„ç¡¬ç›˜é‡Œï¼Œåˆ°æœŸè‡ªåŠ¨é”€æ¯</li></ul><h2 id="session"><a href="#session" class="headerlink" title="session"></a>session</h2><h3 id="é—®é¢˜-1"><a href="#é—®é¢˜-1" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>è§£å†³ä¸€ä¸ªç”¨æˆ·çš„ä¸åŒè¯·æ±‚å¤„ç†çš„æ•°æ®å…±äº«é—®é¢˜</p><h3 id="ä½¿ç”¨-3"><a href="#ä½¿ç”¨-3" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//åˆ›å»ºSessionå¯¹è±¡</span><span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®¾ç½®sessionæœ‰æ•ˆæœŸ</span>      session<span class="token punctuation">.</span><span class="token function">setMaxInactiveInterval</span><span class="token punctuation">(</span><span class="token keyword">int</span> seconds<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å­˜å‚¨åˆ°sessionå¯¹è±¡ä¸­</span>session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token class-name">Object</span> valuse<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//è·å–sessionä¸­çš„æ•°æ®,è¿”å›ç±»å‹æ˜¯Objectï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span>session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¼ºåˆ¶é”€æ¯</span>      session<span class="token punctuation">.</span><span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç‰¹ç‚¹-1"><a href="#ç‰¹ç‚¹-1" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><ul><li>æœ‰å”¯ä¸€æ ‡è¯†sessionIdï¼ˆä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå°±æ˜¯è¯´ä½ æ‰“å¼€æµè§ˆå™¨å°±ç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªidï¼Œå…³é—­å°±æ²¡äº†ï¼‰</li><li>sessionè§£å†³äº†åŒä¸€ä¸ªç”¨æˆ·ä¸åŒè¯·æ±‚çš„æ•°æ®å…±äº«é—®é¢˜</li><li>sessionçš„ä½œç”¨åŸŸï¼šæµè§ˆå™¨ä¸å…³é—­sessionä¸å¤±æ•ˆï¼Œåˆ™åŒä¸€ç”¨æˆ·çš„ä»»æ„è¯·æ±‚è·å–çš„éƒ½æ˜¯åŒä¸€session<h3 id="è®¾ç½®"><a href="#è®¾ç½®" class="headerlink" title="è®¾ç½®"></a>è®¾ç½®</h3></li><li>sessioné»˜è®¤æœ‰æ•ˆæ—¶é—´ä¸º30åˆ†é’Ÿï¼Œå¯ä»¥åœ¨tomcatä¸‹çš„web.xmlä¸­è¿›è¡Œé…ç½®</li><li>ä¹Ÿå¯ä»¥åœ¨ä»£ç åœ¨ä½¿ç”¨ï¼š<code>session.setMaxInactiveInterval(int seconds)</code></li></ul><h2 id="ServletContext"><a href="#ServletContext" class="headerlink" title="ServletContext"></a>ServletContext</h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>ServletContextå¯¹è±¡ç”±æœåŠ¡å™¨è¿›è¡Œåˆ›å»ºï¼Œä¸€ä¸ªé¡¹ç›®åªæœ‰ä¸€ä¸ªå¯¹è±¡ã€‚ä¸ç®¡åœ¨é¡¹ç›®çš„ä»»æ„ä½ç½®è¿›è¡Œè·å–å¾—åˆ°çš„éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆä¸åŒç”¨æˆ·å‘èµ·çš„è¯·æ±‚è·å–åˆ°çš„ä¹Ÿå°±æ˜¯åŒä¸€ä¸ªå¯¹è±¡äº†ï¼Œè¯¥å¯¹è±¡ç”±ç”¨æˆ·å…±åŒæ‹¥æœ‰ã€‚</p><h3 id="é—®é¢˜-2"><a href="#é—®é¢˜-2" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>è§£å†³äº†ä¸åŒç”¨æˆ·çš„æ•°æ®å…±äº«é—®é¢˜</p><h3 id="ä½¿ç”¨-4"><a href="#ä½¿ç”¨-4" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// è·å–ServletContextå¯¹è±¡çš„ä¸‰ç§æ–¹æ³•</span><span class="token class-name">ServletContext</span> sc <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">ServletContext</span> sc2 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getServletConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">ServletContext</span> sc3 <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å­˜å‚¨ç”¨æˆ·å…±äº«æ•°æ®åˆ°ServletContextä¸­</span>sc<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token class-name">Object</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è·å–æ•°æ®ï¼Œéœ€è¦å¼ºè½¬</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span>sc<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token comment">// è·å–web.xmlä¸­çš„å…¨å±€é…ç½®å±æ€§</span>sc<span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è·å–é¡¹ç›®webä¸‹çš„èµ„æºçš„ç»å¯¹è·¯å¾„,è·å–çš„è·¯å¾„ä¸ºé¡¹ç›®æ ¹ç›®å½•ï¼Œpathå‚æ•°ä¸ºé¡¹ç›®æ ¹ç›®å½•ä¸­çš„è·¯å¾„</span><span class="token class-name">String</span> path <span class="token operator">=</span> sc<span class="token punctuation">.</span><span class="token function">getRealPath</span><span class="token punctuation">(</span><span class="token class-name">String</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//  è·å–webä¸‹çš„èµ„æºæµå¯¹è±¡</span><span class="token class-name">InputStream</span> is <span class="token operator">=</span> sc<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token class-name">String</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç‰¹ç‚¹-2"><a href="#ç‰¹ç‚¹-2" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><p>æœåŠ¡å™¨åˆ›å»ºï¼Œæ‰€æœ‰ç”¨æˆ·å…±äº«</p><h3 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h3><p>æœåŠ¡å™¨å¯åŠ¨åˆ°æœåŠ¡å™¨å…³é—­</p><h2 id="ServletConfig"><a href="#ServletConfig" class="headerlink" title="ServletConfig"></a>ServletConfig</h2><h3 id="ä½œç”¨-2"><a href="#ä½œç”¨-2" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h3><p>è§£å†³è·å–åœ¨web.xmlä¸­ç»™æ¯ä¸ªservletå•ç‹¬é…ç½®çš„æ•°æ®é—®é¢˜</p><h3 id="ä½¿ç”¨-5"><a href="#ä½¿ç”¨-5" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//è·å–ServletConfigå¯¹è±¡</span><span class="token class-name">ServletConfig</span> sc <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getServletConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä½¿ç”¨web.xmlä¸­çš„é…ç½®æ•°æ®</span>sc<span class="token punctuation">.</span><span class="token function">getInitParmeter</span><span class="token punctuation">(</span><span class="token class-name">String</span>  name<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Servlet </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaWeb </tag>
            
            <tag> Servlet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çŸ­ä¿¡ä¸šåŠ¡å®æˆ˜</title>
      <link href="2020/06/18/duan-xin-ye-wu-shi-zhan/"/>
      <url>2020/06/18/duan-xin-ye-wu-shi-zhan/</url>
      
        <content type="html"><![CDATA[<h1 id="é˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡"><a href="#é˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡" class="headerlink" title="é˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡"></a>é˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡</h1><h2 id="äº†è§£é˜¿é‡Œäº‘ç”¨æˆ·æƒé™æ“ä½œ"><a href="#äº†è§£é˜¿é‡Œäº‘ç”¨æˆ·æƒé™æ“ä½œ" class="headerlink" title="äº†è§£é˜¿é‡Œäº‘ç”¨æˆ·æƒé™æ“ä½œ"></a>äº†è§£é˜¿é‡Œäº‘ç”¨æˆ·æƒé™æ“ä½œ</h2><blockquote><p><img src="https://s1.ax1x.com/2020/05/12/YNhuZt.png" alt="ç”¨æˆ·æ“ä½œæƒé™"></p></blockquote><h3 id="è¿›å…¥RAMè®¿é—®æ§åˆ¶"><a href="#è¿›å…¥RAMè®¿é—®æ§åˆ¶" class="headerlink" title="è¿›å…¥RAMè®¿é—®æ§åˆ¶"></a>è¿›å…¥RAMè®¿é—®æ§åˆ¶</h3><blockquote><p><img src="https://s1.ax1x.com/2020/05/12/YNhxfS.png" alt="RAMè®¿é—®æ§åˆ¶"></p></blockquote><h3 id="æ·»åŠ ç”¨æˆ·ç»„"><a href="#æ·»åŠ ç”¨æˆ·ç»„" class="headerlink" title="æ·»åŠ ç”¨æˆ·ç»„"></a>æ·»åŠ ç”¨æˆ·ç»„</h3><blockquote><p>é€‰æ‹©ç»„ç¾¤ç®¡ç†â€“&gt;æ–°å»ºç»„ç¾¤ï¼Œå¡«å†™ç›¸åº”çš„ä¿¡æ¯ï¼Œç¡®å®šå³å¯</p></blockquote><h3 id="æ·»åŠ ç”¨æˆ·"><a href="#æ·»åŠ ç”¨æˆ·" class="headerlink" title="æ·»åŠ ç”¨æˆ·"></a>æ·»åŠ ç”¨æˆ·</h3><blockquote><p>ç”¨æˆ·â€“&gt;åˆ›å»ºç”¨æˆ·â€“&gt;è¾“å…¥ç›¸å…³ä¿¡æ¯ï¼Œç¡®å®šå³å¯<br><img src="https://s1.ax1x.com/2020/06/18/Nn3UyQ.jpg" alt="æ·»åŠ ç”¨æˆ·"></p></blockquote><h3 id="å¾—åˆ°Accesskey-idå’Œsecret"><a href="#å¾—åˆ°Accesskey-idå’Œsecret" class="headerlink" title="å¾—åˆ°Accesskey(idå’Œsecret)"></a>å¾—åˆ°Accesskey(idå’Œsecret)</h3><blockquote><p><strong>æ·»åŠ äº†ç”¨æˆ·ä»¥åä¼šæ˜¾ç¤ºï¼Œä¸€å®šè¦ä¿å­˜ä¸€ä¸‹ï¼Œå…³æ‰é¡µé¢å°±ä¸æ˜¾ç¤ºäº†</strong> </p></blockquote><h3 id="æ·»åŠ ç»„æˆå‘˜"><a href="#æ·»åŠ ç»„æˆå‘˜" class="headerlink" title="æ·»åŠ ç»„æˆå‘˜"></a>æ·»åŠ ç»„æˆå‘˜</h3><blockquote><p>æŠŠåˆšåˆ›å»ºçš„ç”¨æˆ·æ”¾å…¥ç”¨æˆ·ç»„ä¸­ï¼Œç±»ä¼¼äºLinuxç³»ç»Ÿçš„ç»„å’Œç”¨æˆ·çš„å…³ç³»</p></blockquote><h3 id="æ·»åŠ ç»„æƒé™"><a href="#æ·»åŠ ç»„æƒé™" class="headerlink" title="æ·»åŠ ç»„æƒé™"></a>æ·»åŠ ç»„æƒé™</h3><blockquote><p>æ·»åŠ æƒé™â€“&gt;ç³»ç»Ÿç­–ç•¥smsâ€“&gt;ç®¡ç†çŸ­ä¿¡æœåŠ¡â€“&gt;ç¡®å®šå³å¯<br><img src="https://s1.ax1x.com/2020/06/18/Nn3CL9.jpg" alt="æ·»åŠ æƒé™"></p></blockquote><h2 id="å¼€é€šé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡"><a href="#å¼€é€šé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡" class="headerlink" title="å¼€é€šé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡"></a>å¼€é€šé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡</h2><p>è®¤è¯†ä¸€ä¸‹ğŸ‘‡<br><img src="https://s1.ax1x.com/2020/06/18/NnYFXD.jpg" alt="æ¨¡æ¿ç»†åˆ†ä»‹ç»"></p><h3 id="æ‰“å¼€é˜¿é‡Œäº‘çŸ­ä¿¡æ§åˆ¶é¢æ¿"><a href="#æ‰“å¼€é˜¿é‡Œäº‘çŸ­ä¿¡æ§åˆ¶é¢æ¿" class="headerlink" title="æ‰“å¼€é˜¿é‡Œäº‘çŸ­ä¿¡æ§åˆ¶é¢æ¿"></a>æ‰“å¼€é˜¿é‡Œäº‘çŸ­ä¿¡æ§åˆ¶é¢æ¿</h3><blockquote><p><a href="https://dysms.console.aliyun.com/dysms.htm?spm=5176.12818093.nav-right.1.488716d0MlrfNE#/overview">https://dysms.console.aliyun.com/dysms.htm?spm=5176.12818093.nav-right.1.488716d0MlrfNE#/overview</a></p></blockquote><h3 id="è®¾ç½®ç­¾å"><a href="#è®¾ç½®ç­¾å" class="headerlink" title="è®¾ç½®ç­¾å"></a>è®¾ç½®ç­¾å</h3><blockquote><p>é€‰æ‹©éªŒè¯ç æŒ‰é’®ï¼Œä¸€ä¸ªäººæœ€å¤šæ‹¥æœ‰ä¸€ä¸ªç­¾åã€‚<strong>ç†ç”±è¦å¡«å†™æ­£å½“ï¼Œä¸ç„¶ä¸ç»™é€šè¿‡</strong></p></blockquote><h3 id="è®¾ç½®æ¨¡æ¿"><a href="#è®¾ç½®æ¨¡æ¿" class="headerlink" title="è®¾ç½®æ¨¡æ¿"></a>è®¾ç½®æ¨¡æ¿</h3><blockquote><p>æ·»åŠ æ¨¡æ¿ï¼ŒæŒ‰è¦æ±‚å¡«å†™ä¿¡æ¯<br><img src="https://s1.ax1x.com/2020/06/18/NnYE0H.jpg" alt="æ·»åŠ æ¨¡æ¿"><br><strong>ç”³è¯·ç†ç”±ä¸€å®šè¦æ­£å½“ï¼Œä¸ç„¶ä¸ç»™é€šè¿‡</strong></p></blockquote><h2 id="ç¼–å†™æµ‹è¯•ä»£ç "><a href="#ç¼–å†™æµ‹è¯•ä»£ç " class="headerlink" title="ç¼–å†™æµ‹è¯•ä»£ç "></a>ç¼–å†™æµ‹è¯•ä»£ç </h2><blockquote><p>å…·ä½“è¯·å‚è€ƒ â†’ <a href="https://help.aliyun.com/product/44282.html?spm=5176.12438469.0.0.170d1cbe8iQbMH">é˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡apiå¸®åŠ©æ–‡æ¡£</a></p></blockquote><h3 id="æ–°å»ºspringbooté¡¹ç›®"><a href="#æ–°å»ºspringbooté¡¹ç›®" class="headerlink" title="æ–°å»ºspringbooté¡¹ç›®"></a>æ–°å»ºspringbooté¡¹ç›®</h3><h3 id="å¯¼å…¥ä¾èµ–"><a href="#å¯¼å…¥ä¾èµ–" class="headerlink" title="å¯¼å…¥ä¾èµ–"></a>å¯¼å…¥ä¾èµ–</h3><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">  <span class="token comment">&lt;!--å¯¼å…¥é˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡ä¾èµ–--></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.aliyun<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>aliyun-java-sdk-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>4.5.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å¯¼å…¥fastjson--></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>fastjson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2.60<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!--å¯¼å…¥redis--></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç¼–å†™æµ‹è¯•ä»£ç -1"><a href="#ç¼–å†™æµ‹è¯•ä»£ç -1" class="headerlink" title="ç¼–å†™æµ‹è¯•ä»£ç "></a>ç¼–å†™æµ‹è¯•ä»£ç </h3><p>åœ¨testä¸­ä¹¦å†™æµ‹è¯•ä»£ç æµ‹è¯•</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// è¿æ¥é˜¿é‡Œäº‘</span>        <span class="token class-name">DefaultProfile</span> profile <span class="token operator">=</span> <span class="token class-name">DefaultProfile</span><span class="token punctuation">.</span><span class="token function">getProfile</span><span class="token punctuation">(</span><span class="token string">"cn-hangzhou"</span><span class="token punctuation">,</span> <span class="token string">"AccessKeyID"</span><span class="token punctuation">,</span> <span class="token string">"SECRET"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">IAcsClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultAcsClient</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ„å»ºè¯·æ±‚</span>        <span class="token class-name">CommonRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommonRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        request<span class="token punctuation">.</span><span class="token function">setSysMethod</span><span class="token punctuation">(</span><span class="token class-name">MethodType</span><span class="token punctuation">.</span>POST<span class="token punctuation">)</span><span class="token punctuation">;</span>        request<span class="token punctuation">.</span><span class="token function">setSysDomain</span><span class="token punctuation">(</span><span class="token string">"dysmsapi.aliyuncs.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä¸è¦åŠ¨</span>        request<span class="token punctuation">.</span><span class="token function">setSysVersion</span><span class="token punctuation">(</span><span class="token string">"2017-05-25"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä¸è¦åŠ¨</span>        request<span class="token punctuation">.</span><span class="token function">setSysAction</span><span class="token punctuation">(</span><span class="token string">"SendSms"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// äº‹ä»¶åç§°</span>        <span class="token comment">// è‡ªå®šä¹‰å‚æ•°(æ‰‹æœºå·,éªŒè¯ç ,ç­¾å,æ¨¡æ¿)</span>        request<span class="token punctuation">.</span><span class="token function">putQueryParameter</span><span class="token punctuation">(</span><span class="token string">"PhoneNumbers"</span><span class="token punctuation">,</span> <span class="token string">"æ¥æ”¶çŸ­ä¿¡çš„æ‰‹æœºå·"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        request<span class="token punctuation">.</span><span class="token function">putQueryParameter</span><span class="token punctuation">(</span><span class="token string">"SignName"</span><span class="token punctuation">,</span> <span class="token string">"ä½ ç”³è¯·çš„ç­¾å"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        request<span class="token punctuation">.</span><span class="token function">putQueryParameter</span><span class="token punctuation">(</span><span class="token string">"TemplateCode"</span><span class="token punctuation">,</span> <span class="token string">"ä½ ç”³è¯·çš„æ¨¡æ¿CODE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ„å»ºä¸€ä¸ªçŸ­ä¿¡éªŒè¯ç ï¼Œä½œä¸ºæµ‹è¯•</span>        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">,</span><span class="token number">2233</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        request<span class="token punctuation">.</span><span class="token function">putQueryParameter</span><span class="token punctuation">(</span><span class="token string">"TemplateParam"</span><span class="token punctuation">,</span> <span class="token class-name">JSONObject</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// å‘é€å®¢æˆ·ç«¯</span>            <span class="token class-name">CommonResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">getCommonResponse</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ServerException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClientException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ•ˆæœå›¾ï¼š<br><img src="https://s1.ax1x.com/2020/06/18/Nng3uj.jpg" alt="å‘é€æˆåŠŸ"></p><h2 id="ç¼–å†™å¯å¤ç”¨çš„å¾®æœåŠ¡æ¥å£"><a href="#ç¼–å†™å¯å¤ç”¨çš„å¾®æœåŠ¡æ¥å£" class="headerlink" title="ç¼–å†™å¯å¤ç”¨çš„å¾®æœåŠ¡æ¥å£"></a>ç¼–å†™å¯å¤ç”¨çš„å¾®æœåŠ¡æ¥å£</h2><p>ç¼–å†™æ¥å£æ–¹ä¾¿ä»¥åç›´æ¥æ•´åˆåˆ°éœ€è¦çš„é¡¹ç›®ä¸­</p><h3 id="ç¼–å†™application-properties"><a href="#ç¼–å†™application-properties" class="headerlink" title="ç¼–å†™application.properties"></a>ç¼–å†™application.properties</h3><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">server.port</span><span class="token punctuation">=</span><span class="token attr-value">8080</span><span class="token comment"># è®¾ç½®redis</span><span class="token attr-name">spring.redis.host</span><span class="token punctuation">=</span><span class="token attr-value">localhost</span><span class="token attr-name">spring.redis.port</span><span class="token punctuation">=</span><span class="token attr-value">6379</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç¼–å†™serviceå±‚æ¥å£"><a href="#ç¼–å†™serviceå±‚æ¥å£" class="headerlink" title="ç¼–å†™serviceå±‚æ¥å£"></a>ç¼–å†™serviceå±‚æ¥å£</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/**    * çŸ­ä¿¡å‘é€åŠŸèƒ½    * @param phoneNum æ‰‹æœºå·    * @param signName ç­¾å    * @param templateCode æ¨¡æ¿ç¼–å·code    * @param code éªŒè¯ç     * @return boolean    */</span>   <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">String</span> phoneNum<span class="token punctuation">,</span><span class="token class-name">String</span> signName<span class="token punctuation">,</span> <span class="token class-name">String</span> templateCode<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">></span></span> code<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç¼–å†™serviceImplå±‚å®ç°æ–¹æ³•"><a href="#ç¼–å†™serviceImplå±‚å®ç°æ–¹æ³•" class="headerlink" title="ç¼–å†™serviceImplå±‚å®ç°æ–¹æ³•"></a>ç¼–å†™serviceImplå±‚å®ç°æ–¹æ³•</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">String</span> phoneNum<span class="token punctuation">,</span><span class="token class-name">String</span> signName<span class="token punctuation">,</span> <span class="token class-name">String</span> templateCode<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">></span></span> code<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// è¿æ¥é˜¿é‡Œäº‘</span>        <span class="token class-name">DefaultProfile</span> profile <span class="token operator">=</span> <span class="token class-name">DefaultProfile</span><span class="token punctuation">.</span><span class="token function">getProfile</span><span class="token punctuation">(</span><span class="token string">"cn-hangzhou"</span><span class="token punctuation">,</span> <span class="token class-name">SmsConstant</span><span class="token punctuation">.</span>ACCESSKEYID<span class="token punctuation">,</span> <span class="token class-name">SmsConstant</span><span class="token punctuation">.</span>SECRET<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">IAcsClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultAcsClient</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æ„å»ºè¯·æ±‚</span>        <span class="token class-name">CommonRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommonRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        request<span class="token punctuation">.</span><span class="token function">setSysMethod</span><span class="token punctuation">(</span><span class="token class-name">MethodType</span><span class="token punctuation">.</span>POST<span class="token punctuation">)</span><span class="token punctuation">;</span>        request<span class="token punctuation">.</span><span class="token function">setSysDomain</span><span class="token punctuation">(</span><span class="token string">"dysmsapi.aliyuncs.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä¸è¦åŠ¨</span>        request<span class="token punctuation">.</span><span class="token function">setSysVersion</span><span class="token punctuation">(</span><span class="token string">"2017-05-25"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä¸è¦åŠ¨</span>        request<span class="token punctuation">.</span><span class="token function">setSysAction</span><span class="token punctuation">(</span><span class="token string">"SendSms"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// äº‹ä»¶åç§°</span>        <span class="token comment">// è‡ªå®šä¹‰å‚æ•°(æ‰‹æœºå·,éªŒè¯ç ,ç­¾å,æ¨¡æ¿)</span>        request<span class="token punctuation">.</span><span class="token function">putQueryParameter</span><span class="token punctuation">(</span><span class="token string">"PhoneNumbers"</span><span class="token punctuation">,</span> phoneNum<span class="token punctuation">)</span><span class="token punctuation">;</span>        request<span class="token punctuation">.</span><span class="token function">putQueryParameter</span><span class="token punctuation">(</span><span class="token string">"SignName"</span><span class="token punctuation">,</span> signName<span class="token punctuation">)</span><span class="token punctuation">;</span>        request<span class="token punctuation">.</span><span class="token function">putQueryParameter</span><span class="token punctuation">(</span><span class="token string">"TemplateCode"</span><span class="token punctuation">,</span> templateCode<span class="token punctuation">)</span><span class="token punctuation">;</span>        request<span class="token punctuation">.</span><span class="token function">putQueryParameter</span><span class="token punctuation">(</span><span class="token string">"TemplateParam"</span><span class="token punctuation">,</span> <span class="token class-name">JSONObject</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// å‘é€å®¢æˆ·ç«¯</span>            <span class="token class-name">CommonResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">getCommonResponse</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">getHttpResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ServerException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClientException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç¼–å†™controllerå±‚å¯¹å¤–éƒ¨çš„æ¥å£"><a href="#ç¼–å†™controllerå±‚å¯¹å¤–éƒ¨çš„æ¥å£" class="headerlink" title="ç¼–å†™controllerå±‚å¯¹å¤–éƒ¨çš„æ¥å£"></a>ç¼–å†™controllerå±‚å¯¹å¤–éƒ¨çš„æ¥å£</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Autowired</span>   <span class="token keyword">private</span> <span class="token class-name">SendSms</span> sendSms<span class="token punctuation">;</span>   <span class="token annotation punctuation">@Autowired</span>   <span class="token keyword">private</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">></span></span> redisTemplate<span class="token punctuation">;</span>   <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/send/&#123;phone&#125;"</span><span class="token punctuation">)</span>   <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">code</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">String</span> phone<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token comment">// è·å–redisä¸­çš„ç¼“å­˜codeåˆ¤æ–­æœ‰æ²¡æœ‰è¿‡æœŸ</span>       <span class="token class-name">String</span> code <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token comment">// éªŒè¯ç è¿˜æ²¡æœ‰è¿‡æœŸ</span>           <span class="token keyword">return</span> phone<span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span>code<span class="token operator">+</span><span class="token string">"å·²ç»å­˜åœ¨ï¼Œè¿˜æ²¡æœ‰è¿‡æœŸ"</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>       <span class="token comment">// ç”ŸæˆéªŒè¯ç ï¼Œå¹¶å­˜å‚¨åœ¨redisä¸­</span>       code <span class="token operator">=</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">></span></span>param <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       param<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">,</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">boolean</span> send <span class="token operator">=</span> sendSms<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>phone<span class="token punctuation">,</span> <span class="token class-name">SmsConstant</span><span class="token punctuation">.</span>SIGNNAME<span class="token punctuation">,</span> <span class="token class-name">SmsConstant</span><span class="token punctuation">.</span>TEMPLATECODE<span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span>send<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>phone<span class="token punctuation">,</span>code<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MINUTES<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">return</span> phone<span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span>code<span class="token operator">+</span><span class="token string">"å‘é€æˆåŠŸ"</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token string">"å‘é€å¤±è´¥"</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç¼–å†™å¸¸é‡ç±»"><a href="#ç¼–å†™å¸¸é‡ç±»" class="headerlink" title="ç¼–å†™å¸¸é‡ç±»"></a>ç¼–å†™å¸¸é‡ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SIGNNAME <span class="token operator">=</span> <span class="token string">"ä½ ç”³è¯·çš„ç­¾å"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> TEMPLATECODE <span class="token operator">=</span> <span class="token string">"ä½ ç”³è¯·çš„æ¨¡æ¿CODE"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> ACCESSKEYID <span class="token operator">=</span> <span class="token string">"ä½ çš„accesskeyID"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SECRET <span class="token operator">=</span> <span class="token string">"ä½ çš„secret"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®æ¥å£ã€‚ä¾‹å¦‚ï¼šlocalhost:8080/send/æ‰‹æœºå·<br><img src="https://s1.ax1x.com/2020/06/18/Nn22es.jpg" alt="å‘é€æˆåŠŸ"><br>å‡ºç°è¿™ä¸ªå°±è¯æ˜å‘é€æˆåŠŸå•¦ï¼</p>]]></content>
      
      
      <categories>
          
          <category> é˜¿é‡Œäº‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é˜¿é‡Œäº‘ </tag>
            
            <tag> å¾®æœåŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>githubåšå®¢è¿ç§»åˆ°gitee</title>
      <link href="2020/06/18/github-bo-ke-qian-yi-dao-gitee/"/>
      <url>2020/06/18/github-bo-ke-qian-yi-dao-gitee/</url>
      
        <content type="html"><![CDATA[<h1 id="blogè¿ç§»Gitee"><a href="#blogè¿ç§»Gitee" class="headerlink" title="blogè¿ç§»Gitee"></a>blogè¿ç§»Gitee</h1><p>ps:æœ¬ç¯‡åšå®¢å¯ä»¥å®ç°GitHubå’ŒgiteeåŒå‘è®¿é—®ï¼Œæˆ‘ä»¬åªéœ€å†™æ–‡ç« ä¹‹åç”¨hexoå‘å¸ƒåˆ°GitHubä»“åº“ï¼Œå†å»giteeä¸ŠåŒæ­¥ä¸€ä¸‹å³å¯ã€‚ç”¨giteeå¯ä»¥æ›´å¿«é€Ÿçš„è®¿é—®æˆ‘ä»¬çš„åšå®¢</p><h2 id="åœ¨Giteeç”¨GitHubçš„é“¾æ¥å»ºç«‹ä»“åº“"><a href="#åœ¨Giteeç”¨GitHubçš„é“¾æ¥å»ºç«‹ä»“åº“" class="headerlink" title="åœ¨Giteeç”¨GitHubçš„é“¾æ¥å»ºç«‹ä»“åº“"></a>åœ¨Giteeç”¨GitHubçš„é“¾æ¥å»ºç«‹ä»“åº“</h2><h3 id="åˆ›å»ºä»“åº“"><a href="#åˆ›å»ºä»“åº“" class="headerlink" title="åˆ›å»ºä»“åº“"></a>åˆ›å»ºä»“åº“</h3><p>è¯­è¨€å¿…é¡»é€‰æ‹©jsï¼Œä»“åº“å¿…é¡»å…¬å¼€<br><img src="https://s1.ax1x.com/2020/06/18/Nevbc9.png" alt="åˆ›å»ºå‰çš„è®¾ç½®"></p><h3 id="æ‰“å¼€Gitee-Pages"><a href="#æ‰“å¼€Gitee-Pages" class="headerlink" title="æ‰“å¼€Gitee Pages"></a>æ‰“å¼€Gitee Pages</h3><p><img src="https://s1.ax1x.com/2020/06/18/NexeN8.png" alt="æ‰“å¼€gitee pagesåŠŸèƒ½"></p><h3 id="å¯åŠ¨Gitee-Pagesé¡¹ç›®"><a href="#å¯åŠ¨Gitee-Pagesé¡¹ç›®" class="headerlink" title="å¯åŠ¨Gitee Pagesé¡¹ç›®"></a>å¯åŠ¨Gitee Pagesé¡¹ç›®</h3><p>éƒ¨ç½²åˆ†æ”¯ä¸€èˆ¬æ˜¯masterï¼Œç‚¹ä¸Šå¼ºåˆ¶ä½¿ç”¨httpså³å¯ã€‚<br><img src="https://i.loli.net/2019/07/18/5d302f3d46d7b67296.png" alt="è®¾ç½®ä¸å¯åŠ¨"></p><p>æˆåŠŸä¹‹åç‚¹å‡»æ˜¾ç¤ºçš„è·¯å¾„å°±èƒ½è®¿é—®è‡ªå·±çš„blogäº†</p><h2 id="ä¸€äº›é—®é¢˜"><a href="#ä¸€äº›é—®é¢˜" class="headerlink" title="ä¸€äº›é—®é¢˜"></a>ä¸€äº›é—®é¢˜</h2><h3 id="è¿›å…¥é¡µé¢æ ·å¼æ— æ³•æ­£å¸¸åŠ è½½"><a href="#è¿›å…¥é¡µé¢æ ·å¼æ— æ³•æ­£å¸¸åŠ è½½" class="headerlink" title="è¿›å…¥é¡µé¢æ ·å¼æ— æ³•æ­£å¸¸åŠ è½½"></a>è¿›å…¥é¡µé¢æ ·å¼æ— æ³•æ­£å¸¸åŠ è½½</h3><p><img src="https://i.loli.net/2019/07/18/5d302fee7596d45273.png" alt="æ ·å¼æ— æ³•åŠ è½½"><br><strong>åŸå› æ˜¯ç”±äºè·¯å¾„çš„é—®é¢˜ï¼Œæ— æ³•æ­£ç¡®åŠ è½½æ ·å¼ï¼Œæˆ‘ä»¬åªéœ€è¦å°†é“¾æ¥åçš„äºŒçº§ç›®å½•å»æ‰å°±å¥½äº†ã€‚</strong>ç‚¹å‡»ç®¡ç†ï¼Œå°†ä»“åº“çš„è·¯å¾„è®¾ç½®ä¸ºä¸ç”¨æˆ·åä¸€æ ·å³å¯ã€‚</p><p><img src="https://s1.ax1x.com/2020/06/18/NmpQjH.png" alt="è§£å†³æ–¹æ¡ˆ"></p><p>ç„¶åå°±èƒ½æ„‰å¿«çš„è®¿é—®äº†~~</p>]]></content>
      
      
      <categories>
          
          <category> blog </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
            <tag> Gitee </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jdbcå’Œdebug</title>
      <link href="2020/05/30/jdbc-he-debug/"/>
      <url>2020/05/30/jdbc-he-debug/</url>
      
        <content type="html"><![CDATA[<h1 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h1><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><blockquote><p>JDBC APIæ˜¯ä¸€ä¸ªJava APIï¼Œå¯ä»¥è®¿é—®ä»»ä½•ç±»å‹è¡¨åˆ—æ•°æ®ï¼Œç‰¹åˆ«æ˜¯å­˜å‚¨åœ¨å…³ç³»æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚JDBCä»£è¡¨Javaæ•°æ®åº“è¿æ¥ã€‚ç›¸å½“äºä¸€ä¸ªä¸­é—´å•†ã€‚</p></blockquote><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><h3 id="1ã€åŠ è½½é©±åŠ¨"><a href="#1ã€åŠ è½½é©±åŠ¨" class="headerlink" title="1ã€åŠ è½½é©±åŠ¨"></a>1ã€åŠ è½½é©±åŠ¨</h3><h4 id="1-1ã€å¯¼åŒ…"><a href="#1-1ã€å¯¼åŒ…" class="headerlink" title="1.1ã€å¯¼åŒ…"></a>1.1ã€å¯¼åŒ…</h4><p>å¯¼å…¥ç›¸å…³çš„æ•°æ®åº“jaråŒ…</p><h4 id="1-2ã€-åŠ è½½é©±åŠ¨"><a href="#1-2ã€-åŠ è½½é©±åŠ¨" class="headerlink" title="1.2ã€ åŠ è½½é©±åŠ¨"></a>1.2ã€ åŠ è½½é©±åŠ¨</h4><p>è¿™ä¸€æ­¥ç›¸å½“äºä½ å‡†å¤‡æ‰“å¼€äº†æ‰‹æœº</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>yourDriverName<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2ã€è·å¾—è¿æ¥"><a href="#2ã€è·å¾—è¿æ¥" class="headerlink" title="2ã€è·å¾—è¿æ¥"></a>2ã€è·å¾—è¿æ¥</h3><p>è¿™ä¸€æ­¥ç›¸å½“äºä½ æ‰“å¼€äº†ç¾å›¢å¤–å–</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="3ã€ä¹¦å†™sql"><a href="#3ã€ä¹¦å†™sql" class="headerlink" title="3ã€ä¹¦å†™sql"></a>3ã€ä¹¦å†™sql</h3><p>è¿™ä¸€æ­¥ç›¸å½“äºä½ ç‚¹äº†è¦åƒçš„ä¸œè¥¿</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> sql<span class="token operator">=</span><span class="token string">"select * from student"</span><span class="token punctuation">;</span><span class="token comment">// æŸ¥æ‰¾</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="4ã€å‡†å¤‡å‘èµ·å¯¹è¯"><a href="#4ã€å‡†å¤‡å‘èµ·å¯¹è¯" class="headerlink" title="4ã€å‡†å¤‡å‘èµ·å¯¹è¯"></a>4ã€å‡†å¤‡å‘èµ·å¯¹è¯</h3><p>ç›¸å½“äºä½ ä¸‹å•äº†ï¼Œå¤–å–å°å“¥æ¥åˆ°äº†ä½ çš„å•å­</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">PreparedStatement</span> ps <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="5ã€æ‰§è¡Œæ“ä½œå¹¶æ¥æ”¶ç»“æœ"><a href="#5ã€æ‰§è¡Œæ“ä½œå¹¶æ¥æ”¶ç»“æœ" class="headerlink" title="5ã€æ‰§è¡Œæ“ä½œå¹¶æ¥æ”¶ç»“æœ"></a>5ã€æ‰§è¡Œæ“ä½œå¹¶æ¥æ”¶ç»“æœ</h3><p>ç›¸å½“äºå¤–å–å°å“¥å»é¥­é¦†ä¹°äº†é¥­ç»™ä½ é€è¿‡æ¥ï¼Œä½ è¦å»æ‹¿</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/*æƒ…å†µä¸€ï¼šæ‰§è¡ŒæŸ¥è¯¢æ“ä½œçš„æ—¶å€™  è¦è°ƒç”¨çš„æ–¹æ³•æ˜¯executeQuery()ï¼Œå…¶è¿”å›å€¼æ˜¯ResultSetç±»å‹*/</span><span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è¿™æ—¶å€™å°±éœ€è¦éå†rsï¼Œè¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œï¼ˆç›´æ¥è¾“å‡ºæˆ–è€…æ”¾åˆ°å¯¹è±¡é‡Œè¾¹è¿”å›ï¼‰</span><span class="token keyword">while</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// è¿™é‡Œè¿›è¡Œä¸šåŠ¡ä»£ç çš„ä¹¦å†™</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"Sname"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"   "</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"Sage"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/*æƒ…å†µäºŒï¼šæ‰§è¡Œåˆ é™¤ï¼Œå¢åŠ ï¼Œä¿®æ”¹æ“ä½œçš„æ—¶å€™ï¼Œè°ƒç”¨æ–¹æ³•execute()æˆ–è€…executeUpdate()åŒºåˆ«:executeUpdate() è¿”å›çš„æ˜¯å—å½±å“çš„è¡Œæ•°execute() æ‰§è¡ŒæˆåŠŸè¿”å›false*/</span><span class="token keyword">boolean</span> execute <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è¿”å›æ‰§è¡ŒæˆåŠŸäº†æ²¡æœ‰</span><span class="token comment">// æˆ–è€…</span><span class="token keyword">int</span> executeUpdate <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è¿”å›æ‰§è¡Œçš„è¡Œæ•°</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ”¹è¿›"><a href="#æ”¹è¿›" class="headerlink" title="æ”¹è¿›"></a>æ”¹è¿›</h2><p>æˆ‘ä»¬å‘ç°ç”¨ä¸Šé¢çš„æ–¹æ³•å†™ä¸šåŠ¡çš„æ—¶å€™ä¼šå‡ºç°å¤§é‡ä»£ç å†—ä½™çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªå·±å°è£…ä¸€ä¸‹ï¼Œå¯ä»¥å‡å°‘å¾ˆå¤šå†—ä½™</p><h3 id="1ã€ä¹¦å†™é…ç½®æ–‡ä»¶"><a href="#1ã€ä¹¦å†™é…ç½®æ–‡ä»¶" class="headerlink" title="1ã€ä¹¦å†™é…ç½®æ–‡ä»¶"></a>1ã€ä¹¦å†™é…ç½®æ–‡ä»¶</h3><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">driver</span><span class="token punctuation">=</span><span class="token attr-value">com.mysql.cj.jdbc.Driver #é©±åŠ¨å</span><span class="token attr-name">jdbcUrl</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost:3306/test?serverTimezone=GMT%2B8 #å›ºå®šæ ¼å¼ï¼Œåªéœ€è¦ä¿®æ”¹åœ°å€å’Œæ•°æ®åº“åä»¥åŠåé¢çš„å‚æ•°</span><span class="token attr-name">username</span><span class="token punctuation">=</span><span class="token attr-value">root #ç”¨æˆ·å</span><span class="token attr-name">userpassword</span><span class="token punctuation">=</span><span class="token attr-value">root #å¯†ç </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2ã€åˆ›å»ºJdbcUtilç±»"><a href="#2ã€åˆ›å»ºJdbcUtilç±»" class="headerlink" title="2ã€åˆ›å»ºJdbcUtilç±»"></a>2ã€åˆ›å»ºJdbcUtilç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>baidu<span class="token punctuation">.</span>util</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DriverManager</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">ResultSet</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLException</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Statement</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ResourceBundle</span><span class="token punctuation">;</span><span class="token comment">/* * jdbcå·¥å…·ç±» * @author Zhy * */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JDBCUtil</span> <span class="token punctuation">&#123;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> driver<span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> jdbcUrl<span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> userpassword<span class="token punctuation">;</span><span class="token keyword">static</span><span class="token punctuation">&#123;</span><span class="token comment">//è¯»å–Propertiesæ–‡ä»¶</span><span class="token class-name">ResourceBundle</span> bundle <span class="token operator">=</span> <span class="token class-name">ResourceBundle</span><span class="token punctuation">.</span><span class="token function">getBundle</span><span class="token punctuation">(</span><span class="token string">"jdbc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>driver <span class="token operator">=</span> bundle<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>jdbcUrl<span class="token operator">=</span> bundle<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"jdbcUrl"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>username <span class="token operator">=</span> bundle<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>userpassword <span class="token operator">=</span> bundle<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"userpassword"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//è·å–Connectionå¯¹è±¡</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token class-name">Connection</span> conn <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span> conn <span class="token operator">=</span><span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>jdbcUrl<span class="token punctuation">,</span> username<span class="token punctuation">,</span> userpassword<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> conn<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å…³é—­Statement</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeStatement</span><span class="token punctuation">(</span><span class="token class-name">Statement</span> state<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>state <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>state<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//å…³é—­Connection</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeConnection</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> conn<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>conn <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//å…³é—­èµ„æº</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeResource</span><span class="token punctuation">(</span><span class="token class-name">Statement</span> state<span class="token punctuation">,</span><span class="token class-name">Connection</span> conn<span class="token punctuation">,</span><span class="token class-name">ResultSet</span> rs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">closeStatement</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">closeConnection</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">closeResultSet</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å…³é—­ResultSetè¿æ¥</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeResultSet</span><span class="token punctuation">(</span><span class="token class-name">ResultSet</span> rs<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>rs <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//äº‹åŠ¡å›æ»š</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">rollback</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> conn<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>conn <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>conn<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">commit</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> conn<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span>conn<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>conn<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/* * æµ‹è¯•è¿æ¥Connection */</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">Connection</span> con <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>con <span class="token operator">=</span> <span class="token class-name">JDBCUtil</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>con<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3ã€ä¹¦å†™ä»£ç "><a href="#3ã€ä¹¦å†™ä»£ç " class="headerlink" title="3ã€ä¹¦å†™ä»£ç "></a>3ã€ä¹¦å†™ä»£ç </h3><p>ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// è°ƒç”¨å·¥å…·ç±»è·å–è¿æ¥</span><span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">JDBCUtil</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//ä¹¦å†™sql</span><span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"select * from school limit 0,10"</span><span class="token punctuation">;</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token comment">//å‡†å¤‡å¼€å§‹å¯¹è¯</span><span class="token class-name">PreparedStatement</span> prepareStatement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//æ¥æ”¶ç»“æœ</span><span class="token class-name">ResultSet</span> rs <span class="token operator">=</span> prepareStatement<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//éå†ç»“æœé›†ï¼Œå†™ä¸šåŠ¡ä»£ç </span><span class="token keyword">while</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">//è¿™é‡Œå†™ä¸šåŠ¡ä»£ç </span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="DeBug"><a href="#DeBug" class="headerlink" title="DeBug"></a>DeBug</h1><blockquote><p>å‚è€ƒé“¾æ¥:<a href="https://blog.csdn.net/qq_33339121/article/details/78536185">https://blog.csdn.net/qq_33339121/article/details/78536185</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JDBC </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vueå­¦ä¹ </title>
      <link href="2020/05/16/vue-xue-xi/"/>
      <url>2020/05/16/vue-xue-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="Vueå®æˆ˜"><a href="#Vueå®æˆ˜" class="headerlink" title="Vueå®æˆ˜"></a>Vueå®æˆ˜</h1><h2 id="1-Vue-å¼•è¨€"><a href="#1-Vue-å¼•è¨€" class="headerlink" title="1. Vue å¼•è¨€"></a>1. Vue å¼•è¨€</h2><blockquote><p><code>æ¸è¿›å¼</code> JavaScript æ¡†æ¶   â€“æ‘˜è‡ªå®˜ç½‘</p></blockquote><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ¸è¿›å¼</span>   <span class="token list punctuation">1.</span> æ˜“ç”¨  html css javascript   <span class="token list punctuation">2.</span> é«˜æ•ˆ  å¼€å‘å‰ç«¯é¡µé¢ éå¸¸é«˜æ•ˆ    <span class="token list punctuation">3.</span> çµæ´»  å¼€å‘çµæ´» å¤šæ ·æ€§<span class="token title important"><span class="token punctuation">#</span> æ€»ç»“</span>Vue æ˜¯ä¸€ä¸ªjavascript æ¡†æ¶<span class="token title important"><span class="token punctuation">#</span> åç«¯æœåŠ¡ç«¯å¼€å‘äººå‘˜: </span>Vue æ¸è¿›å¼javascriptæ¡†æ¶: è®©æˆ‘ä»¬é€šè¿‡æ“ä½œå¾ˆå°‘çš„DOM,ç”šè‡³ä¸éœ€è¦æ“ä½œé¡µé¢ä¸­ä»»ä½•DOMå…ƒç´ ,å°±å¾ˆå®¹æ˜“çš„å®Œæˆæ•°æ®å’Œè§†å›¾ç»‘å®š  åŒå‘ç»‘å®š MVVM  <span class="token code keyword">æ³¨æ„: æ—¥ååœ¨ä½¿ç”¨Vueè¿‡ç¨‹ä¸­é¡µé¢ä¸­ä¸è¦åœ¨å¼•å…¥Jqueryæ¡†æ¶htmlcss--->javascript ----->jquery---->angularjs -----> Vue</span>  <span class="token title important"><span class="token punctuation">#</span> Vue ä½œè€…</span>  å°¤é›¨æºª   å›½å†…çš„    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="2-Vueå…¥é—¨"><a href="#2-Vueå…¥é—¨" class="headerlink" title="2. Vueå…¥é—¨"></a>2. Vueå…¥é—¨</h2><h3 id="2-1-ä¸‹è½½Vuejs"><a href="#2-1-ä¸‹è½½Vuejs" class="headerlink" title="2.1    ä¸‹è½½Vuejs"></a>2.1    ä¸‹è½½Vuejs</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//å¼€å‘ç‰ˆæœ¬:</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> å¼€å‘ç¯å¢ƒç‰ˆæœ¬ï¼ŒåŒ…å«äº†æœ‰å¸®åŠ©çš„å‘½ä»¤è¡Œè­¦å‘Š <span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://cdn.jsdelivr.net/npm/vue/dist/vue.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token comment">//ç”Ÿäº§ç‰ˆæœ¬:</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> ç”Ÿäº§ç¯å¢ƒç‰ˆæœ¬ï¼Œä¼˜åŒ–äº†å°ºå¯¸å’Œé€Ÿåº¦ <span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://cdn.jsdelivr.net/npm/vue"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-2-Vueç¬¬ä¸€ä¸ªå…¥é—¨åº”ç”¨"><a href="#2-2-Vueç¬¬ä¸€ä¸ªå…¥é—¨åº”ç”¨" class="headerlink" title="2.2 Vueç¬¬ä¸€ä¸ªå…¥é—¨åº”ç”¨"></a>2.2 Vueç¬¬ä¸€ä¸ªå…¥é—¨åº”ç”¨</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>       &#123;&#123; msg &#125;&#125;  &#123;&#123;username&#125;&#125; &#123;&#123;pwd&#125;&#125;       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>           &#123;&#123; username &#125;&#125;           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>&#123;&#123; msg &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>   <span class="token comment">&lt;!--å¼•å…¥vue.js--></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">       <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>           el<span class="token operator">:</span><span class="token string">"#app"</span><span class="token punctuation">,</span>  <span class="token comment">//element ç”¨æ¥ç»™Vueå®ä¾‹å®šä¹‰ä¸€ä¸ªä½œç”¨èŒƒå›´</span>           data<span class="token operator">:</span><span class="token punctuation">&#123;</span>      <span class="token comment">//ç”¨æ¥ç»™Vueå®ä¾‹å®šä¹‰ä¸€äº›ç›¸å…³æ•°æ®</span>               msg<span class="token operator">:</span><span class="token string">"ç™¾çŸ¥æ¬¢è¿ä½ ,æœŸå¾…ä½ çš„åŠ å…¥!"</span><span class="token punctuation">,</span>               username<span class="token operator">:</span><span class="token string">"hello Vue!"</span><span class="token punctuation">,</span>               pwd <span class="token operator">:</span><span class="token string">"12345"</span><span class="token punctuation">,</span>           <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>       <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“:</span>1.vueå®ä¾‹(å¯¹è±¡)ä¸­elå±æ€§: ä»£è¡¨Vueçš„ä½œç”¨èŒƒå›´  æ—¥ååœ¨Vueçš„ä½œç”¨èŒƒå›´å†…éƒ½å¯ä»¥ä½¿ç”¨Vueçš„è¯­æ³•2.vueå®ä¾‹(å¯¹è±¡)ä¸­dataå±æ€§: ç”¨æ¥ç»™Vueå®ä¾‹ç»‘å®šä¸€äº›ç›¸å…³æ•°æ®, ç»‘å®šçš„æ•°æ®å¯ä»¥é€šè¿‡&#123;&#123;å˜é‡å&#125;&#125;åœ¨Vueä½œç”¨èŒƒå›´å†…å–å‡º3.åœ¨ä½¿ç”¨&#123;&#123;&#125;&#125;è¿›è¡Œè·å–dataä¸­æ•°æ®æ—¶,å¯ä»¥åœ¨&#123;&#123;&#125;&#125;ä¸­ä¹¦å†™è¡¨è¾¾å¼,è¿ç®—ç¬¦,è°ƒç”¨ç›¸å…³æ–¹æ³•,ä»¥åŠé€»è¾‘è¿ç®—ç­‰4.elå±æ€§ä¸­å¯ä»¥ä¹¦å†™ä»»æ„çš„CSSé€‰æ‹©å™¨[jqueryé€‰æ‹©å™¨],ä½†æ˜¯åœ¨ä½¿ç”¨Vueå¼€å‘æ˜¯æ¨èä½¿ç”¨ idé€‰æ‹©å™¨<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="3-v-textå’Œv-html"><a href="#3-v-textå’Œv-html" class="headerlink" title="3. v-textå’Œv-html"></a>3. v-textå’Œv-html</h2><h3 id="3-1-v-text"><a href="#3-1-v-text" class="headerlink" title="3.1 v-text"></a>3.1 v-text</h3><blockquote><p><code>v-text</code>:ç”¨æ¥è·å–dataä¸­æ•°æ®å°†æ•°æ®ä»¥æ–‡æœ¬çš„å½¢å¼æ¸²æŸ“åˆ°æŒ‡å®šæ ‡ç­¾å†…éƒ¨             ç±»ä¼¼äºjavascript ä¸­ innerText</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token punctuation">></span></span>&#123;&#123; message &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!--å¼•å…¥vue.js--></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">      <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>          el<span class="token operator">:</span><span class="token string">"#app"</span><span class="token punctuation">,</span>          data<span class="token operator">:</span><span class="token punctuation">&#123;</span>              message<span class="token operator">:</span><span class="token string">"ç™¾çŸ¥æ¬¢è¿æ‚¨"</span>          <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“</span>1.&#123;&#123;&#125;&#125;(æ’å€¼è¡¨è¾¾å¼)å’Œv-textè·å–æ•°æ®çš„åŒºåˆ«åœ¨äº a.ä½¿ç”¨v-textå–å€¼ä¼šå°†æ ‡ç­¾ä¸­åŸæœ‰çš„æ•°æ®è¦†ç›– ä½¿ç”¨æ’å€¼è¡¨è¾¾å¼çš„å½¢å¼ä¸ä¼šè¦†ç›–æ ‡ç­¾åŸæœ‰çš„æ•°æ®b.ä½¿ç”¨v-textå¯ä»¥é¿å…åœ¨ç½‘ç»œç¯å¢ƒè¾ƒå·®çš„æƒ…å†µä¸‹å‡ºç°æ’å€¼é—ªçƒ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-2-v-html"><a href="#3-2-v-html" class="headerlink" title="3.2 v-html"></a>3.2 v-html</h3><blockquote><p><code>v-html</code>:ç”¨æ¥è·å–dataä¸­æ•°æ®å°†æ•°æ®ä¸­å«æœ‰çš„htmlæ ‡ç­¾å…ˆè§£æåœ¨æ¸²æŸ“åˆ°æŒ‡å®šæ ‡ç­¾çš„å†…éƒ¨  ç±»ä¼¼äºjavascriptä¸­ innerHTML</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>&#123;&#123;message&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-html</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>xxxxxx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--å¼•å…¥vue.js--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">        <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>            el<span class="token operator">:</span><span class="token string">"#app"</span><span class="token punctuation">,</span>            data<span class="token operator">:</span><span class="token punctuation">&#123;</span>                message<span class="token operator">:</span><span class="token string">"&lt;a href=''>ç™¾çŸ¥æ¬¢è¿æ‚¨&lt;/a>"</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="4-vueä¸­äº‹ä»¶ç»‘å®š-v-on"><a href="#4-vueä¸­äº‹ä»¶ç»‘å®š-v-on" class="headerlink" title="4.vueä¸­äº‹ä»¶ç»‘å®š(v-on)"></a>4.vueä¸­äº‹ä»¶ç»‘å®š(v-on)</h2><h3 id="4-1-ç»‘å®šäº‹ä»¶åŸºæœ¬è¯­æ³•"><a href="#4-1-ç»‘å®šäº‹ä»¶åŸºæœ¬è¯­æ³•" class="headerlink" title="4.1 ç»‘å®šäº‹ä»¶åŸºæœ¬è¯­æ³•"></a>4.1 ç»‘å®šäº‹ä»¶åŸºæœ¬è¯­æ³•</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>&#123;&#123;message&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">v-text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>å¹´é¾„:&#123;&#123; age &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ç‚¹æˆ‘æ”¹å˜å¹´é¾„<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">v-on:</span>click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>changeage<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!--å¼•å…¥vue.js--></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">      <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>          el<span class="token operator">:</span><span class="token string">"#app"</span><span class="token punctuation">,</span>          data<span class="token operator">:</span><span class="token punctuation">&#123;</span>              message<span class="token operator">:</span><span class="token string">"hello æ¬¢è¿æ¥åˆ°ç™¾çŸ¥è¯¾å ‚!"</span><span class="token punctuation">,</span>              age<span class="token operator">:</span><span class="token number">23</span><span class="token punctuation">,</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          methods<span class="token operator">:</span><span class="token punctuation">&#123;</span>  <span class="token comment">//methods ç”¨æ¥å®šä¹‰vueä¸­æ—¶é—´</span>              <span class="token function-variable function">changeage</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'ç‚¹å‡»è§¦å‘'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“:</span>äº‹ä»¶  äº‹ä»¶æº:å‘ç”Ÿäº‹ä»¶domå…ƒç´   äº‹ä»¶: å‘ç”Ÿç‰¹å®šçš„åŠ¨ä½œ  click....  ç›‘å¬å™¨  å‘ç”Ÿç‰¹å®šåŠ¨ä½œä¹‹åçš„äº‹ä»¶å¤„ç†ç¨‹åº é€šå¸¸æ˜¯jsä¸­å‡½æ•°1.åœ¨vueä¸­ç»‘å®šäº‹ä»¶æ˜¯é€šè¿‡v-onæŒ‡ä»¤æ¥å®Œæˆçš„ v-on:äº‹ä»¶å å¦‚  v-on:click2.åœ¨v-on:äº‹ä»¶åçš„èµ‹å€¼è¯­å¥ä¸­æ˜¯å½“å‰æ—¶é—´è§¦å‘è°ƒç”¨çš„å‡½æ•°å3.åœ¨vueä¸­äº‹ä»¶çš„å‡½æ•°ç»Ÿä¸€å®šä¹‰åœ¨Vueå®ä¾‹çš„methodså±æ€§ä¸­4.åœ¨vueå®šä¹‰çš„äº‹ä»¶ä¸­thisæŒ‡çš„å°±æ˜¯å½“å‰çš„Vueå®ä¾‹,æ—¥åå¯ä»¥åœ¨äº‹ä»¶ä¸­é€šè¿‡ä½¿ç”¨thisè·å–Vueå®ä¾‹ä¸­ç›¸å…³æ•°æ®<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-2-Vueä¸­äº‹ä»¶çš„ç®€åŒ–è¯­æ³•"><a href="#4-2-Vueä¸­äº‹ä»¶çš„ç®€åŒ–è¯­æ³•" class="headerlink" title="4.2 Vueä¸­äº‹ä»¶çš„ç®€åŒ–è¯­æ³•"></a>4.2 Vueä¸­äº‹ä»¶çš„ç®€åŒ–è¯­æ³•</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>&#123;&#123; age &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>é€šè¿‡v-onäº‹ä»¶ä¿®æ”¹å¹´é¾„æ¯æ¬¡+1<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">v-on:</span>click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>changeage<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>é€šè¿‡@ç»‘å®šæ—¶é—´ä¿®æ”¹å¹´é¾„æ¯æ¬¡-1<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>editage<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!--å¼•å…¥vue.js--></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">      <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>         el<span class="token operator">:</span><span class="token string">"#app"</span><span class="token punctuation">,</span>  <span class="token comment">//element: ç”¨æ¥æŒ‡å®švueä½œç”¨èŒƒå›´</span>         data<span class="token operator">:</span><span class="token punctuation">&#123;</span>             age<span class="token operator">:</span><span class="token number">23</span><span class="token punctuation">,</span>         <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token comment">//data   : ç”¨æ¥å®šä¹‰vueå®ä¾‹ä¸­ç›¸å…³æ•°æ®</span>         methods<span class="token operator">:</span><span class="token punctuation">&#123;</span>             <span class="token function-variable function">changeage</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                 <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token operator">++</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>             <span class="token function-variable function">editage</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                 <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token operator">--</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span>  <span class="token comment">//methods: ç”¨æ¥å®šä¹‰äº‹ä»¶çš„å¤„ç†å‡½æ•°</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“:</span>1.æ—¥ååœ¨vueä¸­ç»‘å®šäº‹ä»¶æ—¶å¯ä»¥é€šè¿‡@ç¬¦å·å½¢å¼ ç®€åŒ–  v-on çš„äº‹ä»¶ç»‘å®š<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="4-3-Vueäº‹ä»¶å‡½æ•°ä¸¤ç§å†™æ³•"><a href="#4-3-Vueäº‹ä»¶å‡½æ•°ä¸¤ç§å†™æ³•" class="headerlink" title="4.3 Vueäº‹ä»¶å‡½æ•°ä¸¤ç§å†™æ³•"></a>4.3 Vueäº‹ä»¶å‡½æ•°ä¸¤ç§å†™æ³•</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>&#123;&#123;count&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æ”¹å˜countçš„å€¼<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>changecount<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!--å¼•å…¥vue.js--></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">      <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>         el<span class="token operator">:</span><span class="token string">"#app"</span><span class="token punctuation">,</span>         data<span class="token operator">:</span><span class="token punctuation">&#123;</span>             count<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>         <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>         methods<span class="token operator">:</span><span class="token punctuation">&#123;</span>             <span class="token comment">/*changecount:function()&#123;                 this.count++;             &#125;*/</span>             <span class="token function">changecount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                 <span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“:</span>1.åœ¨Vueä¸­äº‹ä»¶å®šä¹‰å­˜åœ¨ä¸¤ç§å†™æ³•  ä¸€ç§æ˜¯ å‡½æ•°å:function()&#123;&#125;  æ¨è    ä¸€ç§æ˜¯  å‡½æ•°å()&#123;&#125; æ¨è<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="4-4-Vueäº‹ä»¶å‚æ•°ä¼ é€’"><a href="#4-4-Vueäº‹ä»¶å‚æ•°ä¼ é€’" class="headerlink" title="4.4 Vueäº‹ä»¶å‚æ•°ä¼ é€’"></a>4.4 Vueäº‹ä»¶å‚æ•°ä¼ é€’</h3><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>&#123;&#123;count&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æ”¹å˜countä¸ºæŒ‡å®šçš„å€¼<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>changecount(23,<span class="token punctuation">'</span>xiaohei<span class="token punctuation">'</span>)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!--å¼•å…¥vue.js--></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">      <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>         el<span class="token operator">:</span><span class="token string">"#app"</span><span class="token punctuation">,</span>         data<span class="token operator">:</span><span class="token punctuation">&#123;</span>             count<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>         <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>         methods<span class="token operator">:</span><span class="token punctuation">&#123;</span>             <span class="token comment">//å®šä¹‰changecount</span>             <span class="token function">changecount</span><span class="token punctuation">(</span><span class="token parameter">count<span class="token punctuation">,</span>name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                 <span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">=</span> count<span class="token punctuation">;</span>                 <span class="token function">alert</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">&#125;</span>         <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“:</span>1.åœ¨ä½¿ç”¨äº‹ä»¶æ—¶,å¯ä»¥ç›´æ¥åœ¨äº‹ä»¶è°ƒç”¨å‡ºç»™äº‹ä»¶è¿›è¡Œå‚æ•°ä¼ é€’,åœ¨äº‹ä»¶å®šä¹‰å‡ºé€šè¿‡å®šä¹‰å¯¹åº”å˜é‡æ¥æ”¶ä¼ é€’çš„å‚æ•°<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><hr><h2 id="5-v-show-v-if-v-bind"><a href="#5-v-show-v-if-v-bind" class="headerlink" title="5.v-show v-if v-bind"></a>5.v-show v-if v-bind</h2><h3 id="5-1-v-show"><a href="#5-1-v-show" class="headerlink" title="5.1 v-show"></a>5.1 v-show</h3><blockquote><p><code>v-show</code>:ç”¨æ¥æ§åˆ¶é¡µé¢ä¸­æŸä¸ªæ ‡ç­¾å…ƒç´ æ˜¯å¦å±•ç¤º        åº•å±‚ä½¿ç”¨æ§åˆ¶æ˜¯ display å±æ€§</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--        v-show: ç”¨æ¥æ§åˆ¶æ ‡ç­¾å±•ç¤ºè¿˜æ˜¯éšè—çš„    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç™¾çŸ¥æ•™è‚²æ¬¢è¿ä½ çš„åŠ å…¥!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>show<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç™¾çŸ¥æ•™è‚²æ¬¢è¿ä½ çš„åŠ å…¥è¿™æ˜¯vueä¸­å®šä¹‰å˜é‡true!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>å±•ç¤ºéšè—æ ‡ç­¾<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>showmsg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å¼•å…¥vue.js--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        el<span class="token operator">:</span><span class="token string">"#app"</span><span class="token punctuation">,</span>        data<span class="token operator">:</span><span class="token punctuation">&#123;</span>            show<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        methods<span class="token operator">:</span><span class="token punctuation">&#123;</span>            <span class="token comment">//å®šä¹‰æ—¶é—´</span>            <span class="token function">showmsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token keyword">this</span><span class="token punctuation">.</span>show <span class="token operator">=</span>  <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>show<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“</span>1.åœ¨ä½¿ç”¨v-showæ—¶å¯ä»¥ç›´æ¥ä¹¦å†™booleanå€¼æ§åˆ¶å…ƒç´ å±•ç¤º,ä¹Ÿå¯ä»¥é€šè¿‡å˜é‡æ§åˆ¶æ ‡ç­¾å±•ç¤ºå’Œéšè—2.åœ¨v-showä¸­å¯ä»¥é€šè¿‡booleanè¡¨è¾¾å¼æ§åˆ¶æ ‡ç­¾çš„å±•ç¤ºè¯¾éšè—<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="5-2-v-if"><a href="#5-2-v-if" class="headerlink" title="5.2 v-if"></a>5.2 v-if</h3><blockquote><p><code>v-if</code>: ç”¨æ¥æ§åˆ¶é¡µé¢å…ƒç´ æ˜¯å¦å±•ç¤º                åº•å±‚æ§åˆ¶æ˜¯DOMå…ƒç´     æ“ä½œDOM</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç™¾çŸ¥æ•™è‚²<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>show<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç™¾çŸ¥æ•™è‚²æ¬¢è¿ä½ çš„åŠ å…¥<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å¼•å…¥vue.js--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        el<span class="token operator">:</span><span class="token string">"#app"</span><span class="token punctuation">,</span>        data<span class="token operator">:</span><span class="token punctuation">&#123;</span>            show<span class="token operator">:</span><span class="token boolean">false</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        methods<span class="token operator">:</span><span class="token punctuation">&#123;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-3-v-bind"><a href="#5-3-v-bind" class="headerlink" title="5.3 v-bind"></a>5.3 v-bind</h3><blockquote><p><code>v-bind</code>: ç”¨æ¥ç»‘å®šæ ‡ç­¾çš„å±æ€§ä»è€Œé€šè¿‡vueåŠ¨æ€ä¿®æ”¹æ ‡ç­¾çš„å±æ€§</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">v-bind:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">v-bind:</span>class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;aa:showCss&#125;<span class="token punctuation">"</span></span>  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>baizhilogo.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å¼•å…¥vue.js--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        el<span class="token operator">:</span><span class="token string">"#app"</span><span class="token punctuation">,</span>        data<span class="token operator">:</span><span class="token punctuation">&#123;</span>            msg<span class="token operator">:</span><span class="token string">"ç™¾çŸ¥æ•™è‚²å®˜æ–¹logo!!!!"</span><span class="token punctuation">,</span>            showCss<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        methods<span class="token operator">:</span><span class="token punctuation">&#123;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-4-v-bind-ç®€åŒ–å†™æ³•"><a href="#5-4-v-bind-ç®€åŒ–å†™æ³•" class="headerlink" title="5.4 v-bind ç®€åŒ–å†™æ³•"></a>5.4 v-bind ç®€åŒ–å†™æ³•</h3><blockquote><p>â€‹    vueä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬æ—¥åç»‘å®šæ ‡ç­¾çš„å±æ€§æä¾›äº†å¯¹å±æ€§ç»‘å®šçš„ç®€åŒ–å†™æ³•å¦‚ <code>v-bind:å±æ€§å</code> ç®€åŒ–ä¹‹å <code>:å±æ€§å</code></p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span> <span class="token attr-name">:title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;aa:showCss&#125;<span class="token punctuation">"</span></span>  <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>src<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>åŠ¨æ€æ§åˆ¶åŠ å…¥æ ·å¼<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>addCss<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æ”¹å˜å›¾ç‰‡<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>changeSrc<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å¼•å…¥vue.js--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        el<span class="token operator">:</span><span class="token string">"#app"</span><span class="token punctuation">,</span>        data<span class="token operator">:</span><span class="token punctuation">&#123;</span>            msg<span class="token operator">:</span><span class="token string">"ç™¾çŸ¥æ•™è‚²å®˜æ–¹logo!!!!"</span><span class="token punctuation">,</span>            showCss<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>            src<span class="token operator">:</span><span class="token string">"https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1583490365568&amp;di=52a82bd614cd4030f97ada9441bb2d0e&amp;imgtype=0&amp;src=http%3A%2F%2Fimg.kanzhun.com%2Fimages%2Flogo%2F20160714%2F820a68f65b4e4a3634085055779c000c.jpg"</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        methods<span class="token operator">:</span><span class="token punctuation">&#123;</span>            <span class="token function">addCss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>showCss<span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>showCss<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token function">changeSrc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">"https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=1925088662,1336364220&amp;fm=26&amp;gp=0.jpg"</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="6-v-forçš„ä½¿ç”¨"><a href="#6-v-forçš„ä½¿ç”¨" class="headerlink" title="6.v-forçš„ä½¿ç”¨"></a>6.v-forçš„ä½¿ç”¨</h2><blockquote><p><code>v-for</code>: ä½œç”¨å°±æ˜¯ç”¨æ¥å¯¹å¯¹è±¡è¿›è¡Œéå†çš„(æ•°ç»„ä¹Ÿæ˜¯å¯¹è±¡çš„ä¸€ç§)</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>&#123;&#123; user.name &#125;&#125; &#123;&#123; user.age &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--       é€šè¿‡v-foréå†å¯¹è±¡    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(value,key,index) in user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        &#123;&#123;index&#125;&#125; : &#123;&#123;key&#125;&#125; : &#123;&#123;value&#125;&#125;    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--        é€šè¿‡v-foréå†æ•°ç»„    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>a,index in arr<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>            &#123;&#123;index&#125;&#125; &#123;&#123;a&#125;&#125;        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>    <span class="token comment">&lt;!--        é€šè¿‡v-foréå†æ•°ç»„ä¸­å¯¹è±¡        :key ä¾¿äºvueå†…éƒ¨åšé‡ç”¨å’Œæ’åº    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user,index in users<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user.id<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            &#123;&#123;index+1&#125;&#125; &#123;&#123; user.name &#125;&#125;  === &#123;&#123; user.age &#125;&#125; ==== &#123;&#123; user.content &#125;&#125;        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å¼•å…¥vue--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span>        data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>            user<span class="token operator">:</span><span class="token punctuation">&#123;</span>name<span class="token operator">:</span><span class="token string">"å°é™ˆ"</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token number">23</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            arr<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"åŒ—äº¬æ ¡åŒº"</span><span class="token punctuation">,</span> <span class="token string">"å¤©æ´¥æ ¡åŒº"</span><span class="token punctuation">,</span> <span class="token string">"æ²³å—æ ¡åŒº"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            users<span class="token operator">:</span><span class="token punctuation">[</span>                <span class="token punctuation">&#123;</span>id<span class="token operator">:</span><span class="token string">"1"</span><span class="token punctuation">,</span>name<span class="token operator">:</span><span class="token string">"xiaochen"</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token number">23</span><span class="token punctuation">,</span>content<span class="token operator">:</span><span class="token string">"æˆ‘æ›¾ç»ä¹Ÿæ˜¯ä¸€ä¸ªå•çº¯çš„å°‘å¹´!"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                <span class="token punctuation">&#123;</span>id<span class="token operator">:</span><span class="token string">"2"</span><span class="token punctuation">,</span>name<span class="token operator">:</span><span class="token string">"å°ç™½"</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token number">23</span><span class="token punctuation">,</span>content<span class="token operator">:</span><span class="token string">"æˆ‘æ›¾ç»æ˜¯ä¸€ä¸ªé‚ªæ¶çš„å°‘å¹´!"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        methods<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“</span>1.åœ¨ä½¿ç”¨v-forçš„æ—¶å€™ä¸€å®šè¦æ³¨æ„åŠ å…¥:key ç”¨æ¥ç»™vueå†…éƒ¨æä¾›é‡ç”¨å’Œæ’åºçš„å”¯ä¸€key <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><hr><h2 id="7-v-model-åŒå‘ç»‘å®š"><a href="#7-v-model-åŒå‘ç»‘å®š" class="headerlink" title="7 .v-model åŒå‘ç»‘å®š"></a>7 .v-model åŒå‘ç»‘å®š</h2><blockquote><p><code>v-model</code>: ä½œç”¨ç”¨æ¥ç»‘å®šæ ‡ç­¾å…ƒç´ çš„å€¼ä¸vueå®ä¾‹å¯¹è±¡ä¸­dataæ•°æ®ä¿æŒä¸€è‡´,ä»è€Œå®ç°åŒå‘çš„æ•°æ®ç»‘å®šæœºåˆ¶</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>&#123;&#123;message&#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æ”¹å˜Dataä¸­å€¼<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>changeValue<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å¼•å…¥vue--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span>        data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>            message<span class="token operator">:</span><span class="token string">""</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        methods<span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token function">changeValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token operator">=</span><span class="token string">'ç™¾çŸ¥æ•™è‚²!'</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“</span>1.ä½¿ç”¨v-modelæŒ‡ä»¤å¯ä»¥å®ç°æ•°æ®çš„åŒå‘ç»‘å®š 2.æ‰€è°“åŒå‘ç»‘å®š è¡¨å•ä¸­æ•°æ®å˜åŒ–å¯¼è‡´vueå®ä¾‹dataæ•°æ®å˜åŒ–   vueå®ä¾‹ä¸­dataæ•°æ®çš„å˜åŒ–å¯¼è‡´è¡¨å•ä¸­æ•°æ®å˜åŒ– ç§°ä¹‹ä¸ºåŒå‘ç»‘å®š<span class="token title important"><span class="token punctuation">#</span> MVVMæ¶æ„  åŒå‘ç»‘å®šæœºåˆ¶</span>Model: æ•°æ®  Vueå®ä¾‹ä¸­ç»‘å®šæ•°æ®<span class="token code keyword">VM:   ViewModel  ç›‘å¬å™¨</span><span class="token code keyword">View:  é¡µé¢  é¡µé¢å±•ç¤ºçš„æ•°æ®</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="8-äº‹ä»¶ä¿®é¥°ç¬¦"><a href="#8-äº‹ä»¶ä¿®é¥°ç¬¦" class="headerlink" title="8. äº‹ä»¶ä¿®é¥°ç¬¦"></a>8. äº‹ä»¶ä¿®é¥°ç¬¦</h2><blockquote><p><code>ä¿®é¥°ç¬¦</code>: ä½œç”¨ç”¨æ¥å’Œäº‹ä»¶è¿ç”¨,ç”¨æ¥å†³å®šäº‹ä»¶è§¦å‘æ¡ä»¶æˆ–è€…æ˜¯é˜»æ­¢äº‹ä»¶çš„è§¦å‘æœºåˆ¶</p></blockquote><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> 1.å¸¸ç”¨çš„äº‹ä»¶ä¿®é¥°ç¬¦</span>.stop.prevent.capture.self.once.passive<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="8-1-stopäº‹ä»¶ä¿®é¥°ç¬¦"><a href="#8-1-stopäº‹ä»¶ä¿®é¥°ç¬¦" class="headerlink" title="8.1 stopäº‹ä»¶ä¿®é¥°ç¬¦"></a>8.1 stopäº‹ä»¶ä¿®é¥°ç¬¦</h3><blockquote><p>ç”¨æ¥é˜»æ­¢äº‹ä»¶å†’æ³¡</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>divClick<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!--ç”¨æ¥é˜»æ­¢äº‹ä»¶å†’æ³¡--></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æŒ‰é’®<span class="token punctuation">"</span></span> <span class="token attr-name">@click.stop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btnClick<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å¼•å…¥vue--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/vue/dist/vue.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span>        data<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        methods<span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token function">btnClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'buttonè¢«ç‚¹å‡»äº†'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token function">divClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'divè¢«ç‚¹å‡»äº†'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="8-2-prevent-äº‹ä»¶ä¿®é¥°ç¬¦"><a href="#8-2-prevent-äº‹ä»¶ä¿®é¥°ç¬¦" class="headerlink" title="8.2 prevent äº‹ä»¶ä¿®é¥°ç¬¦"></a>8.2 prevent äº‹ä»¶ä¿®é¥°ç¬¦</h3><blockquote><p>ç”¨æ¥é˜»æ­¢æ ‡ç­¾çš„é»˜è®¤è¡Œä¸º</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--ç”¨æ¥é˜»æ­¢äº‹ä»¶çš„é»˜è®¤è¡Œä¸º--></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.baizhibest.com/<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aClick<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç™¾çŸ¥æ•™è‚²<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="8-3-self-äº‹ä»¶ä¿®é¥°ç¬¦"><a href="#8-3-self-äº‹ä»¶ä¿®é¥°ç¬¦" class="headerlink" title="8.3 self äº‹ä»¶ä¿®é¥°ç¬¦"></a>8.3 self äº‹ä»¶ä¿®é¥°ç¬¦</h3><blockquote><p>ç”¨æ¥é’ˆå¯¹äºå½“å‰æ ‡ç­¾çš„äº‹ä»¶è§¦å‘     ===========&gt; åªè§¦å‘è‡ªå·±æ ‡ç­¾çš„ä¸Šç‰¹å®šåŠ¨ä½œçš„äº‹ä»¶     åªå…³å¿ƒè‡ªå·±æ ‡ç­¾ä¸Šè§¦å‘çš„äº‹ä»¶ ä¸ç›‘å¬äº‹ä»¶å†’æ³¡</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--åªè§¦å‘æ ‡ç­¾è‡ªèº«çš„äº‹ä»¶--></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aa<span class="token punctuation">"</span></span> <span class="token attr-name">@click.self</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>divClick<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token comment">&lt;!--ç”¨æ¥é˜»æ­¢äº‹ä»¶å†’æ³¡--></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æŒ‰é’®<span class="token punctuation">"</span></span> <span class="token attr-name">@click.stop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btnClick<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æŒ‰é’®1<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btnClick1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="8-4-once-äº‹ä»¶ä¿®é¥°ç¬¦"><a href="#8-4-once-äº‹ä»¶ä¿®é¥°ç¬¦" class="headerlink" title="8.4 once äº‹ä»¶ä¿®é¥°ç¬¦"></a>8.4 once äº‹ä»¶ä¿®é¥°ç¬¦</h3><blockquote><p>once ä¸€æ¬¡ ä½œç”¨:  å°±æ˜¯è®©æŒ‡å®šäº‹ä»¶åªè§¦å‘ä¸€æ¬¡</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--.prevent : ç”¨æ¥é˜»æ­¢äº‹ä»¶çš„é»˜è®¤è¡Œä¸º.once    : ç”¨æ¥åªæ‰§è¡Œä¸€æ¬¡ç‰¹å®šçš„äº‹ä»¶--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.baizhibest.com/<span class="token punctuation">"</span></span> <span class="token attr-name">@click.prevent.once</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aClick<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç™¾çŸ¥æ•™è‚²<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="9-æŒ‰é”®ä¿®é¥°ç¬¦"><a href="#9-æŒ‰é”®ä¿®é¥°ç¬¦" class="headerlink" title="9. æŒ‰é”®ä¿®é¥°ç¬¦"></a>9. æŒ‰é”®ä¿®é¥°ç¬¦</h2><blockquote><p>ä½œç”¨: ç”¨æ¥ä¸é”®ç›˜ä¸­æŒ‰é”®äº‹ä»¶ç»‘å®šåœ¨ä¸€èµ·,ç”¨æ¥ä¿®é¥°ç‰¹å®šçš„æŒ‰é”®äº‹ä»¶çš„ä¿®é¥°ç¬¦</p></blockquote><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æŒ‰é”®ä¿®é¥°ç¬¦</span>.enter.tab.delete (æ•è·â€œåˆ é™¤â€å’Œâ€œé€€æ ¼â€é”®).esc.space.up.down.left.right<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="9-1-enter-å›è½¦é”®"><a href="#9-1-enter-å›è½¦é”®" class="headerlink" title="9.1 enter å›è½¦é”®"></a>9.1 enter å›è½¦é”®</h3><blockquote><p>ç”¨æ¥åœ¨è§¦å‘å›è½¦æŒ‰é”®ä¹‹åè§¦å‘çš„äº‹ä»¶</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msg<span class="token punctuation">"</span></span> <span class="token attr-name">@keyup.enter</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>keyups<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="9-2-tab-é”®"><a href="#9-2-tab-é”®" class="headerlink" title="9.2 tab é”®"></a>9.2 tab é”®</h3><blockquote><p>ç”¨æ¥æ•è·åˆ°tabé”®æ‰§è¡Œåˆ°å½“å‰æ ‡ç­¾æ˜¯æ‰ä¼šè§¦å‘</p></blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">@keyup.tab</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>keytabs<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="10-Axios-åŸºæœ¬ä½¿ç”¨"><a href="#10-Axios-åŸºæœ¬ä½¿ç”¨" class="headerlink" title="10. Axios åŸºæœ¬ä½¿ç”¨"></a>10. Axios åŸºæœ¬ä½¿ç”¨</h2><h3 id="10-1-å¼•è¨€"><a href="#10-1-å¼•è¨€" class="headerlink" title="10.1 å¼•è¨€"></a>10.1 å¼•è¨€</h3><blockquote><p><code>Axios</code> æ˜¯ä¸€ä¸ªå¼‚æ­¥è¯·æ±‚æŠ€æœ¯,æ ¸å¿ƒä½œç”¨å°±æ˜¯ç”¨æ¥åœ¨é¡µé¢ä¸­å‘é€å¼‚æ­¥è¯·æ±‚,å¹¶è·å–å¯¹åº”æ•°æ®åœ¨é¡µé¢ä¸­æ¸²æŸ“       é¡µé¢å±€éƒ¨æ›´æ–°æŠ€æœ¯  Ajax</p></blockquote><h3 id="10-2-Axios-ç¬¬ä¸€ä¸ªç¨‹åº"><a href="#10-2-Axios-ç¬¬ä¸€ä¸ªç¨‹åº" class="headerlink" title="10.2 Axios ç¬¬ä¸€ä¸ªç¨‹åº"></a>10.2 Axios ç¬¬ä¸€ä¸ªç¨‹åº</h3><p>ä¸­æ–‡ç½‘ç«™:<a href="https://www.kancloud.cn/yunye/axios/234845">https://www.kancloud.cn/yunye/axios/234845</a></p><p>å®‰è£…: <a href="https://unpkg.com/axios/dist/axios.min.js">https://unpkg.com/axios/dist/axios.min.js</a></p><h4 id="10-2-1-GETæ–¹å¼çš„è¯·æ±‚"><a href="#10-2-1-GETæ–¹å¼çš„è¯·æ±‚" class="headerlink" title="10.2.1 GETæ–¹å¼çš„è¯·æ±‚"></a>10.2.1 GETæ–¹å¼çš„è¯·æ±‚</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//å‘é€GETæ–¹å¼è¯·æ±‚</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8989/user/findAll?name=xiaochen"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="10-2-2-POSTæ–¹å¼è¯·æ±‚"><a href="#10-2-2-POSTæ–¹å¼è¯·æ±‚" class="headerlink" title="10.2.2 POSTæ–¹å¼è¯·æ±‚"></a>10.2.2 POSTæ–¹å¼è¯·æ±‚</h4><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">//å‘é€POSTæ–¹å¼è¯·æ±‚</span>  axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8989/user/save"</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>      username<span class="token operator">:</span><span class="token string">"xiaochen"</span><span class="token punctuation">,</span>      age<span class="token operator">:</span><span class="token number">23</span><span class="token punctuation">,</span>      email<span class="token operator">:</span><span class="token string">"xiaochen@zparkhr.com"</span><span class="token punctuation">,</span>      phone<span class="token operator">:</span><span class="token number">13260426185</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="10-2-3-axioså¹¶å‘è¯·æ±‚"><a href="#10-2-3-axioså¹¶å‘è¯·æ±‚" class="headerlink" title="10.2.3 axioså¹¶å‘è¯·æ±‚"></a>10.2.3 axioså¹¶å‘è¯·æ±‚</h4><blockquote><p><code>å¹¶å‘è¯·æ±‚</code>:  å°†å¤šä¸ªè¯·æ±‚åœ¨åŒä¸€æ—¶åˆ»å‘é€åˆ°åç«¯æœåŠ¡æ¥å£,æœ€ååœ¨é›†ä¸­å¤„ç†æ¯ä¸ªè¯·æ±‚çš„å“åº”ç»“æœ</p></blockquote><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//1.åˆ›å»ºä¸€ä¸ªæŸ¥è¯¢æ‰€æœ‰è¯·æ±‚</span>   <span class="token keyword">function</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8989/user/findAll?name=xiaochen"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token comment">//2.åˆ›å»ºä¸€ä¸ªä¿å­˜çš„è¯·æ±‚</span>   <span class="token keyword">function</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8989/user/save"</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>           username<span class="token operator">:</span><span class="token string">"xiaochen"</span><span class="token punctuation">,</span>           age<span class="token operator">:</span><span class="token number">23</span><span class="token punctuation">,</span>           email<span class="token operator">:</span><span class="token string">"xiaochen@zparkhr.com"</span><span class="token punctuation">,</span>           phone<span class="token operator">:</span><span class="token number">13260426185</span>       <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span>   <span class="token comment">//3.å¹¶å‘æ‰§è¡Œ</span>   axios<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>       axios<span class="token punctuation">.</span><span class="token function">spread</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res1<span class="token punctuation">,</span>res2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">//ç”¨æ¥å°†ä¸€ç»„å‡½æ•°çš„å“åº”ç»“æœæ±‡æ€»å¤„ç†</span>           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res1<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res2<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>   <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç”¨æ¥å‘é€ä¸€ç»„å¹¶å‘è¯·æ±‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="11-Vue-ç”Ÿå‘½å‘¨æœŸ"><a href="#11-Vue-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="11. Vue ç”Ÿå‘½å‘¨æœŸ"></a>11. Vue ç”Ÿå‘½å‘¨æœŸ</h2><blockquote><p><code>ç”Ÿå‘½å‘¨æœŸé’©å­</code>   ====&gt;  <code>ç”Ÿå‘½å‘¨æœŸå‡½æ•°</code></p></blockquote><p><img src="Vue%E5%AE%9E%E6%88%98.assets/lifecycle.png" alt="img"></p><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> Vueç”Ÿå‘½å‘¨æœŸæ€»ç»“</span>1.åˆå§‹åŒ–é˜¶æ®µbeforeCreate()&#123; //1.ç”Ÿå‘½å‘¨æœŸä¸­ç¬¬ä¸€ä¸ªå‡½æ•°,è¯¥å‡½æ•°åœ¨æ‰§è¡Œæ—¶Vueå®ä¾‹ä»…ä»…å®Œæˆäº†è‡ªèº«äº‹ä»¶çš„ç»‘å®šå’Œç”Ÿå‘½å‘¨æœŸå‡½æ•°çš„åˆå§‹åŒ–å·¥ä½œ,Vueå®ä¾‹ä¸­è¿˜æ²¡æœ‰ Data el methodsç›¸å…³å±æ€§            console.log("beforeCreate: "+this.msg);        &#125;,        created()&#123; //2.ç”Ÿå‘½å‘¨æœŸä¸­ç¬¬äºŒä¸ªå‡½æ•°,è¯¥å‡½æ•°åœ¨æ‰§è¡Œæ—¶Vueå®ä¾‹å·²ç»åˆå§‹åŒ–äº†dataå±æ€§å’Œmethodsä¸­ç›¸å…³æ–¹æ³•            console.log("created: "+this.msg);        &#125;,        beforeMount()&#123;//3.ç”Ÿå‘½å‘¨æœŸä¸­ç¬¬ä¸‰ä¸ªå‡½æ•°,è¯¥å‡½æ•°åœ¨æ‰§è¡Œæ—¶Vueå°†Elä¸­æŒ‡å®šä½œç”¨èŒƒå›´ä½œä¸ºæ¨¡æ¿ç¼–è¯‘            console.log("beforeMount: "+document.getElementById("sp").innerText);        &#125;,        mounted()&#123;//4.ç”Ÿå‘½å‘¨æœŸä¸­ç¬¬å››ä¸ªå‡½æ•°,è¯¥å‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­,å·²ç»å°†æ•°æ®æ¸²æŸ“åˆ°ç•Œé¢ä¸­å¹¶ä¸”å·²ç»æ›´æ–°é¡µé¢            console.log("Mounted: "+document.getElementById("sp").innerText);        &#125;        <span class="token code keyword">2.è¿è¡Œé˜¶æ®µ beforeUpdate()&#123;//5.ç”Ÿå‘½å‘¨æœŸä¸­ç¬¬äº”ä¸ªå‡½æ•°,è¯¥å‡½æ•°æ˜¯dataä¸­æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶æ‰§è¡Œ è¿™ä¸ªäº‹ä»¶æ‰§è¡Œæ—¶ä»…ä»…æ˜¯Vueå®ä¾‹ä¸­dataæ•°æ®å˜åŒ–é¡µé¢æ˜¾ç¤ºçš„ä¾ç„¶æ˜¯åŸå§‹æ•°æ®            console.log("beforeUpdate:"+this.msg);            console.log("beforeUpdate:"+document.getElementById("sp").innerText);        &#125;,        updated()&#123;    //6.ç”Ÿå‘½å‘¨æœŸä¸­ç¬¬å…­ä¸ªå‡½æ•°,è¯¥å‡½æ•°æ‰§è¡Œæ—¶dataä¸­æ•°æ®å‘ç”Ÿå˜åŒ–,é¡µé¢ä¸­æ•°æ®ä¹Ÿå‘ç”Ÿäº†å˜åŒ–  é¡µé¢ä¸­æ•°æ®å·²ç»å’Œdataä¸­æ•°æ®ä¸€è‡´            console.log("updated:"+this.msg);            console.log("updated:"+document.getElementById("sp").innerText);        &#125;,        3.é”€æ¯é˜¶æ®µ beforeDestory()&#123;//7.ç”Ÿå‘½å‘¨æœŸç¬¬ä¸ƒä¸ªå‡½æ•°,è¯¥å‡½æ•°æ‰§è¡Œæ—¶,Vueä¸­æ‰€æœ‰æ•°æ® methods componet éƒ½æ²¡é”€æ¯</span><span class="token code keyword">        &#125;,        destoryed()&#123; //8.ç”Ÿå‘½å‘¨æœŸçš„ç¬¬å…«ä¸ªå‡½æ•°,è¯¥å‡½æ•°æ‰§è¡Œæ—¶,Vueå®ä¾‹å½»åº•é”€æ¯</span><span class="token code keyword">        &#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="12-Vueä¸­ç»„ä»¶-Component"><a href="#12-Vueä¸­ç»„ä»¶-Component" class="headerlink" title="12. Vueä¸­ç»„ä»¶(Component)"></a>12. Vueä¸­ç»„ä»¶(Component)</h2><h3 id="12-1-ç»„ä»¶ä½œç”¨"><a href="#12-1-ç»„ä»¶ä½œç”¨" class="headerlink" title="12.1 ç»„ä»¶ä½œç”¨"></a>12.1 ç»„ä»¶ä½œç”¨</h3><p>ç»„ä»¶ä½œç”¨: ç”¨æ¥å‡å°‘Vueå®ä¾‹å¯¹è±¡ä¸­ä»£ç é‡,æ—¥ååœ¨ä½¿ç”¨Vueå¼€å‘è¿‡ç¨‹ä¸­,å¯ä»¥æ ¹æ® ä¸èƒ½ä¸šåŠ¡åŠŸèƒ½å°†é¡µé¢ä¸­åˆ’åˆ†ä¸åŒçš„å¤šä¸ªç»„ä»¶,ç„¶åç”±å¤šä¸ªç»„ä»¶å»å®Œæˆæ•´ä¸ªé¡µé¢çš„å¸ƒå±€,ä¾¿äºæ—¥åä½¿ç”¨Vueè¿›è¡Œå¼€å‘æ—¶é¡µé¢ç®¡ç†,æ–¹ä¾¿å¼€å‘äººå‘˜ç»´æŠ¤ã€‚</p><h3 id="12-2-ç»„ä»¶ä½¿ç”¨"><a href="#12-2-ç»„ä»¶ä½¿ç”¨" class="headerlink" title="12.2 ç»„ä»¶ä½¿ç”¨"></a>12.2 ç»„ä»¶ä½¿ç”¨</h3><h4 id="12-2-1-å…¨å±€ç»„ä»¶æ³¨å†Œ"><a href="#12-2-1-å…¨å±€ç»„ä»¶æ³¨å†Œ" class="headerlink" title="12.2.1 å…¨å±€ç»„ä»¶æ³¨å†Œ"></a>12.2.1 å…¨å±€ç»„ä»¶æ³¨å†Œ</h4><p><code>è¯´æ˜:å…¨å±€ç»„ä»¶æ³¨å†Œç»™Vueå®ä¾‹,æ—¥åå¯ä»¥åœ¨ä»»æ„Vueå®ä¾‹çš„èŒƒå›´å†…ä½¿ç”¨è¯¥ç»„ä»¶</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//1.å¼€å‘å…¨å±€ç»„ä»¶</span>Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">'login'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>        template<span class="token operator">:</span><span class="token string">'&lt;div>&lt;h1>ç”¨æˆ·ç™»å½•&lt;/h1>&lt;/div>'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2.ä½¿ç”¨å…¨å±€ç»„ä»¶  åœ¨Vueå®ä¾‹èŒƒå›´å†…</span><span class="token operator">&lt;</span>login<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>login<span class="token operator">></span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ³¨æ„:</span>1.Vue.componentç”¨æ¥å¼€å‘å…¨å±€ç»„ä»¶ å‚æ•°1: ç»„ä»¶çš„åç§°  å‚æ•°2: ç»„ä»¶é…ç½®&#123;&#125;  template:''ç”¨æ¥ä¹¦å†™ç»„ä»¶çš„htmlä»£ç   templateä¸­å¿…é¡»æœ‰ä¸”åªæœ‰ä¸€ä¸ªrootå…ƒç´ 2.ä½¿ç”¨æ—¶éœ€è¦åœ¨Vueçš„ä½œç”¨èŒƒå›´å†…æ ¹æ®ç»„ä»¶åä½¿ç”¨å…¨å±€ç»„ä»¶3.å¦‚æœåœ¨æ³¨å†Œç»„ä»¶è¿‡ç¨‹ä¸­ä½¿ç”¨ é©¼å³°å‘½åç»„ä»¶çš„æ–¹å¼ åœ¨ä½¿ç”¨ç»„ä»¶æ—¶ å¿…é¡»å°†é©¼å³°çš„æ‰€æœ‰å•è¯å°å†™åŠ å…¥-çº¿è¿›è¡Œä½¿ç”¨<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="12-2-2-å±€éƒ¨ç»„ä»¶æ³¨å†Œ"><a href="#12-2-2-å±€éƒ¨ç»„ä»¶æ³¨å†Œ" class="headerlink" title="12.2.2 å±€éƒ¨ç»„ä»¶æ³¨å†Œ"></a>12.2.2 å±€éƒ¨ç»„ä»¶æ³¨å†Œ</h4><p><code>è¯´æ˜:é€šè¿‡å°†ç»„ä»¶æ³¨å†Œç»™å¯¹åº”Vueå®ä¾‹ä¸­ä¸€ä¸ªcomponentså±æ€§æ¥å®Œæˆç»„ä»¶æ³¨å†Œ,è¿™ç§æ–¹å¼ä¸ä¼šå¯¹Vueå®ä¾‹é€ æˆç´¯åŠ </code></p><ul><li>ç¬¬ä¸€ç§å¼€å‘æ–¹å¼</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//å±€éƒ¨ç»„ä»¶ç™»å½•æ¨¡æ¿å£°æ˜</span>  <span class="token keyword">let</span> login <span class="token operator">=</span><span class="token punctuation">&#123;</span>   <span class="token comment">//å…·ä½“å±€éƒ¨ç»„ä»¶åç§°</span>      template<span class="token operator">:</span><span class="token string">'&lt;div>&lt;h2>ç”¨æˆ·ç™»å½•&lt;/h2>&lt;/div>'</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>      el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span>      data<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>      methods<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>      components<span class="token operator">:</span><span class="token punctuation">&#123;</span>  <span class="token comment">//ç”¨æ¥æ³¨å†Œå±€éƒ¨ç»„ä»¶</span>          login<span class="token operator">:</span>login  <span class="token comment">//æ³¨å†Œå±€éƒ¨ç»„ä»¶</span>      <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å±€éƒ¨ç»„ä»¶ä½¿ç”¨ åœ¨Vueå®ä¾‹èŒƒå›´å†…</span><span class="token operator">&lt;</span>login<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>login<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>ç¬¬äºŒç§å¼€å‘æ–¹å¼</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//1.å£°æ˜å±€éƒ¨ç»„ä»¶æ¨¡æ¿  template æ ‡ç­¾ æ³¨æ„:åœ¨Vueå®ä¾‹ä½œç”¨èŒƒå›´å¤–å£°æ˜</span>  <span class="token operator">&lt;</span>template id<span class="token operator">=</span><span class="token string">"loginTemplate"</span><span class="token operator">></span>      <span class="token operator">&lt;</span>h1<span class="token operator">></span>ç”¨æˆ·ç™»å½•<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>  <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span><span class="token comment">//2.å®šä¹‰å˜é‡ç”¨æ¥ä¿å­˜æ¨¡æ¿é…ç½®å¯¹è±¡</span>    <span class="token keyword">let</span> login <span class="token operator">=</span><span class="token punctuation">&#123;</span>   <span class="token comment">//å…·ä½“å±€éƒ¨ç»„ä»¶åç§°</span>        template<span class="token operator">:</span><span class="token string">'#loginTemplate'</span>  <span class="token comment">//ä½¿ç”¨è‡ªå®šä¹‰templateæ ‡ç­¾é€‰æ‹©å™¨å³å¯</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">//3.æ³¨å†Œç»„ä»¶</span>    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span>        data<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        methods<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        components<span class="token operator">:</span><span class="token punctuation">&#123;</span>  <span class="token comment">//ç”¨æ¥æ³¨å†Œå±€éƒ¨ç»„ä»¶</span>            login<span class="token operator">:</span>login  <span class="token comment">//æ³¨å†Œå±€éƒ¨ç»„ä»¶</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//4.å±€éƒ¨ç»„ä»¶ä½¿ç”¨ åœ¨Vueå®ä¾‹èŒƒå›´å†…</span> <span class="token operator">&lt;</span>login<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>login<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="12-3-Propçš„ä½¿ç”¨"><a href="#12-3-Propçš„ä½¿ç”¨" class="headerlink" title="12.3 Propçš„ä½¿ç”¨"></a>12.3 Propçš„ä½¿ç”¨</h3></li></ul><p><code>ä½œç”¨:propsç”¨æ¥ç»™ç»„ä»¶ä¼ é€’ç›¸åº”é™æ€æ•°æ®æˆ–è€…æ˜¯åŠ¨æ€æ•°æ®çš„</code></p><h4 id="12-3-1-é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜é™æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨"><a href="#12-3-1-é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜é™æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨" class="headerlink" title="12.3.1 é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜é™æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨"></a>12.3.1 é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜é™æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//1.å£°æ˜ç»„ä»¶æ¨¡æ¿é…ç½®å¯¹è±¡</span>    <span class="token keyword">let</span> login <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        template<span class="token operator">:</span><span class="token string">"&lt;div>&lt;h1>æ¬¢è¿:&#123;&#123; userName &#125;&#125; å¹´é¾„:&#123;&#123; age &#125;&#125;&lt;/h1>&lt;/div>"</span><span class="token punctuation">,</span>        props<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'userName'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">]</span>  <span class="token comment">//propsä½œç”¨ ç”¨æ¥æ¥æ”¶ä½¿ç”¨ç»„ä»¶æ—¶é€šè¿‡ç»„ä»¶æ ‡ç­¾ä¼ é€’çš„æ•°æ®</span>    <span class="token punctuation">&#125;</span><span class="token comment">//2.æ³¨å†Œç»„ä»¶</span>    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span>        data<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        methods<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        components<span class="token operator">:</span><span class="token punctuation">&#123;</span>            login <span class="token comment">//ç»„ä»¶æ³¨å†Œ</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3.é€šè¿‡ç»„ä»¶å®Œæˆæ•°æ®ä¼ é€’</span><span class="token operator">&lt;</span>login user<span class="token operator">-</span>name<span class="token operator">=</span><span class="token string">"å°é™ˆ"</span> age<span class="token operator">=</span><span class="token string">"23"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>login<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“:</span>1.ä½¿ç”¨ç»„ä»¶æ—¶å¯ä»¥åœ¨ç»„ä»¶ä¸Šå®šä¹‰å¤šä¸ªå±æ€§ä»¥åŠå¯¹åº”æ•°æ®2.åœ¨ç»„ä»¶å†…éƒ¨å¯ä»¥ä½¿ç”¨propsæ•°ç»„ç”Ÿå‘½å¤šä¸ªå®šä¹‰åœ¨ç»„ä»¶ä¸Šçš„å±æ€§å æ—¥åå¯ä»¥åœ¨ç»„ä»¶ä¸­é€šè¿‡&#123;&#123; å±æ€§å &#125;&#125; æ–¹å¼è·å–ç»„ä»¶ä¸­å±æ€§å€¼<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="12-3-2-é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜åŠ¨æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨"><a href="#12-3-2-é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜åŠ¨æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨" class="headerlink" title="12.3.2 é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜åŠ¨æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨"></a>12.3.2 é€šè¿‡åœ¨ç»„ä»¶ä¸Šå£°æ˜åŠ¨æ€æ•°æ®ä¼ é€’ç»™ç»„ä»¶å†…éƒ¨</h4><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//1.å£°æ˜ç»„ä»¶æ¨¡æ¿å¯¹è±¡</span>    <span class="token keyword">const</span> login <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        template<span class="token operator">:</span><span class="token string">'&lt;div>&lt;h2>æ¬¢è¿: &#123;&#123; name &#125;&#125; å¹´é¾„:&#123;&#123; age &#125;&#125;&lt;/h2>&lt;/div>'</span><span class="token punctuation">,</span>        props<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span> <span class="token comment">//2.æ³¨å†Œå±€éƒ¨ç»„ä»¶</span>    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span>        data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>            username<span class="token operator">:</span><span class="token string">"å°é™ˆé™ˆ"</span><span class="token punctuation">,</span>            age<span class="token operator">:</span><span class="token number">23</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        methods<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        components<span class="token operator">:</span><span class="token punctuation">&#123;</span>            login <span class="token comment">//æ³¨å†Œç»„ä»¶</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3.ä½¿ç”¨ç»„ä»¶</span> <span class="token operator">&lt;</span>login <span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">"username"</span> <span class="token operator">:</span>age<span class="token operator">=</span><span class="token string">"age"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>login<span class="token operator">></span>  <span class="token comment">//ä½¿ç”¨v-bindå½¢å¼å°†æ•°æ®ç»‘å®šVueå®ä¾‹ä¸­dataå±æ€§,æ—¥ådataå±æ€§å‘ç”Ÿå˜åŒ–,ç»„ä»¶å†…éƒ¨æ•°æ®è·Ÿç€å˜åŒ–</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="12-3-3-propçš„å•å‘æ•°æ®æµ"><a href="#12-3-3-propçš„å•å‘æ•°æ®æµ" class="headerlink" title="12.3.3 propçš„å•å‘æ•°æ®æµ"></a>12.3.3 propçš„å•å‘æ•°æ®æµ</h4><p><code>å•å‘æ•°æ®æµ:æ‰€æœ‰çš„ prop éƒ½ä½¿å¾—å…¶çˆ¶å­ prop ä¹‹é—´å½¢æˆäº†ä¸€ä¸ª**å•å‘ä¸‹è¡Œç»‘å®š**ï¼šçˆ¶çº§ prop çš„æ›´æ–°ä¼šå‘ä¸‹æµåŠ¨åˆ°å­ç»„ä»¶ä¸­ï¼Œä½†æ˜¯åè¿‡æ¥åˆ™ä¸è¡Œã€‚</code></p><blockquote><p>æ‰€æœ‰çš„ prop éƒ½ä½¿å¾—å…¶çˆ¶å­ prop ä¹‹é—´å½¢æˆäº†ä¸€ä¸ª<strong>å•å‘ä¸‹è¡Œç»‘å®š</strong>ï¼šçˆ¶çº§ prop çš„æ›´æ–°ä¼šå‘ä¸‹æµåŠ¨åˆ°å­ç»„ä»¶ä¸­ï¼Œä½†æ˜¯åè¿‡æ¥åˆ™ä¸è¡Œã€‚è¿™æ ·ä¼šé˜²æ­¢ä»å­ç»„ä»¶æ„å¤–æ”¹å˜çˆ¶çº§ç»„ä»¶çš„çŠ¶æ€ï¼Œä»è€Œå¯¼è‡´ä½ çš„åº”ç”¨çš„æ•°æ®æµå‘éš¾ä»¥ç†è§£ã€‚</p><p>é¢å¤–çš„ï¼Œæ¯æ¬¡çˆ¶çº§ç»„ä»¶å‘ç”Ÿæ›´æ–°æ—¶ï¼Œå­ç»„ä»¶ä¸­æ‰€æœ‰çš„ prop éƒ½å°†ä¼šåˆ·æ–°ä¸ºæœ€æ–°çš„å€¼ã€‚è¿™æ„å‘³ç€ä½ <strong>ä¸</strong>åº”è¯¥åœ¨ä¸€ä¸ªå­ç»„ä»¶å†…éƒ¨æ”¹å˜ propã€‚å¦‚æœä½ è¿™æ ·åšäº†ï¼ŒVue ä¼šåœ¨æµè§ˆå™¨çš„æ§åˆ¶å°ä¸­å‘å‡ºè­¦å‘Šã€‚â€”æ‘˜è‡ªå®˜ç½‘</p></blockquote><h3 id="12-4-ç»„ä»¶ä¸­å®šä¹‰æ•°æ®å’Œäº‹ä»¶ä½¿ç”¨"><a href="#12-4-ç»„ä»¶ä¸­å®šä¹‰æ•°æ®å’Œäº‹ä»¶ä½¿ç”¨" class="headerlink" title="12.4 ç»„ä»¶ä¸­å®šä¹‰æ•°æ®å’Œäº‹ä»¶ä½¿ç”¨"></a>12.4 ç»„ä»¶ä¸­å®šä¹‰æ•°æ®å’Œäº‹ä»¶ä½¿ç”¨</h3><h5 id="1-ç»„ä»¶ä¸­å®šä¹‰å±äºç»„ä»¶çš„æ•°æ®"><a href="#1-ç»„ä»¶ä¸­å®šä¹‰å±äºç»„ä»¶çš„æ•°æ®" class="headerlink" title="1. ç»„ä»¶ä¸­å®šä¹‰å±äºç»„ä»¶çš„æ•°æ®"></a>1. ç»„ä»¶ä¸­å®šä¹‰å±äºç»„ä»¶çš„æ•°æ®</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//ç»„ä»¶å£°æ˜çš„é…ç½®å¯¹è±¡</span>    <span class="token keyword">const</span> login <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        template<span class="token operator">:</span><span class="token string">'&lt;div>&lt;h1>&#123;&#123; msg &#125;&#125; ç™¾çŸ¥æ•™è‚²&lt;/h1>&lt;ul>&lt;li v-for="item,index in lists">&#123;&#123; index &#125;&#125;&#123;&#123; item &#125;&#125;&lt;/li>&lt;/ul>&lt;/div>'</span><span class="token punctuation">,</span>        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token comment">//ä½¿ç”¨dataå‡½æ•°æ–¹å¼å®šä¹‰ç»„ä»¶çš„æ•°æ®   åœ¨templatehtmlä»£ç ä¸­é€šè¿‡æ’å€¼è¡¨è¾¾å¼ç›´æ¥è·å–</span>            <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>                msg<span class="token operator">:</span><span class="token string">"hello"</span><span class="token punctuation">,</span>                lists<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'java'</span><span class="token punctuation">,</span><span class="token string">'spring'</span><span class="token punctuation">,</span><span class="token string">'springboot'</span><span class="token punctuation">]</span>            <span class="token punctuation">&#125;</span><span class="token comment">//ç»„ä»¶è‡ªå·±å†…éƒ¨æ•°æ®</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="2-ç»„ä»¶ä¸­äº‹ä»¶å®šä¹‰"><a href="#2-ç»„ä»¶ä¸­äº‹ä»¶å®šä¹‰" class="headerlink" title="2.ç»„ä»¶ä¸­äº‹ä»¶å®šä¹‰"></a>2.ç»„ä»¶ä¸­äº‹ä»¶å®šä¹‰</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> login<span class="token operator">=</span><span class="token punctuation">&#123;</span>       template<span class="token operator">:</span><span class="token string">'&lt;div>&lt;input type="button" value="ç‚¹æˆ‘è§¦å‘ç»„ä»¶ä¸­äº‹ä»¶" @click="change">&lt;/div>'</span><span class="token punctuation">,</span>       <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>               name<span class="token operator">:</span><span class="token string">'å°é™ˆ'</span>           <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>       methods<span class="token operator">:</span><span class="token punctuation">&#123;</span>           <span class="token function">change</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>               <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'è§¦å‘äº‹ä»¶'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“</span>1.ç»„ä»¶ä¸­å®šä¹‰äº‹ä»¶å’Œç›´æ¥åœ¨Vueä¸­å®šä¹‰äº‹ä»¶åŸºæœ¬ä¸€è‡´ ç›´æ¥åœ¨ç»„ä»¶å†…éƒ¨å¯¹åº”çš„htmlä»£ç ä¸ŠåŠ å…¥@äº‹ä»¶å=å‡½æ•°åæ–¹å¼å³å¯2.åœ¨ç»„ä»¶å†…éƒ¨ä½¿ç”¨methodså±æ€§ç”¨æ¥å®šä¹‰å¯¹åº”çš„äº‹ä»¶å‡½æ•°å³å¯,äº‹ä»¶å‡½æ•°ä¸­this æŒ‡å‘çš„æ˜¯å½“å‰ç»„ä»¶çš„å®ä¾‹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="12-5-å‘å­ç»„ä»¶ä¸­ä¼ é€’äº‹ä»¶å¹¶åœ¨å­ç»„ä»¶ä¸­è°ƒç”¨æ”¹äº‹ä»¶"><a href="#12-5-å‘å­ç»„ä»¶ä¸­ä¼ é€’äº‹ä»¶å¹¶åœ¨å­ç»„ä»¶ä¸­è°ƒç”¨æ”¹äº‹ä»¶" class="headerlink" title="12.5 å‘å­ç»„ä»¶ä¸­ä¼ é€’äº‹ä»¶å¹¶åœ¨å­ç»„ä»¶ä¸­è°ƒç”¨æ”¹äº‹ä»¶"></a>12.5 å‘å­ç»„ä»¶ä¸­ä¼ é€’äº‹ä»¶å¹¶åœ¨å­ç»„ä»¶ä¸­è°ƒç”¨æ”¹äº‹ä»¶</h3><p><code>åœ¨å­ç»„ä»¶ä¸­è°ƒç”¨ä¼ é€’è¿‡æ¥çš„ç›¸å…³äº‹ä»¶å¿…é¡»ä½¿ç”¨ this.$emit(&#39;å‡½æ•°å&#39;) æ–¹å¼è°ƒç”¨</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//1.å£°æ˜ç»„ä»¶</span>    <span class="token keyword">const</span> login <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        template<span class="token operator">:</span><span class="token string">"&lt;div>&lt;h1>ç™¾çŸ¥æ•™è‚² &#123;&#123; uname &#125;&#125;&lt;/h1> &lt;input type='button' value='ç‚¹æˆ‘' @click='change'>&lt;/div>"</span><span class="token punctuation">,</span>        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>                uname<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>name            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        props<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        methods<span class="token operator">:</span><span class="token punctuation">&#123;</span>            <span class="token function">change</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token comment">//è°ƒç”¨vueå®ä¾‹ä¸­å‡½æ•°</span>                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'aaa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//è°ƒç”¨ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å…¶ä»–å‡½æ•°æ—¶éœ€è¦ä½¿ç”¨ this.$emit('å‡½æ•°åè°ƒç”¨')</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>     <span class="token comment">//2.æ³¨å†Œç»„ä»¶</span>    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span>        data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>            username<span class="token operator">:</span><span class="token string">"å°é™ˆ"</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        methods<span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">//ä¸€ä¸ªäº‹ä»¶å‡½æ•°  å°†è¿™ä¸ªå‡½æ•°ä¼ é€’ç»™å­ç»„ä»¶</span>                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Vue å®ä¾‹ä¸­å®šä¹‰å‡½æ•°'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        components<span class="token operator">:</span><span class="token punctuation">&#123;</span>            login<span class="token punctuation">,</span><span class="token comment">//ç»„ä»¶çš„æ³¨å†Œ</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//3.ä½¿ç”¨ç»„ä»¶</span><span class="token operator">&lt;</span>login  @find<span class="token operator">=</span><span class="token string">"findAll"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>login<span class="token operator">></span>    <span class="token comment">//=====> åœ¨ç»„ä»¶å†…éƒ¨ä½¿ç”¨  this.$emit('find')</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="13-Vueä¸­è·¯ç”±-VueRouter"><a href="#13-Vueä¸­è·¯ç”±-VueRouter" class="headerlink" title="13.Vueä¸­è·¯ç”±(VueRouter)"></a>13.Vueä¸­è·¯ç”±(VueRouter)</h2><h4 id="13-1-è·¯ç”±"><a href="#13-1-è·¯ç”±" class="headerlink" title="13.1 è·¯ç”±"></a>13.1 è·¯ç”±</h4><p><code>è·¯ç”±:æ ¹æ®è¯·æ±‚çš„è·¯å¾„æŒ‰ç…§ä¸€å®šçš„è·¯ç”±è§„åˆ™è¿›è¡Œè¯·æ±‚çš„è½¬å‘ä»è€Œå¸®åŠ©æˆ‘ä»¬å®ç°ç»Ÿä¸€è¯·æ±‚çš„ç®¡ç†</code></p><h4 id="13-2-ä½œç”¨"><a href="#13-2-ä½œç”¨" class="headerlink" title="13.2 ä½œç”¨"></a>13.2 ä½œç”¨</h4><p><code>ç”¨æ¥åœ¨vueä¸­å®ç°ç»„ä»¶ä¹‹é—´çš„åŠ¨æ€åˆ‡æ¢</code></p><h4 id="13-3-ä½¿ç”¨è·¯ç”±"><a href="#13-3-ä½¿ç”¨è·¯ç”±" class="headerlink" title="13.3 ä½¿ç”¨è·¯ç”±"></a>13.3 ä½¿ç”¨è·¯ç”±</h4><ol><li><h5 id="å¼•å…¥è·¯ç”±"><a href="#å¼•å…¥è·¯ç”±" class="headerlink" title="å¼•å…¥è·¯ç”±"></a>å¼•å…¥è·¯ç”±</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://cdn.jsdelivr.net/npm/vue/dist/vue.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://unpkg.com/vue-router/dist/vue-router.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>  <span class="token comment">//vue è·¯ç”±js</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><h5 id="åˆ›å»ºç»„ä»¶å¯¹è±¡"><a href="#åˆ›å»ºç»„ä»¶å¯¹è±¡" class="headerlink" title="åˆ›å»ºç»„ä»¶å¯¹è±¡"></a>åˆ›å»ºç»„ä»¶å¯¹è±¡</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//å£°æ˜ç»„ä»¶æ¨¡æ¿</span><span class="token keyword">const</span> login <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  template<span class="token operator">:</span><span class="token string">'&lt;h1>ç™»å½•&lt;/h1>'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">const</span> register <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  template<span class="token operator">:</span><span class="token string">'&lt;h1>æ³¨å†Œ&lt;/h1>'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><h5 id="å®šä¹‰è·¯ç”±å¯¹è±¡çš„è§„åˆ™"><a href="#å®šä¹‰è·¯ç”±å¯¹è±¡çš„è§„åˆ™" class="headerlink" title="å®šä¹‰è·¯ç”±å¯¹è±¡çš„è§„åˆ™"></a>å®šä¹‰è·¯ç”±å¯¹è±¡çš„è§„åˆ™</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"> <span class="token comment">//åˆ›å»ºè·¯ç”±å¯¹è±¡</span><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  routes<span class="token operator">:</span><span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span>path<span class="token operator">:</span><span class="token string">'/login'</span><span class="token punctuation">,</span>component<span class="token operator">:</span>login<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>   <span class="token comment">//path: è·¯ç”±çš„è·¯å¾„  component:è·¯å¾„å¯¹åº”çš„ç»„ä»¶</span>    <span class="token punctuation">&#123;</span>path<span class="token operator">:</span><span class="token string">'/register'</span><span class="token punctuation">,</span>component<span class="token operator">:</span>register<span class="token punctuation">&#125;</span>  <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><ol start="4"><li><h5 id="å°†è·¯ç”±å¯¹è±¡æ³¨å†Œåˆ°vueå®ä¾‹"><a href="#å°†è·¯ç”±å¯¹è±¡æ³¨å†Œåˆ°vueå®ä¾‹" class="headerlink" title="å°†è·¯ç”±å¯¹è±¡æ³¨å†Œåˆ°vueå®ä¾‹"></a>å°†è·¯ç”±å¯¹è±¡æ³¨å†Œåˆ°vueå®ä¾‹</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span>  data<span class="token operator">:</span> <span class="token punctuation">&#123;</span>    username<span class="token operator">:</span><span class="token string">"å°é™ˆ"</span><span class="token punctuation">,</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  methods<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  router<span class="token operator">:</span>router   <span class="token comment">//è®¾ç½®è·¯ç”±å¯¹è±¡</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><ol start="5"><li><h5 id="åœ¨é¡µé¢ä¸­æ˜¾ç¤ºè·¯ç”±çš„ç»„ä»¶"><a href="#åœ¨é¡µé¢ä¸­æ˜¾ç¤ºè·¯ç”±çš„ç»„ä»¶" class="headerlink" title="åœ¨é¡µé¢ä¸­æ˜¾ç¤ºè·¯ç”±çš„ç»„ä»¶"></a>åœ¨é¡µé¢ä¸­æ˜¾ç¤ºè·¯ç”±çš„ç»„ä»¶</h5><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--æ˜¾ç¤ºè·¯ç”±çš„ç»„ä»¶--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><h5 id="æ ¹æ®è¿æ¥åˆ‡æ¢è·¯ç”±"><a href="#æ ¹æ®è¿æ¥åˆ‡æ¢è·¯ç”±" class="headerlink" title="æ ¹æ®è¿æ¥åˆ‡æ¢è·¯ç”±"></a>æ ¹æ®è¿æ¥åˆ‡æ¢è·¯ç”±</h5><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#/login<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç‚¹æˆ‘ç™»å½•<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#/register<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç‚¹æˆ‘æ³¨å†Œ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="13-4-router-linkä½¿ç”¨"><a href="#13-4-router-linkä½¿ç”¨" class="headerlink" title="13.4 router-linkä½¿ç”¨"></a>13.4 router-linkä½¿ç”¨</h3></li></ol><p><code>ä½œç”¨:ç”¨æ¥æ›¿æ¢æˆ‘ä»¬åœ¨åˆ‡æ¢è·¯ç”±æ—¶ä½¿ç”¨aæ ‡ç­¾åˆ‡æ¢è·¯ç”±</code></p><p><code>å¥½å¤„:å°±æ˜¯å¯ä»¥è‡ªåŠ¨ç»™è·¯ç”±è·¯å¾„åŠ å…¥#ä¸éœ€è¦æ‰‹åŠ¨åŠ å…¥</code></p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/login<span class="token punctuation">"</span></span> <span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æˆ‘è¦ç™»å½•<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/register<span class="token punctuation">"</span></span> <span class="token attr-name">tag</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç‚¹æˆ‘æ³¨å†Œ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> æ€»ç»“:</span>1.router-link ç”¨æ¥æ›¿æ¢ä½¿ç”¨aæ ‡ç­¾å®ç°è·¯ç”±åˆ‡æ¢ å¥½å¤„æ˜¯ä¸éœ€è¦ä¹¦å†™#å·ç›´æ¥ä¹¦å†™è·¯ç”±è·¯å¾„2.router-link toå±æ€§ç”¨æ¥ä¹¦å†™è·¯ç”±è·¯å¾„   tagå±æ€§:ç”¨æ¥å°†router-linkæ¸²æŸ“æˆæŒ‡å®šçš„æ ‡ç­¾<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="13-5-é»˜è®¤è·¯ç”±"><a href="#13-5-é»˜è®¤è·¯ç”±" class="headerlink" title="13.5 é»˜è®¤è·¯ç”±"></a>13.5 é»˜è®¤è·¯ç”±</h3><p><code>ä½œç”¨:ç”¨æ¥åœ¨ç¬¬ä¸€æ¬¡è¿›å…¥ç•Œé¢æ˜¯æ˜¾ç¤ºä¸€ä¸ªé»˜è®¤çš„ç»„ä»¶</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  routes<span class="token operator">:</span><span class="token punctuation">[</span>    <span class="token comment">//&#123; path:'/',component:login&#125;,</span>    <span class="token punctuation">&#123;</span> path<span class="token operator">:</span><span class="token string">'/'</span><span class="token punctuation">,</span>redirect<span class="token operator">:</span><span class="token string">'/login'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token comment">//redirect: ç”¨æ¥å½“è®¿é—®çš„æ˜¯é»˜è®¤è·¯ç”± "/" æ—¶ è·³è½¬åˆ°æŒ‡å®šçš„è·¯ç”±å±•ç¤º  æ¨èä½¿ç”¨</span>    <span class="token punctuation">&#123;</span> path<span class="token operator">:</span><span class="token string">'/login'</span><span class="token punctuation">,</span> component<span class="token operator">:</span>login<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token punctuation">&#123;</span> path<span class="token operator">:</span><span class="token string">'/register'</span><span class="token punctuation">,</span> component<span class="token operator">:</span>register<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="13-6-è·¯ç”±ä¸­å‚æ•°ä¼ é€’"><a href="#13-6-è·¯ç”±ä¸­å‚æ•°ä¼ é€’" class="headerlink" title="13.6 è·¯ç”±ä¸­å‚æ•°ä¼ é€’"></a>13.6 è·¯ç”±ä¸­å‚æ•°ä¼ é€’</h3><ul><li>ç¬¬ä¸€ç§æ–¹å¼ä¼ é€’å‚æ•° ä¼ ç»Ÿæ–¹å¼</li></ul><ol><li><p>é€šè¿‡?å·å½¢å¼æ‹¼æ¥å‚æ•°</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/login?id=21&amp;name=zhangsan<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æˆ‘è¦ç™»å½•<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>ç»„ä»¶ä¸­è·å–å‚æ•°</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> login <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  template<span class="token operator">:</span><span class="token string">'&lt;h1>ç”¨æˆ·ç™»å½•&lt;/h1>'</span><span class="token punctuation">,</span>  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  methods<span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"=============>"</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id<span class="token operator">+</span><span class="token string">"======>"</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><ul><li>ç¬¬äºŒç§æ–¹å¼ä¼ é€’å‚æ•° restful</li></ul><ol><li><p>é€šè¿‡ä½¿ç”¨è·¯å¾„æ–¹å¼ä¼ é€’å‚æ•°</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>router<span class="token operator">-</span>link to<span class="token operator">=</span><span class="token string">"/register/24/å¼ ä¸‰"</span><span class="token operator">></span>æˆ‘è¦æ³¨å†Œ<span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">></span><span class="token keyword">var</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>  routes<span class="token operator">:</span><span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span>path<span class="token operator">:</span><span class="token string">'/register/:id/:name'</span><span class="token punctuation">,</span>component<span class="token operator">:</span>register<span class="token punctuation">&#125;</span>   <span class="token comment">//å®šä¹‰è·¯å¾„ä¸­è·å–å¯¹åº”å‚æ•°</span>  <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><ol start="2"><li><p>ç»„ä»¶ä¸­è·å–å‚æ•°</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> register <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  template<span class="token operator">:</span><span class="token string">'&lt;h1>ç”¨æˆ·æ³¨å†Œ&#123;&#123; $route.params.name &#125;&#125;&lt;/h1>'</span><span class="token punctuation">,</span>  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æ³¨å†Œç»„ä»¶ä¸­id:   "</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="13-7-åµŒå¥—è·¯ç”±"><a href="#13-7-åµŒå¥—è·¯ç”±" class="headerlink" title="13.7 åµŒå¥—è·¯ç”±"></a>13.7 åµŒå¥—è·¯ç”±</h3></li><li><h5 id="å£°æ˜æœ€å¤–å±‚å’Œå†…å±‚è·¯ç”±"><a href="#å£°æ˜æœ€å¤–å±‚å’Œå†…å±‚è·¯ç”±" class="headerlink" title="å£°æ˜æœ€å¤–å±‚å’Œå†…å±‚è·¯ç”±"></a>å£°æ˜æœ€å¤–å±‚å’Œå†…å±‚è·¯ç”±</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&lt;</span>template id<span class="token operator">=</span><span class="token string">"product"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>h1<span class="token operator">></span>å•†å“ç®¡ç†<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>        <span class="token operator">&lt;</span>router<span class="token operator">-</span>link to<span class="token operator">=</span><span class="token string">"/product/add"</span><span class="token operator">></span>å•†å“æ·»åŠ <span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">></span>        <span class="token operator">&lt;</span>router<span class="token operator">-</span>link to<span class="token operator">=</span><span class="token string">"/product/edit"</span><span class="token operator">></span>å•†å“ç¼–è¾‘<span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">></span>        <span class="token operator">&lt;</span>router<span class="token operator">-</span>view<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>view<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span><span class="token comment">//å£°æ˜ç»„ä»¶æ¨¡æ¿</span><span class="token keyword">const</span> product<span class="token operator">=</span><span class="token punctuation">&#123;</span>  template<span class="token operator">:</span><span class="token string">'#product'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">const</span> add <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  template<span class="token operator">:</span><span class="token string">'&lt;h4>å•†å“æ·»åŠ &lt;/h4>'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">const</span> edit <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  template<span class="token operator">:</span><span class="token string">'&lt;h4>å•†å“ç¼–è¾‘&lt;/h4>'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><ol start="2"><li><h5 id="åˆ›å»ºè·¯ç”±å¯¹è±¡å«æœ‰åµŒå¥—è·¯ç”±"><a href="#åˆ›å»ºè·¯ç”±å¯¹è±¡å«æœ‰åµŒå¥—è·¯ç”±" class="headerlink" title="åˆ›å»ºè·¯ç”±å¯¹è±¡å«æœ‰åµŒå¥—è·¯ç”±"></a>åˆ›å»ºè·¯ç”±å¯¹è±¡å«æœ‰åµŒå¥—è·¯ç”±</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>        routes<span class="token operator">:</span><span class="token punctuation">[</span>            <span class="token punctuation">&#123;</span>                path<span class="token operator">:</span><span class="token string">'/product'</span><span class="token punctuation">,</span>                component<span class="token operator">:</span>product<span class="token punctuation">,</span>                children<span class="token operator">:</span><span class="token punctuation">[</span>                    <span class="token punctuation">&#123;</span>path<span class="token operator">:</span><span class="token string">'add'</span><span class="token punctuation">,</span>component<span class="token operator">:</span> add<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                    <span class="token punctuation">&#123;</span>path<span class="token operator">:</span><span class="token string">'edit'</span><span class="token punctuation">,</span>component<span class="token operator">:</span> edit<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                <span class="token punctuation">]</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><ol start="3"><li><h5 id="æ³¨å†Œè·¯ç”±å¯¹è±¡"><a href="#æ³¨å†Œè·¯ç”±å¯¹è±¡" class="headerlink" title="æ³¨å†Œè·¯ç”±å¯¹è±¡"></a>æ³¨å†Œè·¯ç”±å¯¹è±¡</h5><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>    el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span>    data<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    methods<span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    router<span class="token punctuation">,</span><span class="token comment">//å®šä¹‰è·¯ç”±å¯¹è±¡</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æµ‹è¯•è·¯ç”±</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/product<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>å•†å“ç®¡ç†<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><hr></li></ol><h2 id="14-Vue-CLI-è„šæ‰‹æ¶"><a href="#14-Vue-CLI-è„šæ‰‹æ¶" class="headerlink" title="14. Vue CLI è„šæ‰‹æ¶"></a>14. Vue CLI è„šæ‰‹æ¶</h2><h3 id="14-1-ä»€ä¹ˆæ˜¯CLI"><a href="#14-1-ä»€ä¹ˆæ˜¯CLI" class="headerlink" title="14.1 ä»€ä¹ˆæ˜¯CLI"></a>14.1 ä»€ä¹ˆæ˜¯CLI</h3><p>å‘½ä»¤è¡Œç•Œé¢ï¼ˆè‹±è¯­ï¼šcommand-line interfaceï¼Œç¼©å†™ï¼š<em>CLI</em>ï¼‰æ˜¯åœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢å¾—åˆ°æ™®åŠä¹‹å‰ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„ç”¨æˆ·ç•Œé¢ï¼Œå®ƒé€šå¸¸ä¸æ”¯æŒé¼ æ ‡ï¼Œç”¨æˆ·é€šè¿‡é”®ç›˜è¾“å…¥æŒ‡ä»¤ï¼Œè®¡ç®—æœºæ¥æ”¶åˆ°æŒ‡ä»¤åï¼Œäºˆä»¥æ‰§è¡Œã€‚ä¹Ÿæœ‰äººç§°ä¹‹ä¸ºå­—ç¬¦ç”¨æˆ·ç•Œé¢ï¼ˆCUIï¼‰</p><h3 id="14-2-ä»€ä¹ˆæ˜¯Vue-CLI"><a href="#14-2-ä»€ä¹ˆæ˜¯Vue-CLI" class="headerlink" title="14.2 ä»€ä¹ˆæ˜¯Vue CLI"></a>14.2 ä»€ä¹ˆæ˜¯Vue CLI</h3><p>Vue CLI æ˜¯ä¸€ä¸ªåŸºäº Vue.js è¿›è¡Œå¿«é€Ÿå¼€å‘çš„å®Œæ•´ç³»ç»Ÿã€‚ä½¿ç”¨Vue è„šæ‰‹æ¶ä¹‹åæˆ‘ä»¬å¼€å‘çš„é¡µé¢å°†æ˜¯ä¸€ä¸ªå®Œæ•´ç³»ç»Ÿ(é¡¹ç›®)ã€‚</p><h3 id="14-3-Vue-CLIä¼˜åŠ¿"><a href="#14-3-Vue-CLIä¼˜åŠ¿" class="headerlink" title="14.3 Vue CLIä¼˜åŠ¿"></a>14.3 Vue CLIä¼˜åŠ¿</h3><ul><li>é€šè¿‡ <code>vue-cli</code> æ­å»ºäº¤äº’å¼çš„é¡¹ç›®è„šæ‰‹æ¶ã€‚bootstrap css js jquery js     é€šè¿‡æ‰§è¡Œå‘½ä»¤æ–¹å¼ä¸‹è½½ç›¸å…³ä¾èµ–</li><li>é€šè¿‡ <code>@vue/cli</code> + <code>@vue/cli-service-global</code> å¿«é€Ÿå¼€å§‹é›¶é…ç½®åŸå‹å¼€å‘    vueé¡µé¢ vuejs  vuerouter        axios(ä¸€æ¡å‘½ä»¤)</li><li>ä¸€ä¸ªè¿è¡Œæ—¶ä¾èµ– (<code>@vue/cli-service</code>)ï¼Œè¯¥ä¾èµ–ï¼š<ul><li>å¯å‡çº§ï¼›  ä¸€æ¡å‘½ä»¤</li><li>åŸºäº webpack æ„å»ºï¼Œå¹¶å¸¦æœ‰åˆç†çš„é»˜è®¤é…ç½®ï¼›  webpack  é¡¹ç›®æ‰“åŒ…æ–¹å¼     ç¼–è¯‘å¥½çš„é¡¹ç›®æºç ===&gt;éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šç›´æ¥ä½¿ç”¨</li><li>å¯ä»¥é€šè¿‡é¡¹ç›®å†…çš„é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®ï¼›               é»˜è®¤é…ç½®æ–‡ä»¶,é€šè¿‡ä¿®æ”¹é»˜è®¤é…ç½®æ–‡ä»¶è¾¾åˆ°è‡ªå·±æƒ³è¦çš„é¡¹ç›®ç¯å¢ƒ            </li><li>å¯ä»¥é€šè¿‡æ’ä»¶è¿›è¡Œæ‰©å±•ã€‚                                       vue v-charts  elementui </li></ul></li><li>ä¸€ä¸ªä¸°å¯Œçš„å®˜æ–¹æ’ä»¶é›†åˆï¼Œé›†æˆäº†å‰ç«¯ç”Ÿæ€ä¸­æœ€å¥½çš„å·¥å…·ã€‚Nodejs(tomcat)  Vue VueRouter webpack yarn</li><li>ä¸€å¥—å®Œå…¨å›¾å½¢åŒ–çš„åˆ›å»ºå’Œç®¡ç† Vue.js é¡¹ç›®çš„ç”¨æˆ·ç•Œé¢</li></ul><h3 id="14-4-Vue-CLIå®‰è£…"><a href="#14-4-Vue-CLIå®‰è£…" class="headerlink" title="14.4 Vue CLIå®‰è£…"></a>14.4 Vue CLIå®‰è£…</h3><h5 id="1-ç¯å¢ƒå‡†å¤‡"><a href="#1-ç¯å¢ƒå‡†å¤‡" class="headerlink" title="1. ç¯å¢ƒå‡†å¤‡"></a>1. ç¯å¢ƒå‡†å¤‡</h5><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span>1.ä¸‹è½½nodejs</span>http://nodejs.cn/download/windowsç³»ç»Ÿ:   .msi  å®‰è£…åŒ…(exe)æŒ‡å®šå®‰è£…ä½ç½®   .zip(å‹ç¼©åŒ…)ç›´æ¥è§£å‹ç¼©æŒ‡å®šç›®å½•  mac os ç³»ç»Ÿ:   .pkg  å®‰è£…åŒ…æ ¼å¼è‡ªåŠ¨é…ç½®ç¯å¢ƒå˜é‡  .tar.gz(å‹ç¼©åŒ…)è§£å‹ç¼©å®‰è£…åˆ°æŒ‡å®šå<span class="token title important"><span class="token punctuation">#</span>2.é…ç½®nodejsç¯å¢ƒå˜é‡</span>windowsç³»ç»Ÿ:1.è®¡ç®—ä¸Šå³é”®å±æ€§---->  é«˜çº§å±æ€§ ---->ç¯å¢ƒå˜é‡ æ·»åŠ å¦‚ä¸‹é…ç½®:NODE_HOME=  nodejså®‰è£…ç›®å½•        PATH    = xxxx;%NODE_HOME%    2.macos ç³»ç»Ÿ    æ¨èä½¿ç”¨.pkgå®‰è£…ç›´æ¥é…ç½®nodeç¯å¢ƒ <span class="token title important"><span class="token punctuation">#</span>3.éªŒè¯nodejsç¯å¢ƒæ˜¯å¦æˆåŠŸ</span>node -v <span class="token title important"><span class="token punctuation">#</span>4.npmä»‹ç»</span>node package mangager    nodejsåŒ…ç®¡ç†å·¥å…·       å‰ç«¯ä¸»æµæŠ€æœ¯  npm è¿›è¡Œç»Ÿä¸€ç®¡ç†maven ç®¡ç†javaåç«¯ä¾èµ–   è¿œç¨‹ä»“åº“(ä¸­å¿ƒä»“åº“)      é˜¿é‡Œäº‘é•œåƒnpm   ç®¡ç†å‰ç«¯ç³»ç»Ÿä¾èµ–    è¿œç¨‹ä»“åº“(ä¸­å¿ƒä»“åº“)      é…ç½®æ·˜å®é•œåƒ<span class="token title important"><span class="token punctuation">#</span>5.é…ç½®æ·˜å®é•œåƒ</span>  npm config set registry https://registry.npm.taobao.org  npm config get registry<span class="token title important"><span class="token punctuation">#</span>6.é…ç½®npmä¸‹è½½ä¾èµ–ä½ç½®</span> windows:npm config set cache "D:\nodereps\npm-cache"npm config set prefix "D:\nodereps\npm_global" mac os: npm config set cache "/Users/chenyannan/dev/nodereps"npm config set prefix "/Users/chenyannan/dev/nodereps"<span class="token title important"><span class="token punctuation">#</span>7.éªŒè¯nodejsç¯å¢ƒé…ç½®</span>npm config ls<span class="token code keyword">    ; userconfig /Users/chenyannan/.npmrc    cache = "/Users/chenyannan/dev/nodereps"    prefix = "/Users/chenyannan/dev/nodereps"    registry = "https://registry.npm.taobao.org/"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="2-å®‰è£…è„šæ‰‹æ¶"><a href="#2-å®‰è£…è„šæ‰‹æ¶" class="headerlink" title="2.å®‰è£…è„šæ‰‹æ¶"></a>2.å®‰è£…è„šæ‰‹æ¶</h5><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span>0.å¸è½½è„šæ‰‹æ¶</span>npm uninstall -g @vue/cli  //å¸è½½3.xç‰ˆæœ¬è„šæ‰‹æ¶npm uninstall -g vue-cli  //å¸è½½2.xç‰ˆæœ¬è„šæ‰‹æ¶<span class="token title important"><span class="token punctuation">#</span>1.Vue Cliå®˜æ–¹ç½‘ç«™</span>https://cli.vuejs.org/zh/guide/<span class="token title important"><span class="token punctuation">#</span>2.å®‰è£…vue Cli</span>npm install -g vue-cli<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="3-ç¬¬ä¸€ä¸ªvueè„šæ‰‹æ¶é¡¹ç›®"><a href="#3-ç¬¬ä¸€ä¸ªvueè„šæ‰‹æ¶é¡¹ç›®" class="headerlink" title="3.ç¬¬ä¸€ä¸ªvueè„šæ‰‹æ¶é¡¹ç›®"></a>3.ç¬¬ä¸€ä¸ªvueè„šæ‰‹æ¶é¡¹ç›®</h5><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> 1.åˆ›å»ºvueè„šæ‰‹æ¶ç¬¬ä¸€ä¸ªé¡¹ç›®</span>vue init webpack é¡¹ç›®å<span class="token title important"><span class="token punctuation">#</span> 2.åˆ›å»ºç¬¬ä¸€ä¸ªé¡¹ç›®</span>hello     ------------->é¡¹ç›®å    -build  ------------->ç”¨æ¥ä½¿ç”¨webpackæ‰“åŒ…ä½¿ç”¨buildä¾èµ–    -config ------------->ç”¨æ¥åšæ•´ä¸ªé¡¹ç›®é…ç½®ç›®å½•    -node_modules  ------>ç”¨æ¥ç®¡ç†é¡¹ç›®ä¸­ä½¿ç”¨ä¾èµ–    -src ------>ç”¨æ¥ä¹¦å†™vueçš„æºä»£ç [é‡ç‚¹]    +assets      ------>ç”¨æ¥å­˜æ”¾é™æ€èµ„æº [é‡ç‚¹]      components   ------>ç”¨æ¥ä¹¦å†™Vueç»„ä»¶ [é‡ç‚¹]      router ------>ç”¨æ¥é…ç½®é¡¹ç›®ä¸­è·¯ç”±[é‡ç‚¹]      App.vue      ------>é¡¹ç›®ä¸­æ ¹ç»„ä»¶[é‡ç‚¹]      main.js      ------>é¡¹ç›®ä¸­ä¸»å…¥å£[é‡ç‚¹]    -static        ------>å…¶å®ƒé™æ€    -.babelrc      ------> å°†es6è¯­æ³•è½¬ä¸ºes5è¿è¡Œ    -.editorconfig ------> é¡¹ç›®ç¼–è¾‘é…ç½®    -.gitignore    ------> gitç‰ˆæœ¬æ§åˆ¶å¿½ç•¥æ–‡ä»¶    -.postcssrc.js ------> æºç ç›¸å…³js    -index.html    ------> é¡¹ç›®ä¸»é¡µ    -package.json  ------> ç±»ä¼¼ä¸pom.xml ä¾èµ–ç®¡ç†  jquery ä¸å»ºè®®æ‰‹åŠ¨ä¿®æ”¹    -package-lock.json ----> å¯¹package.jsonåŠ é”    -README.md         ----> é¡¹ç›®è¯´æ˜æ–‡ä»¶<span class="token title important"><span class="token punctuation">#</span> 3.å¦‚ä½•è¿è¡Œåœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸­æ‰§è¡Œ</span>npm start è¿è¡Œå‰ç«¯ç³»ç»Ÿ<span class="token title important"><span class="token punctuation">#</span> 4.å¦‚ä½•è®¿é—®é¡¹ç›®</span>http://localhost:8081    <span class="token title important"><span class="token punctuation">#</span> 5.Vue Cliä¸­é¡¹ç›®å¼€å‘æ–¹å¼</span> æ³¨æ„: ä¸€åˆ‡çš†ç»„ä»¶   ä¸€ä¸ªç»„ä»¶ä¸­   jsä»£ç   htmlä»£ç   cssæ ·å¼ <span class="token code keyword"> 1. VueCliå¼€å‘æ–¹å¼æ˜¯åœ¨é¡¹ç›®ä¸­å¼€å‘ä¸€ä¸ªä¸€ä¸ªç»„ä»¶å¯¹åº”ä¸€ä¸ªä¸šåŠ¡åŠŸèƒ½æ¨¡å—,æ—¥åå¯ä»¥å°†å¤šä¸ªç»„ä»¶ç»„åˆåˆ°ä¸€èµ·å½¢æˆä¸€ä¸ªå‰ç«¯ç³»ç»Ÿ 2. æ—¥ååœ¨ä½¿ç”¨vue Cliè¿›è¡Œå¼€å‘æ—¶ä¸å†ä¹¦å†™html,ç¼–å†™çš„æ˜¯ä¸€ä¸ªä¸ªç»„ä»¶(ç»„ä»¶åç¼€.vueç»“å°¾çš„æ–‡ä»¶),æ—¥åæ‰“åŒ…æ—¶vue cliä¼šå°†ç»„ä»¶ç¼–è¯‘æˆè¿è¡Œçš„htmlæ–‡ä»¶  </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="4-å¦‚ä½•å¼€å‘Vueè„šæ‰‹æ¶"><a href="#4-å¦‚ä½•å¼€å‘Vueè„šæ‰‹æ¶" class="headerlink" title="4.å¦‚ä½•å¼€å‘Vueè„šæ‰‹æ¶"></a>4.å¦‚ä½•å¼€å‘Vueè„šæ‰‹æ¶</h5><p><code>æ³¨æ„:åœ¨Vue cli ä¸­ä¸€åˆ‡çš†ç»„ä»¶</code></p><hr><h2 id="15-åœ¨è„šæ‰‹æ¶ä¸­ä½¿ç”¨axios"><a href="#15-åœ¨è„šæ‰‹æ¶ä¸­ä½¿ç”¨axios" class="headerlink" title="15.åœ¨è„šæ‰‹æ¶ä¸­ä½¿ç”¨axios"></a>15.åœ¨è„šæ‰‹æ¶ä¸­ä½¿ç”¨axios</h2><h3 id="15-1-å®‰è£…axios"><a href="#15-1-å®‰è£…axios" class="headerlink" title="15.1 å®‰è£…axios"></a>15.1 å®‰è£…axios</h3><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> 1.å®‰è£…axios</span>npm install axios --save-dev<span class="token title important"><span class="token punctuation">#</span> 2.é…ç½®main.jsä¸­å¼•å…¥axios</span>import axios from 'axios';<span class="token code keyword">Vue.prototype.$http=axios;</span><span class="token title important"><span class="token punctuation">#</span> 3.ä½¿ç”¨axios</span>åœ¨éœ€è¦å‘é€å¼‚æ­¥è¯·æ±‚çš„ä½ç½®:this.$http.get("url").then((res)=>&#123;&#125;) this.$http.post("url").then((res)=>&#123;&#125;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="16-Vue-Cliè„šæ‰‹æ¶é¡¹ç›®æ‰“åŒ…å’Œéƒ¨ç½²"><a href="#16-Vue-Cliè„šæ‰‹æ¶é¡¹ç›®æ‰“åŒ…å’Œéƒ¨ç½²" class="headerlink" title="16.Vue Cliè„šæ‰‹æ¶é¡¹ç›®æ‰“åŒ…å’Œéƒ¨ç½²"></a>16.Vue Cliè„šæ‰‹æ¶é¡¹ç›®æ‰“åŒ…å’Œéƒ¨ç½²</h2><pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> 1.åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤:</span>  vue run build<span class="token code keyword">æ³¨æ„:vueè„šæ‰‹æ¶æ‰“åŒ…çš„é¡¹ç›®å¿…é¡»åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œä¸èƒ½ç›´æ¥åŒå‡»è¿è¡Œ</span><span class="token title important"><span class="token punctuation">#</span> 2.æ‰“åŒ…ä¹‹åå½“å‰é¡¹ç›®ä¸­å˜åŒ–</span> åœ¨æ‰“åŒ…ä¹‹åé¡¹ç›®ä¸­å‡ºç°distç›®å½•,distç›®å½•å°±æ˜¯vueè„šæ‰‹æ¶é¡¹ç›®ç”Ÿäº§ç›®å½•æˆ–è€…è¯´æ˜¯ç›´æ¥éƒ¨ç½²ç›®å½•<span class="token title important"><span class="token punctuation">#</span> 3.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Bootæ•´åˆWebæŠ€æœ¯</title>
      <link href="2020/04/26/spring-boot-zheng-he-web-ji-zhu/"/>
      <url>2020/04/26/spring-boot-zheng-he-web-ji-zhu/</url>
      
        <content type="html"><![CDATA[<blockquote><h1 id="SpringBoot-æ•´åˆWebå±‚æŠ€æœ¯"><a href="#SpringBoot-æ•´åˆWebå±‚æŠ€æœ¯" class="headerlink" title="SpringBoot æ•´åˆWebå±‚æŠ€æœ¯"></a>SpringBoot æ•´åˆWebå±‚æŠ€æœ¯</h1></blockquote><h2 id="ä¸€ã€æ•´åˆservlet"><a href="#ä¸€ã€æ•´åˆservlet" class="headerlink" title="ä¸€ã€æ•´åˆservlet"></a>ä¸€ã€æ•´åˆservlet</h2><h3 id="1-é€šè¿‡æ³¨è§£æ‰«æå®Œæˆ-Servlet-ç»„ä»¶çš„æ³¨å†Œ"><a href="#1-é€šè¿‡æ³¨è§£æ‰«æå®Œæˆ-Servlet-ç»„ä»¶çš„æ³¨å†Œ" class="headerlink" title="1. é€šè¿‡æ³¨è§£æ‰«æå®Œæˆ Servlet ç»„ä»¶çš„æ³¨å†Œ"></a>1. é€šè¿‡æ³¨è§£æ‰«æå®Œæˆ Servlet ç»„ä»¶çš„æ³¨å†Œ</h3><h4 id="1-1åˆ›å»º-Servlet"><a href="#1-1åˆ›å»º-Servlet" class="headerlink" title="1.1åˆ›å»º Servlet"></a>1.1åˆ›å»º Servlet</h4><blockquote><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;@WebServlet(name &#x3D; &quot;FirstServlet&quot;,urlPatterns &#x3D; &quot;&#x2F;first&quot;)&gt;public class FirstServlet extends HttpServlet &#123;&gt;public void doGet(HttpServletRequest request,HttpServletResponse response)&#123;System.out.println(&quot;First Servlet........&quot;);&gt;&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h4 id="1-2ä¿®æ”¹å¯åŠ¨ç±»-æ·»åŠ æ³¨è§£-ServletComponentScan"><a href="#1-2ä¿®æ”¹å¯åŠ¨ç±»-æ·»åŠ æ³¨è§£-ServletComponentScan" class="headerlink" title="1.2ä¿®æ”¹å¯åŠ¨ç±»(æ·»åŠ æ³¨è§£@ServletComponentScan)"></a>1.2ä¿®æ”¹å¯åŠ¨ç±»(æ·»åŠ æ³¨è§£@ServletComponentScan)</h4><blockquote><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;@SpringBootApplication&gt;@ServletComponentScan&#x2F;&#x2F;åœ¨ spring Boot å¯åŠ¨æ—¶ä¼šæ‰«æ@WebServletæ³¨è§£ï¼Œå¹¶å°†è¯¥ç±»å®ä¾‹åŒ–&gt;public class SpringbootwebApplication &#123;public static void main(String[] args) &#123;&gt;SpringApplication.run(SpringbootwebApplication.class,args);&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h3 id="2-é€šè¿‡æ–¹æ³•å®Œæˆ-Servlet-ç»„ä»¶çš„æ³¨å†Œ"><a href="#2-é€šè¿‡æ–¹æ³•å®Œæˆ-Servlet-ç»„ä»¶çš„æ³¨å†Œ" class="headerlink" title="2.é€šè¿‡æ–¹æ³•å®Œæˆ Servlet ç»„ä»¶çš„æ³¨å†Œ"></a>2.é€šè¿‡æ–¹æ³•å®Œæˆ Servlet ç»„ä»¶çš„æ³¨å†Œ</h3><h4 id="2-1-åˆ›å»º-Servlet"><a href="#2-1-åˆ›å»º-Servlet" class="headerlink" title="2.1 åˆ›å»º Servlet"></a>2.1 åˆ›å»º Servlet</h4><blockquote><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;public class SecondServlet extends HttpServlet &#123;public void doGet(HttpServletRequest request,HttpServletResponse response)&#123;System.out.println(&quot;Second Servlet........&quot;);&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h4 id="2-2-åˆ›å»º-Servlet-é…ç½®ç±»"><a href="#2-2-åˆ›å»º-Servlet-é…ç½®ç±»" class="headerlink" title="2.2 åˆ›å»º Servlet é…ç½®ç±»"></a>2.2 åˆ›å»º Servlet é…ç½®ç±»</h4><blockquote><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;@Configuration&gt;public class ServletConfig &#123;&gt;@Bean&gt;public ServletRegistrationBeangetServletRegistrationBean()&#123;ServletRegistrationBean bean &#x3D; new ServletRegistrationBean(new SecondServlet());bean.addUrlMappings(&quot;&#x2F;second&quot;);return bean;&gt;&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h2 id="2-æ•´åˆFilter"><a href="#2-æ•´åˆFilter" class="headerlink" title="2. æ•´åˆFilter"></a>2. æ•´åˆFilter</h2><h3 id="1-é€šè¿‡æ³¨è§£æ‰«æå®Œæˆ-Filter-ç»„ä»¶æ³¨å†Œ"><a href="#1-é€šè¿‡æ³¨è§£æ‰«æå®Œæˆ-Filter-ç»„ä»¶æ³¨å†Œ" class="headerlink" title="1. é€šè¿‡æ³¨è§£æ‰«æå®Œæˆ Filter ç»„ä»¶æ³¨å†Œ"></a>1. é€šè¿‡æ³¨è§£æ‰«æå®Œæˆ Filter ç»„ä»¶æ³¨å†Œ</h3><h4 id="1-1-åˆ›å»º-Filter"><a href="#1-1-åˆ›å»º-Filter" class="headerlink" title="1.1 åˆ›å»º Filter"></a>1.1 åˆ›å»º Filter</h4><blockquote><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;@WebFilter(filterName &#x3D; &quot;FirstFilter&quot;,urlPatterns &#x3D;&quot;&#x2F;first&quot;)&gt;public class FirstFilter implements Filter&#123;@Overridepublic void init(FilterConfig filterConfig) throwsServletException &#123;&#125;@Overridepublic void doFilter(ServletRequest servletRequest,ServletResponse servletResponse, FilterChain filterChain)throws IOException, ServletException &#123;System.out.println(&quot;è¿›å…¥ First Filter&quot;);filterChain.doFilter(servletRequest,servletResponse);System.out.println(&quot;ç¦»å¼€ First Filter&quot;);&#125;@Overridepublic void destroy() &#123;&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h4 id="1-2-ä¿®æ”¹å¯åŠ¨ç±»"><a href="#1-2-ä¿®æ”¹å¯åŠ¨ç±»" class="headerlink" title="1.2 ä¿®æ”¹å¯åŠ¨ç±»"></a>1.2 ä¿®æ”¹å¯åŠ¨ç±»</h4><blockquote><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;@SpringBootApplication&gt;@ServletComponentScan&#x2F;&#x2F;åœ¨ spring Boot å¯åŠ¨æ—¶ä¼šæ‰«æ@WebServlet,@WebFilter æ³¨è§£ï¼Œå¹¶å°†è¯¥ç±»å®ä¾‹åŒ–&gt;public class SpringbootwebApplication &#123;public static void main(String[] args) &#123;&gt;SpringApplication.run(SpringbootwebApplication.class,args);&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h3 id="2-é€šè¿‡æ–¹æ³•å®Œæˆ-Filter-ç»„ä»¶æ³¨å†Œ"><a href="#2-é€šè¿‡æ–¹æ³•å®Œæˆ-Filter-ç»„ä»¶æ³¨å†Œ" class="headerlink" title="2.é€šè¿‡æ–¹æ³•å®Œæˆ Filter ç»„ä»¶æ³¨å†Œ"></a>2.é€šè¿‡æ–¹æ³•å®Œæˆ Filter ç»„ä»¶æ³¨å†Œ</h3><h4 id="2-1-åˆ›å»º-Filter"><a href="#2-1-åˆ›å»º-Filter" class="headerlink" title="2.1 åˆ›å»º Filter"></a>2.1 åˆ›å»º Filter</h4><blockquote><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;public class SecondFilter implements Filter &#123;@Overridepublic void init(FilterConfig filterConfig) throwsServletException &#123;&#125;@Overridepublic void doFilter(ServletRequest servletRequest,ServletResponse servletResponse, FilterChain filterChain)throws IOException, ServletException &#123;System.out.println(&quot;è¿›å…¥ Second Filter&quot;);filterChain.doFilter(servletRequest,servletResponse);System.out.println(&quot;ç¦»å¼€ Second Filter&quot;);&#125;@Overridepublic void destroy() &#123;&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h4 id="2-2-åˆ›å»º-Filter-é…ç½®ç±»"><a href="#2-2-åˆ›å»º-Filter-é…ç½®ç±»" class="headerlink" title="2.2 åˆ›å»º Filter é…ç½®ç±»"></a>2.2 åˆ›å»º Filter é…ç½®ç±»</h4><blockquote><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;@Configuration&gt;public class FilterConfig &#123;@Beanpublic FilterRegistrationBean getFilterRegistrationBean()&#123;FilterRegistrationBean bean &#x3D; new FilterRegistrationBean(new SecondFilter());&#x2F;&#x2F; bean.addUrlPatterns(new String[]&#123;&quot;*.do&quot;,&quot;*.jsp&quot;&#125;);bean.addUrlPatterns(&quot;&#x2F;second&quot;);return bean;&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h2 id="3-æ•´åˆ-Listener"><a href="#3-æ•´åˆ-Listener" class="headerlink" title="3.æ•´åˆ Listener"></a>3.æ•´åˆ Listener</h2><h3 id="1-é€šè¿‡æ³¨è§£æ‰«æå®Œæˆ-Listener-ç»„ä»¶æ³¨å†Œ"><a href="#1-é€šè¿‡æ³¨è§£æ‰«æå®Œæˆ-Listener-ç»„ä»¶æ³¨å†Œ" class="headerlink" title="1. é€šè¿‡æ³¨è§£æ‰«æå®Œæˆ Listener ç»„ä»¶æ³¨å†Œ"></a>1. é€šè¿‡æ³¨è§£æ‰«æå®Œæˆ Listener ç»„ä»¶æ³¨å†Œ</h3><h4 id="1-1-ç¼–å†™Listiener"><a href="#1-1-ç¼–å†™Listiener" class="headerlink" title="1.1 ç¼–å†™Listiener"></a>1.1 ç¼–å†™Listiener</h4><blockquote><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;@WebListener&gt;public class FirstListener implements ServletContextListener&#123;public void contextDestroyed(ServletContextEvent event)&#123;&#125;public void contextInitialized(ServletContextEvent event)&#123;System.out.println(&quot;Listener ...Init......&quot;);&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h4 id="1-2-ä¿®æ”¹å¯åŠ¨ç±»-1"><a href="#1-2-ä¿®æ”¹å¯åŠ¨ç±»-1" class="headerlink" title="1.2 ä¿®æ”¹å¯åŠ¨ç±»"></a>1.2 ä¿®æ”¹å¯åŠ¨ç±»</h4><blockquote><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;@SpringBootApplication&gt;@ServletComponentScan&#x2F;&#x2F;åœ¨ spring Boot å¯åŠ¨æ—¶ä¼šæ‰«æ@WebServlet,@WebFilter,@WebListener æ³¨è§£ï¼Œå¹¶å°†è¯¥ç±»å®ä¾‹åŒ–&gt;public class SpringbootwebApplication &#123;public static void main(String[] args) &#123;SpringApplication.run(SpringbootwebApplication.class,args);&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h3 id="2-é€šè¿‡æ–¹æ³•å®Œæˆ-Listener-ç»„ä»¶æ³¨å†Œ"><a href="#2-é€šè¿‡æ–¹æ³•å®Œæˆ-Listener-ç»„ä»¶æ³¨å†Œ" class="headerlink" title="2.é€šè¿‡æ–¹æ³•å®Œæˆ Listener ç»„ä»¶æ³¨å†Œ"></a>2.é€šè¿‡æ–¹æ³•å®Œæˆ Listener ç»„ä»¶æ³¨å†Œ</h3><h4 id="2-1-ç¼–å†™-Listener"><a href="#2-1-ç¼–å†™-Listener" class="headerlink" title="2.1 ç¼–å†™ Listener"></a>2.1 ç¼–å†™ Listener</h4><blockquote><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;public class SecondListener implements ServletContextListener &#123;public void contextDestroyed(ServletContextEvent event)&#123;&#125;public void contextInitialized(ServletContextEvent event)&#123;System.out.println(&quot;Second....Listener ...Init......&quot;);&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h4 id="2-2-åˆ›å»º-Listener-é…ç½®ç±»"><a href="#2-2-åˆ›å»º-Listener-é…ç½®ç±»" class="headerlink" title="2.2 åˆ›å»º Listener é…ç½®ç±»"></a>2.2 åˆ›å»º Listener é…ç½®ç±»</h4><blockquote><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;@Configuration&gt;public class ListenerConfig &#123;@Beanpublic ServletListenerRegistrationBean getServletListenerRegistrationBean()&#123;ServletListenerRegistrationBean bean &#x3D; new ServletListenerRegistrationBean(new SecondListener());return bean;&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaWeb </tag>
            
            <tag> Spring Boot </tag>
            
            <tag> Javaæ¡†æ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Bootæ•´åˆJDBC</title>
      <link href="2020/04/26/spring-boot-zheng-he-jdbc/"/>
      <url>2020/04/26/spring-boot-zheng-he-jdbc/</url>
      
        <content type="html"><![CDATA[<h1 id="SpringBootæ•´åˆJDBC"><a href="#SpringBootæ•´åˆJDBC" class="headerlink" title="SpringBootæ•´åˆJDBC"></a>SpringBootæ•´åˆJDBC</h1><h2 id="1-å¼•å…¥ç›¸åº”çš„pom-xmlæ–‡ä»¶ä¾èµ–"><a href="#1-å¼•å…¥ç›¸åº”çš„pom-xmlæ–‡ä»¶ä¾èµ–" class="headerlink" title="1.å¼•å…¥ç›¸åº”çš„pom.xmlæ–‡ä»¶ä¾èµ–"></a>1.å¼•å…¥ç›¸åº”çš„pom.xmlæ–‡ä»¶ä¾èµ–</h2><blockquote><pre class="line-numbers language-xml" data-language="xml"><div class="caption"><span><!--æ·»åŠ jdbcå¯åŠ¨å™¨--></span></div><code class="language-xml">><span class="token comment">&lt;!--æ·»åŠ jdbcå¯åŠ¨å™¨--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>><span class="token comment">&lt;!--æ·»åŠ mysqlçš„é©±åŠ¨--></span>><span class="token comment">&lt;!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java --></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>8.0.11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h2 id="2-é…ç½®æ•°æ®æº"><a href="#2-é…ç½®æ•°æ®æº" class="headerlink" title="2.é…ç½®æ•°æ®æº"></a>2.é…ç½®æ•°æ®æº</h2><blockquote></blockquote><h3 id="2-1é€šè¿‡è‡ªå®šä¹‰é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®æ•°æ®æºä¿¡æ¯"><a href="#2-1é€šè¿‡è‡ªå®šä¹‰é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®æ•°æ®æºä¿¡æ¯" class="headerlink" title="2.1é€šè¿‡è‡ªå®šä¹‰é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®æ•°æ®æºä¿¡æ¯"></a>2.1é€šè¿‡è‡ªå®šä¹‰é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®æ•°æ®æºä¿¡æ¯</h3><blockquote><ul><li>æ·»åŠ  Druid æ•°æ®æºä¾èµ–</li></ul><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">><span class="token comment">&lt;!--Druid æ•°æ®æºä¾èµ–--></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>druid<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.1.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åˆ›å»º Properties æ–‡ä»¶</li></ul><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">>jdbc.driverClassName</span><span class="token punctuation">=</span><span class="token attr-value">com.mysql.jdbc.Driver</span><span class="token attr-name">>jdbc.url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false</span><span class="token attr-name">>jdbc.username</span><span class="token punctuation">=</span><span class="token attr-value">root</span><span class="token attr-name">>jdbc.password</span><span class="token punctuation">=</span><span class="token attr-value">root</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¦æ³¨æ„mysql8.0ä»¥åçš„<code>driverClassName</code>æ˜¯<code>com.mysql.cj.jdbc.Driver</code></strong></p><ul><li>åˆ›å»ºé…ç½®ç±»<pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;@Configuration&gt;@PropertySource(&quot;classpath:&#x2F;jdbc.properties&quot;) &#x2F;&#x2F;åŠ è½½æŒ‡å®šçš„Properties é…ç½®æ–‡ä»¶&gt;public class JdbcConfiguration &#123;&gt;@Value(&quot;$&#123;jdbc.driverClassName&#125;&quot;)&gt;private String driverClassName;&gt;@Value(&quot;$&#123;jdbc.url&#125;&quot;)&gt;private String url;&gt;@Value(&quot;$&#123;jdbc.username&#125;&quot;)&gt;private String username;&gt;@Value(&quot;$&#123;jdbc.password&#125;&quot;)&gt;private String password;&gt;&#x2F;&#x2F; å®ä¾‹åŒ– Druid&gt;@Bean&gt;public DataSource getDataSource()&#123;&gt;DruidDataSource source &#x3D; new DruidDataSource(); &#x2F;&#x2F; æŠŠå±æ€§å€¼èµ‹è¿›å»&gt;source.setPassword(this.password);&gt;source.setUsername(this.username);&gt;source.setUrl(this.url);&gt;source.setDriverClassName(this.driverClassName);&gt;return source;&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></blockquote><h3 id="2-2é€šè¿‡-ConfigurationProperties-æ³¨è§£è¯»å–é…ç½®ä¿¡æ¯"><a href="#2-2é€šè¿‡-ConfigurationProperties-æ³¨è§£è¯»å–é…ç½®ä¿¡æ¯" class="headerlink" title="2.2é€šè¿‡@ConfigurationProperties æ³¨è§£è¯»å–é…ç½®ä¿¡æ¯"></a>2.2é€šè¿‡@ConfigurationProperties æ³¨è§£è¯»å–é…ç½®ä¿¡æ¯</h3><blockquote><p><font color = red>è¿™ç§æ–¹å¼åªèƒ½è·å–applicationçš„é…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸”å˜é‡åè¦ä¸€æ ·</font></p><ul><li>åˆ›å»ºé…ç½®ä¿¡æ¯å®ä½“ç±»<pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;@ConfigurationProperties(prefix &#x3D; &quot;jdbc&quot;)&#x2F;&#x2F;æ˜¯ SpringBoot çš„æ³¨è§£ä¸èƒ½è¯»å–å…¶ä»–é…ç½®æ–‡ä»¶ï¼Œåªèƒ½è¯»å– SpringBoot çš„ application é…ç½®æ–‡ä»¶&gt;public class JdbcProperties &#123;&gt;private String driverClassName;&gt;private String url;&gt;private String username;&gt;private String password;&gt;public String getDriverClassName() &#123;&gt;return driverClassName;&gt;&#125;&gt;public void setDriverClassName(String driverClassName) &#123;&gt;this.driverClassName &#x3D; driverClassName;&gt;&#125;&gt;public String getUrl() &#123;&gt;return url;&gt;&#125;&gt;public void setUrl(String url) &#123;&gt;this.url &#x3D; url;&gt;&#125;&gt;public String getUsername() &#123;&gt;return username;&gt;&#125;&gt;public void setUsername(String username) &#123;&gt;this.username &#x3D; username;&gt;&#125;&gt;public String getPassword() &#123;&gt;return password;&gt;&#125;&gt;public void setPassword(String password) &#123;&gt;this.password &#x3D; password;&gt;&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>ä¿®æ”¹é…ç½®ç±»<pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;@Configuration&gt;&#x2F;&#x2F;@PropertySource(&quot;classpath:&#x2F;jdbc.properties&quot;) &#x2F;&#x2F;åŠ è½½æŒ‡å®šçš„ Properties é…ç½®æ–‡ä»¶&gt;@EnableConfigurationProperties(JdbcProperties.class)&#x2F;&#x2F;æŒ‡å®šåŠ è½½å“ªä¸ªé…ç½®ä¿¡æ¯å±æ€§ç±»&gt;public class JdbcConfiguration &#123;&gt;@Bean&gt;public DataSource getDataSource(JdbcProperties&gt;jdbcProperties)&#123;&gt;DruidDataSource source &#x3D; new DruidDataSource();&gt;source.setPassword(jdbcProperties.getPassword());&gt;source.setUsername(jdbcProperties.getUsername());&gt;source.setUrl(jdbcProperties.getUrl());&gt;source.setDriverClassName(jdbcProperties.getDriverClassName());&gt;return source;&gt;&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></blockquote><h3 id="2-3-ConfigurationProperties-æ³¨è§£çš„ä¼˜é›…ä½¿ç”¨æ–¹å¼"><a href="#2-3-ConfigurationProperties-æ³¨è§£çš„ä¼˜é›…ä½¿ç”¨æ–¹å¼" class="headerlink" title="2.3 @ConfigurationProperties æ³¨è§£çš„ä¼˜é›…ä½¿ç”¨æ–¹å¼"></a>2.3 @ConfigurationProperties æ³¨è§£çš„ä¼˜é›…ä½¿ç”¨æ–¹å¼</h3><blockquote><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;@Configuration&gt;public class JdbcConfiguration &#123;@Bean@ConfigurationProperties(prefix &#x3D; &quot;jdbc&quot;)&#x2F;&#x2F; è·å–applicationé…ç½®æ–‡ä»¶ä¸­ä»¥jdbcå¼€å¤´çš„public DataSource getDataSource()&#123;DruidDataSource source &#x3D; new DruidDataSource();return source;&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h3 id="2-4-é€šè¿‡-Spring-Boot-é…ç½®æ–‡ä»¶é…ç½®æ•°æ®æº"><a href="#2-4-é€šè¿‡-Spring-Boot-é…ç½®æ–‡ä»¶é…ç½®æ•°æ®æº" class="headerlink" title="2.4 é€šè¿‡ Spring Boot é…ç½®æ–‡ä»¶é…ç½®æ•°æ®æº"></a>2.4 é€šè¿‡ Spring Boot é…ç½®æ–‡ä»¶é…ç½®æ•°æ®æº</h3><blockquote><p>åœ¨ Spring Boot1.x ç‰ˆ æœ¬ ä¸­ çš„ spring-boot-starter-jdbc å¯ åŠ¨ å™¨ ä¸­ é»˜ è®¤ ä½¿ ç”¨ çš„ æ˜¯<br>org.apache.tomcat.jdbc.pool.DataSource ä½œä¸ºæ•°æ®æº<br>åœ¨ Spring Boot2.x ç‰ˆ æœ¬ ä¸­ çš„ spring-boot-starter-jdbc å¯ åŠ¨ å™¨ ä¸­ é»˜ è®¤ ä½¿ ç”¨ çš„ æ˜¯<br>com.zaxxer.hikariDataSource ä½œä¸ºæ•°æ®æº</p><ul><li>ä½¿ç”¨ Spring Boot é»˜è®¤çš„ HikariDataSource æ•°æ®æº<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">>spring.datasource.url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false</span><span class="token attr-name">>spring.datasource.driver-class-name</span><span class="token punctuation">=</span><span class="token attr-value">com.mysql.jdbc.Driver</span><span class="token attr-name">>spring.datasource.username</span><span class="token punctuation">=</span><span class="token attr-value">root</span><span class="token attr-name">>spring.datasource.password</span><span class="token punctuation">=</span><span class="token attr-value">root</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li>ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„ Druid æ•°æ®æºï¼ˆæ·»åŠ ä¸€ä¸ªtypeå±æ€§ï¼‰<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">>spring.datasource.url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false</span><span class="token attr-name">>spring.datasource.driver-class-name</span><span class="token punctuation">=</span><span class="token attr-value">com.mysql.jdbc.Driver</span><span class="token attr-name">>spring.datasource.username</span><span class="token punctuation">=</span><span class="token attr-value">root</span><span class="token attr-name">>spring.datasource.password</span><span class="token punctuation">=</span><span class="token attr-value">root</span><span class="token attr-name">>spring.datasource.type</span><span class="token punctuation">=</span><span class="token attr-value">com.alibaba.druid.pool.DruidDataSource</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaWeb </tag>
            
            <tag> Spring Boot </tag>
            
            <tag> JDBC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Thymeleaf è¯­æ³•è®²è§£</title>
      <link href="2020/04/25/thymeleaf-yu-fa-jiang-jie/"/>
      <url>2020/04/25/thymeleaf-yu-fa-jiang-jie/</url>
      
        <content type="html"><![CDATA[<blockquote><h1 id="Thymeleaf-è¯­æ³•è®²è§£"><a href="#Thymeleaf-è¯­æ³•è®²è§£" class="headerlink" title="Thymeleaf è¯­æ³•è®²è§£"></a>Thymeleaf è¯­æ³•è®²è§£</h1></blockquote><h2 id="1-å‘½åç©ºé—´ï¼š"><a href="#1-å‘½åç©ºé—´ï¼š" class="headerlink" title="1.å‘½åç©ºé—´ï¼š"></a>1.å‘½åç©ºé—´ï¼š</h2><blockquote><p>åœ¨htmlæ ‡ç­¾åè¾¹æ·»åŠ ä¸Š<code>xmlns:th=&quot;http://www.thymeleaf.org&quot;</code>å³å¯<br>å¦‚æœä¸æ·»åŠ ä¹Ÿæ— ä¼¤å¤§é›…ï¼Œåªæ˜¯ä¼šæŠ¥çº¢</p></blockquote><h2 id="2-å­—ç¬¦ä¸²ä¸å˜é‡è¾“å‡ºæ“ä½œ"><a href="#2-å­—ç¬¦ä¸²ä¸å˜é‡è¾“å‡ºæ“ä½œ" class="headerlink" title="2.å­—ç¬¦ä¸²ä¸å˜é‡è¾“å‡ºæ“ä½œ"></a>2.å­—ç¬¦ä¸²ä¸å˜é‡è¾“å‡ºæ“ä½œ</h2><h3 id="2-1-th-textåœ¨é¡µé¢ä¸­è¾“å‡ºå€¼"><a href="#2-1-th-textåœ¨é¡µé¢ä¸­è¾“å‡ºå€¼" class="headerlink" title="2.1 th:textåœ¨é¡µé¢ä¸­è¾“å‡ºå€¼"></a>2.1 th:textåœ¨é¡µé¢ä¸­è¾“å‡ºå€¼</h3><blockquote><ul><li><code>th:text=&quot;value&quot;</code><br><code>&lt;span th:text=&quot;æ–‡æœ¬1&quot;&gt;æ–‡æœ¬&lt;/span&gt;</code></li></ul><p><strong>è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§æƒ…å†µ<code>th:text</code>ä¸­çš„å€¼ä¼šæŠŠ<code>span</code>æ ‡ç­¾ä¸­çš„å€¼è¦†ç›–æ‰ï¼Œæ˜¾ç¤ºæ–‡æœ¬1ã€‚</strong></p><ul><li><code>th:text=&quot;$&#123;key&#125;&quot;</code></li></ul><p><strong>Thymeleafä¹Ÿå¯ä»¥ç”¨ELè¡¨è¾¾å¼è·å–controllerå±‚å‘é€è¿‡æ¥çš„æ•°æ®ï¼Œæ˜¾ç¤ºåˆ°é¡µé¢ä¸­</strong><br><code>&lt;span th:text=&quot;$&#123;msg&#125;&quot;&gt;&lt;/span&gt;</code></p></blockquote><h2 id="3-å­—ç¬¦ä¸²æ“ä½œ"><a href="#3-å­—ç¬¦ä¸²æ“ä½œ" class="headerlink" title="3.å­—ç¬¦ä¸²æ“ä½œ"></a>3.å­—ç¬¦ä¸²æ“ä½œ</h2><blockquote><p><font color = red><strong>Thymeleaf æä¾›äº†ä¸€äº›å†…ç½®å¯¹è±¡ï¼Œå†…ç½®å¯¹è±¡å¯ç›´æ¥åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ã€‚è¿™äº›å¯¹è±¡æ˜¯ä»¥#å¼•ç”¨çš„ã€‚</strong></font></p></blockquote><h3 id="3-1ä½¿ç”¨å†…ç½®å¯¹è±¡çš„è¯­æ³•"><a href="#3-1ä½¿ç”¨å†…ç½®å¯¹è±¡çš„è¯­æ³•" class="headerlink" title="3.1ä½¿ç”¨å†…ç½®å¯¹è±¡çš„è¯­æ³•"></a>3.1ä½¿ç”¨å†…ç½®å¯¹è±¡çš„è¯­æ³•</h3><blockquote><ul><li>å¼•ç”¨å†…ç½®å¯¹è±¡éœ€è¦ä½¿ç”¨#</li><li>å¤§éƒ¨åˆ†å†…ç½®å¯¹è±¡çš„åç§°éƒ½ä»¥ s ç»“å°¾ã€‚å¦‚ï¼šstringsã€numbersã€dates</li></ul><table><thead><tr><th align="center"></th><th align="center"></th></tr></thead><tbody><tr><td align="center">${ #strings.isEmpty(key)}</td><td align="center">åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºè¿”å› trueï¼Œå¦åˆ™è¿”å› false</td></tr><tr><td align="center">${ #strings.contains(msg,â€™Tâ€™)}</td><td align="center">åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æŒ‡å®šçš„å­ä¸²ï¼Œå¦‚æœåŒ…å«è¿”å› trueï¼Œå¦åˆ™è¿”å› false</td></tr><tr><td align="center">${ #strings.startsWith(msg,â€™aâ€™)}</td><td align="center">åˆ¤æ–­å½“å‰å­—ç¬¦ä¸²æ˜¯å¦ä»¥å­ä¸²å¼€å¤´ï¼Œå¦‚æœæ˜¯è¿”å› trueï¼Œå¦åˆ™è¿”å› false</td></tr><tr><td align="center">${ #strings.endsWith(msg,â€™aâ€™)}</td><td align="center">åˆ¤æ–­å½“å‰å­—ç¬¦ä¸²æ˜¯å¦ä»¥å­ä¸²ç»“å°¾ï¼Œå¦‚æœæ˜¯è¿”å› trueï¼Œå¦åˆ™è¿”å› false</td></tr><tr><td align="center">${ #strings.length(msg)}</td><td align="center">è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦</td></tr><tr><td align="center">${ #strings.indexOf(msg,â€™hâ€™)}</td><td align="center">æŸ¥æ‰¾å­ä¸²çš„ä½ç½®ï¼Œå¹¶è¿”å›è¯¥å­ä¸²çš„ä¸‹æ ‡ï¼Œå¦‚æœæ²¡æ‰¾åˆ°åˆ™è¿”å›-1</td></tr><tr><td align="center">${ #strings.substring(msg,2)} ${ #strings.substring(msg,2,5)}</td><td align="center">æˆªå–å­ä¸²ï¼Œç”¨æˆ·ä¸ jdk String ç±»ä¸‹ SubString æ–¹æ³•ç›¸åŒ</td></tr><tr><td align="center">${ #strings.toUpperCase(msg)} ${ #strings.toLowerCase(msg)}</td><td align="center">å­—ç¬¦ä¸²è½¬å¤§å°å†™ã€‚</td></tr></tbody></table><p><font color = red><strong>å­—ç¬¦ä¸²æ“ä½œç±»ä¼¼ä¸Javaä¸­çš„å­—ç¬¦ä¸²æ“ä½œï¼Œå¾ˆå¥½è®°å¿†</strong></font></p></blockquote><h2 id="4-æ—¥æœŸæ ¼å¼åŒ–å¤„ç†"><a href="#4-æ—¥æœŸæ ¼å¼åŒ–å¤„ç†" class="headerlink" title="4.æ—¥æœŸæ ¼å¼åŒ–å¤„ç†"></a>4.æ—¥æœŸæ ¼å¼åŒ–å¤„ç†</h2><blockquote><p><strong>è¿™é‡Œçš„keyæ˜¯controllerå±‚ä¼ è¿‡æ¥çš„å€¼</strong></p><table><thead><tr><th align="center"></th><th align="center"></th></tr></thead><tbody><tr><td align="center">${ #dates.format(key)}</td><td align="center">æ ¼å¼åŒ–æ—¥æœŸï¼Œé»˜è®¤çš„ä»¥æµè§ˆå™¨é»˜è®¤è¯­è¨€ä¸ºæ ¼å¼åŒ–æ ‡å‡†</td></tr><tr><td align="center">${ #dates.format(key,â€™yyyy/MM/ddâ€™)}</td><td align="center">æŒ‰ç…§è‡ªå®šä¹‰çš„æ ¼å¼åšæ—¥æœŸè½¬æ¢</td></tr><tr><td align="center">${ #dates.year(key)} ${ #dates.month(key)} ${ #dates.day(key)}</td><td align="center">Yearï¼šå–å¹´ Monthï¼šå–æœˆ Dayï¼šå–æ—¥</td></tr></tbody></table></blockquote><h2 id="5-æ¡ä»¶åˆ¤æ–­"><a href="#5-æ¡ä»¶åˆ¤æ–­" class="headerlink" title="5.æ¡ä»¶åˆ¤æ–­"></a>5.æ¡ä»¶åˆ¤æ–­</h2><h3 id="5-1-th-if"><a href="#5-1-th-if" class="headerlink" title="5.1 th:if"></a>5.1 th:if</h3><h3 id="5-2-th-switch-th-case"><a href="#5-2-th-switch-th-case" class="headerlink" title="5.2 th:switch/th:case"></a>5.2 th:switch/th:case</h3><blockquote><p><strong><code>th:switch / th:case</code> ä¸ Java ä¸­çš„ switch è¯­å¥ç­‰æ•ˆï¼Œæœ‰æ¡ä»¶åœ°æ˜¾ç¤ºåŒ¹é…çš„å†…å®¹ã€‚å¦‚æœæœ‰å¤šä¸ªåŒ¹é…ç»“æœåªé€‰æ‹©ç¬¬ä¸€ä¸ªæ˜¾ç¤ºã€‚</strong><br><code>th:case=&quot;*&quot;</code>è¡¨ç¤º Java ä¸­ switch çš„ defaultï¼Œå³æ²¡æœ‰ case çš„å€¼ä¸º true æ—¶åˆ™æ˜¾ç¤º <code>th:case=&quot;*&quot;</code> çš„å†…å®¹ã€‚</p></blockquote><h2 id="6-è¿­ä»£éå†"><a href="#6-è¿­ä»£éå†" class="headerlink" title="6.è¿­ä»£éå†"></a>6.è¿­ä»£éå†</h2><h3 id="6-1-th-each-è¿­ä»£å™¨ï¼Œç”¨äºå¾ªç¯è¿­ä»£é›†åˆ"><a href="#6-1-th-each-è¿­ä»£å™¨ï¼Œç”¨äºå¾ªç¯è¿­ä»£é›†åˆ" class="headerlink" title="6.1 th:each  è¿­ä»£å™¨ï¼Œç”¨äºå¾ªç¯è¿­ä»£é›†åˆ"></a>6.1 th:each  è¿­ä»£å™¨ï¼Œç”¨äºå¾ªç¯è¿­ä»£é›†åˆ</h3><blockquote><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token comment">&lt;!--è¿™é‡Œçš„u : $&#123;list&#125;ä¸­ï¼Œuè¡¨ç¤ºæ¯ä¸€æ¬¡éå†è·å¾—çš„å¯¹è±¡--></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span> <span class="token attr-name"><span class="token namespace">th:</span>each</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>u : $&#123;list&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;u.name&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;u.age&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;u.sex&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr></blockquote><h3 id="6-2-th-each-çŠ¶æ€å˜é‡"><a href="#6-2-th-each-çŠ¶æ€å˜é‡" class="headerlink" title="6.2 th:each çŠ¶æ€å˜é‡"></a>6.2 th:each çŠ¶æ€å˜é‡</h3><blockquote><p><strong>åœ¨éå†çš„åŸºç¡€ä¸Šï¼Œuçš„åè¾¹åŠ ä¸€ä¸ªå‚æ•°</strong></p><pre class="line-numbers language-html" data-language="html"><code class="language-html">><span class="token comment">&lt;!--è¿™é‡Œçš„varå°±æ˜¯å®šä¹‰äº†çŠ¶æ€å˜é‡ï¼Œç”¨ä»–å¯ä»¥è°ƒç”¨ç›¸åº”çš„æ–¹æ³•--></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span> <span class="token attr-name"><span class="token namespace">th:</span>each</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>u,var : $&#123;list&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;u.name&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;u.age&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;u.sex&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;var.index&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;var.count&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;var.size&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;var.odd&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;var.even&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><table><thead><tr><th align="center"></th><th align="center"></th></tr></thead><tbody><tr><td align="center">index</td><td align="center">å½“å‰è¿­ä»£å™¨çš„ç´¢å¼• ä» 0 å¼€å§‹</td></tr><tr><td align="center">count</td><td align="center">å½“å‰è¿­ä»£å¯¹è±¡çš„è®¡æ•° ä» 1 å¼€å§‹</td></tr><tr><td align="center">size</td><td align="center">è¢«è¿­ä»£å¯¹è±¡çš„é•¿åº¦</td></tr><tr><td align="center">odd/even</td><td align="center">å½“å‰å¾ªç¯æ˜¯å¦æ˜¯å¶æ•°/å¥‡æ•° ä» 0 å¼€å§‹</td></tr><tr><td align="center">first</td><td align="center">å½“å‰å¾ªç¯çš„æ˜¯å¦æ˜¯ç¬¬ä¸€æ¡ï¼Œå¦‚æœæ˜¯è¿”å› true å¦åˆ™è¿”å› false</td></tr><tr><td align="center">last</td><td align="center">å½“å‰å¾ªç¯çš„æ˜¯å¦æ˜¯æœ€åä¸€æ¡ï¼Œå¦‚æœæ˜¯åˆ™è¿”å› true å¦åˆ™è¿”å› false</td></tr></tbody></table></blockquote><h2 id="7-æ“ä½œåŸŸå¯¹è±¡"><a href="#7-æ“ä½œåŸŸå¯¹è±¡" class="headerlink" title="7.æ“ä½œåŸŸå¯¹è±¡"></a>7.æ“ä½œåŸŸå¯¹è±¡</h2><blockquote><ul><li><code>HttpServletRequest</code><pre class="line-numbers language-html" data-language="html"><code class="language-html">><span class="token comment">&lt;!--ä¸¤ç§æ–¹å¼è·å–--></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;#httpServletRequest.getAttribute(<span class="token punctuation">'</span>req<span class="token punctuation">'</span>)&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;#request.getAttribute(<span class="token punctuation">'</span>req<span class="token punctuation">'</span>)&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><code>HttpSession</code><pre class="line-numbers language-html" data-language="html"><code class="language-html">><span class="token comment">&lt;!--ä¸¤ç§è·å–æ–¹å¼--></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;session.ses&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;#session.getAttribute(<span class="token punctuation">'</span>ses<span class="token punctuation">'</span>)&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li>ServletContext<pre class="line-numbers language-html" data-language="html"><code class="language-html">><span class="token comment">&lt;!--ä¸¤ç§è·å–æ–¹å¼--></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;application.app&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;#servletContext.getAttribute(<span class="token punctuation">'</span>app<span class="token punctuation">'</span>)&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li></ul></blockquote><h2 id="8-URL-è¡¨è¾¾å¼"><a href="#8-URL-è¡¨è¾¾å¼" class="headerlink" title="8.URL è¡¨è¾¾å¼"></a>8.URL è¡¨è¾¾å¼</h2><h3 id="8-1-è¯­æ³•"><a href="#8-1-è¯­æ³•" class="headerlink" title="8.1 è¯­æ³•"></a>8.1 è¯­æ³•</h3><blockquote><p><strong>åœ¨ Thymeleaf ä¸­ URL è¡¨è¾¾å¼çš„è¯­æ³•æ ¼å¼ä¸º@{}</strong></p></blockquote><h3 id="8-2-ç»å¯¹è·¯å¾„"><a href="#8-2-ç»å¯¹è·¯å¾„" class="headerlink" title="8.2 ç»å¯¹è·¯å¾„"></a>8.2 ç»å¯¹è·¯å¾„</h3><blockquote><p><code>&lt;a th:href=&quot;@&#123;http://www.baidu.com&#125;&quot;&gt;ç»å¯¹è·¯å¾„&lt;/a&gt;</code></p></blockquote><h3 id="8-3-ç›¸å¯¹è·¯å¾„"><a href="#8-3-ç›¸å¯¹è·¯å¾„" class="headerlink" title="8.3 ç›¸å¯¹è·¯å¾„"></a>8.3 ç›¸å¯¹è·¯å¾„</h3><blockquote><ul><li>ç›¸å¯¹äºå½“å‰é¡¹ç›®çš„æ ¹<br><code>&lt;a th:href=&quot;@&#123;/show&#125;&quot;&gt;ç›¸å¯¹è·¯å¾„&lt;/a&gt;</code></li><li>ç›¸å¯¹äºæœåŠ¡å™¨è·¯å¾„çš„æ ¹<br><code>&lt;a th:href=&quot;@&#123;~/project2/resourcename&#125;&quot;&gt;ç›¸å¯¹äºæœåŠ¡å™¨çš„æ ¹&lt;/a&gt;</code></li></ul></blockquote><h3 id="8-4-åœ¨-URL-ä¸­ä¼ é€’å‚æ•°"><a href="#8-4-åœ¨-URL-ä¸­ä¼ é€’å‚æ•°" class="headerlink" title="8.4 åœ¨ URL ä¸­ä¼ é€’å‚æ•°"></a>8.4 åœ¨ URL ä¸­ä¼ é€’å‚æ•°</h3><blockquote><ul><li>åœ¨æ™®é€šæ ¼å¼çš„ URL ä¸­ä¼ é€’å‚æ•°<ul><li><code>&lt;a th:href=&quot;@&#123;/show?id=1&amp;name=zhangsan&#125;&quot;&gt;æ™®é€š URL æ ¼å¼ä¼ å‚&lt;/a&gt;</code></li><li><code>&lt;a th:href=&quot;@&#123;/show(id=1,name=zhangsan)&#125;&quot;&gt;æ™®é€š URL æ ¼å¼ä¼ å‚&lt;/a&gt;</code></li><li><code>&lt;a th:href=&quot;@&#123;&#39;/show?id=&#39;+$&#123;id&#125;+&#39;&amp;name=&#39;+$&#123;name&#125;&#125;&quot;&gt;æ™®é€šURLæ ¼å¼ä¼ å‚&lt;/a&gt;</code><br><font color = red>è¦æ³¨æ„çš„æ˜¯ï¼Œæ™®é€šurlæ ¼å¼ä¼ å‚ä¸ä»¥å¾€çš„ä¸åŒï¼Œéœ€è¦æŠŠå›ºå®šçš„éƒ¨åˆ†ç”¨â€™â€™æ‹¼æ¥èµ·æ¥</font></li><li><code>&lt;a th:href=&quot;@&#123;/show(id=$&#123;id&#125;,name=$&#123;name&#125;)&#125;&quot;&gt;æ™®é€š URL æ ¼å¼ä¼ å‚&lt;/a&gt;</code></li></ul></li><li>åœ¨ restful æ ¼å¼çš„ URL ä¸­ä¼ é€’å‚æ•°<ul><li><code>&lt;a th:href=&quot;@&#123;/show/&#123;id&#125;(id=1)&#125;&quot;&gt;restful æ ¼å¼ä¼ å‚&lt;/a&gt;</code></li><li><code>&lt;a th:href=&quot;@&#123;/show/&#123;id&#125;/&#123;name&#125;(id=1,name=admin)&#125;&quot;&gt;restfulæ ¼å¼ä¼ å‚&lt;/a&gt;</code><br><font color = red>ä»¥ä¸‹ä¸¤ç§æ–¹æ³•å¯ä»¥å°†restfulé£æ ¼å’Œæ™®é€šçš„ä¼ å‚é£æ ¼ç»“åˆèµ·æ¥</font></li><li><code>&lt;a th:href=&quot;@&#123;/show/&#123;id&#125;(id=1,name=admin)&#125;&quot;&gt;restful æ ¼å¼ä¼ å‚&lt;/a&gt;</code></li><li><code>&lt;a th:href=&quot;@&#123;/show/&#123;id&#125;(id=$&#123;id&#125;,name=$&#123;name&#125;)&#125;&quot;&gt;restfulæ ¼å¼ä¼ å‚&lt;/a&gt;</code></li></ul></li></ul></blockquote><h2 id="9-åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®-Thymeleaf"><a href="#9-åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®-Thymeleaf" class="headerlink" title="9.åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½® Thymeleaf"></a>9.åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½® Thymeleaf</h2><blockquote><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">>spring.thymeleaf.prefix</span><span class="token punctuation">=</span><span class="token attr-value">classpath:/templates/suibian/  #å¦‚æœhtmlè¢«æ”¾åœ¨å…¶ä»–æ–‡ä»¶å¤¹ä¸‹ï¼Œå¯ä»¥ä¿®æ”¹é»˜è®¤çš„è·¯å¾„å‰ç¼€</span><span class="token attr-name">>spring.thymeleaf.suffix</span><span class="token punctuation">=</span><span class="token attr-value">.html   #é»˜è®¤åç¼€æ˜¯htmlï¼Œæ‰€ä»¥controllerå±‚çš„returnåé¢ä¸éœ€è¦åŠ .html</span><span class="token attr-name">>spring.thymeleaf.mode</span><span class="token punctuation">=</span><span class="token attr-value">HTML #é…ç½®è§†å›¾æ¨¡æ¿ç±»å‹ï¼Œå¦‚æœè§†å›¾æ¨¡æ¿ä½¿ç”¨çš„</span><span class="token attr-name">>æ˜¯</span> <span class="token attr-value">html5 éœ€è¦é…ç½®</span><span class="token attr-name">>spring.thymeleaf.encoding</span><span class="token punctuation">=</span><span class="token attr-value">utf-8</span><span class="token attr-name">>spring.thymeleaf.servlet.content-type</span><span class="token punctuation">=</span><span class="token attr-value">text/html #å“åº”ç±»å‹</span>>#é…ç½®é¡µé¢ç¼“å­˜<span class="token attr-name">>spring.thymeleaf.cache</span><span class="token punctuation">=</span><span class="token attr-value">false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaWeb </tag>
            
            <tag> Web </tag>
            
            <tag> Thymeleaf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Bootæ•´åˆè§†å›¾å±‚æŠ€æœ¯</title>
      <link href="2020/04/25/spring-boot-zheng-he-shi-tu-ceng-ji-zhu/"/>
      <url>2020/04/25/spring-boot-zheng-he-shi-tu-ceng-ji-zhu/</url>
      
        <content type="html"><![CDATA[<h1 id="Spring-Boot-æ•´åˆè§†å›¾å±‚"><a href="#Spring-Boot-æ•´åˆè§†å›¾å±‚" class="headerlink" title="Spring Boot æ•´åˆè§†å›¾å±‚"></a>Spring Boot æ•´åˆè§†å›¾å±‚</h1><h2 id="Spring-Boot-æ•´åˆ-JSP-æŠ€æœ¯"><a href="#Spring-Boot-æ•´åˆ-JSP-æŠ€æœ¯" class="headerlink" title="Spring Boot æ•´åˆ JSP æŠ€æœ¯"></a>Spring Boot æ•´åˆ JSP æŠ€æœ¯</h2><h3 id="1-ä¿®æ”¹-POM-æ–‡ä»¶ï¼Œæ·»åŠ -JSP-å¼•æ“ä¸-JSTL-æ ‡ç­¾åº“"><a href="#1-ä¿®æ”¹-POM-æ–‡ä»¶ï¼Œæ·»åŠ -JSP-å¼•æ“ä¸-JSTL-æ ‡ç­¾åº“" class="headerlink" title="1.ä¿®æ”¹ POM æ–‡ä»¶ï¼Œæ·»åŠ  JSP å¼•æ“ä¸ JSTL æ ‡ç­¾åº“"></a>1.ä¿®æ”¹ POM æ–‡ä»¶ï¼Œæ·»åŠ  JSP å¼•æ“ä¸ JSTL æ ‡ç­¾åº“</h3><blockquote><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">><span class="token comment">&lt;!--æ·»åŠ  jsp å¼•æ“ï¼ŒSpringBoot å†…ç½®çš„ Tomat ä¸­æ²¡æœ‰æ­¤ä¾èµ–--></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.tomcat.embed<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>tomcat-embed-jasper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>><span class="token comment">&lt;!--æ·»åŠ  JSTL åæ ‡ä¾èµ–--></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jstl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h3 id="2-åˆ›å»º-webapp-ç›®å½•"><a href="#2-åˆ›å»º-webapp-ç›®å½•" class="headerlink" title="2.åˆ›å»º webapp ç›®å½•"></a>2.åˆ›å»º webapp ç›®å½•</h3><blockquote><p><img src="https://s1.ax1x.com/2020/04/25/Js4E1e.png" alt="Js4E1e.png"></p></blockquote><h3 id="3-æ ‡è®°ä¸º-web-ç›®å½•"><a href="#3-æ ‡è®°ä¸º-web-ç›®å½•" class="headerlink" title="3.æ ‡è®°ä¸º web ç›®å½•"></a>3.æ ‡è®°ä¸º web ç›®å½•</h3><blockquote><p>æ‰“å¼€Project Structureï¼ŒModulesï¼Œé€‰æ‹©ä½ è¦æ”¹çš„é¡¹ç›®ä¸‹çš„Webï¼Œåœ¨å³è¾¹Web Sourceä¸­ç‚¹å‡»+å·ï¼Œæ‰¾åˆ°é¡¹ç›®ä¸­çš„webappç¡®å®šå°±å¯ã€‚<br><img src="https://s1.ax1x.com/2020/04/25/Js5PDs.png" alt="Js5PDs.png"></p></blockquote><h3 id="4-åˆ›å»º-JSP"><a href="#4-åˆ›å»º-JSP" class="headerlink" title="4.åˆ›å»º JSP"></a>4.åˆ›å»º JSP</h3><h3 id="5-ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œé…ç½®è§†å›¾è§£æå™¨"><a href="#5-ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œé…ç½®è§†å›¾è§£æå™¨" class="headerlink" title="5.ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œé…ç½®è§†å›¾è§£æå™¨"></a>5.ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œé…ç½®è§†å›¾è§£æå™¨</h3><blockquote><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">>spring.mvc.view.prefix</span><span class="token punctuation">=</span><span class="token attr-value">/WEB-INF/jsp/</span><span class="token attr-name">>spring.mvc.view.suffix</span><span class="token punctuation">=</span><span class="token attr-value">.jsp</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></blockquote><h3 id="6-åˆ›å»º-Controller"><a href="#6-åˆ›å»º-Controller" class="headerlink" title="6.åˆ›å»º Controller"></a>6.åˆ›å»º Controller</h3><blockquote><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&gt;@Controller&gt;public class PageController &#123;&gt;&#x2F;**&gt;* é¡µé¢è·³è½¬&gt;*&#x2F;@GetMapping(&quot;&#x2F;&#123;page&#125;&quot;)public String showPage(@PathVariable String page)&#123;return page;&#125;&gt;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å¦‚æœåœ¨ IDEA ä¸­é¡¹ç›®ç»“æ„ä¸ºèšåˆå·¥ç¨‹ã€‚é‚£ä¹ˆåœ¨è¿è¡Œ jsp æ˜¯éœ€è¦æŒ‡å®šè·¯å¾„ã€‚å¦‚æœé¡¹ç›®ç»“æ„ä¸ºç‹¬ç«‹é¡¹ç›®åˆ™ä¸éœ€è¦ã€‚</strong><br><img src="https://s1.ax1x.com/2020/04/25/JsI9JK.png" alt="JsI9JK.png"></p></blockquote><h2 id="Spring-Boot-æ•´åˆ-Freemarker"><a href="#Spring-Boot-æ•´åˆ-Freemarker" class="headerlink" title="Spring Boot æ•´åˆ Freemarker"></a>Spring Boot æ•´åˆ Freemarker</h2><h3 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1.ç®€ä»‹"></a>1.ç®€ä»‹</h3><blockquote><p>FreeMarker æ˜¯ä¸€æ¬¾ æ¨¡æ¿å¼•æ“ï¼š å³ä¸€ç§åŸºäºæ¨¡æ¿å’Œè¦æ”¹å˜çš„æ•°æ®ï¼Œ å¹¶ç”¨æ¥ç”Ÿæˆè¾“å‡ºæ–‡æœ¬(HTMLç½‘é¡µï¼Œç”µå­é‚®ä»¶ï¼Œé…ç½®æ–‡ä»¶ï¼Œæºä»£ç ç­‰)çš„é€šç”¨å·¥å…·ã€‚ å®ƒä¸æ˜¯é¢å‘æœ€ç»ˆç”¨æˆ·çš„ï¼Œè€Œæ˜¯ä¸€ä¸ªJavaç±»åº“ï¼Œæ˜¯ä¸€æ¬¾ç¨‹åºå‘˜å¯ä»¥åµŒå…¥ä»–ä»¬æ‰€å¼€å‘äº§å“çš„ç»„ä»¶ã€‚<br>æ¨¡æ¿ç¼–å†™ä¸ºFreeMarker Template Language (FTL)ã€‚å®ƒæ˜¯ç®€å•çš„ï¼Œä¸“ç”¨çš„è¯­è¨€ï¼Œ ä¸æ˜¯ åƒPHPé‚£æ ·æˆç†Ÿçš„ç¼–ç¨‹è¯­è¨€ã€‚ é‚£å°±æ„å‘³ç€è¦å‡†å¤‡æ•°æ®åœ¨çœŸå®ç¼–ç¨‹è¯­è¨€ä¸­æ¥æ˜¾ç¤ºï¼Œæ¯”å¦‚æ•°æ®åº“æŸ¥è¯¢å’Œä¸šåŠ¡è¿ç®—ï¼Œ ä¹‹åæ¨¡æ¿æ˜¾ç¤ºå·²ç»å‡†å¤‡å¥½çš„æ•°æ®ã€‚åœ¨æ¨¡æ¿ä¸­ï¼Œä½ å¯ä»¥ä¸“æ³¨äºå¦‚ä½•å±•ç°æ•°æ®ï¼Œ è€Œåœ¨æ¨¡æ¿ä¹‹å¤–å¯ä»¥ä¸“æ³¨äºè¦å±•ç¤ºä»€ä¹ˆæ•°æ®ã€‚</p></blockquote><h3 id="2-ä¿®æ”¹-POM-æ–‡ä»¶ï¼Œæ·»åŠ -Freemarker-å¯åŠ¨å™¨"><a href="#2-ä¿®æ”¹-POM-æ–‡ä»¶ï¼Œæ·»åŠ -Freemarker-å¯åŠ¨å™¨" class="headerlink" title="2.ä¿®æ”¹ POM æ–‡ä»¶ï¼Œæ·»åŠ  Freemarker å¯åŠ¨å™¨"></a>2.ä¿®æ”¹ POM æ–‡ä»¶ï¼Œæ·»åŠ  Freemarker å¯åŠ¨å™¨</h3><blockquote><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">><span class="token comment">&lt;!--Freemarker å¯åŠ¨å™¨ä¾èµ–--></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-freemarker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h3 id="3-ä¿®æ”¹é…ç½®æ–‡ä»¶æ·»åŠ åç¼€"><a href="#3-ä¿®æ”¹é…ç½®æ–‡ä»¶æ·»åŠ åç¼€" class="headerlink" title="3. ä¿®æ”¹é…ç½®æ–‡ä»¶æ·»åŠ åç¼€"></a>3. ä¿®æ”¹é…ç½®æ–‡ä»¶æ·»åŠ åç¼€</h3><blockquote><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">>spring.freemarker.suffix</span><span class="token punctuation">=</span><span class="token attr-value">.ftl</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><h2 id="Spring-Boot-æ•´åˆ-Thymeleaf"><a href="#Spring-Boot-æ•´åˆ-Thymeleaf" class="headerlink" title="Spring Boot æ•´åˆ Thymeleaf"></a>Spring Boot æ•´åˆ Thymeleaf</h2><h3 id="1-ç®€ä»‹-1"><a href="#1-ç®€ä»‹-1" class="headerlink" title="1.ç®€ä»‹"></a>1.ç®€ä»‹</h3><blockquote><p>Thymeleaf çš„ä¸»è¦ç›®æ ‡æ˜¯å°†ä¼˜é›…çš„è‡ªç„¶æ¨¡æ¿å¸¦åˆ°å¼€å‘å·¥ä½œæµç¨‹ä¸­ï¼Œå¹¶å°† HTML åœ¨æµè§ˆå™¨ä¸­æ­£ç¡®æ˜¾ç¤ºï¼Œå¹¶ä¸”å¯ä»¥ä½œä¸ºé™æ€åŸå‹ï¼Œè®©å¼€å‘å›¢é˜Ÿèƒ½æ›´å®¹æ˜“åœ°åä½œã€‚Thymeleaf èƒ½å¤Ÿå¤„ç†HTMLï¼ŒXMLï¼ŒJavaScriptï¼ŒCSS ç”šè‡³çº¯æ–‡æœ¬ã€‚<br>é•¿æœŸä»¥æ¥,jsp åœ¨è§†å›¾é¢†åŸŸæœ‰éå¸¸é‡è¦çš„åœ°ä½,éšç€æ—¶é—´çš„å˜è¿,å‡ºç°äº†ä¸€ä½æ–°çš„æŒ‘æˆ˜è€…:Thymeleaf,Thymeleaf æ˜¯åŸç”Ÿçš„,ä¸ä¾èµ–äºæ ‡ç­¾åº“.å®ƒèƒ½å¤Ÿåœ¨æ¥å—åŸå§‹ HTML çš„åœ°æ–¹è¿›è¡Œç¼–è¾‘å’Œæ¸²æŸ“.å› ä¸ºå®ƒæ²¡æœ‰ä¸Serveletè§„èŒƒè€¦åˆ,å› æ­¤Thymeleafæ¨¡æ¿èƒ½è¿›å…¥jspæ‰€æ— æ³•æ¶‰è¶³çš„é¢†åŸŸã€‚</p></blockquote><h3 id="2-ä¿®æ”¹-POM-æ–‡ä»¶ï¼Œæ·»åŠ -Thymeleaf-å¯åŠ¨å™¨ä¾èµ–"><a href="#2-ä¿®æ”¹-POM-æ–‡ä»¶ï¼Œæ·»åŠ -Thymeleaf-å¯åŠ¨å™¨ä¾èµ–" class="headerlink" title="2.ä¿®æ”¹ POM æ–‡ä»¶ï¼Œæ·»åŠ  Thymeleaf å¯åŠ¨å™¨ä¾èµ–"></a>2.ä¿®æ”¹ POM æ–‡ä»¶ï¼Œæ·»åŠ  Thymeleaf å¯åŠ¨å™¨ä¾èµ–</h3><blockquote><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">><span class="token comment">&lt;!--æ·»åŠ  Thymeleaf å¯åŠ¨å™¨ä¾èµ–--></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-thymeleaf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ç”±äºThymeleafæ˜¯ç”¨äºé¡µé¢æ¸²æŸ“çš„ï¼Œæˆ‘ä»¬ä¸å¯èƒ½è®©åˆ«äººè®¿é—®æˆ‘ä»¬è¿˜æœªç”¨æ•°æ®æ¸²æŸ“çš„é¡µé¢ï¼Œæ‰€ä»¥åœ¨åœ°å€æ ä¸­ä¸èƒ½ç›´æ¥è¾“å…¥xxx.htmlè®¿é—®ï¼Œåªèƒ½é€šè¿‡controllerå±‚è¿›è¡Œè·³è½¬</strong></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaWeb </tag>
            
            <tag> Spring Boot </tag>
            
            <tag> Javaæ¡†æ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>springbootè®¿é—®é™æ€èµ„æº</title>
      <link href="2020/04/23/springboot-fang-wen-jing-tai-zi-yuan/"/>
      <url>2020/04/23/springboot-fang-wen-jing-tai-zi-yuan/</url>
      
        <content type="html"><![CDATA[<h1 id="SpringBootè®¿é—®é™æ€èµ„æº"><a href="#SpringBootè®¿é—®é™æ€èµ„æº" class="headerlink" title="SpringBootè®¿é—®é™æ€èµ„æº"></a>SpringBootè®¿é—®é™æ€èµ„æº</h1><blockquote><p>åœ¨ SpringBoot é¡¹ç›®ä¸­æ²¡æœ‰æˆ‘ä»¬ä¹‹å‰å¸¸è§„ web å¼€å‘çš„ WebContentï¼ˆWebAppï¼‰ï¼Œå®ƒåªæœ‰src ç›®å½•ã€‚åœ¨ src/main/resources ä¸‹é¢æœ‰ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œ<code>static</code> å’Œ<code> templates</code>ã€‚SpringBoot é»˜è®¤åœ¨<code> static</code>ç›®å½•ä¸­å­˜æ”¾é™æ€é¡µé¢ï¼Œè€Œ <code>templates</code> ä¸­æ”¾åŠ¨æ€é¡µé¢ã€‚</p></blockquote><h2 id="1-ä»‹ç»"><a href="#1-ä»‹ç»" class="headerlink" title="1.ä»‹ç»"></a>1.ä»‹ç»</h2><h3 id="static-ç›®å½•"><a href="#static-ç›®å½•" class="headerlink" title="static ç›®å½•"></a>static ç›®å½•</h3><blockquote><p>Spring Boot é€šè¿‡<code> classpath/static</code> ç›®å½•è®¿é—®é™æ€èµ„æºã€‚æ³¨æ„å­˜æ”¾é™æ€èµ„æºçš„ç›®å½•åç§°å¿…é¡»æ˜¯ <code>static</code>æˆ–è€…<code>public</code>,<code>resources</code></p></blockquote><h3 id="templates-ç›®å½•"><a href="#templates-ç›®å½•" class="headerlink" title="templates ç›®å½•"></a>templates ç›®å½•</h3><blockquote><p>åœ¨ Spring Boot ä¸­ä¸æ¨èä½¿ç”¨ jsp ä½œä¸ºè§†å›¾å±‚æŠ€æœ¯ï¼Œè€Œæ˜¯é»˜è®¤ä½¿ç”¨ <code>Thymeleaf </code>æ¥åšåŠ¨æ€é¡µé¢ã€‚Templates ç›®å½•è¿™æ˜¯å­˜æ”¾<code>Thymeleaf</code>çš„é¡µé¢ã€‚</p></blockquote><h2 id="2-é™æ€èµ„æºå­˜æ”¾å…¶ä»–ä½ç½®"><a href="#2-é™æ€èµ„æºå­˜æ”¾å…¶ä»–ä½ç½®" class="headerlink" title="2.é™æ€èµ„æºå­˜æ”¾å…¶ä»–ä½ç½®"></a>2.é™æ€èµ„æºå­˜æ”¾å…¶ä»–ä½ç½®</h2><h3 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h3><p><img src="https://s1.ax1x.com/2020/06/26/NsvOzR.png" alt="WebMvcAutoConfiguration"><br>ç¬¬ä¸€ä¸ªæ¡†æ¡†æ˜¯åˆ¤æ–­ç”¨æˆ·æœ‰æ²¡æœ‰è‡ªå®šä¹‰é™æ€èµ„æºè·¯å¾„ï¼Œå¦‚æœè‡ªå®šä¹‰äº†å°±ç›´æ¥è¿”å›ï¼Œä¸ç»§ç»­å¾€ä¸‹èµ°äº†</p><p><code>/webjars/**</code>æ˜¯ä¸€ç§ä»¥mavenå¼•å…¥çš„é™æ€èµ„æºï¼Œæ¯”å¦‚jquery</p><p>åœ¨mavenä¸­æ·»åŠ åæ ‡</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.webjars<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jquery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.5.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†çœ‹é¡¹ç›®ç›®å½•å¯ä»¥å‘ç°ä»–ä»¬çš„å…³ç³»<br><img src="https://s1.ax1x.com/2020/06/27/Ny4Jxg.png" alt="Ny4Jxg.png"></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> staticPathPattern <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mvcProperties<span class="token punctuation">.</span><span class="token function">getStaticPathPattern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è°ƒç”¨æ–¹æ³•è·å¾—staticPathPatternï¼Œå¦‚ä¸‹<br><img src="https://s1.ax1x.com/2020/06/26/Nsxmef.png" alt="Nsxmef.png"><br>è¿”å›<br><img src="https://s1.ax1x.com/2020/06/26/NsxMFg.png" alt="NsxMFg.png"></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> CLASSPATH_RESOURCE_LOCATIONS <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"classpath:/META-INF/resources/"</span><span class="token punctuation">,</span><span class="token string">"classpath:/resources/"</span><span class="token punctuation">,</span> <span class="token string">"classpath:/static/"</span><span class="token punctuation">,</span> <span class="token string">"classpath:/public/"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ä¸ºä»€ä¹ˆspringbootçš„è®¿é—®é™æ€èµ„æºçš„ä½ç½®æ˜¯è¿™å‡ ä¸ªäº†<br><img src="https://s1.ax1x.com/2020/06/26/NsxJO0.png" alt="NsxJO0.png"></p><h3 id="Spring-Boot-è®¿é—®é™æ€èµ„æºçš„ä½ç½®"><a href="#Spring-Boot-è®¿é—®é™æ€èµ„æºçš„ä½ç½®" class="headerlink" title="Spring Boot è®¿é—®é™æ€èµ„æºçš„ä½ç½®"></a>Spring Boot è®¿é—®é™æ€èµ„æºçš„ä½ç½®</h3><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">classpath</span><span class="token punctuation">:</span><span class="token attr-value">/METAâ€INF/resources/  # ä¸€èˆ¬æ˜¯webjars</span><span class="token attr-name">classpath</span><span class="token punctuation">:</span><span class="token attr-value">/resources/</span><span class="token attr-name">classpath</span><span class="token punctuation">:</span><span class="token attr-value">/static/</span><span class="token attr-name">classpath</span><span class="token punctuation">:</span><span class="token attr-value">/public/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä¼˜å…ˆçº§</strong>ï¼šresources&gt;static(é»˜è®¤)&gt;public</p><h3 id="è‡ªå®šä¹‰é™æ€èµ„æºä½ç½®"><a href="#è‡ªå®šä¹‰é™æ€èµ„æºä½ç½®" class="headerlink" title="è‡ªå®šä¹‰é™æ€èµ„æºä½ç½®"></a>è‡ªå®šä¹‰é™æ€èµ„æºä½ç½®</h3><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment">#é…ç½®é™æ€èµ„æºè®¿é—®è·¯å¾„</span><span class="token attr-name">spring.resources.static-locations</span><span class="token punctuation">=</span><span class="token attr-value">classpath:/suibian/,lasspath:/static/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="SpringBootæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½"><a href="#SpringBootæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½" class="headerlink" title="SpringBootæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½"></a>SpringBootæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½</h1><h2 id="ä¸Šä¼ ç•Œé¢"><a href="#ä¸Šä¼ ç•Œé¢" class="headerlink" title="ä¸Šä¼ ç•Œé¢"></a>ä¸Šä¼ ç•Œé¢</h2><p>ä¸Šä¼ éœ€è¦ä¸€ä¸ªè¡¨å•ï¼Œæœ€é‡è¦çš„ç‰¹ç‚¹æ˜¯å¿…é¡»æ˜¯postè¯·æ±‚ï¼Œä¸”<code>enctype=&quot;multipart/form-data&quot;</code></p><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">&lt;form action&#x3D;&quot;&#x2F;fileUploadController&quot; method&#x3D;&quot;post&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ç¼–å†™-Controller"><a href="#ç¼–å†™-Controller" class="headerlink" title="ç¼–å†™ Controller"></a>ç¼–å†™ Controller</h2><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¦å§<code>MultipartFile name</code>ä½œä¸ºå‚æ•°ä¼ å…¥æ–¹æ³•ä¸­</p><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">@PostMapping(&quot;&#x2F;fileUploadController&quot;)public String fileUpload(MultipartFile file)throws Exception&#123;&#x2F;&#x2F;è¾“å‡ºæ–‡ä»¶çš„çœŸå®åç§°System.out.println(file.getOriginalFilename());&#x2F;&#x2F;è¿™ä¸€æ­¥æ˜¯æŠŠæ–‡ä»¶ä¿å­˜åˆ°æŸä¸ªä½ç½®file.transferTo(new File(&quot;c:&#x2F;&quot;+file.getOriginalFilename()));return &quot;OK&quot;;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ä¿®æ”¹æ–‡ä»¶ä¸Šä¼ å¤§å°"><a href="#ä¿®æ”¹æ–‡ä»¶ä¸Šä¼ å¤§å°" class="headerlink" title="ä¿®æ”¹æ–‡ä»¶ä¸Šä¼ å¤§å°"></a>ä¿®æ”¹æ–‡ä»¶ä¸Šä¼ å¤§å°</h2><p>é»˜è®¤é™åˆ¶äº†ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œæˆ‘ä»¬åº”è¯¥å»é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ä»–</p><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment">#é…ç½®å•ä¸ªä¸Šä¼ æ–‡ä»¶çš„å¤§å°çš„é™åˆ¶</span><span class="token attr-name">spring.servlet.multipart.max-file-size</span><span class="token punctuation">=</span><span class="token attr-value">2MB</span><span class="token comment">#é…ç½®åœ¨ä¸€æ¬¡è¯·æ±‚ä¸­ä¸Šä¼ æ–‡ä»¶çš„æ€»å®¹é‡çš„é™åˆ¶</span><span class="token attr-name">spring.servlet.multipart.max-request-size</span><span class="token punctuation">=</span><span class="token attr-value">20MB</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="JSR303æ•°æ®æ ¡éªŒ"><a href="#JSR303æ•°æ®æ ¡éªŒ" class="headerlink" title="JSR303æ•°æ®æ ¡éªŒ"></a>JSR303æ•°æ®æ ¡éªŒ</h1><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>controllerå±‚åŠ ä¸€ä¸ª<code>@Validated </code>è¿›è¡Œæ•°æ®æ ¡éªŒ</p><h2 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h2><p>JSR-303 æ˜¯JAVA EE 6 ä¸­çš„ä¸€é¡¹å­è§„èŒƒï¼Œå«åšBean Validationï¼ŒHibernate Validator æ˜¯ Bean Validation çš„å‚è€ƒå®ç° . Hibernate Validator æä¾›äº† JSR 303 è§„èŒƒä¸­æ‰€æœ‰å†…ç½® constraint çš„å®ç°ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€äº›é™„åŠ çš„ constraintã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/3145530-8ae74d19e6c65b4c?imageMogr2/auto-orient/strip%7CimageView2/2/w/654/format/webp" alt="JSR303"></p><p> Hibernate Validator é™„åŠ çš„ constraintï¼š<br> <img src="https://upload-images.jianshu.io/upload_images/3145530-10035c6af8e90a7c?imageMogr2/auto-orient/strip%7CimageView2/2/w/432/format/webp" alt="é™„åŠ "></p>]]></content>
      
      
      <categories>
          
          <category> æ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaWeb </tag>
            
            <tag> Spring Boot </tag>
            
            <tag> Javaæ¡†æ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>springbootæ ¸å¿ƒæ³¨è§£</title>
      <link href="2020/04/23/springboot-he-xin-zhu-jie/"/>
      <url>2020/04/23/springboot-he-xin-zhu-jie/</url>
      
        <content type="html"><![CDATA[<h1 id="SpringBootæ ¸å¿ƒæ³¨è§£"><a href="#SpringBootæ ¸å¿ƒæ³¨è§£" class="headerlink" title="SpringBootæ ¸å¿ƒæ³¨è§£"></a>SpringBootæ ¸å¿ƒæ³¨è§£</h1><h2 id="SpringBootApplication"><a href="#SpringBootApplication" class="headerlink" title="@SpringBootApplication"></a>@SpringBootApplication</h2><blockquote><p>æ˜¯ SpringBoot çš„å¯åŠ¨ç±»ã€‚æ­¤æ³¨è§£ç­‰åŒäº@Configuration+@EnableAutoConfiguration+@ComponentScan çš„ç»„åˆ</p></blockquote><h2 id="SpringBootConfiguration"><a href="#SpringBootConfiguration" class="headerlink" title="@SpringBootConfiguration"></a>@SpringBootConfiguration</h2><blockquote><p>@SpringBootConfiguration æ³¨è§£æ˜¯@Configuration æ³¨è§£çš„æ´¾ç”Ÿæ³¨è§£ï¼Œè·Ÿ@Configurationæ³¨è§£çš„åŠŸèƒ½ä¸€è‡´ï¼Œæ ‡æ³¨è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œåªä¸è¿‡@SpringBootConfiguration æ˜¯ springbootçš„æ³¨è§£ï¼Œè€Œ@Configuration æ˜¯ spring çš„æ³¨è§£</p></blockquote><h2 id="Configuration"><a href="#Configuration" class="headerlink" title="@Configuration"></a>@Configuration</h2><blockquote><p>é€šè¿‡å¯¹ bean å¯¹è±¡çš„æ“ä½œæ›¿ä»£ spring ä¸­ xml æ–‡ä»¶</p></blockquote><h2 id="EnableAutoConfiguration"><a href="#EnableAutoConfiguration" class="headerlink" title="@EnableAutoConfiguration"></a>@EnableAutoConfiguration</h2><blockquote><p>Spring Boot è‡ªåŠ¨é…ç½®ï¼ˆauto-configurationï¼‰ï¼šå°è¯•æ ¹æ®ä½ æ·»åŠ çš„ jar ä¾èµ–è‡ªåŠ¨é…ç½®ä½ çš„Spring åº”ç”¨ã€‚æ˜¯@AutoConfigurationPackage å’Œ@Import(AutoConfigurationImportSelector.class)æ³¨è§£çš„ç»„åˆã€‚</p></blockquote><h2 id="AutoConfigurationPackage"><a href="#AutoConfigurationPackage" class="headerlink" title="@AutoConfigurationPackage"></a>@AutoConfigurationPackage</h2><blockquote><p>@AutoConfigurationPackage æ³¨è§£ï¼Œè‡ªåŠ¨æ³¨å…¥ä¸»ç±»ä¸‹æ‰€åœ¨åŒ…ä¸‹æ‰€æœ‰çš„åŠ äº†æ³¨è§£çš„ç±»(@Controllerï¼Œ@Service ç­‰ï¼‰ï¼Œä»¥åŠé…ç½®ç±»ï¼ˆ@Configurationï¼‰</p></blockquote><h2 id="Import-AutoConfigurationImportSelector-class"><a href="#Import-AutoConfigurationImportSelector-class" class="headerlink" title="@Import({AutoConfigurationImportSelector.class})"></a>@Import({AutoConfigurationImportSelector.class})</h2><blockquote><p>ç›´æ¥å¯¼å…¥æ™®é€šçš„ç±»<br>å¯¼å…¥å®ç°äº† ImportSelector æ¥å£çš„ç±»<br>å¯¼å…¥å®ç°äº† ImportBeanDefinitionRegistrar æ¥å£çš„ç±»</p></blockquote><h2 id="ComponentScan"><a href="#ComponentScan" class="headerlink" title="@ComponentScan"></a>@ComponentScan</h2><blockquote><p>ç»„ä»¶æ‰«æï¼Œå¯è‡ªåŠ¨å‘ç°å’Œè£…é…ä¸€äº› Beanã€‚</p></blockquote><h2 id="ConfigurationPropertiesScan"><a href="#ConfigurationPropertiesScan" class="headerlink" title="@ConfigurationPropertiesScan"></a>@ConfigurationPropertiesScan</h2><blockquote><p>@ConfigurationPropertiesScan æ‰«æé…ç½®å±æ€§ã€‚@EnableConfigurationProperties æ³¨è§£çš„ä½œç”¨æ˜¯ä½¿ç”¨ @ConfigurationProperties æ³¨è§£çš„ç±»ç”Ÿæ•ˆã€‚</p></blockquote><h2 id="RestController"><a href="#RestController" class="headerlink" title="@RestController"></a>@RestController</h2><blockquote><p>@RestController ç›¸å½“äº@Controller+@ResponseBody æ³¨è§£<br>å¦‚æœä½¿ç”¨@RestControlleræ³¨è§£ Controller ä¸­çš„æ–¹æ³•æ— æ³•è¿”å›é¡µé¢ï¼Œç›¸å½“äºåœ¨æ–¹æ³•ä¸Šé¢è‡ªåŠ¨ åŠ  äº† @ResponseBody æ³¨ è§£ ï¼Œ æ‰€ ä»¥ <font color=red>æ²¡ åŠ æ³• è·³ è½¬ å¹¶ ä¼  è¾“ æ•° æ® åˆ° å¦ ä¸€ ä¸ª é¡µ é¢ </font>ï¼Œ æ‰€ ä»¥InternalResourceViewResolver ä¹Ÿä¸èµ·ä½œç”¨ï¼Œè¿”å›çš„å†…å®¹å°±æ˜¯ Return é‡Œçš„å†…å®¹ã€‚</p></blockquote><h3 id="GetMapping"><a href="#GetMapping" class="headerlink" title="@GetMapping"></a>@GetMapping</h3><blockquote><p>@GetMapping æ³¨è§£æ˜¯@RequestMapping(method = RequestMethod.GET)çš„ç¼©å†™ã€‚</p></blockquote><h3 id="PostMapping"><a href="#PostMapping" class="headerlink" title="@PostMapping"></a>@PostMapping</h3><blockquote><p>@PostMapping æ³¨è§£æ˜¯@RequestMapping(method = RequestMethod.POST)çš„ç¼©å†™ã€‚</p></blockquote><h3 id="PutMapping"><a href="#PutMapping" class="headerlink" title="@PutMapping"></a>@PutMapping</h3><blockquote><p>@PutMapping æ³¨è§£æ˜¯@RequestMapping(method = RequestMethod.PUT)çš„ç¼©å†™ã€‚</p></blockquote><h3 id="DeleteMapping"><a href="#DeleteMapping" class="headerlink" title="@DeleteMapping"></a>@DeleteMapping</h3><blockquote><p>@DeleteMapping æ³¨è§£æ˜¯@RequestMapping(method = RequestMethod.DELETE)çš„ç¼©å†™</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaWeb </tag>
            
            <tag> Spring Boot </tag>
            
            <tag> Javaæ¡†æ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>springbootç®€ä»‹å’Œæ¡†æ¶æ­å»º</title>
      <link href="2020/04/22/springboot-jian-jie-he-kuang-jia-da-jian/"/>
      <url>2020/04/22/springboot-jian-jie-he-kuang-jia-da-jian/</url>
      
        <content type="html"><![CDATA[<h1 id="Spring-Boot"><a href="#Spring-Boot" class="headerlink" title="Spring Boot"></a>Spring Boot</h1><h2 id="ä¸€ã€ç®€ä»‹"><a href="#ä¸€ã€ç®€ä»‹" class="headerlink" title="ä¸€ã€ç®€ä»‹"></a>ä¸€ã€ç®€ä»‹</h2><h3 id="1-ä»€ä¹ˆæ˜¯-Spring-Boot"><a href="#1-ä»€ä¹ˆæ˜¯-Spring-Boot" class="headerlink" title="1 ä»€ä¹ˆæ˜¯ Spring Boot"></a>1 ä»€ä¹ˆæ˜¯ Spring Boot</h3><blockquote><p>Spring Boot makes it easy to create stand-alone, production-grade Spring based Applications that you can â€œjust runâ€.<br>We take an opinionated view of the Spring platform and third-party libraries so you can get started with minimum fuss. Most Spring Boot applications need minimal Spring configuration.</p><p>Spring Boot æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œä¸€ç§å…¨æ–°çš„ç¼–ç¨‹è§„èŒƒï¼Œä»–çš„äº§ç”Ÿç®€åŒ–äº†æ¡†æ¶çš„ä½¿ç”¨ï¼Œæ‰€è°“ç®€åŒ–æ˜¯æŒ‡ç®€åŒ–äº† Spring ä¼—å¤šæ¡†æ¶ä¸­æ‰€éœ€çš„å¤§é‡ä¸”ç¹ççš„é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥ Spring Boot æ˜¯ä¸€ä¸ªæœåŠ¡äºæ¡†æ¶çš„æ¡†æ¶ï¼ŒæœåŠ¡èŒƒå›´æ˜¯ç®€åŒ–é…ç½®æ–‡ä»¶ã€‚æ‰€ä»¥ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼ŒSpring Boot å…¶å®å°±æ˜¯ Springæ¡†æ¶çš„å¦ä¸€ç§è¡¨ç°å½¢å¼ã€‚</p></blockquote><h3 id="2-Spring-Boot-ç‰¹å¾"><a href="#2-Spring-Boot-ç‰¹å¾" class="headerlink" title="2 Spring Boot ç‰¹å¾"></a>2 Spring Boot ç‰¹å¾</h3><ul><li><p>ä½¿ç”¨ Spring Boot å¯ä»¥åˆ›å»ºç‹¬ç«‹çš„ Spring åº”ç”¨ç¨‹åº</p></li><li><p>åœ¨Spring Bootä¸­ç›´æ¥åµŒå…¥äº†Tomcatã€Jettyã€Undertowç­‰Webå®¹å™¨ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨SpringBooåš Web å¼€å‘æ—¶ä¸éœ€è¦éƒ¨ç½² WAR æ–‡ä»¶</p></li><li><p>é€šè¿‡æä¾›è‡ªå·±çš„å¯åŠ¨å™¨(Starter)ä¾èµ–ï¼Œç®€åŒ–é¡¹ç›®æ„å»ºé…ç½®</p></li><li><p>å°½é‡çš„è‡ªåŠ¨é…ç½® Spring å’Œç¬¬ä¸‰æ–¹åº“</p></li><li><p>æä¾›äº†ç”Ÿäº§å°±ç»ªç‰¹å¾ï¼Œå¦‚ï¼šåº¦é‡æŒ‡æ ‡ï¼Œè¿è¡ŒçŠ¶å†µæ£€æŸ¥å’Œå¤–éƒ¨åŒ–é…ç½®</p></li><li><p>ç»å¯¹æ²¡æœ‰ä»£ç ç”Ÿæˆï¼Œä¹Ÿä¸éœ€è¦ XML é…ç½®æ–‡ä»¶</p><h3 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h3></li><li><p>Create stand-alone Spring applications</p></li><li><p>Embed Tomcat, Jetty or Undertow directly (no need to deploy WAR files)</p></li><li><p>Provide opinionated â€˜starterâ€™ dependencies to simplify your build configuration</p></li><li><p>Automatically configure Spring and 3rd party libraries whenever possible</p></li><li><p>Provide production-ready features such as metrics, health checks, and externalized configuration</p></li><li><p>Absolutely no code generation and no requirement for XML configuration</p></li></ul><h3 id="3-Spring-Boot-ç‰ˆæœ¬ä»‹ç»"><a href="#3-Spring-Boot-ç‰ˆæœ¬ä»‹ç»" class="headerlink" title="3 Spring Boot ç‰ˆæœ¬ä»‹ç»"></a>3 Spring Boot ç‰ˆæœ¬ä»‹ç»</h3><ul><li>SNAPSHOTï¼šå¿«ç…§ç‰ˆï¼Œå³å¼€å‘ç‰ˆã€‚</li><li>CURRENTï¼šæœ€æ–°ç‰ˆï¼Œä½†æ˜¯ä¸ä¸€å®šæ˜¯ç¨³å®šç‰ˆã€‚</li><li>GAï¼šGeneral Availabilityï¼Œæ­£å¼å‘å¸ƒçš„ç‰ˆæœ¬ã€‚</li></ul><p><a href="https://imgchr.com/i/JUkDVe"><img src="https://s1.ax1x.com/2020/04/22/JUkDVe.md.png" alt="JUkDVe.md.png"></a></p><h2 id="äºŒã€æ­å»ºspring-bootæ¡†æ¶é¡¹ç›®"><a href="#äºŒã€æ­å»ºspring-bootæ¡†æ¶é¡¹ç›®" class="headerlink" title="äºŒã€æ­å»ºspring bootæ¡†æ¶é¡¹ç›®"></a>äºŒã€æ­å»ºspring bootæ¡†æ¶é¡¹ç›®</h2><h3 id="1-é€šè¿‡å®˜ç½‘åˆ›å»ºé¡¹ç›®"><a href="#1-é€šè¿‡å®˜ç½‘åˆ›å»ºé¡¹ç›®" class="headerlink" title="1 é€šè¿‡å®˜ç½‘åˆ›å»ºé¡¹ç›®"></a>1 é€šè¿‡å®˜ç½‘åˆ›å»ºé¡¹ç›®</h3><blockquote><ul><li><a href="https://start.spring.io/">æˆ³è¿™é‡Œ</a>è¿›è¡Œç›¸å…³æ“ä½œ</li><li>é€‰æ‹©æ„å»ºMaven Project,å¡«å†™å¿…è¦çš„ä¿¡æ¯ï¼Œç„¶åé€‰æ‹©Generate Projectä¸‹è½½é¡¹ç›®ã€‚</li><li>å°†æˆ‘ä»¬ä¸‹è½½å¥½çš„zipè§£å‹ï¼Œå¯¼å…¥åˆ°IDEä¸­</li></ul></blockquote><h3 id="2-é€šè¿‡ideaè„šæ‰‹æ¶å·¥å…·åˆ›å»º"><a href="#2-é€šè¿‡ideaè„šæ‰‹æ¶å·¥å…·åˆ›å»º" class="headerlink" title="2 é€šè¿‡ideaè„šæ‰‹æ¶å·¥å…·åˆ›å»º"></a>2 é€šè¿‡ideaè„šæ‰‹æ¶å·¥å…·åˆ›å»º</h3><p><a href="https://imgchr.com/i/JUkjqU"><img src="https://s1.ax1x.com/2020/04/22/JUkjqU.md.png" alt="JUkjqU.md.png"></a></p><h3 id="3-å…ˆåˆ›å»ºmavené¡¹ç›®ï¼Œå†å¯¼å…¥ç›¸å…³çš„pomæ–‡ä»¶"><a href="#3-å…ˆåˆ›å»ºmavené¡¹ç›®ï¼Œå†å¯¼å…¥ç›¸å…³çš„pomæ–‡ä»¶" class="headerlink" title="3 å…ˆåˆ›å»ºmavené¡¹ç›®ï¼Œå†å¯¼å…¥ç›¸å…³çš„pomæ–‡ä»¶"></a>3 å…ˆåˆ›å»ºmavené¡¹ç›®ï¼Œå†å¯¼å…¥ç›¸å…³çš„pomæ–‡ä»¶</h3><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>ç‰ˆæœ¬.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">/></span></span> <span class="token comment">&lt;!-- lookup parent from repository --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">></span></span>javaç‰ˆæœ¬<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å¯¼å…¥webå¯åŠ¨å™¨--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å¯¼å…¥testå¯åŠ¨å™¨--></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.junit.vintage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>junit-vintage-engine<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--å¯¼å…¥springbootçš„mavenæ’ä»¶--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ä¸‰ã€Spring-Booté¡¹ç›®ç»“æ„ä»‹ç»"><a href="#ä¸‰ã€Spring-Booté¡¹ç›®ç»“æ„ä»‹ç»" class="headerlink" title="ä¸‰ã€Spring Booté¡¹ç›®ç»“æ„ä»‹ç»"></a>ä¸‰ã€Spring Booté¡¹ç›®ç»“æ„ä»‹ç»</h2><h3 id="1-POMæ–‡ä»¶ï¼š"><a href="#1-POMæ–‡ä»¶ï¼š" class="headerlink" title="1.POMæ–‡ä»¶ï¼š"></a>1.POMæ–‡ä»¶ï¼š</h3><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>ç‰ˆæœ¬å·.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">/></span></span> <span class="token comment">&lt;!-- lookup parent from repository --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Spring Boot çš„çˆ¶çº§ä¾èµ–ï¼Œåªæœ‰ç»§æ‰¿å®ƒé¡¹ç›®æ‰æ˜¯ Spring Boot é¡¹ç›®ã€‚<br>spring-boot-starter-parent æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ starterï¼Œå®ƒç”¨æ¥æä¾›ç›¸çš„ Maven é»˜è®¤ä¾èµ–ã€‚ä½¿<br>ç”¨å®ƒä¹‹åï¼Œå¸¸ç”¨çš„åŒ…ä¾èµ–å¯ä»¥çœå» version æ ‡ç­¾ã€‚</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¯åŠ¨å™¨ä¾èµ–</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>spring-boot-maven-plugin æ’ä»¶æ˜¯å°† springboot çš„åº”ç”¨ç¨‹åºæ‰“åŒ…æˆ jar åŒ…çš„æ’ä»¶ã€‚å°†æ‰€æœ‰åº”ç”¨å¯åŠ¨è¿è¡Œæ‰€éœ€è¦çš„ jar åŒ…éƒ½åŒ…å«è¿›æ¥ï¼Œä»é€»è¾‘ä¸Šå°†å…·å¤‡äº†ç‹¬ç«‹è¿è¡Œçš„æ¡ä»¶ã€‚å½“è¿è¡Œâ€mvn packageâ€è¿›è¡Œæ‰“åŒ…åï¼Œä½¿ç”¨â€java -jarâ€å‘½ä»¤å°±å¯ä»¥ç›´æ¥è¿è¡Œã€‚</p><h3 id="2-å¯åŠ¨ç±»ä¸å¯åŠ¨å™¨åŒºåˆ«ï¼š"><a href="#2-å¯åŠ¨ç±»ä¸å¯åŠ¨å™¨åŒºåˆ«ï¼š" class="headerlink" title="2.å¯åŠ¨ç±»ä¸å¯åŠ¨å™¨åŒºåˆ«ï¼š"></a>2.å¯åŠ¨ç±»ä¸å¯åŠ¨å™¨åŒºåˆ«ï¼š</h3><ul><li><p>å¯åŠ¨ç±»</p><pre class="line-numbers language-Java" data-language="Java"><code class="language-Java">@SpringBootApplicationpublic class SpringBootDemo3Application &#123;    public static void main(String[] args)&#123;    SpringApplication.run(SpringBootDemo3Application.class,args);    &#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>å¯åŠ¨å™¨</p><p>Spring Boot å°†æ‰€æœ‰çš„åŠŸèƒ½åœºæ™¯éƒ½æŠ½å–å‡ºæ¥ï¼Œåšæˆä¸€ä¸ªä¸ªçš„ starter(å¯åŠ¨å™¨)ï¼Œåªéœ€è¦åœ¨é¡¹ç›®é‡Œé¢å¼•å…¥è¿™äº› starter ç›¸å…³åœºæ™¯çš„æ‰€æœ‰ä¾èµ–éƒ½ä¼šå¯¼å…¥è¿›æ¥ï¼Œè¦ç”¨ä»€ä¹ˆåŠŸèƒ½å°±å¯¼å…¥ä»€ä¹ˆåœºæ™¯ï¼Œåœ¨ jar åŒ…ç®¡ç†ä¸Šéå¸¸æ–¹ä¾¿ï¼Œæœ€ç»ˆå®ç°ä¸€ç«™å¼å¼€å‘ã€‚<br><font color=green>Spring Boot æä¾›äº†å¤šè¾¾ 44 ä¸ªå¯åŠ¨å™¨ã€‚</font>è¯¦æƒ…çœ‹è¿™ç¯‡<a href="https://blog.csdn.net/qq_42614253/article/details/83592638">æ–‡ç« </a></p></li></ul><h3 id="3-é…ç½®æ–‡ä»¶"><a href="#3-é…ç½®æ–‡ä»¶" class="headerlink" title="3.é…ç½®æ–‡ä»¶"></a>3.é…ç½®æ–‡ä»¶</h3><p>Spring Boot æä¾›ä¸€ä¸ªåç§°ä¸º application çš„å…¨å±€é…ç½®æ–‡ä»¶ï¼Œæ”¯æŒä¸¤ç§æ ¼å¼ properteis æ ¼å¼ä¸ yaml(yml) æ ¼å¼ã€‚</p><ul><li><p>Properties æ ¼å¼<br>é…ç½® Tomcat ç›‘å¬ç«¯å£</p><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">server.port</span><span class="token punctuation">=</span><span class="token attr-value">8888</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>yamlæ ¼å¼(æ‹“å±•åå¯ä»¥æ˜¯yamlä¹Ÿå¯ä»¥æ˜¯yml)</p><ul><li><p>å¤§å°å†™æ•æ„Ÿ</p></li><li><p>ä½¿ç”¨ç¼©è¿›ä»£è¡¨å±‚çº§å…³ç³»</p></li><li><p>ç›¸åŒçš„éƒ¨åˆ†åªå‡ºç°ä¸€æ¬¡</p><p>é…ç½® Tomcat ç›‘å¬ç«¯å£</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span><span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8888</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ul></li><li><p>é…ç½®æ–‡ä»¶å­˜æ”¾ä½ç½®</p><ul><li>å½“å‰é¡¹ç›®æ ¹ç›®å½•ä¸­</li><li>å½“å‰é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ä¸€ä¸ª<code>/config</code> å­ç›®å½•ä¸­</li><li>é¡¹ç›®çš„ resources å³ classpath æ ¹è·¯å¾„ä¸­</li><li>é¡¹ç›®çš„ resources å³ classpath æ ¹è·¯å¾„ä¸‹çš„<code>/config</code> ç›®å½•ä¸­</li></ul></li><li><p>é…ç½®æ–‡ä»¶åŠ è½½é¡ºåº</p><ul><li>ä¸åŒæ ¼å¼çš„åŠ è½½é¡ºåº(ä¼˜å…ˆçº§)ï¼š<ul><li>å½“å‰é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ä¸€ä¸ª/config å­ç›®å½•ä¸­(æœ€é«˜)</li><li>å½“å‰é¡¹ç›®æ ¹ç›®å½•ä¸­(å…¶æ¬¡)</li><li>é¡¹ç›®çš„ resources å³ classpath æ ¹è·¯å¾„ä¸‹çš„/config ç›®å½•ä¸­(ä¸€èˆ¬)</li><li>é¡¹ç›®çš„ resources å³ classpath æ ¹è·¯å¾„ä¸­(æœ€å)</li></ul></li></ul></li></ul><h3 id="4-é…ç½®æ–‡ä»¶ä¸­çš„å ä½ç¬¦"><a href="#4-é…ç½®æ–‡ä»¶ä¸­çš„å ä½ç¬¦" class="headerlink" title="4.é…ç½®æ–‡ä»¶ä¸­çš„å ä½ç¬¦${}"></a>4.é…ç½®æ–‡ä»¶ä¸­çš„å ä½ç¬¦${}</h3><h4 id="4-1-ç®€ä»‹"><a href="#4-1-ç®€ä»‹" class="headerlink" title="4.1 ç®€ä»‹"></a>4.1 ç®€ä»‹</h4><p>è¯­æ³•ï¼š<code>$&#123;&#125;</code></p><ul><li><p>å ä½ç¬¦ä½œç”¨ï¼š</p><ul><li><code>$&#123;&#125;</code>ä¸­å¯ä»¥è·å–æ¡†æ¶æä¾›çš„æ–¹æ³•ä¸­çš„å€¼å¦‚ï¼šrandom.int ç­‰</li><li>å ä½ç¬¦å¯ä»¥è·å–é…ç½®æ–‡ä»¶ä¸­çš„é”®çš„å€¼èµ‹ç»™å¦ä¸€ä¸ªé”®ä½œä¸ºå€¼</li></ul></li><li><p>ç”Ÿæˆéšæœºæ•°</p></li></ul><table><thead><tr><th align="center">ä»£ç </th><th align="center">è§£é‡Š</th></tr></thead><tbody><tr><td align="center">${random.value}</td><td align="center">ç±»ä¼¼ uuid çš„éšæœºæ•°ï¼Œæ²¡æœ‰â€-â€œè¿æ¥</td></tr><tr><td align="center">${random.int}</td><td align="center">éšæœºå–æ•´å‹èŒƒå›´å†…çš„ä¸€ä¸ªå€¼</td></tr><tr><td align="center">${random.long}</td><td align="center">éšæœºå–é•¿æ•´å‹èŒƒå›´å†…çš„ä¸€ä¸ªå€¼</td></tr><tr><td align="center">${random.long(100,200)}</td><td align="center">éšæœºç”Ÿæˆé•¿æ•´å‹ 100-200 èŒƒå›´å†…çš„ä¸€ä¸ªå€¼</td></tr><tr><td align="center">${random.uuid}</td><td align="center">ç”Ÿæˆä¸€ä¸ª uuidï¼Œæœ‰çŸ­æ è¿æ¥</td></tr><tr><td align="center">${random.int(10)}</td><td align="center">éšæœºç”Ÿæˆä¸€ä¸ª 10 ä»¥å†…çš„æ•°</td></tr><tr><td align="center">${random.int(100,200)}</td><td align="center">éšæœºç”Ÿæˆä¸€ä¸ª 100-200 èŒƒå›´ä»¥å†…çš„æ•°</td></tr></tbody></table><h4 id="4-2-é…ç½®æ–‡ä»¶æ³¨å…¥å€¼"><a href="#4-2-é…ç½®æ–‡ä»¶æ³¨å…¥å€¼" class="headerlink" title="4.2 é…ç½®æ–‡ä»¶æ³¨å…¥å€¼"></a>4.2 é…ç½®æ–‡ä»¶æ³¨å…¥å€¼</h4><p> <strong>é…ç½®æ–‡ä»¶</strong></p><p> <img src="https://s1.ax1x.com/2020/06/26/NsbqGq.png" alt="yml"></p><p> <strong>javaå®ä½“ç±»</strong><br> <img src="https://s1.ax1x.com/2020/06/26/NsHNjS.png" alt="pojo"></p><p> <strong>javaå®ä½“ç±»è·å–é…ç½®æ–‡ä»¶ä¸­çš„å€¼çš„ä¸¤ç§å½¢å¼</strong></p><ul><li>è‡ªåŠ¨æ³¨å…¥applicationé…ç½®æ–‡ä»¶<ul><li>æ·»åŠ æ³¨è§£<code>@ConfigurationProperties(prefix = &quot;xxx&quot;)</code></li><li>springbootä¼šè‡ªåŠ¨å°†åå­—ç›¸åŒçš„å±æ€§æ³¨å…¥è¿›å»<br>  <img src="https://s1.ax1x.com/2020/06/26/NsLi7Q.png" alt="è¿è¡Œæ•ˆæœå›¾"></li><li><strong>å¦‚æœé…ç½®æ–‡ä»¶ä¸­å­˜åœ¨å®ä½“ç±»ä¸­æ²¡æœ‰çš„å±æ€§ï¼Œæˆ–è€…å®ä½“ç±»ä¸­å­˜åœ¨é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰çš„å±æ€§ï¼Œéƒ½ä¼šè®¾ç½®ä¸ºnull</strong></li></ul></li><li>æŒ‡å®šè¦æ³¨å…¥çš„é…ç½®æ–‡ä»¶<ul><li>æ·»åŠ æ³¨è§£<code>@PropertySource(value = &quot;xxx&quot;)</code>ï¼Œè¿™ä¸ªæ³¨è§£ä¸ä¼šè‡ªåŠ¨æ³¨å…¥</li><li>åœ¨å¯¹åº”çš„ä½ç½®åˆ›å»ºä¸Šé…ç½®æ–‡ä»¶ï¼Œå†™å…¥å†…å®¹</li><li>åœ¨å®ä½“ç±»ä¸­ç”¨<code>@Value()</code>å’Œelè¡¨è¾¾å¼è·å–å€¼<br>  <img src="https://s1.ax1x.com/2020/06/26/NsXmeU.png" alt="è¿è¡Œå›¾"></li></ul></li></ul><h3 id="5-bootstrap-é…ç½®æ–‡ä»¶"><a href="#5-bootstrap-é…ç½®æ–‡ä»¶" class="headerlink" title="5.bootstrap é…ç½®æ–‡ä»¶"></a>5.bootstrap é…ç½®æ–‡ä»¶</h3><ul><li>bootstrap é…ç½®æ–‡ä»¶ä»‹ç»ï¼š<br>Spring Boot ä¸­æœ‰ä¸¤ç§ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œä¸€ç§æ˜¯ bootstrap, å¦å¤–ä¸€ç§æ˜¯ pplication, bootstrap<br>æ˜¯åº”ç”¨ç¨‹åºçš„çˆ¶ä¸Šä¸‹æ–‡ï¼Œä¹Ÿå°±æ˜¯è¯´ bootstrap åŠ è½½ä¼˜å…ˆäº applicatonã€‚bootstrap ä¸»è¦ç”¨äºä»<br>é¢å¤–çš„èµ„æºæ¥åŠ è½½é…ç½®ä¿¡æ¯ï¼Œè¿˜å¯ä»¥åœ¨æœ¬åœ°å¤–éƒ¨é…ç½®æ–‡ä»¶ä¸­è§£å¯†å±æ€§ã€‚è¿™ä¸¤ä¸ªä¸Šä¸‹æ–‡å…±ç”¨ä¸€<br>ä¸ªç¯å¢ƒï¼Œå®ƒæ˜¯ä»»ä½• Spring åº”ç”¨ç¨‹åºçš„å¤–éƒ¨å±æ€§çš„æ¥æºã€‚bootstrap é‡Œé¢çš„å±æ€§ä¼šä¼˜å…ˆåŠ è½½ï¼Œ<br>å®ƒä»¬é»˜è®¤ä¹Ÿä¸èƒ½è¢«æœ¬åœ°ç›¸åŒé…ç½®è¦†ç›–ã€‚</li><li>bootstrap é…ç½®æ–‡ä»¶ç‰¹å¾<ul><li>boostrap ç”±çˆ¶ ApplicationContext åŠ è½½ï¼Œæ¯” applicaton ä¼˜å…ˆåŠ è½½ã€‚</li><li>boostrap é‡Œé¢çš„å±æ€§ä¸èƒ½è¢«è¦†ç›–ã€‚</li></ul></li><li>bootstrap ä¸ application çš„åº”ç”¨åœºæ™¯<ul><li>application é…ç½®æ–‡ä»¶ä¸»è¦ç”¨äº Spring Boot é¡¹ç›®çš„è‡ªåŠ¨åŒ–é…ç½®ã€‚</li><li>bootstrap é…ç½®æ–‡ä»¶æœ‰ä»¥ä¸‹å‡ ä¸ªåº”ç”¨åœºæ™¯ã€‚<ul><li>ä½¿ç”¨ Spring Cloud Config é…ç½®ä¸­å¿ƒæ—¶ï¼Œè¿™æ—¶éœ€è¦åœ¨ bootstrap é…ç½®æ–‡ä»¶ä¸­æ·»åŠ è¿æ¥åˆ°é…ç½®ä¸­å¿ƒçš„é…ç½®å±æ€§æ¥åŠ è½½å¤–éƒ¨é…ç½®ä¸­å¿ƒçš„é…ç½®ä¿¡æ¯ã€‚</li><li>ä¸€äº›å›ºå®šçš„ä¸èƒ½è¢«è¦†ç›–çš„å±æ€§ã€‚</li><li>ä¸€äº›åŠ å¯†/è§£å¯†çš„åœºæ™¯ã€‚</li></ul></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ¡†æ¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaWeb </tag>
            
            <tag> Spring Boot </tag>
            
            <tag> Javaæ¡†æ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®åº“çš„èŒƒå¼</title>
      <link href="2020/04/21/shu-ju-ku-de-fan-shi/"/>
      <url>2020/04/21/shu-ju-ku-de-fan-shi/</url>
      
        <content type="html"><![CDATA[<blockquote><h6 id="èŒƒå¼æ˜¯å…³ç³»æ•°æ®åº“å…³ç³»æ¨¡å¼è§„èŒƒåŒ–çš„æ ‡å‡†ï¼Œä»è§„èŒƒåŒ–çš„å®½æ¾åˆ°ä¸¥æ ¼ï¼Œåˆ†ä¸ºä¸åŒçš„èŒƒå¼ï¼Œé€šå¸¸ä½¿ç”¨çš„æœ‰ç¬¬ä¸€èŒƒå¼ã€‚ç¬¬äºŒèŒƒå¼ã€ç¬¬ä¸‰èŒƒå¼åŠBCèŒƒå¼ã€‚èŒƒå¼æ˜¯å»ºç«‹åœ¨å‡½æ•°ä¾èµ–åŸºç¡€ä¸Šçš„ã€‚"><a href="#èŒƒå¼æ˜¯å…³ç³»æ•°æ®åº“å…³ç³»æ¨¡å¼è§„èŒƒåŒ–çš„æ ‡å‡†ï¼Œä»è§„èŒƒåŒ–çš„å®½æ¾åˆ°ä¸¥æ ¼ï¼Œåˆ†ä¸ºä¸åŒçš„èŒƒå¼ï¼Œé€šå¸¸ä½¿ç”¨çš„æœ‰ç¬¬ä¸€èŒƒå¼ã€‚ç¬¬äºŒèŒƒå¼ã€ç¬¬ä¸‰èŒƒå¼åŠBCèŒƒå¼ã€‚èŒƒå¼æ˜¯å»ºç«‹åœ¨å‡½æ•°ä¾èµ–åŸºç¡€ä¸Šçš„ã€‚" class="headerlink" title="èŒƒå¼æ˜¯å…³ç³»æ•°æ®åº“å…³ç³»æ¨¡å¼è§„èŒƒåŒ–çš„æ ‡å‡†ï¼Œä»è§„èŒƒåŒ–çš„å®½æ¾åˆ°ä¸¥æ ¼ï¼Œåˆ†ä¸ºä¸åŒçš„èŒƒå¼ï¼Œé€šå¸¸ä½¿ç”¨çš„æœ‰ç¬¬ä¸€èŒƒå¼ã€‚ç¬¬äºŒèŒƒå¼ã€ç¬¬ä¸‰èŒƒå¼åŠBCèŒƒå¼ã€‚èŒƒå¼æ˜¯å»ºç«‹åœ¨å‡½æ•°ä¾èµ–åŸºç¡€ä¸Šçš„ã€‚"></a>èŒƒå¼æ˜¯å…³ç³»æ•°æ®åº“å…³ç³»æ¨¡å¼è§„èŒƒåŒ–çš„æ ‡å‡†ï¼Œä»è§„èŒƒåŒ–çš„å®½æ¾åˆ°ä¸¥æ ¼ï¼Œåˆ†ä¸ºä¸åŒçš„èŒƒå¼ï¼Œé€šå¸¸ä½¿ç”¨çš„æœ‰ç¬¬ä¸€èŒƒå¼ã€‚ç¬¬äºŒèŒƒå¼ã€ç¬¬ä¸‰èŒƒå¼åŠBCèŒƒå¼ã€‚èŒƒå¼æ˜¯å»ºç«‹åœ¨å‡½æ•°ä¾èµ–åŸºç¡€ä¸Šçš„ã€‚</h6><h1 id="å‡½æ•°ä¾èµ–"><a href="#å‡½æ•°ä¾èµ–" class="headerlink" title="å‡½æ•°ä¾èµ–"></a>å‡½æ•°ä¾èµ–</h1><p>å¦‚æœä¸€ä¸ªè¡¨ä¸­æŸä¸€ä¸ªå­—æ®µYçš„å€¼æ˜¯ç”±å¦å¤–ä¸€ä¸ªå­—æ®µæˆ–ä¸€ç»„å­—æ®µXçš„å€¼æ¥ç¡®å®šçš„ï¼Œå°±ç§°ä¸ºYå‡½æ•°ä¾èµ–äºXã€‚</p></blockquote><h1 id="å‡½æ•°ä¾èµ–-1"><a href="#å‡½æ•°ä¾èµ–-1" class="headerlink" title="å‡½æ•°ä¾èµ–"></a>å‡½æ•°ä¾èµ–</h1><blockquote><p>é¦–å…ˆè¦ç†æ¸…ç›¸å…³çš„ä¾èµ–å…³ç³»</p><p>1.å®Œå…¨å‡½æ•°ä¾èµ–</p><p>è®¾X,Yæ˜¯å…³ç³»Rçš„ä¸¤ä¸ªå±æ€§é›†åˆï¼ŒXâ€™æ˜¯Xçš„çœŸå­é›†ï¼Œå­˜åœ¨Xâ†’Yï¼Œä½†å¯¹æ¯ä¸€ä¸ªXâ€™éƒ½æœ‰Xâ€™!â†’Yï¼Œåˆ™ç§°Yå®Œå…¨å‡½æ•°ä¾èµ–äºXã€‚</p><p>ä¾‹ï¼šæˆç»©è¡¨ï¼ˆå­¦å·ï¼Œè¯¾ç¨‹å·ï¼Œæˆç»©ï¼‰å…³ç³»ä¸­ï¼Œ</p><p>å®Œå…¨å‡½æ•°ä¾èµ–ï¼šï¼ˆå­¦å·ï¼Œè¯¾ç¨‹å·ï¼‰â†’ æˆç»©ï¼Œå­¦å· ï¼\â†’ æˆç»©ï¼Œè¯¾ç¨‹å· ï¼\â†’ æˆç»©ï¼Œæ‰€ä»¥ï¼ˆå­¦å·ï¼Œè¯¾ç¨‹å·ï¼‰â†’ æˆç»© æ˜¯å®Œå…¨å‡½æ•°ä¾èµ–ã€‚</p><p>2.éƒ¨åˆ†å‡½æ•°ä¾èµ–</p><p>è®¾X,Yæ˜¯å…³ç³»Rçš„ä¸¤ä¸ªå±æ€§é›†åˆï¼Œå­˜åœ¨Xâ†’Yï¼Œè‹¥Xâ€™æ˜¯Xçš„çœŸå­é›†ï¼Œå­˜åœ¨Xâ€™â†’Yï¼Œåˆ™ç§°Yéƒ¨åˆ†å‡½æ•°ä¾èµ–äºXã€‚</p><p>ä¾‹ï¼šå­¦ç”Ÿè¡¨ï¼ˆå­¦å·ï¼Œå§“åï¼Œæ€§åˆ«ï¼Œç­çº§ï¼Œå¹´é¾„ï¼‰å…³ç³»ä¸­ï¼Œ</p><p>éƒ¨åˆ†å‡½æ•°ä¾èµ–ï¼šï¼ˆå­¦å·ï¼Œå§“åï¼‰â†’ æ€§åˆ«ï¼Œå­¦å· â†’ æ€§åˆ«ï¼Œæ‰€ä»¥ï¼ˆå­¦å·ï¼Œå§“åï¼‰â†’ æ€§åˆ« æ˜¯éƒ¨åˆ†å‡½æ•°ä¾èµ–ã€‚</p><p>3.ä¼ é€’å‡½æ•°ä¾èµ–</p><p>è®¾X,Y,Zæ˜¯å…³ç³»Rä¸­äº’ä¸ç›¸åŒçš„å±æ€§é›†åˆï¼Œå­˜åœ¨Xâ†’Y(Y !â†’X),Yâ†’Zï¼Œåˆ™ç§°Zä¼ é€’å‡½æ•°ä¾èµ–äºXã€‚</p><p>ä¾‹ï¼šå…³ç³»S1ï¼ˆå­¦å·ï¼Œç³»åï¼Œç³»ä¸»ä»»ï¼‰ï¼Œ</p><p>å­¦å· â†’ ç³»åï¼Œç³»å â†’ ç³»ä¸»ä»»ï¼Œå¹¶ä¸”ç³»å ï¼\â†’ å­¦å·ï¼Œç³»ä¸»ä»» ï¼\â†’ ç³»åï¼Œæ‰€ä»¥å­¦å· â†’ ç³»ä¸»ä»»ä¸ºä¼ é€’å‡½æ•°ä¾èµ–ã€‚</p></blockquote><h2 id="èŒƒå¼ç®€ä»‹"><a href="#èŒƒå¼ç®€ä»‹" class="headerlink" title="èŒƒå¼ç®€ä»‹"></a>èŒƒå¼ç®€ä»‹</h2><blockquote><p>å…³ç³»æ•°æ®åº“æœ‰å…­ç§ï¼Œä¸€ã€äºŒã€ä¸‰ã€å››ã€äº”å’ŒBCã€‚æ»¡è¶³æœ€ä½è¦æ±‚çš„èŒƒå¼æ˜¯ç¬¬ä¸€èŒƒå¼ã€‚åœ¨ç¬¬ä¸€èŒƒå¼çš„åŸºç¡€ä¸Šè¿›ä¸€æ­¥æ»¡è¶³æ›´å¤šè¦æ±‚çš„ç§°ä¸ºç¬¬äºŒèŒƒå¼ï¼Œå…¶ä½™èŒƒå¼ä»¥æ­¤ç±»æ¨ã€‚ä¸€èˆ¬æƒ…å†µçš„æ•°æ®åº“åªéœ€æ»¡è¶³ç¬¬ä¸‰èŒƒå¼å³å¯ã€‚</p></blockquote><h2 id="1NF"><a href="#1NF" class="headerlink" title="1NF"></a>1NF</h2><blockquote><p>å¦‚æœå…³ç³»æ¨¡å¼Ræ˜¯ç¬¬ä¸€èŒƒå¼çš„æ¨¡å¼ï¼Œé‚£ä¹ˆï¼ŒRçš„æ¯ä¸€ä¸ªå…³ç³»rçš„å±æ€§éƒ½æ˜¯åŸå­é¡¹ï¼Œä¸å¯åˆ†å‰²ã€‚</p><p><a href="https://imgchr.com/i/Y8oaPe"><img src="https://s1.ax1x.com/2020/05/11/Y8oaPe.png" alt="img"></a></p><p>1NFæ˜¯å…³ç³»æ¨¡å¼åº”å…·å¤‡çš„æœ€èµ·ç çš„æ¡ä»¶ï¼Œå¦‚æœæ•°æ®åº“è®¾è®¡ä¸èƒ½æ»¡è¶³ç¬¬ä¸€èŒƒå¼ï¼Œå°±ä¸èƒ½ç§°ä¸ºå…³ç³»å‹æ•°æ®åº“ã€‚å…³ç³»æ•°æ®åº“è®¾è®¡ç ”ç©¶çš„å…³ç³»è§„èŒƒåŒ–æ˜¯åœ¨1NFä¹‹ä¸Šè¿›è¡Œçš„ã€‚</p></blockquote><h2 id="2NF"><a href="#2NF" class="headerlink" title="2NF"></a>2NF</h2><blockquote><p>å¦‚æœå…³ç³»æ¨¡å¼Ræ˜¯1NFï¼Œä¸”æ¯ä¸€ä¸ªéä¸»å±æ€§å®Œå…¨ä¾èµ–äºå€™é€‰å»ºï¼Œé‚£ä¹ˆå°±ç§°Ræ˜¯ç¬¬äºŒèŒƒå¼ã€‚</p><p>ç¬¬äºŒèŒƒå¼è¦æ»¡è¶³çš„æ¡ä»¶ï¼šé¦–å…ˆè¦æ»¡è¶³ç¬¬ä¸€èŒƒå¼ï¼Œå…¶æ¬¡æ¯ä¸€ä¸ªéä¸»å±æ€§è¦å®Œå…¨å‡½æ•°ä¾èµ–äºå€™é€‰é”®ï¼Œæˆ–è€…æ˜¯ä¸»é”®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªéä¸»å±æ€§æ˜¯ç”±æ•´ä¸ªä¸»é”®å‡½æ•°å†³å®šçš„ï¼Œè€Œä¸èƒ½æœ‰ä¸»é”®çš„ä¸€éƒ¨åˆ†æ¥å†³å®šã€‚</p><p>ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰ï¼šç¬¦åˆ1NFï¼Œå¹¶ä¸”ï¼Œéä¸»å±æ€§å®Œå…¨ä¾èµ–äºç ã€‚ï¼ˆä¸€ä¸ªå€™é€‰ç ä¸­çš„ä¸»å±æ€§ä¹Ÿå¯èƒ½æ˜¯å¥½å‡ ä¸ªã€‚å¦‚æœä¸€ä¸ªä¸»å±æ€§ï¼Œå®ƒä¸èƒ½å•ç‹¬åšä¸ºä¸€ä¸ªå€™é€‰ç ï¼Œé‚£ä¹ˆå®ƒä¹Ÿä¸èƒ½ç¡®å®šä»»ä½•ä¸€ä¸ªéä¸»å±æ€§ã€‚</p><p>ä»€ä¹ˆæ ·çš„å®ä¾‹ä¸ç¬¦åˆç¬¬äºŒèŒƒå¼ï¼Ÿ</p><p>ä¸¾ä¸€ä¸ªæ•™åŠ¡ç®¡ç†ç³»ç»Ÿçš„ä¾‹å­ã€‚</p><p>å­¦ç”Ÿä¸Šè¯¾æŒ‡å®šä¸€ä¸ªè€å¸ˆï¼Œä¸€æœ¬æ•™æï¼Œä¸€ä¸ªæ•™å®¤ï¼Œä¸€ä¸ªæ—¶é—´ï¼Œå­¦ç”Ÿå»ä¸Šè¯¾ï¼Œæ€ä¹ˆè®¾è®¡æ•°æ®åº“ï¼Ÿ</p><p><a href="https://imgchr.com/i/Y8od8H"><img src="https://s1.ax1x.com/2020/05/11/Y8od8H.png" alt="img"></a></p><p>æœ‰å¦‚ä¸‹å…³ç³»æˆç«‹ï¼š</p><p>ï¼ˆå­¦ç”Ÿï¼Œè¯¾ç¨‹ï¼‰â€”â€”&gt;æ•™å®¤ï¼›</p><p>ï¼ˆå­¦ç”Ÿï¼Œè¯¾ç¨‹ï¼‰â€”â€”&gt;è€å¸ˆï¼›</p><p>ï¼ˆå­¦ç”Ÿï¼Œè¯¾ç¨‹ï¼‰â€”â€”&gt;è€å¸ˆèŒç§°ï¼›</p><p>ï¼ˆå­¦ç”Ÿï¼Œè¯¾ç¨‹ï¼‰â€”â€”&gt;æ•™æï¼›</p><p>ï¼ˆå­¦ç”Ÿï¼Œè¯¾ç¨‹ï¼‰â€”â€”&gt;ä¸Šè¯¾æ—¶é—´ï¼›</p><p>å¯ä»¥å¾—å‡ºï¼ˆå­¦ç”Ÿï¼Œè¯¾ç¨‹ï¼‰æ˜¯ä¸€ä¸ªç ã€‚</p><p>åˆï¼šè¯¾ç¨‹â€”â€”&gt;æ•™æï¼›</p><ul><li>ï¼ˆå­¦ç”Ÿï¼Œè¯¾ç¨‹ï¼‰æ˜¯ä¸€ä¸ªç ï¼Œè¯¾ç¨‹å´å†³å®šäº†æ•™æï¼Œè¿™å°±å«åšä¸å®Œå…¨ä¾èµ–ï¼Œæˆ–è€…è¯´éƒ¨åˆ†ä¾èµ–ã€‚</li></ul><p> å‡ºç°äº†è¿™ç§æƒ…å†µï¼Œå°±ä¸æ»¡è¶³ç¬¬äºŒèŒƒå¼äº†ã€‚</p><p>è§£å†³åŠæ³•ï¼šåˆ†è§£ã€‚è¿›è¡ŒæŠ•å½±åˆ†è§£ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/11/Y8ow2d.png" alt="img"></p></blockquote><h2 id="3NF"><a href="#3NF" class="headerlink" title="3NF"></a>3NF</h2><blockquote><p>å¦‚æœå…³ç³»æ¨¡å¼Ræ˜¯2NFï¼Œä¸”å…³ç³»æ¨¡å¼Rï¼ˆU,Fï¼‰ä¸­çš„æ‰€æœ‰éä¸»å±æ€§å¯¹ä»»ä½•å€™é€‰å…³é”®å­—éƒ½ä¸å­˜åœ¨ä¼ é€’ä¾èµ–ï¼Œåˆ™ç§°å…³ç³»Ræ˜¯å±äºç¬¬ä¸‰èŒƒå¼ã€‚</p><p>ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰ï¼›ç¬¦åˆ2NFï¼Œå¹¶ä¸”ï¼Œæ¶ˆé™¤ä¼ é€’ä¾èµ–ã€‚</p><p>ä¸Šå›¾ä¸­ç¬¦åˆ2NF ï¼Œä½†å­˜åœ¨ä¼ é€’ä¾èµ–ï¼ˆè€å¸ˆâ€”â€”&gt;è€å¸ˆèŒç§°ã€‚ä¸€ä¸ªè€å¸ˆä¸€å®šèƒ½ç¡®å®šä¸€ä¸ªè€å¸ˆèŒç§°ï¼‰ã€‚</p><p>è§£å†³åŠæ³•ï¼šåˆ†è§£ã€‚æŠ•å½±åˆ†è§£ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/11/Y8o0xA.png" alt="img"></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®åº“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxåŸºç¡€æŒ‡ä»¤</title>
      <link href="2020/04/19/linux-ji-chu-zhi-ling/"/>
      <url>2020/04/19/linux-ji-chu-zhi-ling/</url>
      
        <content type="html"><![CDATA[<h1 id="Linuxå­¦ä¹ "><a href="#Linuxå­¦ä¹ " class="headerlink" title="Linuxå­¦ä¹ "></a>Linuxå­¦ä¹ </h1><h2 id="å¸¸ç”¨æŒ‡ä»¤"><a href="#å¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="å¸¸ç”¨æŒ‡ä»¤"></a>å¸¸ç”¨æŒ‡ä»¤</h2><ul><li><code>cd</code> è¿›å…¥è·¯å¾„æŒ‡ä»¤  <code>cd /local/user</code> è¡¨ç¤ºè¿›å…¥/local/useræ–‡ä»¶å¤¹ä¸­</li><li><code>pwd</code> æ˜¾ç¤ºå½“å‰æ‰€åœ¨çš„è·¯å¾„</li><li><code>ll</code> åˆ—å‡ºè¯¥æ–‡ä»¶ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¿¡æ¯ï¼ŒåŒ…æ‹¬éšè—çš„æ–‡ä»¶</li><li><code>ls -l</code>  åªåˆ—å‡ºæ˜¾å¼æ–‡ä»¶ï¼Œ<code>ls -a</code>æŸ¥çœ‹æ‰€æœ‰å†…å®¹åŒ…æ‹¬éšè—æ–‡ä»¶</li><li><code>clear</code> æ¸…ç©ºæ¸…å±</li><li><code>touch</code> åˆ›å»ºç©ºç™½æ–‡ä»¶ï¼Œä¸éœ€è¦åç¼€<br><img src="https://s1.ax1x.com/2020/06/19/NuasjP.png" alt="touchåˆ›å»ºæ–‡ä»¶"></li><li><code>cat</code> æŸ¥çœ‹æ–‡ä»¶å…¨éƒ¨å†…å®¹ï¼Œ<code>cat /local/user/a</code>ï¼Œè¡¨ç¤ºæŸ¥çœ‹/local/user/ä¸‹çš„aæ–‡ä»¶çš„æ‰€æœ‰å†…å®¹</li><li><code>more</code> åˆ†å±æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</li><li><code>ctrl+c</code> å¼ºåˆ¶é€€å‡º</li><li><code>tab</code> å½“ä½ ä¹¦å†™ä¸€ä¸²æŒ‡ä»¤çš„æ—¶å€™å¯ä»¥ç”¨tabè‡ªåŠ¨è¡¥å…¨ï¼Œå¦‚æœæ–‡ä»¶ä¸­æœ‰çš„è¯</li><li><code>head</code> æ˜¾ç¤ºæ–‡ä»¶çš„å‰å¤šå°‘è¡Œï¼Œé»˜è®¤10è¡Œ,å¦‚æœä¸å¤Ÿ10è¡Œä¼šç”¨å›è½¦è¡¥å……ï¼Œé€šè¿‡<code>head -number æ–‡ä»¶å</code>æ§åˆ¶<br><img src="https://s1.ax1x.com/2020/06/19/NuwXlR.png" alt="NuwXlR.png"></li><li><code>tail</code> æ˜¾ç¤ºæ–‡ä»¶æœ«å°¾å¤šå°‘è¡Œï¼Œé»˜è®¤10è¡Œï¼Œæ ¼å¼åŒä¸Š</li><li><code>mkdir</code> åˆ›å»ºç›®å½•ï¼Œæ ¼å¼ä¸º<code>mkdir [è·¯å¾„] ç›®å½•å</code><ul><li>åˆ›å»ºå¤šçº§ç›®å½•éœ€è¦æŒ‡ä»¤ -p<br><img src="https://s1.ax1x.com/2020/06/19/Nu07ut.png" alt="Nu07ut.png"></li></ul></li><li><code>cp</code> å¤åˆ¶<ul><li>å¤åˆ¶æ–‡ä»¶<ul><li><code>cp æ–‡ä»¶å æ–°æ–‡ä»¶å</code></li><li><code>cp ç›®å½•å/æ–‡ä»¶å æ–‡ä»¶å/[æ–°æ–‡ä»¶å]</code></li></ul></li><li>å¤åˆ¶ç›®å½•<ul><li><code>cp -r ç›®å½•å æ–°ç›®å½•å</code></li></ul></li></ul></li><li><code>rm</code> åˆ é™¤<ul><li><code>rm [ç›®å½•å] æ–‡ä»¶å</code> åˆ é™¤æ–‡ä»¶</li><li><code>rm -r [ç›®å½•å]</code> åˆ é™¤ç›®å½•</li><li>å¦å¤–ï¼Œ-fæ˜¯å¼ºåˆ¶åˆ é™¤çš„æ„æ€ï¼Œæœ‰æ—¶å€™ä¼šç”¨åˆ° <code>rm -r -f [ç›®å½•å]</code></li></ul></li><li><code>mv</code> ç§»åŠ¨(å‰ªåˆ‡)ï¼Œ<code>mv æ–‡ä»¶å æ–°è·¯å¾„</code></li><li><code>vi/vim</code> ä¸¤è€…éƒ½æ˜¯ç¼–è¾‘æ–‡ä»¶ï¼Œvimæ˜¯å­—æ¯é«˜äº®ã€‚è¿›å…¥æ–‡ä»¶ä»¥åçš„æ“ä½œ<ul><li><code>a</code> è¿½åŠ æ–¹å¼è¿›å…¥ç¼–è¾‘æ¨¡å¼</li><li><code>i</code> åœ¨å…‰æ ‡æ‰€åœ¨ä½ç½®å¤„æ’å…¥</li><li><code>o</code> åœ¨ä¸‹ä¸€è¡Œè¿›å…¥ç¼–è¾‘æ¨¡å¼</li><li><code>O</code> åœ¨ä¸Šä¸€è¡Œè¿›å…¥ç¼–è¾‘æ¨¡å¼</li><li><code>dd</code> åˆ é™¤å½“å‰è¡Œ</li><li><code>:wq</code> ä¿å­˜å¹¶é€€å‡º</li><li><code>:q!</code> å¼ºåˆ¶é€€å‡º</li><li><code>set nu</code> è®¾ç½®è¡Œå·</li><li><code>/keywords</code> æœç´¢å…³é”®å­—</li><li><code>G</code> è®©å…‰æ ‡ç§»åŠ¨åˆ°æ–‡ä»¶æœ«å°¾</li><li><code>gg</code> è¿”å›æ–‡ä»¶é¡¶éƒ¨</li></ul></li><li><code>reboot</code> é‡å¯Linuxç³»ç»Ÿ</li><li><code>halt</code> å…³é—­æ­£åœ¨è¿è¡Œçš„Linuxæ“ä½œç³»ç»Ÿ</li><li><code>yum install xxx</code> å¸¸ç”¨çš„ä¸‹è½½èµ„æºæŒ‡ä»¤<h2 id="Linuxæ—¶åŒºè®¾ç½®"><a href="#Linuxæ—¶åŒºè®¾ç½®" class="headerlink" title="Linuxæ—¶åŒºè®¾ç½®"></a>Linuxæ—¶åŒºè®¾ç½®</h2></li><li><code>date</code> æŸ¥çœ‹ç³»ç»Ÿæ—¶é—´</li><li><code>tzselect</code> å¯ä»¥é€‰æ‹©æ—¶åŒºï¼Œå›½å†…ä¸€èˆ¬é€‰æ‹©shanghai</li><li>æœ€åæŠŠè·å–åˆ°çš„æ—¶åŒºä¿¡æ¯æ·»åŠ åˆ°é…ç½®æ–‡ä»¶ä¸­</li></ul><h2 id="Linuxå¼€å¯ç½‘ç»œ"><a href="#Linuxå¼€å¯ç½‘ç»œ" class="headerlink" title="Linuxå¼€å¯ç½‘ç»œ"></a>Linuxå¼€å¯ç½‘ç»œ</h2><p>å¾ˆå¤šcentosç³»ç»Ÿéƒ½æ˜¯é»˜è®¤å¼€å¯ç½‘ç»œçš„ï¼Œä½†æœ‰æ—¶å€™æŠ½é£ä¼šå‡ºç°æ— æ³•ä¸Šç½‘çš„æƒ…å†µï¼Œæˆ‘ä»¬å°±éœ€è¦<strong>å¯åŠ¨ens32/33ç½‘ç»œé…ç½®</strong> ï¼Œ<code>nmcli up ens32/33</code>ï¼Œå…·ä½“æ•°å€¼çœ‹ç‰ˆæœ¬,centos8æ˜¯33</p><h2 id="è™šæ‹Ÿæœºè®¾ç½®ç½‘ç»œç±»å‹"><a href="#è™šæ‹Ÿæœºè®¾ç½®ç½‘ç»œç±»å‹" class="headerlink" title="è™šæ‹Ÿæœºè®¾ç½®ç½‘ç»œç±»å‹"></a>è™šæ‹Ÿæœºè®¾ç½®ç½‘ç»œç±»å‹</h2><ul><li>NATæ¨¡å¼<ul><li>ä¼˜ç‚¹ï¼šçœIPèµ„æº</li><li>ç¼ºç‚¹ï¼šç½‘æ®µä¸åŒï¼Œå±€åŸŸç½‘å†…å…¶ä»–è®¾å¤‡æ— æ³•è®¿é—®è™šæ‹Ÿæœºä¸­çš„æ“ä½œç³»ç»Ÿ</li></ul></li><li>æ¡¥è¿æ¨¡å¼<ul><li>å°†è™šæ‹Ÿæœºçš„è™šæ‹Ÿç½‘ç»œé€‚é…å™¨ä¸ä¸»æœºçš„ç‰©ç†ç½‘ç»œé€‚é…å™¨è¿›è¡Œäº¤æ¥ï¼Œè™šæ‹Ÿæœºä¸­çš„è™šæ‹Ÿç½‘ç»œé€‚é…å™¨å¯é€šè¿‡ä¸»æœºä¸­çš„ç‰©ç†ç½‘ç»œé€‚é…å™¨ç›´æ¥è®¿é—®åˆ°å¤–éƒ¨ç½‘ç»œ</li></ul></li></ul><h2 id="å¿«ç…§å’Œå…‹éš†æ¦‚å¿µ"><a href="#å¿«ç…§å’Œå…‹éš†æ¦‚å¿µ" class="headerlink" title="å¿«ç…§å’Œå…‹éš†æ¦‚å¿µ"></a>å¿«ç…§å’Œå…‹éš†æ¦‚å¿µ</h2><ul><li>å¿«ç…§<ul><li>ç”¨äºæ¢å¤ç³»ç»Ÿåˆ°å¿«ç…§çŠ¶æ€</li></ul></li><li>å…‹éš†<ul><li>åˆè£…äº†ä¸€ä¸ªè·Ÿä»–ä¸€æ ·çš„è™šæ‹Ÿæœº<h2 id="æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½"><a href="#æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½"></a>æ–‡ä»¶ä¸Šä¼ ä¸ä¸‹è½½</h2><h3 id="lrzszçš„ä½¿ç”¨"><a href="#lrzszçš„ä½¿ç”¨" class="headerlink" title="lrzszçš„ä½¿ç”¨"></a>lrzszçš„ä½¿ç”¨</h3></li></ul></li><li><code>yum install lrzsz</code> æ‰§è¡ŒæŒ‡ä»¤ä¸‹è½½lrzsz</li><li><code>rz</code> å¼¹å‡ºä¸€ä¸ªæ–‡ä»¶é€‰æ‹©çª—å£ï¼Œä»æœ¬åœ°é€‰æ‹©æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨</li><li><code>sz</code> å°†é€‰å®šçš„æ–‡ä»¶å‘é€åˆ°æœ¬åœ°æœºå™¨ï¼Œè¯­å¥ï¼š<code>sz xxx</code><h3 id="xftpçš„ä½¿ç”¨"><a href="#xftpçš„ä½¿ç”¨" class="headerlink" title="xftpçš„ä½¿ç”¨"></a>xftpçš„ä½¿ç”¨</h3></li><li>ä¸‹è½½xftpçš„è½¯ä»¶<br><img src="https://s1.ax1x.com/2020/06/19/NKkD7F.jpg" alt="NKkD7F.jpg"></li><li>æ–°å»ºè¿æ¥ï¼Œè¾“å…¥è™šæ‹Ÿæœºåœ°å€ï¼Œç”¨æˆ·ï¼Œå¯†ç ï¼Œè¿æ¥æˆåŠŸ</li><li>å·¦è¾¹æ˜¯æœ¬åœ°ï¼Œå³è¾¹æ˜¯Linuxï¼Œç„¶åå°±èƒ½ä¸Šä¼ ä¸‹è½½æ–‡ä»¶äº†</li></ul><h2 id="æ–‡ä»¶å‹ç¼©ä¸è§£å‹"><a href="#æ–‡ä»¶å‹ç¼©ä¸è§£å‹" class="headerlink" title="æ–‡ä»¶å‹ç¼©ä¸è§£å‹"></a>æ–‡ä»¶å‹ç¼©ä¸è§£å‹</h2><ul><li>*tar.gzæ ¼å¼<ul><li><code>tar -czvf æ–‡ä»¶åç§°.tar.gz [ç›®å½•åç§°]</code> åˆ›å»ºå‹ç¼©æ–‡ä»¶</li><li><code>tar -zxvf æ–‡ä»¶åç§°</code> è§£å‹æ–‡ä»¶</li></ul></li><li>*.zipæ ¼å¼<ul><li><code>zip æ–‡ä»¶.zip</code> å‹ç¼©æ–‡ä»¶</li><li><code>unzip æ–‡ä»¶.zip -d æŒ‡å®šç›®å½•</code> è§£å‹æ–‡ä»¶<h3 id="è§£å‹å‘½ä»¤ç»†èŠ‚"><a href="#è§£å‹å‘½ä»¤ç»†èŠ‚" class="headerlink" title="è§£å‹å‘½ä»¤ç»†èŠ‚"></a>è§£å‹å‘½ä»¤ç»†èŠ‚</h3></li></ul></li><li>-c: å»ºç«‹å‹ç¼©æ¡£æ¡ˆ</li><li>-xï¼šè§£å‹</li><li>-tï¼šæŸ¥çœ‹å†…å®¹</li><li>-vï¼šæ˜¾ç¤ºæ‰€æœ‰è¿‡ç¨‹</li><li>-fï¼šä½¿ç”¨æ–‡ä»¶å</li><li>-z: æ˜¯å¦åŒæ—¶å…·æœ‰gzå±æ€§</li></ul>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸ªäººç®€å†æ¨¡æ¿</title>
      <link href="2020/04/18/ge-ren-jian-li-mo-ban/"/>
      <url>2020/04/18/ge-ren-jian-li-mo-ban/</url>
      
        <content type="html"><![CDATA[<blockquote><h1 id="ä¸ªäººç®€å†"><a href="#ä¸ªäººç®€å†" class="headerlink" title="ä¸ªäººç®€å†"></a>ä¸ªäººç®€å†</h1></blockquote><h2 id="ä¸€ã€ä¸ªäººä¿¡æ¯"><a href="#ä¸€ã€ä¸ªäººä¿¡æ¯" class="headerlink" title="ä¸€ã€ä¸ªäººä¿¡æ¯"></a>ä¸€ã€ä¸ªäººä¿¡æ¯</h2><blockquote><ul><li>å§“åï¼š</li><li>æ€§åˆ«ï¼š</li><li>ç±è´¯ï¼š</li><li>å­¦æ ¡ï¼š</li><li>ä¸“ä¸šï¼š</li><li>å­¦å†ï¼š</li><li>è‹±è¯­ç­‰çº§ï¼š</li><li>é‚®ç®±ï¼š</li><li>æ‰‹æœºå·ï¼š</li></ul></blockquote><h2 id="äºŒã€æ•™è‚²èƒŒæ™¯"><a href="#äºŒã€æ•™è‚²èƒŒæ™¯" class="headerlink" title="äºŒã€æ•™è‚²èƒŒæ™¯"></a>äºŒã€æ•™è‚²èƒŒæ™¯</h2><blockquote><ul><li>xxxx.xx~xxxx.xx </li></ul></blockquote><h2 id="ä¸‰ã€ä¸“ä¸šæŠ€èƒ½"><a href="#ä¸‰ã€ä¸“ä¸šæŠ€èƒ½" class="headerlink" title="ä¸‰ã€ä¸“ä¸šæŠ€èƒ½"></a>ä¸‰ã€ä¸“ä¸šæŠ€èƒ½</h2><blockquote><ol><li>ç†Ÿæ‚‰Javaè¯­è¨€ã€Cã€C++è¯­è¨€</li><li>ç†Ÿæ‚‰SQLã€MySQLã€SQL Server</li><li>xxxxxx</li></ol></blockquote><h2 id="å››ã€é¡¹ç›®ç»éªŒ"><a href="#å››ã€é¡¹ç›®ç»éªŒ" class="headerlink" title="å››ã€é¡¹ç›®ç»éªŒ"></a>å››ã€é¡¹ç›®ç»éªŒ</h2><blockquote><blockquote><p>å»ºè®®å†™3ä¸ªå·¦å³çš„é¡¹ç›®ï¼Œæœ€å¥½æ˜¯æœ‰å®é™…ç”¨æˆ·ï¼Œæ¨¡æ‹Ÿé¡¹ç›®é¢è¯•å®˜å…´è¶£ä¸å¤§</p></blockquote><ul><li>é¡¹ç›®åç§°ï¼šxxx</li><li>å¼€å‘ç¯å¢ƒï¼šWindowsã€</li><li>å¼€å‘å·¥å…·ï¼š</li><li>ç¼–ç è§„èŒƒï¼š</li><li>ä»£ç è´¨é‡ï¼šAlibaba Code Guidelinesã€PMDã€Sonar</li><li>é¡¹ç›®æè¿°ï¼š</li><li>ä¸ªäººèŒè´£ï¼šï¼ˆåšäº†ä»€ä¹ˆï¼Œæ€ä¹ˆåšçš„ï¼Œä»£ç å®ç°æµç¨‹ï¼‰</li></ul></blockquote><h2 id="äº”ã€å¤§å­¦ç»å†"><a href="#äº”ã€å¤§å­¦ç»å†" class="headerlink" title="äº”ã€å¤§å­¦ç»å†"></a>äº”ã€å¤§å­¦ç»å†</h2><blockquote><ul><li>è·å¾—äº’è”ç½‘+å¤§èµ› xxx</li><li>è·å¾—å›½å®¶è½¯è‘—ç™»è®°ä¸€é¡¹</li><li>å‚åŠ xxxxï¼ˆä¸å·¥ä½œæœ‰å…³ï¼‰</li></ul></blockquote><h2 id="å…­ã€è‡ªæˆ‘è¯„ä»·"><a href="#å…­ã€è‡ªæˆ‘è¯„ä»·" class="headerlink" title="å…­ã€è‡ªæˆ‘è¯„ä»·"></a>å…­ã€è‡ªæˆ‘è¯„ä»·</h2><blockquote><p>1ã€æœ‰è‰¯å¥½çš„æ²Ÿé€šèƒ½åŠ›ã€å›¢é˜Ÿåˆä½œç²¾ç¥<br>2ã€xxxxxxx</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ç®€å† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mavenå­¦ä¹ åŠç§æœé…ç½®</title>
      <link href="2020/04/18/maven-xue-xi-ji-si-fu-pei-zhi/"/>
      <url>2020/04/18/maven-xue-xi-ji-si-fu-pei-zhi/</url>
      
        <content type="html"><![CDATA[<h1 id="Mavenå­¦ä¹ "><a href="#Mavenå­¦ä¹ " class="headerlink" title="Mavenå­¦ä¹ "></a>Mavenå­¦ä¹ </h1><blockquote></blockquote><h2 id="ä¸€ã€Mavenå¸¸ç”¨å‘½ä»¤"><a href="#ä¸€ã€Mavenå¸¸ç”¨å‘½ä»¤" class="headerlink" title="ä¸€ã€Mavenå¸¸ç”¨å‘½ä»¤"></a>ä¸€ã€Mavenå¸¸ç”¨å‘½ä»¤</h2><h3 id="Clean"><a href="#Clean" class="headerlink" title="Clean"></a><code>Clean</code></h3><blockquote><p>æ¸…é™¤å·²ç¼–è¯‘ä¿¡æ¯ã€‚<br>åˆ é™¤å·¥ç¨‹ä¸­çš„ target ç›®å½•ã€‚</p></blockquote><h3 id="validate"><a href="#validate" class="headerlink" title="validate"></a><code>validate</code></h3><blockquote><p>éªŒè¯é¡¹ç›®æ˜¯å¦æ­£ç¡®</p></blockquote><h3 id="complie"><a href="#complie" class="headerlink" title="complie"></a><code>complie</code></h3><blockquote><p>åªç¼–è¯‘ã€‚ javac å‘½ä»¤</p></blockquote><h3 id="test"><a href="#test" class="headerlink" title="test"></a><code>test</code></h3><blockquote><p>ç”¨äºæ‰§è¡Œé¡¹ç›®çš„æµ‹è¯•ï¼Œå¦‚æœtestç›®å½•ä¸‹å«æœ‰æµ‹è¯•ä»£ç ï¼Œé‚£ä¹ˆmavenåœ¨æ‰§è¡Œinstallçš„æ—¶å€™ä¼šå…ˆå»æ‰§è¡Œtestå‘½ä»¤ï¼ŒæŠŠtestç›®å½•ä¸‹æ‰€æœ‰çš„æµ‹è¯•ä»£ç èµ°ä¸€éã€‚å¦‚æœæœ‰æµ‹è¯•ä»£ç æ‰§è¡Œå¤±è´¥ï¼Œinstallç»ˆæ­¢</p></blockquote><h3 id="package"><a href="#package" class="headerlink" title="package"></a><code>package</code></h3><blockquote><p>æ‰“åŒ…ã€‚ åŒ…å«ç¼–è¯‘ï¼Œæ‰“åŒ…ä¸¤ä¸ªåŠŸèƒ½</p></blockquote><h3 id="verify"><a href="#verify" class="headerlink" title="verify"></a><code>verify</code></h3><blockquote><p>è¿è¡Œä»»ä½•æ£€æŸ¥ï¼ŒéªŒè¯jaråŒ…æ˜¯å¦æœ‰æ•ˆå¹¶ä¸”è¾¾åˆ°è´¨é‡æ ‡å‡†</p></blockquote><h3 id="install"><a href="#install" class="headerlink" title="install"></a><code>install</code></h3><blockquote><p>æœ¬åœ°å®‰è£…ï¼Œ åŒ…å«ç¼–è¯‘ï¼Œæ‰“åŒ…ï¼Œå®‰è£…åˆ°æœ¬åœ°ä»“åº“<br>ç¼–è¯‘ - javac<br>æ‰“åŒ… - jarï¼Œ å°† java ä»£ç æ‰“åŒ…ä¸º jar æ–‡ä»¶<br>å®‰è£…åˆ°æœ¬åœ°ä»“åº“ - å°†æ‰“åŒ…çš„ jar æ–‡ä»¶ï¼Œä¿å­˜åˆ°æœ¬åœ°ä»“åº“ç›®å½•ä¸­ã€‚</p></blockquote><h3 id="site"><a href="#site" class="headerlink" title="site"></a><code>site</code></h3><blockquote><p>é¡¹ç›®ç«™ç‚¹æ–‡ä»¶åˆ›å»ºçš„å¤„ç†ï¼Œè¯¥å‘½ä»¤éœ€è¦é…ç½®æ’ä»¶</p></blockquote><h3 id="deploy"><a href="#deploy" class="headerlink" title="deploy"></a><code>deploy</code></h3><blockquote><p>éƒ¨ç½²ã€‚ å¸¸è§äºç»“åˆç§æœä½¿ç”¨çš„å‘½ä»¤ã€‚<br>ç›¸å½“äºæ˜¯ install+ä¸Šä¼  jar åˆ°ç§æœã€‚<br>åŒ…å«ç¼–è¯‘ï¼Œæ‰“åŒ…ï¼Œå®‰è£…åˆ°æœ¬åœ°ä»“åº“ï¼Œä¸Šä¼ åˆ°ç§æœä»“åº“ã€‚</p></blockquote><h2 id="äºŒã€Mavenç§æœ"><a href="#äºŒã€Mavenç§æœ" class="headerlink" title="äºŒã€Mavenç§æœ"></a>äºŒã€Mavenç§æœ</h2><ol><li>ç§æœæ˜¯ä¸€ç§ç‰¹æ®Šçš„è¿œç¨‹ä»“åº“ï¼Œå®ƒæ˜¯æ¶è®¾åœ¨å±€åŸŸç½‘çš„ä»“åº“æœåŠ¡ï¼Œç§æœä»£ç†å¹¿åŸŸç½‘ä¸Šçš„è¿œç¨‹ä»“åº“ï¼Œä¾›å±€åŸŸç½‘ä½¿ç”¨ã€‚å…¶å¥½å¤„æœ‰ï¼š</li></ol><ul><li><font color=red>èŠ‚çœèµ„é‡‘ã€å¤–ç½‘å¸¦å®½</font><br>åˆ©ç”¨ç§æœä»£ç†å¤–éƒ¨ä»“åº“ä¹‹åï¼Œå¯¹å¤–çš„é‡å¤æ„ä»¶ä¸‹è½½ä¾¿å¾—ä»¥ç®€åŒ–ï¼Œé™ä½å¤–ç½‘å¸¦å®½å‹åŠ›ã€‚</li><li><font color=red>åŠ é€Ÿ Maven æ„å»º</font><br>ä¸åœåœ°è¿æ¥è¯·æ±‚å¤–éƒ¨ä»“åº“æ˜¯ç›¸å½“è€—æ—¶çš„ï¼Œä½†æ˜¯ maven çš„ä¸€äº›å†…éƒ¨æœºåˆ¶ï¼ˆå¦‚å¿«ç…§æ›´æ–°æ£€æŸ¥ï¼‰è¦æ±‚Maven åœ¨æ‰§è¡Œæ„å»ºçš„æ—¶å€™ä¸åœåœ°æ£€æŸ¥è¿œç¨‹ä»“åº“æ•°æ®ã€‚å› æ­¤ï¼Œå½“é¡¹ç›®é…ç½®äº†å¾ˆå¤šå¤–éƒ¨è¿œç¨‹ä»“åº“çš„æ—¶å€™ï¼Œæ„å»ºé€Ÿåº¦ä¼šé™ä½ã€‚ä½¿ç”¨ç§æœè§£å†³è¿™é—®é¢˜ï¼Œå› ä¸º Maven åªéœ€è¦æ£€æŸ¥å±€åŸŸç½‘å†…ç§æœçš„æ•°æ®æ—¶ï¼Œæ„å»ºé€Ÿåº¦ä¾¿æœ‰æ˜æ˜¾æé«˜ã€‚</li><li><font color=red>éƒ¨ç½²ç¬¬ä¸‰æ–¹æ„ä»¶</font><br>å½“æŸä¸ªæ„ä»¶æ— æ³•ä»ä»»ä½•ä¸€ä¸ªè¿œç¨‹ä»“åº“è·å–æ€ä¹ˆåŠï¼Ÿæ¯”å¦‚ Oracle çš„ JDBC é©±åŠ¨ç”±äºç‰ˆæƒåŸå› ä¸èƒ½å‘å¸ƒåˆ°å…¬å…±ä»“åº“ä¸­ã€‚å»ºç«‹ç§æœåï¼Œä¾¿å¯ä»¥å°†è¿™äº›æ„ä»¶éƒ¨ç½²åˆ°è¿™ä¸ªå†…éƒ¨ä»“åº“ä¸­ï¼Œä¾›å†…éƒ¨ Maven é¡¹ç›®ä½¿ç”¨ã€‚</li><li><font color=red>æé«˜ç¨³å®šæ€§ï¼Œå¢å¼ºæ§åˆ¶</font><br>å¯¹äºè¿œç¨‹ä»“åº“æ¥è¯´ï¼Œå½“å¤–ç½‘ä¸å¯ç”¨æ—¶ï¼ŒMaven æ„å»ºæœ‰å¯èƒ½å› ä¸ºä¾èµ–æ²¡æœ‰ä¸‹è½½è€Œä¸å¯è¡Œï¼Œæ­å»ºå¹¶åº”ç”¨ç§æœåï¼Œå³ä½¿æ²¡æœ‰å¤–ç½‘ï¼Œå¦‚æœè¯¥æ„ä»¶ä¹‹å‰è¢«å…¶å®ƒäººä¸‹è½½è¿‡å°±ä¼šå­˜åœ¨ç§æœä¸Šï¼Œæ­¤æ—¶å†æ¬¡ä¾èµ–è¯¥æ„ä»¶å°±å¯ä»¥ä¸ç”¨è¿æ¥å¤–ç½‘ç›´æ¥å°±å¯ä»¥ä»ç§æœä¸Šä¸‹è½½åˆ°ã€‚åŒæ—¶ç§æœè½¯ä»¶ï¼ˆnexus)è¿˜æä¾›äº†é¢å¤–çš„ç®¡ç†åŠŸèƒ½ã€‚</li><li><font color=red>é™ä½ä¸­å¤®ä»“åº“çš„è´Ÿè·</font><br>ä¸­å¤®ä»“åº“æ˜¯æœ‰é™çš„ã€‚å¦‚æœæ‰€æœ‰çš„ Maven å·¥ç¨‹å¼€å‘è¿‡ç¨‹ä¸­ï¼Œéƒ½é€šè¿‡ä¸­å¤®ä»“åº“å®ç°æ„ä»¶çš„ä¾èµ–å’Œç®¡ç†ï¼Œé‚£ä¹ˆä¸­å¤®ä»“åº“çš„è´Ÿè·è¿‡é«˜ï¼Œä¹Ÿä¼šä¸¥é‡å½±å“å·¥ç¨‹æ„å»ºçš„æ•ˆç‡ã€‚å¦‚æœä½¿ç”¨ç§æœï¼Œå¯ä»¥åˆ†æ•£ä¸­å¤®ä»“åº“çš„è´Ÿè·ï¼Œåªæœ‰åœ¨ç§æœä¸­æ²¡æœ‰éœ€è¦ä¾èµ–çš„æ„ä»¶æ—¶æ‰ä¼šå»è¿æ¥ä¸­å¤®ä»“åº“ã€‚</li></ul><h2 id="ä¸‰ã€Nexusæ­å»ºç§æœ"><a href="#ä¸‰ã€Nexusæ­å»ºç§æœ" class="headerlink" title="ä¸‰ã€Nexusæ­å»ºç§æœ"></a>ä¸‰ã€Nexusæ­å»ºç§æœ</h2><h3 id="1-æ­å»ºç¯å¢ƒï¼šCentOS7-6ï¼ŒJDK1-8"><a href="#1-æ­å»ºç¯å¢ƒï¼šCentOS7-6ï¼ŒJDK1-8" class="headerlink" title="1. æ­å»ºç¯å¢ƒï¼šCentOS7.6ï¼ŒJDK1.8"></a>1. æ­å»ºç¯å¢ƒï¼šCentOS7.6ï¼ŒJDK1.8</h3><h3 id="2-æ­å»ºæ­¥éª¤ï¼š"><a href="#2-æ­å»ºæ­¥éª¤ï¼š" class="headerlink" title="2. æ­å»ºæ­¥éª¤ï¼š"></a>2. æ­å»ºæ­¥éª¤ï¼š</h3><h4 id="2-1-å®‰è£…JDK"><a href="#2-1-å®‰è£…JDK" class="headerlink" title="2.1 å®‰è£…JDK"></a>2.1 å®‰è£…JDK</h4><h5 id="2-1-1-JDK-èµ„æºåŒ…ä¸‹è½½"><a href="#2-1-1-JDK-èµ„æºåŒ…ä¸‹è½½" class="headerlink" title="2.1.1 JDK èµ„æºåŒ…ä¸‹è½½"></a>2.1.1 JDK èµ„æºåŒ…ä¸‹è½½</h5><blockquote><p>JDK å®˜æ–¹ä¸‹è½½åœ°å€ä¸ºï¼š<a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a></p></blockquote><h5 id="2-1-2-JDK-èµ„æºåŒ…è§£å‹"><a href="#2-1-2-JDK-èµ„æºåŒ…è§£å‹" class="headerlink" title="2.1.2 JDK èµ„æºåŒ…è§£å‹"></a>2.1.2 JDK èµ„æºåŒ…è§£å‹</h5><blockquote><p>åœ¨ Linux ä¸­å®‰è£…åº”ç”¨çš„å¸¸ç”¨ç›®å½•ä¸ºï¼š/opt æˆ–/usr/local ç›®å½•ã€‚æœ¬è¯¾ä»¶å°† JDK å®‰è£…åˆ°<code>/usr/local/java</code>ç›®å½•ä¸­ã€‚è§£å‹ JDK åˆ°æŒ‡å®šç›®å½•ï¼š<code>tar -zxvf jdk-7u80-linux-x64.tar.gz -C /usr/local</code>é‡å‘½å JDK ç›®å½•ï¼š<code>mv /usr/local/jdk1.7.0_80 /usr/local/java</code></p></blockquote><h5 id="2-1-3-ç¯å¢ƒå˜é‡é…ç½®"><a href="#2-1-3-ç¯å¢ƒå˜é‡é…ç½®" class="headerlink" title="2.1.3 ç¯å¢ƒå˜é‡é…ç½®"></a>2.1.3 ç¯å¢ƒå˜é‡é…ç½®</h5><blockquote><p>ä¿®æ”¹<code>/etc/profile </code>é…ç½®æ–‡ä»¶ï¼Œå¢åŠ ç¯å¢ƒå˜é‡é…ç½®ã€‚</p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">export JAVA_HOME&#x3D;&#x2F;usr&#x2F;local&#x2F;javaexport CLASSPATH&#x3D;.:$JAVA_HOME&#x2F;lib&#x2F;dt.jar:$JAVA_HOME&#x2F;lib&#x2F;tools.jarexport PATH&#x3D;$JAVA_HOME&#x2F;bin:$PATH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç¯å¢ƒå˜é‡ä¿®æ”¹åï¼Œå¯ä»¥é‡å¯ Linux å®ç°æ°¸ä¹…ç”Ÿæ•ˆï¼›æˆ–æ‰§è¡Œ source /etc/profile å‘½ä»¤ï¼Œè®©æ–°ä¿®æ”¹çš„ç¯å¢ƒå˜é‡åœ¨å½“å‰ç»ˆç«¯ä¸­ç”Ÿæ•ˆã€‚</p></blockquote><h4 id="2-2-å®‰è£…ç§æœ-Nexus"><a href="#2-2-å®‰è£…ç§æœ-Nexus" class="headerlink" title="2.2 å®‰è£…ç§æœ Nexus"></a>2.2 å®‰è£…ç§æœ Nexus</h4><h5 id="2-2-1-Nexus-èµ„æºåŒ…ä¸‹è½½"><a href="#2-2-1-Nexus-èµ„æºåŒ…ä¸‹è½½" class="headerlink" title="2.2.1 Nexus èµ„æºåŒ…ä¸‹è½½"></a>2.2.1 Nexus èµ„æºåŒ…ä¸‹è½½</h5><blockquote><p>Nexus å®˜æ–¹ä¸‹è½½åœ°å€ä¸ºï¼š<a href="https://www.sonatype.com/nexus-repository-oss">https://www.sonatype.com/nexus-repository-oss</a></p></blockquote><h5 id="2-2-2-Nexus-èµ„æºåŒ…è§£å‹"><a href="#2-2-2-Nexus-èµ„æºåŒ…è§£å‹" class="headerlink" title="2.2.2 Nexus èµ„æºåŒ…è§£å‹"></a>2.2.2 Nexus èµ„æºåŒ…è§£å‹</h5><blockquote><p>åœ¨/usr/local ç›®å½•ä¸­åˆ›å»ºå­ç›®å½• nexusï¼š<code>mkdir /usr/local/nexus</code>è§£å‹ Nexus åˆ°æŒ‡å®šç›®å½•ï¼š<code>tar -zxvf nexus-2.11.2-03-bundle.tar.gz -C /usr/local/nexus</code>Nexus å‹ç¼©åŒ…ä¸­åŒ…å«ä¸¤ä¸ªå­ç›®å½•: <code>nexus-2.11.2-03</code> å’Œ <code>sonatype-work</code>nexus-2.11.2-03 æ˜¯å…·ä½“çš„ç§æœåº”ç”¨å†…å®¹ï¼Œ<code>sonatype-work</code> æ˜¯ Nexus ç§æœä¸‹è½½çš„æ„ä»¶å­˜æ”¾å·¥<br>ä½œç›®å½•ã€‚</p></blockquote><h5 id="2-2-3-æ£€æŸ¥ç§æœç«¯å£å’Œå·¥ä½œç›®å½•"><a href="#2-2-3-æ£€æŸ¥ç§æœç«¯å£å’Œå·¥ä½œç›®å½•" class="headerlink" title="2.2.3 æ£€æŸ¥ç§æœç«¯å£å’Œå·¥ä½œç›®å½•"></a>2.2.3 æ£€æŸ¥ç§æœç«¯å£å’Œå·¥ä½œç›®å½•</h5><blockquote><p>åœ¨ nexus-2.11.2-03 ç›®å½•ä¸­æœ‰å­ç›®å½• <code>conf</code>ï¼Œå…¶ä¸­ä¿å­˜ç§æœåº”ç”¨çš„é…ç½®ä¿¡æ¯ã€‚æŸ¥çœ‹<code>nexus.properties</code> æ–‡ä»¶ï¼Œç¡®å®šç§æœè®¿é—®ç«¯å£å’Œå·¥ä½œç›®å½•ã€‚æ­¤æ“ä½œå¯ä¸åšä»»ä½•å†…å®¹ä¿®æ”¹ã€‚é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none"># Jetty sectionï¼ŒNexus ç§æœåº”ç”¨æ˜¯ä½¿ç”¨ Jetty æä¾› web æœåŠ¡çš„ï¼Œä¸‹è¿°å†…å®¹ä¸º Jetty é…ç½®ã€‚application-port&#x3D;8081 # ç§æœè®¿é—®ç«¯å£application-host&#x3D;0.0.0.0nexus-webapp&#x3D;$&#123;bundleBasedir&#125;&#x2F;nexus # Nexus ç§æœ WEB åº”ç”¨æ‰€åœ¨ä½ç½®nexus-webapp-context-path&#x3D;&#x2F;nexus # Nexus ç§æœ WEB åº”ç”¨ contextPath#Nexus section Nexus ç§æœé…ç½®ä¿¡æ¯nexus-work&#x3D;$&#123;bundleBasedir&#125;&#x2F;..&#x2F;sonatype-work&#x2F;nexus # ç§æœå·¥ä½œç›®å½•ï¼Œå³æ„ä»¶ä¿å­˜ç›®å½•runtime&#x3D;$&#123;bundleBasedir&#125;&#x2F;nexus&#x2F;WEB-INF # ç§æœ WEB åº”ç”¨è¿è¡Œç›®å½•<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h4 id="2-2-4-ä¿®æ”¹-Nexus-è¿è¡Œç”¨æˆ·"><a href="#2-2-4-ä¿®æ”¹-Nexus-è¿è¡Œç”¨æˆ·" class="headerlink" title="2.2.4 ä¿®æ”¹ Nexus è¿è¡Œç”¨æˆ·"></a>2.2.4 ä¿®æ”¹ Nexus è¿è¡Œç”¨æˆ·</h4><blockquote><p>Nexus ç§æœåœ¨å¯åŠ¨åï¼Œç§æœåº”ç”¨éœ€è¦è®¿é—® Linux çš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ‰€ä»¥éœ€è¦æœ‰è¶³å¤Ÿçš„æƒé™ã€‚Nexus çš„å¯åŠ¨è„šæœ¬æ–‡ä»¶ä¸­ï¼Œå¯ä»¥æŒ‡å®šç§æœåº”ç”¨çš„è®¿é—®ç”¨æˆ·ï¼Œæ­¤ä¿¡æ¯åœ¨ <code>nexus-2.11.2-03/bin/nexus</code>è„šæœ¬æ–‡ä»¶ä¸­å®šä¹‰ã€‚éœ€è¦ä¿®æ”¹çš„ä¿¡æ¯å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none"># NOTE - This will set the user which is used to run the Wrapper as well as# the JVM and is not useful in situations where a privileged resource or# port needs to be allocated prior to the user being changed#RUN_AS_USER&#x3D; #åŸå†…å®¹RUN_AS_USER&#x3D;root #ä¿®æ”¹åçš„å†…å®¹ï¼Œä»£è¡¨ Nexus ç§æœä½¿ç”¨ root ç”¨æˆ·æƒé™ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h4 id="2-2-5-ä¿®æ”¹é˜²ç«å¢™ï¼Œå¼€æ”¾-Nexus-ç§æœç«¯å£è®¿é—®"><a href="#2-2-5-ä¿®æ”¹é˜²ç«å¢™ï¼Œå¼€æ”¾-Nexus-ç§æœç«¯å£è®¿é—®" class="headerlink" title="2.2.5 ä¿®æ”¹é˜²ç«å¢™ï¼Œå¼€æ”¾ Nexus ç§æœç«¯å£è®¿é—®"></a>2.2.5 ä¿®æ”¹é˜²ç«å¢™ï¼Œå¼€æ”¾ Nexus ç§æœç«¯å£è®¿é—®</h4><blockquote><p>ä¿®æ”¹é˜²ç«å¢™é…ç½®æ–‡ä»¶ï¼Œå¼€æ”¾ Nexus ç§æœçš„è®¿é—®ç«¯å£ 8081ï¼Œé€šè¿‡<code>vi /etc/sysconfig/iptables</code>ï¼Œåœ¨å…¶ä¸­åŠ å…¥<code>-A INPUT -m state --state NEW -m tcp -p tcp --dport 8081 -j ACCEPT</code>ï¼Œæœ€åé‡æ–°å¯åŠ¨é˜²ç«å¢™ï¼š<code>service iptables restart</code></p></blockquote><h4 id="2-2-6-å¯åŠ¨å¹¶æµ‹è¯•è®¿é—®"><a href="#2-2-6-å¯åŠ¨å¹¶æµ‹è¯•è®¿é—®" class="headerlink" title="2.2.6 å¯åŠ¨å¹¶æµ‹è¯•è®¿é—®"></a>2.2.6 å¯åŠ¨å¹¶æµ‹è¯•è®¿é—®</h4><blockquote><p>å¯åŠ¨ Nexus ç§æœï¼š<br><code>/usr/local/nexus/nexus-2.11.2-03/bin/nexus start</code><br>å¯é€šè¿‡å‘½ä»¤æ£€æŸ¥ç§æœè¿è¡ŒçŠ¶æ€ï¼š<br><code>/usr/local/nexus/nexus-2.11.2-03/bin/nexus status</code><br>ä¹Ÿå¯ä½¿ç”¨æµè§ˆå™¨è®¿é—® Nexus ç§æœ WEB åº”ç”¨ï¼Œ è®¿é—®åœ°å€ä¸ºï¼š<br><code>http://ip:8081/nexus ï¼ˆip ä¸º Nexus æ‰€åœ¨ç³»ç»Ÿçš„è®¿é—® IPï¼‰</code></p></blockquote><h3 id="3-ç§æœç™»å½•"><a href="#3-ç§æœç™»å½•" class="headerlink" title="3. ç§æœç™»å½•"></a>3. ç§æœç™»å½•</h3><blockquote><p>Nexus é»˜è®¤æä¾›ç®¡ç†ç”¨æˆ·ï¼Œç”¨æˆ·åä¸º <code>admin</code>ï¼Œå¯†ç ä¸º<code>admin123</code>ã€‚ </p></blockquote><h3 id="4-ä»“åº“ç®¡ç†"><a href="#4-ä»“åº“ç®¡ç†" class="headerlink" title="4. ä»“åº“ç®¡ç†"></a>4. ä»“åº“ç®¡ç†</h3><blockquote><p>å¸¸ç”¨ä»“åº“ç±»å‹ä¸ºï¼šhosted å’Œ proxy</p></blockquote><h4 id="4-1-group"><a href="#4-1-group" class="headerlink" title="4.1 group"></a>4.1 group</h4><blockquote><p>ä»“åº“ç»„ï¼šNexus é€šè¿‡ä»“åº“ç»„æ¥ç»Ÿä¸€ç®¡ç†å¤šä¸ªä»“åº“ï¼Œè¿™æ ·è®¿é—®ä»“åº“ç»„å°±ç›¸å½“äºè®¿é—®ä»“åº“ç»„ç®¡ç†çš„å¤šä¸ªä»“åº“ã€‚</p></blockquote><h4 id="4-2-hosted"><a href="#4-2-hosted" class="headerlink" title="4.2 hosted"></a>4.2 hosted</h4><blockquote><p>å®¿ä¸»ä»“åº“ï¼šä¸»è¦ç”¨äºå‘å¸ƒå†…éƒ¨é¡¹ç›®æ„ä»¶æˆ–ç¬¬ä¸‰æ–¹çš„é¡¹ç›®æ„ä»¶ï¼ˆå¦‚è´­ä¹°å•†ä¸šçš„æ„ä»¶ï¼‰ä»¥åŠæ— æ³•ä»å…¬å…±ä»“åº“è·å–çš„æ„ä»¶ï¼ˆå¦‚ oracle çš„ JDBC é©±åŠ¨ï¼‰ã€‚</p></blockquote><h4 id="4-3-releases"><a href="#4-3-releases" class="headerlink" title="4.3 releases"></a>4.3 releases</h4><blockquote><p>å‘å¸ƒå†…éƒ¨çš„ releases æ¨¡å—çš„ä»“åº“ï¼Œæ‰€æœ‰éå¿«ç…§ç‰ˆæœ¬å·¥ç¨‹éƒ½å‘å¸ƒåˆ°æ­¤ä»“åº“ä¸­ã€‚</p></blockquote><h4 id="4-4-snapshots"><a href="#4-4-snapshots" class="headerlink" title="4.4 snapshots"></a>4.4 snapshots</h4><blockquote><p>å‘å¸ƒå†…éƒ¨çš„å¿«ç…§æ¨¡å—çš„ä»“åº“ï¼Œæ‰€æœ‰å·¥ç¨‹ç‰ˆæœ¬ä»¥ SNAPSHOT ç»“å°¾çš„éƒ½å‘å¸ƒåˆ°æ­¤ä»“åº“ä¸­ã€‚</p></blockquote><h4 id="4-5-3rd-party"><a href="#4-5-3rd-party" class="headerlink" title="4.5 3rd party"></a>4.5 3rd party</h4><blockquote><p>ç¬¬ä¸‰æ–¹ä¾èµ–çš„ä»“åº“ï¼Œè¿™ä¸ªæ•°æ®é€šå¸¸æ˜¯ç”±å†…éƒ¨äººå‘˜è‡ªè¡Œä¸‹è½½ä¹‹åå‘å¸ƒä¸Šå»</p></blockquote><h4 id="4-6-proxy"><a href="#4-6-proxy" class="headerlink" title="4.6 proxy"></a>4.6 proxy</h4><blockquote><p>ä»£ç†ä»“åº“ï¼šä»£ç†å…¬å…±çš„è¿œç¨‹ä»“åº“ã€‚</p></blockquote><h4 id="4-7-virtual"><a href="#4-7-virtual" class="headerlink" title="4.7 virtual"></a>4.7 virtual</h4><blockquote><p>è™šæ‹Ÿä»“åº“ï¼šç”¨äºé€‚é… Maven 1</p></blockquote><h3 id="5-ä»£ç†ä»“åº“é…ç½®"><a href="#5-ä»£ç†ä»“åº“é…ç½®" class="headerlink" title="5.ä»£ç†ä»“åº“é…ç½®"></a>5.ä»£ç†ä»“åº“é…ç½®</h3><blockquote><p><a href="https://repo1.maven.org/maven2/">Mavençš„è¿œç¨‹ä¸­å¤®ä»“åº“</a>æ‰€æœ‰çš„mavenéƒ½æ˜¯ä»è¿™é‡Œä¸‹è½½ä¸œè¥¿çš„ã€‚<br><a href="http://maven.aliyun.com/nexus/content/groups/public/">é˜¿é‡Œäº‘çš„é•œåƒmavenä¸­å¤®ä»“åº“</a>ï¼Œé…ç½®åœ°å€æ”¹æˆè¿™ä¸ªèƒ½ä¸‹è½½æ›´å¿«ã€‚</p></blockquote><h4 id="5-1-ä¿®æ”¹settings-xmlæ–‡ä»¶"><a href="#5-1-ä¿®æ”¹settings-xmlæ–‡ä»¶" class="headerlink" title="5.1 ä¿®æ”¹settings.xmlæ–‡ä»¶"></a>5.1 ä¿®æ”¹settings.xmlæ–‡ä»¶</h4><blockquote></blockquote><h3 id="6-åœ¨serversèŠ‚ç‚¹ä¸­æ·»åŠ ä»“åº“çš„ç”¨æˆ·è®¤è¯"><a href="#6-åœ¨serversèŠ‚ç‚¹ä¸­æ·»åŠ ä»“åº“çš„ç”¨æˆ·è®¤è¯" class="headerlink" title="6.åœ¨serversèŠ‚ç‚¹ä¸­æ·»åŠ ä»“åº“çš„ç”¨æˆ·è®¤è¯"></a>6.åœ¨serversèŠ‚ç‚¹ä¸­æ·»åŠ ä»“åº“çš„ç”¨æˆ·è®¤è¯</h3><blockquote><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servers</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>server</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- server çš„ id å¿…é¡»å’Œ pom.xml æ–‡ä»¶ä¸­çš„ä»“åº“ id ä¸€è‡´ --></span><span class="token comment">&lt;!--è¿™æ˜¯ server çš„ idï¼ˆæ³¨æ„ä¸æ˜¯ç”¨æˆ·ç™»é™†çš„ idï¼‰ï¼Œè¯¥ id ä¸ distributionManagement ä¸­repository å…ƒç´ çš„ id ç›¸åŒ¹é…ã€‚--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>nexus-releases<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span>deployment<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">></span></span>deployment123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>server</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>server</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>nexus-snapshots<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span>deployment<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">></span></span>deployment123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>server</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servers</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h3 id="7-é…ç½®profileå’Œæ’ä»¶"><a href="#7-é…ç½®profileå’Œæ’ä»¶" class="headerlink" title="7.é…ç½®profileå’Œæ’ä»¶"></a>7.é…ç½®profileå’Œæ’ä»¶</h3><blockquote><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!--æ ¹æ®ç¯å¢ƒå‚æ•°æ¥è°ƒæ•´æ„å»ºé…ç½®çš„åˆ—è¡¨ã€‚--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profiles</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profile</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>jdk-1.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activation</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activeByDefault</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activeByDefault</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jdk</span><span class="token punctuation">></span></span>1.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jdk</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activation</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">></span></span>1.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">></span></span>1.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.compilerVersion</span><span class="token punctuation">></span></span>1.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.compilerVersion</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profile</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profile</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>sxt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activation</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activeByDefault</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activeByDefault</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jdk</span><span class="token punctuation">></span></span>1.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jdk</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activation</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repositories</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- ç§æœ‰åº“é…ç½® --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repository</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- ç§æœ‰åº“ id --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>nexus<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- ç§æœ‰åº“åœ°å€ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">></span></span>http://192.168.120.158:8081/nexus/content/groups/public/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- ç§æœ‰åº“æ˜¯å¦æ”¯æŒ releases ç‰ˆæœ¬ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>releases</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enabled</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enabled</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>releases</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- ç§æœ‰åº“æ˜¯å¦æ”¯æŒ snapshots ç‰ˆæœ¬ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>snapshots</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enabled</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enabled</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>snapshots</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repository</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repositories</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pluginRepositories</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- æ’ä»¶åº“é…ç½®ï¼Œå…·ä½“å«ä¹‰ç§æœ‰åº“é…ç½® --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pluginRepository</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>nexus<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">></span></span>http://192.168.120.158:8081/nexus/content/groups/public/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>releases</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enabled</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enabled</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>releases</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>snapshots</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enabled</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enabled</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>snapshots</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pluginRepository</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pluginRepositories</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profile</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profiles</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h3 id="8-æ¿€æ´»profile"><a href="#8-æ¿€æ´»profile" class="headerlink" title="8.æ¿€æ´»profile"></a>8.æ¿€æ´»profile</h3><blockquote><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- æ¿€æ´» profile --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activeProfiles</span><span class="token punctuation">></span></span><span class="token comment">&lt;!-- æ ¹æ® profile çš„ id æ ‡ç­¾å€¼æ¿€æ´»æŒ‡å®šçš„å†…å®¹ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activeProfile</span><span class="token punctuation">></span></span>sxt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activeProfile</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activeProfiles</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h3 id="9-åˆ é™¤åŸæœ¬çš„é˜¿é‡Œé•œåƒï¼ˆå¦‚æœä¸€å¼€å§‹æ²¡æœ‰é…ç½®å°±ä¸ç”¨äº†ï¼‰"><a href="#9-åˆ é™¤åŸæœ¬çš„é˜¿é‡Œé•œåƒï¼ˆå¦‚æœä¸€å¼€å§‹æ²¡æœ‰é…ç½®å°±ä¸ç”¨äº†ï¼‰" class="headerlink" title="9.åˆ é™¤åŸæœ¬çš„é˜¿é‡Œé•œåƒï¼ˆå¦‚æœä¸€å¼€å§‹æ²¡æœ‰é…ç½®å°±ä¸ç”¨äº†ï¼‰"></a>9.åˆ é™¤åŸæœ¬çš„é˜¿é‡Œé•œåƒï¼ˆå¦‚æœä¸€å¼€å§‹æ²¡æœ‰é…ç½®å°±ä¸ç”¨äº†ï¼‰</h3><h2 id="å››ã€mavené¡¹ç›®ç»“æ„"><a href="#å››ã€mavené¡¹ç›®ç»“æ„" class="headerlink" title="å››ã€mavené¡¹ç›®ç»“æ„"></a>å››ã€mavené¡¹ç›®ç»“æ„</h2><h3 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h3><ul><li><font color = red>src</font><ul><li><font color = blue>main</font><ul><li><font color = green>java</font> è¿™ä¸ªç›®å½•ä¸‹å‚¨å­˜ java æºä»£ç </li><li><font color = green>resources</font> å‚¨å­˜ä¸»è¦çš„èµ„æºæ–‡ä»¶</li></ul></li><li><font color = blue>test</font><ul><li><font color = green>java</font> å­˜æ”¾æµ‹è¯•ä»£ç </li></ul></li></ul></li><li><font color = red>pom.xml</font> æ˜¯ Maven çš„åŸºç¡€é…ç½®æ–‡ä»¶ï¼Œä¹Ÿæ˜¯ Maven é¡¹ç›®æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½®é¡¹ç›®çš„åŸºæœ¬ä¿¡æ¯ï¼Œé¡¹ç›®çš„ç»§æ‰¿å…³ç³»ï¼Œé¡¹ç›®ç±»å‹ï¼Œä¾èµ–ç®¡ç†ï¼Œä¾èµ–æ³¨å…¥ï¼Œæ’ä»¶ç®¡ç†ï¼Œæ’ä»¶æ³¨å…¥ç­‰ç­‰</li><li><font color = red>target</font> ç¼–è¯‘åå†…å®¹æ”¾ç½®çš„åœ°æ–¹</li></ul><h3 id="POMæ¨¡å‹"><a href="#POMæ¨¡å‹" class="headerlink" title="POMæ¨¡å‹"></a>POMæ¨¡å‹</h3><p><img src="https://s1.ax1x.com/2020/06/19/NK1Jbj.png" alt="NK1Jbj.png"></p><h3 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h3><ul><li>å†…ç½®æ’ä»¶</li><li>æ‹“å±•æ’ä»¶</li></ul>]]></content>
      
      
      <categories>
          
          <category> Mavenä»“åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaWeb </tag>
            
            <tag> Javaé«˜çº§æŠ€æœ¯ </tag>
            
            <tag> Maven </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GitæŒ‡ä»¤æ•´ç†</title>
      <link href="2020/03/10/git-zhi-ling-zheng-li/"/>
      <url>2020/03/10/git-zhi-ling-zheng-li/</url>
      
        <content type="html"><![CDATA[<blockquote><p>éšä¾¿æ•´ç†çš„ä¸€äº›è‡ªç”¨çš„GitæŒ‡ä»¤</p></blockquote><h1 id="GitHubåˆ›å»ºä»“åº“æç¤ºä»£ç "><a href="#GitHubåˆ›å»ºä»“åº“æç¤ºä»£ç " class="headerlink" title="GitHubåˆ›å»ºä»“åº“æç¤ºä»£ç "></a>GitHubåˆ›å»ºä»“åº“æç¤ºä»£ç </h1><pre><code>echo &quot;# é¡¹ç›®å&quot; &gt;&gt; README.mdgit initgit add README.mdgit commit -m &quot;first commit&quot;git remote add origin git@github.com:qiubaiying/é¡¹ç›®å.gitgit push -u origin master</code></pre><p>è‹¥ä»“åº“å­˜åœ¨ç›´æ¥push</p><pre><code>git remote add origin git@github.com:qiubaiying/test.gitgit push -u origin master</code></pre><h1 id="å¸¸ç”¨æ“ä½œ"><a href="#å¸¸ç”¨æ“ä½œ" class="headerlink" title="å¸¸ç”¨æ“ä½œ"></a>å¸¸ç”¨æ“ä½œ</h1><h4 id="åˆ›å»ºä»“åº“ï¼ˆåˆå§‹åŒ–ï¼‰"><a href="#åˆ›å»ºä»“åº“ï¼ˆåˆå§‹åŒ–ï¼‰" class="headerlink" title="åˆ›å»ºä»“åº“ï¼ˆåˆå§‹åŒ–ï¼‰"></a>åˆ›å»ºä»“åº“ï¼ˆåˆå§‹åŒ–ï¼‰</h4><pre><code>åœ¨å½“å‰æŒ‡å®šç›®å½•ä¸‹åˆ›å»ºgit initæ–°å»ºä¸€ä¸ªä»“åº“ç›®å½•git init [project-name]å…‹éš†ä¸€ä¸ªè¿œç¨‹é¡¹ç›®git clone [url]</code></pre><h4 id="æ·»åŠ æ–‡ä»¶åˆ°ç¼“å­˜åŒº"><a href="#æ·»åŠ æ–‡ä»¶åˆ°ç¼“å­˜åŒº" class="headerlink" title="æ·»åŠ æ–‡ä»¶åˆ°ç¼“å­˜åŒº"></a>æ·»åŠ æ–‡ä»¶åˆ°ç¼“å­˜åŒº</h4><pre><code>æ·»åŠ æ‰€æœ‰å˜åŒ–çš„æ–‡ä»¶git add .æ·»åŠ åç§°æŒ‡å®šæ–‡ä»¶git add text.txt</code></pre><h4 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h4><pre><code>è®¾ç½®æäº¤ä»£ç æ—¶çš„ç”¨æˆ·ä¿¡æ¯git config [--global] user.name &quot;[name]&quot;git config [--global] user.email &quot;[email address]&quot;</code></pre><p>â€‹    </p><h4 id="æäº¤"><a href="#æäº¤" class="headerlink" title="æäº¤"></a>æäº¤</h4><pre><code>æäº¤æš‚å­˜åŒºåˆ°ä»“åº“åŒºgit commit -m &quot;msg&quot;# æäº¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°ä»“åº“åŒº$ git commit [file1] [file2] ... -m [message]# æäº¤å·¥ä½œåŒºè‡ªä¸Šæ¬¡commitä¹‹åçš„å˜åŒ–ï¼Œç›´æ¥åˆ°ä»“åº“åŒº$ git commit -a# æäº¤æ—¶æ˜¾ç¤ºæ‰€æœ‰diffä¿¡æ¯$ git commit -v# ä½¿ç”¨ä¸€æ¬¡æ–°çš„commitï¼Œæ›¿ä»£ä¸Šä¸€æ¬¡æäº¤# å¦‚æœä»£ç æ²¡æœ‰ä»»ä½•æ–°å˜åŒ–ï¼Œåˆ™ç”¨æ¥æ”¹å†™ä¸Šä¸€æ¬¡commitçš„æäº¤ä¿¡æ¯$ git commit --amend -m [message]# é‡åšä¸Šä¸€æ¬¡commitï¼Œå¹¶åŒ…æ‹¬æŒ‡å®šæ–‡ä»¶çš„æ–°å˜åŒ–$ git commit --amend [file1] [file2] ...</code></pre><h4 id="è¿œç¨‹åŒæ­¥"><a href="#è¿œç¨‹åŒæ­¥" class="headerlink" title="è¿œç¨‹åŒæ­¥"></a>è¿œç¨‹åŒæ­¥</h4><pre><code># ä¸‹è½½è¿œç¨‹ä»“åº“çš„æ‰€æœ‰å˜åŠ¨$ git fetch [remote]# æ˜¾ç¤ºæ‰€æœ‰è¿œç¨‹ä»“åº“$ git remote -v# æ˜¾ç¤ºæŸä¸ªè¿œç¨‹ä»“åº“çš„ä¿¡æ¯$ git remote show [remote]# å¢åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“ï¼Œå¹¶å‘½å$ git remote add [shortname] [url]# å–å›è¿œç¨‹ä»“åº“çš„å˜åŒ–ï¼Œå¹¶ä¸æœ¬åœ°åˆ†æ”¯åˆå¹¶$ git pull [remote] [branch]# ä¸Šä¼ æœ¬åœ°æŒ‡å®šåˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“$ git push [remote] [branch]# å¼ºè¡Œæ¨é€å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ï¼Œå³ä½¿æœ‰å†²çª$ git push [remote] --force# æ¨é€æ‰€æœ‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“$ git push [remote] --all</code></pre><p>â€‹    </p><h4 id="åˆ†æ”¯"><a href="#åˆ†æ”¯" class="headerlink" title="åˆ†æ”¯"></a>åˆ†æ”¯</h4><pre><code># åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯$ git branch# åˆ—å‡ºæ‰€æœ‰è¿œç¨‹åˆ†æ”¯$ git branch -r# åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯$ git branch -a# æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä½†ä¾ç„¶åœç•™åœ¨å½“å‰åˆ†æ”¯$ git branch [branch-name]# æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯$ git checkout -b [branch]# æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ŒæŒ‡å‘æŒ‡å®šcommit$ git branch [branch] [commit]# æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯å»ºç«‹è¿½è¸ªå…³ç³»$ git branch --track [branch] [remote-branch]# åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯ï¼Œå¹¶æ›´æ–°å·¥ä½œåŒº$ git checkout [branch-name]# åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªåˆ†æ”¯$ git checkout -# å»ºç«‹è¿½è¸ªå…³ç³»ï¼Œåœ¨ç°æœ‰åˆ†æ”¯ä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯ä¹‹é—´$ git branch --set-upstream [branch] [remote-branch]# åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯$ git merge [branch]# é€‰æ‹©ä¸€ä¸ªcommitï¼Œåˆå¹¶è¿›å½“å‰åˆ†æ”¯$ git cherry-pick [commit]# åˆ é™¤åˆ†æ”¯$ git branch -d [branch-name]# åˆ é™¤è¿œç¨‹åˆ†æ”¯$ git push origin --delete [branch-name]$ git branch -dr [remote/branch]</code></pre><h4 id="æ ‡ç­¾Tags"><a href="#æ ‡ç­¾Tags" class="headerlink" title="æ ‡ç­¾Tags"></a>æ ‡ç­¾Tags</h4><pre><code>æ·»åŠ æ ‡ç­¾ åœ¨å½“å‰commitgit tag -a v1.0 -m &#39;xxx&#39; æ·»åŠ æ ‡ç­¾ åœ¨æŒ‡å®šcommitgit tag v1.0 [commit]æŸ¥çœ‹git tagåˆ é™¤git tag -d V1.0åˆ é™¤è¿œç¨‹taggit push origin :refs/tags/[tagName]æ¨é€git push origin --tagsæ‹‰å–git fetch origin tag V1.0æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ŒæŒ‡å‘æŸä¸ªtaggit checkout -b [branch] [tag]</code></pre><h4 id="æŸ¥çœ‹ä¿¡æ¯"><a href="#æŸ¥çœ‹ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹ä¿¡æ¯"></a>æŸ¥çœ‹ä¿¡æ¯</h4><pre><code># æ˜¾ç¤ºæœ‰å˜æ›´çš„æ–‡ä»¶$ git status# æ˜¾ç¤ºå½“å‰åˆ†æ”¯çš„ç‰ˆæœ¬å†å²$ git log# æ˜¾ç¤ºcommitå†å²ï¼Œä»¥åŠæ¯æ¬¡commitå‘ç”Ÿå˜æ›´çš„æ–‡ä»¶$ git log --stat# æœç´¢æäº¤å†å²ï¼Œæ ¹æ®å…³é”®è¯$ git log -S [keyword]# æ˜¾ç¤ºæŸä¸ªcommitä¹‹åçš„æ‰€æœ‰å˜åŠ¨ï¼Œæ¯ä¸ªcommitå æ®ä¸€è¡Œ$ git log [tag] HEAD --pretty=format:%s# æ˜¾ç¤ºæŸä¸ªcommitä¹‹åçš„æ‰€æœ‰å˜åŠ¨ï¼Œå…¶&quot;æäº¤è¯´æ˜&quot;å¿…é¡»ç¬¦åˆæœç´¢æ¡ä»¶$ git log [tag] HEAD --grep feature# æ˜¾ç¤ºæŸä¸ªæ–‡ä»¶çš„ç‰ˆæœ¬å†å²ï¼ŒåŒ…æ‹¬æ–‡ä»¶æ”¹å$ git log --follow [file]$ git whatchanged [file]# æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶ç›¸å…³çš„æ¯ä¸€æ¬¡diff$ git log -p [file]# æ˜¾ç¤ºè¿‡å»5æ¬¡æäº¤$ git log -5 --pretty --oneline# æ˜¾ç¤ºæ‰€æœ‰æäº¤è¿‡çš„ç”¨æˆ·ï¼ŒæŒ‰æäº¤æ¬¡æ•°æ’åº$ git shortlog -sn# æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æ˜¯ä»€ä¹ˆäººåœ¨ä»€ä¹ˆæ—¶é—´ä¿®æ”¹è¿‡$ git blame [file]# æ˜¾ç¤ºæš‚å­˜åŒºå’Œå·¥ä½œåŒºçš„å·®å¼‚$ git diff# æ˜¾ç¤ºæš‚å­˜åŒºå’Œä¸Šä¸€ä¸ªcommitçš„å·®å¼‚$ git diff --cached [file]# æ˜¾ç¤ºå·¥ä½œåŒºä¸å½“å‰åˆ†æ”¯æœ€æ–°commitä¹‹é—´çš„å·®å¼‚$ git diff HEAD# æ˜¾ç¤ºä¸¤æ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚$ git diff [first-branch]...[second-branch]# æ˜¾ç¤ºä»Šå¤©ä½ å†™äº†å¤šå°‘è¡Œä»£ç $ git diff --shortstat &quot;@&#123;0 day ago&#125;&quot;# æ˜¾ç¤ºæŸæ¬¡æäº¤çš„å…ƒæ•°æ®å’Œå†…å®¹å˜åŒ–$ git show [commit]# æ˜¾ç¤ºæŸæ¬¡æäº¤å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶$ git show --name-only [commit]# æ˜¾ç¤ºæŸæ¬¡æäº¤æ—¶ï¼ŒæŸä¸ªæ–‡ä»¶çš„å†…å®¹$ git show [commit]:[filename]# æ˜¾ç¤ºå½“å‰åˆ†æ”¯çš„æœ€è¿‘å‡ æ¬¡æäº¤$ git reflog</code></pre><h4 id="æ’¤é”€"><a href="#æ’¤é”€" class="headerlink" title="æ’¤é”€"></a>æ’¤é”€</h4><pre><code># æ¢å¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°å·¥ä½œåŒº$ git checkout [file]# æ¢å¤æŸä¸ªcommitçš„æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒºå’Œå·¥ä½œåŒº$ git checkout [commit] [file]# æ¢å¤æš‚å­˜åŒºçš„æ‰€æœ‰æ–‡ä»¶åˆ°å·¥ä½œåŒº$ git checkout .# é‡ç½®æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶ï¼Œä¸ä¸Šä¸€æ¬¡commitä¿æŒä¸€è‡´ï¼Œä½†å·¥ä½œåŒºä¸å˜$ git reset [file]# é‡ç½®æš‚å­˜åŒºä¸å·¥ä½œåŒºï¼Œä¸ä¸Šä¸€æ¬¡commitä¿æŒä¸€è‡´$ git reset --hard# é‡ç½®å½“å‰åˆ†æ”¯çš„æŒ‡é’ˆä¸ºæŒ‡å®šcommitï¼ŒåŒæ—¶é‡ç½®æš‚å­˜åŒºï¼Œä½†å·¥ä½œåŒºä¸å˜$ git reset [commit]# é‡ç½®å½“å‰åˆ†æ”¯çš„HEADä¸ºæŒ‡å®šcommitï¼ŒåŒæ—¶é‡ç½®æš‚å­˜åŒºå’Œå·¥ä½œåŒºï¼Œä¸æŒ‡å®šcommitä¸€è‡´$ git reset --hard [commit]# é‡ç½®å½“å‰HEADä¸ºæŒ‡å®šcommitï¼Œä½†ä¿æŒæš‚å­˜åŒºå’Œå·¥ä½œåŒºä¸å˜$ git reset --keep [commit]# æ–°å»ºä¸€ä¸ªcommitï¼Œç”¨æ¥æ’¤é”€æŒ‡å®šcommit# åè€…çš„æ‰€æœ‰å˜åŒ–éƒ½å°†è¢«å‰è€…æŠµæ¶ˆï¼Œå¹¶ä¸”åº”ç”¨åˆ°å½“å‰åˆ†æ”¯$ git revert [commit]# æš‚æ—¶å°†æœªæäº¤çš„å˜åŒ–ç§»é™¤ï¼Œç¨åå†ç§»å…¥$ git stash$ git stash pop</code></pre><h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><pre><code># ç”Ÿæˆä¸€ä¸ªå¯ä¾›å‘å¸ƒçš„å‹ç¼©åŒ…$ git archives</code></pre>]]></content>
      
      
      <categories>
          
          <category> ç»ˆç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç»ˆç«¯ </tag>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
